{"version":3,"sources":["node_modules/curvature/base/Bag.js","node_modules/curvature/base/Bindable.js","node_modules/curvature/base/Cache.js","node_modules/curvature/base/Config.js","node_modules/curvature/base/Dom.js","node_modules/curvature/base/Mixin.js","node_modules/curvature/base/Router.js","node_modules/curvature/base/Routes.js","node_modules/curvature/base/RuleSet.js","node_modules/curvature/base/Tag.js","node_modules/curvature/base/View.js","node_modules/curvature/base/ViewList.js","node_modules/curvature/mixin/EventTargetMixin.js","node_modules/curvature/mixin/PromiseMixin.js","node_modules/curvature/model/Database.js","node_modules/curvature/model/Model.js","node_modules/pokemon-parser/BitArray.js","app/Format.js","app/Processor.js","app/canvas/Canvas.js","app/canvas/canvas.html","app/file/Drop.js","app/file/FileDatabase.js","app/file/FileModel.js","app/file/Icon.js","app/file/drop.html","app/file/icon.html","app/format/BitPerPixel.js","app/format/BytePerPixel.js","app/format/Gameboy1bpp.js","app/format/Gameboy1bppCol.js","app/format/Gameboy2bpp.js","app/initialize.js","app/menu/Menu.js","app/menu/menu.html","app/panel/Panel.js","app/panel/Panelable.js","app/panel/panel.html","app/processor/Deinterlace.js","app/processor/Invert.js","app/processor/RLE.js","app/processor/deinterlace.html","app/processor/invert.html","app/processor/rle.html","node_modules/auto-reload-brunch/vendor/auto-reload.js"],"names":["Format","inputBuffer","outputBuffer","width","Processor","args","parent","Object","assign","panel","widget","bindTo","v","inputName","input","name","title","offset","Number","firstByte","length","buffer","View","Mixin","to","Panelable","Canvas","require","height","scale","tileArea","scrollDelta","decoder","showSettings","canvasStyle","k","tags","canvas","drawDots","wait","style","filename","Uint8Array","onTimeout","frame","event","preventDefault","deltaY","depth","key","ctrlKey","shiftKey","bytes","undefined","willDraw","cancelAnimationFrame","requestAnimationFrame","context","getContext","clearRect","formatter","BytePerPixel","BitPerPixel","Gameboy2bpp","Gameboy1bpp","Gameboy1bppCol","format","slice","output","createImageData","data","pixels","tileWidth","tileHeight","next","putImageData","rootPanel","menu","Menu","panels","add","x","toString","padStart","Drop","files","fileDb","FileDatabase","open","query","store","index","type","FileModel","then","db","select","each","file","push","console","log","Bindable","shuck","dataTransfer","arrayBuffer","Promise","all","range","values","lastModified","size","one","result","record","from","insert","consume","update","openCanvasPanel","database","fileStore","createObjectStore","keyPath","createIndex","unique","Database","Model","Icon","inputPos","byte","bits","bit","address","outputPos","palette","maxTilesX","Math","floor","j","currentTile","currentTileX","currentTileY","tileOffset","fromTileY","fromTileX","fromOriginX","fromOriginY","tileOffsetX","tileOffsetY","byteA","byteB","bitPairs","fromTile","reader","FileReader","readAsArrayBuffer","onload","ceil","i","document","addEventListener","drop","Panel","render","body","links","Invert","RLE","Deinterlace","processor","remove","host","openLeft","openTop","left","top","z","Bag","s","a","ITEM_ADDED","list","window","innerWidth","innerHeight","onRemove","maxX","clientWidth","maxY","clientHeight","sort","b","stopMoving","listen","movementX","movementY","once","RootPanel","Symbol","MyPanel","sideSize","BitArray","b1","get","pixelToRowPixel","b2","pallet","pixel","pEven","xOff","xEven","yOff","Array","map","_","tileSize","bitBuffer","xSize","ySize","buffSize","bufferA","bufferB","bufferC","module","outputWidget","buffers","order","bufB","bufC","fillBuffer","mode","deltaFill","copy","empty","xorFill","accept","bitSize","fill","rleFill","dataFill","setTimeout","ii","read","n","table1","m","set","lastBit","max","tilePixel","oddColumn","column","columnOffset","inColumn","bitsA","bitsB","bitA","bitB","WebSocket","MozWebSocket","br","brunch","ar","disabled","_ar","cacheBuster","url","date","round","Date","now","replace","indexOf","browser","navigator","userAgent","toLowerCase","forceRepaint","reloaders","page","location","reload","stylesheet","call","querySelectorAll","filter","link","val","getAttribute","href","forEach","offsetHeight","javascript","scripts","textScripts","script","text","srcScripts","src","loaded","onLoad","eval","newScript","createElement","async","head","appendChild","port","server","hostname","connect","connection","onmessage","message","reloader","onerror","readyState","close","onclose"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC52BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1zEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnsBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ICtHaA,M,GAQZ,gBAAYC,WAAZ,EAAyBC,YAAzB,EAAuCC,KAAvC,EACA;AAAA;;AAAA,qCAPa,CAOb;;AAAA,sCANa,CAMb;;AAAA,qCALa,CAKb;;AAAA,oCAJa,CAIb;;AAAA,iCAHa,CAGb;;AACC,OAAKF,WAAL,GAAoBA,WAApB;AACA,OAAKC,YAAL,GAAoBA,YAApB;AAEA,OAAKC,KAAL,GAAaA,KAAb;AACA,C;;;;;;;;;;;;;;;ACdF;;AACA;;AAEA;;;;;;;;;;;;;;;;;;IAEaC,S;;;;;AAEZ,qBAAYC,IAAZ,EAAiBC,MAAjB,EACA;AAAA;;AAAA;;AACC,8BAAMD,IAAN,EAAYC,MAAZ;AAEAC,UAAM,CAACC,MAAP,CAAc,MAAKC,KAAL,CAAWJ,IAAzB,EAA+B;AAACK,YAAM;AAAP,KAA/B;;AAEA,UAAKL,IAAL,CAAUM,MAAV,CAAiB,OAAjB,EAA0B,UAAAC,CAAC,EAAI;AAC9B,UAAG,CAACA,CAAJ,EACA;AACC;AACA;;AAED,YAAKP,IAAL,CAAUQ,SAAV,GAAsBD,CAAC,CAACP,IAAF,CAAOS,KAAP,GAAeF,CAAC,CAACP,IAAF,CAAOS,KAAP,CAAaC,IAA5B,GAAmCH,CAAC,CAACP,IAAF,CAAOW,KAAhE;AACA,YAAKX,IAAL,CAAUY,MAAV,GAAsBC,MAAM,CAACN,CAAC,CAACP,IAAF,CAAOc,SAAR,CAA5B;AACA,YAAKd,IAAL,CAAUe,MAAV,GAAsBF,MAAM,CAACN,CAAC,CAACP,IAAF,CAAOgB,MAAP,CAAcD,MAAf,CAAN,GAA+B,MAAKf,IAAL,CAAUY,MAA/D;AACA,KATD;;AALD;AAeC;;;EAlB6BK,W;;;;AAqB/BC,aAAMC,EAAN,CAASpB,SAAT,EAAoBqB,oBAApB;;;;;;;;;;;;;AC1BA;;AACA;;AAEA;;AACA;;AAEA;;AACA;;AAEA;;AACA;;AAEA;;AACA;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;IAEaC,M;;;;;AAIZ,kBAAYrB,IAAZ,EAAkBC,MAAlB,EACA;AAAA;;AAAA;;AACC,8BAAMD,IAAN,EAAYC,MAAZ;;AADD,+DAHWqB,OAAO,CAAC,eAAD,CAGlB;;AAGC,UAAKtB,IAAL,CAAUuB,MAAV,GAAmBvB,IAAI,CAACuB,MAAL,IAAe,GAAlC;AACA,UAAKvB,IAAL,CAAUF,KAAV,GAAmBE,IAAI,CAACF,KAAL,IAAe,GAAlC;AACA,UAAKE,IAAL,CAAUwB,KAAV,GAAmBxB,IAAI,CAACwB,KAAL,IAAe,CAAlC;AAEA,UAAKxB,IAAL,CAAUyB,QAAV,GAAqB,CAArB;AACA,UAAKzB,IAAL,CAAUY,MAAV,GAAqB,CAArB;AACA,UAAKc,WAAL,GAAqB,CAArB;AAEA,UAAK1B,IAAL,CAAU2B,OAAV,GAAqB3B,IAAI,CAAC2B,OAAL,IAAgB,SAArC;AACA,UAAK3B,IAAL,CAAU4B,YAAV,GAAyB,KAAzB;AAEA,UAAK5B,IAAL,CAAUS,KAAV,GAAkBT,IAAI,CAACS,KAAL,IAAc,KAAhC;AAEA,UAAKT,IAAL,CAAUc,SAAV,GAAsB,MAAtB;AAEAZ,UAAM,CAACC,MAAP,CAAc,MAAKC,KAAL,CAAWJ,IAAzB,EAA+B;AAC9BK,YAAM,+BADwB;AAE5BM,WAAK,EAAEX,IAAI,CAACW,KAAL,IAAcX,IAAI,CAACS,KAAL,IAAcT,IAAI,CAACS,KAAL,CAAWC,IAAvC,IAA+C;AAF1B,KAA/B;AAlBD;AAsBC;;;;iCAGD;AAAA;;AACC,UAAMmB,WAAW,GAAG;AACnB,mBAAc,KAAK7B,IAAL,CAAUwB,KADL;AAEjB,mBAAY,KAAKxB,IAAL,CAAUF,KAFL;AAGjB,oBAAY,KAAKE,IAAL,CAAUuB;AAHL,OAApB;AAMA,WAAKvB,IAAL,CAAUM,MAAV,CAAiB,QAAjB,EAA2B,UAACC,CAAD,EAAGuB,CAAH,EAAS;AACnC,YAAG,CAAC,MAAI,CAAC9B,IAAL,CAAUgB,MAAX,IAAqB,CAAC,MAAI,CAACe,IAAL,CAAUC,MAAnC,EACA;AACC;AACA;;AAED,cAAI,CAACC,QAAL,CAAc,MAAI,CAACjC,IAAL,CAAUgB,MAAxB;AACA,OAPD,EAOG;AAACkB,YAAI,EAAE;AAAP,OAPH;AASA,WAAKlC,IAAL,CAAUM,MAAV,CAAiB,OAAjB,EAA0B,UAACC,CAAD,EAAGuB,CAAH,EAAS;AAClC,YAAG,MAAI,CAACC,IAAL,CAAUC,MAAb,EACA;AACCH,qBAAW,CAAC,SAAD,CAAX,GAAyBtB,CAAzB;;AACA,gBAAI,CAACwB,IAAL,CAAUC,MAAV,CAAiBG,KAAjB,CAAuBN,WAAvB;AACA;;AAED,YAAG,MAAI,CAAC7B,IAAL,CAAUgB,MAAb,EACA;AACC,gBAAI,CAACiB,QAAL,CAAc,MAAI,CAACjC,IAAL,CAAUgB,MAAxB;AACA;AACD,OAXD,EAWG;AAACkB,YAAI,EAAE;AAAP,OAXH;AAaA,WAAKlC,IAAL,CAAUM,MAAV,CAAiB,OAAjB,EAA0B,UAACC,CAAD,EAAGuB,CAAH,EAAS;AAElCvB,SAAC,GAAGM,MAAM,CAACN,CAAD,CAAV;;AAEA,YAAG,MAAI,CAACwB,IAAL,CAAUC,MAAb,EACA;AACCH,qBAAW,CAAC,SAAD,CAAX,GAAyBtB,CAAzB;AACA,gBAAI,CAACwB,IAAL,CAAUC,MAAV,CAAiBlC,KAAjB,GAAyBS,CAAzB;;AACA,gBAAI,CAACwB,IAAL,CAAUC,MAAV,CAAiBG,KAAjB,CAAuBN,WAAvB;AACA;;AAED,YAAG,MAAI,CAAC7B,IAAL,CAAUgB,MAAb,EACA;AACC,gBAAI,CAACiB,QAAL,CAAc,MAAI,CAACjC,IAAL,CAAUgB,MAAxB;AACA;AACD,OAfD,EAeG;AAACkB,YAAI,EAAE;AAAP,OAfH;AAiBA,WAAKlC,IAAL,CAAUM,MAAV,CAAiB,QAAjB,EAA2B,UAACC,CAAD,EAAGuB,CAAH,EAAS;AAEnCvB,SAAC,GAAGM,MAAM,CAACN,CAAD,CAAV;;AAEA,YAAG,MAAI,CAACwB,IAAL,CAAUC,MAAb,EACA;AACCH,qBAAW,CAAC,UAAD,CAAX,GAA0BtB,CAA1B;AACA,gBAAI,CAACwB,IAAL,CAAUC,MAAV,CAAiBT,MAAjB,GAA0BhB,CAA1B;;AACA,gBAAI,CAACwB,IAAL,CAAUC,MAAV,CAAiBG,KAAjB,CAAuBN,WAAvB;AACA;;AAED,YAAG,MAAI,CAAC7B,IAAL,CAAUgB,MAAb,EACA;AACC,gBAAI,CAACiB,QAAL,CAAc,MAAI,CAACjC,IAAL,CAAUgB,MAAxB;AACA;AAED,OAhBD,EAgBG;AAACkB,YAAI,EAAE;AAAP,OAhBH;AAkBA,WAAKlC,IAAL,CAAUM,MAAV,CAAiB,OAAjB,EAA0B,UAAAC,CAAC,EAAI;AAC9B,YAAG,CAACA,CAAJ,EACA;AACC;AACA;;AAED,cAAI,CAACP,IAAL,CAAUoC,QAAV,GAAqB7B,CAAC,CAACG,IAAvB;AAEA,cAAI,CAACV,IAAL,CAAUgB,MAAV,GAAmB,IAAIqB,UAAJ,CAAe9B,CAAC,CAACS,MAAjB,CAAnB;;AAEA,cAAI,CAACsB,SAAL,CAAe,CAAf,EAAkB,YAAM;AACvB,gBAAI,CAACL,QAAL,CAAc,MAAI,CAACjC,IAAL,CAAUgB,MAAxB;AACA,SAFD;AAGA,OAbD;AAeA,WAAKhB,IAAL,CAAUM,MAAV,CAAiB,SAAjB,EAA4B,UAAAC,CAAC,EAAI;AAEhC,YAAG,CAAC,MAAI,CAACP,IAAL,CAAUgB,MAAd,EACA;AACC;AACA;;AAED,cAAI,CAACiB,QAAL,CAAc,MAAI,CAACjC,IAAL,CAAUgB,MAAxB;AAEA,OATD,EASG;AAACuB,aAAK,EAAE;AAAR,OATH;AAUA;;;0BAEKC,K,EACN;AACCA,WAAK,CAACC,cAAN;;AAEA,UAAGD,KAAK,CAACE,MAAN,GAAe,CAAf,IAAoB,KAAK1C,IAAL,CAAUY,MAAV,GAAmB,CAA1C,EACA;AACC,aAAKZ,IAAL,CAAUY,MAAV,IAAoB,KAAKZ,IAAL,CAAUF,KAAV,GAAkB,KAAK6C,KAA3C;AACA,OAHD,MAIK,IAAGH,KAAK,CAACE,MAAN,GAAe,CAAlB,EACL;AACC,aAAK1C,IAAL,CAAUY,MAAV,IAAoB,KAAKZ,IAAL,CAAUF,KAAV,GAAkB,KAAK6C,KAA3C;AACA;;AAED,UAAG,IAAI,KAAK3C,IAAL,CAAUY,MAAjB,EACA;AACC,aAAKZ,IAAL,CAAUY,MAAV,GAAmB,CAAnB;AACA;AACD;;;4BAEO4B,K,EACR;AACC,UAAGA,KAAK,CAACI,GAAN,KAAc,UAAjB,EACA;AACC,aAAK5C,IAAL,CAAUY,MAAV,IAAoB,KAAKZ,IAAL,CAAUF,KAAV,GAAkB,KAAKE,IAAL,CAAUuB,MAA5B,IAAsC,KAAKoB,KAAL,GAAa,CAAnD,CAApB;AACA,aAAKV,QAAL;AACA,OAJD,MAKK,IAAGO,KAAK,CAACI,GAAN,KAAc,QAAjB,EACL;AACC,aAAK5C,IAAL,CAAUY,MAAV,IAAoB,KAAKZ,IAAL,CAAUF,KAAV,GAAkB,KAAKE,IAAL,CAAUuB,MAA5B,IAAsC,KAAKoB,KAAL,GAAa,CAAnD,CAApB;;AAEA,YAAG,KAAK3C,IAAL,CAAUY,MAAV,GAAmB,CAAtB,EACA;AACC,eAAKZ,IAAL,CAAUY,MAAV,GAAmB,CAAnB;AACA;;AAED,aAAKqB,QAAL;AACA,OAVI,MAWA,IAAGO,KAAK,CAACI,GAAN,KAAc,WAAjB,EACL;AACC,YAAGJ,KAAK,CAACK,OAAT,EACA;AACC,eAAK7C,IAAL,CAAUY,MAAV,IAAoB,KAAK+B,KAAzB;AACA,SAHD,MAIK,IAAGH,KAAK,CAACM,QAAT,EACL;AACC,eAAK9C,IAAL,CAAUY,MAAV,IAAoB,KAAKZ,IAAL,CAAUF,KAAV,GAAmB,KAAK6C,KAAxB,GAAgC,CAApD;AACA,SAHI,MAKL;AACC,eAAK3C,IAAL,CAAUY,MAAV,IAAoB,KAAKZ,IAAL,CAAUF,KAAV,GAAkB,KAAK6C,KAA3C;AACA;;AAED,aAAKV,QAAL;AACA,OAhBI,MAiBA,IAAGO,KAAK,CAACI,GAAN,KAAc,SAAjB,EACL;AACC,YAAGJ,KAAK,CAACK,OAAT,EACA;AACC,eAAK7C,IAAL,CAAUY,MAAV,IAAoB,KAAK+B,KAAzB;AACA,SAHD,MAIK,IAAGH,KAAK,CAACM,QAAT,EACL;AACC,eAAK9C,IAAL,CAAUY,MAAV,IAAoB,KAAKZ,IAAL,CAAUF,KAAV,GAAmB,KAAK6C,KAAxB,GAAgC,CAApD;AACA,SAHI,MAKL;AACC,eAAK3C,IAAL,CAAUY,MAAV,IAAoB,KAAKZ,IAAL,CAAUF,KAAV,GAAkB,KAAK6C,KAA3C;AACA;;AAED,YAAG,KAAK3C,IAAL,CAAUY,MAAV,GAAmB,CAAtB,EACA;AACC,eAAKZ,IAAL,CAAUY,MAAV,GAAmB,CAAnB;AACA;;AACD,aAAKqB,QAAL;AACA,OApBI,MAqBA,IAAGO,KAAK,CAACI,GAAN,KAAc,YAAjB,EACL;AACC,YAAGJ,KAAK,CAACK,OAAT,EACA;AACC,eAAK7C,IAAL,CAAUY,MAAV;AACA,SAHD,MAIK,IAAG4B,KAAK,CAACM,QAAT,EACL;AACC,eAAK9C,IAAL,CAAUY,MAAV,IAAoB,KAAKa,QAAL,IAAiB,KAAKkB,KAAL,GAAa,CAA9B,IAAmC,CAAvD;AACA,SAHI,MAKL;AACC,eAAK3C,IAAL,CAAUY,MAAV,IAAoB,KAAKa,QAAL,IAAiB,KAAKkB,KAAL,GAAa,CAA9B,CAApB;AACA;;AAED,aAAKV,QAAL;AACA,OAhBI,MAiBA,IAAGO,KAAK,CAACI,GAAN,KAAc,WAAjB,EACL;AACC,YAAGJ,KAAK,CAACK,OAAT,EACA;AACC,eAAK7C,IAAL,CAAUY,MAAV;AACA,SAHD,MAIK,IAAG4B,KAAK,CAACM,QAAT,EACL;AACC,eAAK9C,IAAL,CAAUY,MAAV,IAAoB,KAAKa,QAAL,IAAiB,KAAKkB,KAAL,GAAa,CAA9B,IAAmC,CAAvD;AACA,SAHI,MAKL;AACC,eAAK3C,IAAL,CAAUY,MAAV,IAAoB,KAAKa,QAAL,IAAiB,KAAKkB,KAAL,GAAa,CAA9B,CAApB;AACA;;AAED,YAAG,KAAK3C,IAAL,CAAUY,MAAV,GAAmB,CAAtB,EACA;AACC,eAAKZ,IAAL,CAAUY,MAAV,GAAmB,CAAnB;AACA;;AACD,aAAKqB,QAAL;AACA,OApBI,MAqBA,IAAGO,KAAK,CAACI,GAAN,KAAc,MAAjB,EACL;AACC,aAAK5C,IAAL,CAAUY,MAAV,GAAmB,CAAnB;AACA,aAAKqB,QAAL;AACA,OAJI,MAKA,IAAGO,KAAK,CAACI,GAAN,KAAc,KAAjB,EACL;AACC,aAAK5C,IAAL,CAAUY,MAAV,GAAmB,KAAKZ,IAAL,CAAUgB,MAAV,CAAiBD,MAApC;AACA,aAAKkB,QAAL;AACA;AACD;;;+BAGD;AAAA;;AAAA,UADSc,KACT,uEADiBC,SACjB;;AACC,UAAG,KAAKC,QAAR,EACA;AACCC,4BAAoB,CAAC,KAAKD,QAAN,CAApB;AACA;;AAED,WAAKA,QAAL,GAAgBE,qBAAqB,CAAC,YAAI;AACzC,YAAGJ,KAAK,KAAKC,SAAb,EACA;AACCD,eAAK,GAAG,MAAI,CAAC/C,IAAL,CAAUgB,MAAlB;AACA;;AAED,YAAMgB,MAAM,GAAI,MAAI,CAACD,IAAL,CAAUC,MAA1B;AACA,YAAMoB,OAAO,GAAGpB,MAAM,CAACqB,UAAP,CAAkB,IAAlB,CAAhB;AAEAF,6BAAqB,CAAC;AAAA,iBAAIC,OAAO,CAACE,SAAR,CAAkB,CAAlB,EAAqB,CAArB,EAAwBtB,MAAM,CAAClC,KAA/B,EAAsCkC,MAAM,CAACT,MAA7C,CAAJ;AAAA,SAAD,CAArB;AAEA,YAAIgC,SAAS,GAAG,IAAhB;;AAEA,gBAAO,MAAI,CAACvD,IAAL,CAAU2B,OAAjB;AAEC,eAAK,OAAL;AACC4B,qBAAS,GAAGC,0BAAZ;AACA;;AACD,eAAK,MAAL;AACCD,qBAAS,GAAGE,wBAAZ;AACA;;AACD,eAAK,SAAL;AACCF,qBAAS,GAAGG,wBAAZ;AACA;;AACD,eAAK,cAAL;AACCH,qBAAS,GAAGI,wBAAZ;AACA;;AACD,eAAK,mBAAL;AACCJ,qBAAS,GAAGK,8BAAZ;AACA;AAhBF;;AAmBA,cAAI,CAACC,MAAL,CAAYN,SAAZ,EAAuBR,KAAvB;AACA,OAjCoC,CAArC;AAkCA;;;2BAEMQ,S,EAAWR,K,EAClB;AACC,UAAMf,MAAM,GAAI,KAAKD,IAAL,CAAUC,MAA1B;AACA,UAAMoB,OAAO,GAAGpB,MAAM,CAACqB,UAAP,CAAkB,IAAlB,CAAhB;AAEA,UAAMzD,WAAW,GAAImD,KAAK,CAACe,KAAN,CAAY,KAAK9D,IAAL,CAAUY,MAAtB,CAArB;AACA,UAAMmD,MAAM,GAASX,OAAO,CAACY,eAAR,CAAwB,KAAKhE,IAAL,CAAUF,KAAlC,EAAyC,KAAKE,IAAL,CAAUuB,MAAnD,CAArB;AACA,UAAM1B,YAAY,GAAGkE,MAAM,CAACE,IAA5B;AAEA,UAAMC,MAAM,GAAG,IAAIX,SAAJ,CACd3D,WADc,EAEZC,YAFY,EAGZ,KAAKG,IAAL,CAAUF,KAHE,CAAf;AAMA,WAAK2B,QAAL,GAAgByC,MAAM,CAACC,SAAP,GAAmBD,MAAM,CAACE,UAA1C;AACA,WAAKzB,KAAL,GAAgBuB,MAAM,CAACvB,KAAvB;;AAEA,aAAOuB,MAAM,CAACG,IAAP,EAAP;AAAsB;AAAtB;;AAEAlB,2BAAqB,CACpB;AAAA,eAAIC,OAAO,CAACkB,YAAR,CAAqBP,MAArB,EAA6B,CAA7B,EAAgC,CAAhC,CAAJ;AAAA,OADoB,CAArB;AAGA;;;qCAGD;AACC,WAAK/D,IAAL,CAAU4B,YAAV,GAAyB,CAAC,KAAK5B,IAAL,CAAU4B,YAApC;AACA;;;6BAGD;AACC,WAAK5B,IAAL,CAAUwB,KAAV;AACA;;;8BAGD;AACC,WAAKxB,IAAL,CAAUwB,KAAV;AACA;;;wBAEGgB,K,EACJ;AACC,UAAM+B,SAAS,GAAG,KAAKvE,IAAL,CAAUI,KAA5B;AAEA,UAAMK,KAAK,GAAG,IAAd;AACA,UAAM+D,IAAI,GAAI,IAAIC,UAAJ,CAAS;AAAChE,aAAK,EAALA,KAAD;AAAQL,aAAK,EAAEmE;AAAf,OAAT,EAAoC,IAApC,CAAd;AAEAA,eAAS,CAACG,MAAV,CAAiBC,GAAjB,CAAqBH,IAAI,CAACpE,KAA1B;AACA;;;wBAEGwE,C,EACJ;AACC,aAAO/D,MAAM,CAAC+D,CAAD,CAAN,CAAUC,QAAV,CAAmB,EAAnB,EAAuBC,QAAvB,CAAgC,CAAhC,EAAmC,GAAnC,CAAP;AACA;;;;EAtV0B7D,W;;;;AAyV5BC,aAAMC,EAAN,CAASE,MAAT,EAAiBD,oBAAjB;;;AC1WA;AAAA;AAAA;AAAA;;;;;;;;;;;ACAA;;AAEA;;AACA;;AACA;;AAEA;;AACA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAEa2D,I;;;;;AAIZ,gBAAY/E,IAAZ,EAAkBC,MAAlB,EACA;AAAA;;AAAA;;AACC,8BAAMD,IAAN,EAAYC,MAAZ;;AADD,+DAHWqB,OAAO,CAAC,aAAD,CAGlB;;AAGC,UAAKtB,IAAL,CAAUgF,KAAV,GAAkB,EAAlB;AAEA,UAAKC,MAAL,GAAcC,2BAAaC,IAAb,CAAkB,OAAlB,EAA2B,CAA3B,CAAd;AAEA,QAAMC,KAAK,GAAG;AACbC,WAAK,EAAE,OADM;AAEXC,WAAK,EAAE,MAFI;AAGXC,UAAI,EAAGC;AAHI,KAAd;;AAMA,UAAKP,MAAL,CAAYQ,IAAZ,CAAiB,UAACC,EAAD;AAAA,aAAOA,EAAE,CAACC,MAAH,CAAUP,KAAV,EAAiBQ,IAAjB,CAAsB,UAAAC,IAAI,EAAI;AACrDA,YAAI,IAAI,MAAK7F,IAAL,CAAUgF,KAAV,CAAgBc,IAAhB,CAAqBD,IAArB,CAAR;AACAA,YAAI,IAAIE,OAAO,CAACC,GAAR,CAAYH,IAAZ,EAAkBI,mBAASC,KAAT,CAAeL,IAAf,CAAlB,CAAR;AACA,OAHuB,CAAP;AAAA,KAAjB;;AAbD;AAiBC;;;;yBAEIrD,K,EACL;AAAA;;AACCA,WAAK,CAACC,cAAN;AAEA,UAAMoD,IAAI,GAAKrD,KAAK,CAAC2D,YAAN,CAAmBnB,KAAnB,CAAyB,CAAzB,CAAf;AACA,UAAMhE,MAAM,GAAG6E,IAAI,CAACO,WAAL,EAAf;AACA,UAAMnB,MAAM,GAAG,KAAKA,MAApB;AAEAoB,aAAO,CAACC,GAAR,CAAY,CAACtF,MAAD,EAASiE,MAAT,CAAZ,EAA8BQ,IAA9B,CAAmC,gBAAoB;AAAA;AAAA,YAAlBzE,MAAkB;AAAA,YAAViE,MAAU;;AAEtD,YAAMG,KAAK,GAAG;AACbC,eAAK,EAAE,OADM;AAEXC,eAAK,EAAE,MAFI;AAGXiB,eAAK,EAAEV,IAAI,CAACnF,IAHD;AAIX6E,cAAI,EAAGC;AAJI,SAAd;AAOA,YAAMgB,MAAM,GAAG;AACd9F,cAAI,EAAEmF,IAAI,CAACnF,IADG;AAEZ+F,sBAAY,EAAEZ,IAAI,CAACY,YAFP;AAGZC,cAAI,EAAEb,IAAI,CAACa,IAHC;AAIZnB,cAAI,EAAEM,IAAI,CAACN,IAJC;AAKZvE,gBAAM,EAAEA;AALI,SAAf;AAQAiE,cAAM,CAACU,MAAP,CAAcP,KAAd,EAAqBuB,GAArB,GAA2BlB,IAA3B,CAAgC,UAAAmB,MAAM,EAAI;AAEzC,cAAIC,MAAM,GAAGD,MAAM,CAACC,MAApB;;AAEA,cAAG,CAACA,MAAJ,EACA;AACCA,kBAAM,GAAGrB,qBAAUsB,IAAV,CAAeN,MAAf,CAAT;AACAvB,kBAAM,CAAC8B,MAAP,CAAc,OAAd,EAAuBF,MAAvB;AACA,WAJD,MAMA;AACCA,kBAAM,CAACG,OAAP,CAAeR,MAAf;AACAvB,kBAAM,CAACgC,MAAP,CAAc,OAAd,EAAuBJ,MAAvB;AACA;;AAED,gBAAI,CAAC7G,IAAL,CAAUgF,KAAV,CAAgBc,IAAhB,CAAqBe,MAArB;;AAEA,gBAAI,CAACK,eAAL,CAAqBL,MAArB;AACA,SAlBD;AAmBA,OApCD;AAqCA;;;6BAEQrE,K,EACT;AACCA,WAAK,CAACC,cAAN;AACA;;;gCAEWD,K,EAAOqD,I,EACnB;AACC,WAAKqB,eAAL,CAAqBrB,IAArB;AACA;;;oCAEeA,I,EAChB;AACC,UAAMtB,SAAS,GAAG,KAAKvE,IAAL,CAAUI,KAA5B;AAEA,UAAM4B,MAAM,GAAG,IAAIX,cAAJ,CAAW;AAACZ,aAAK,EAAEoF,IAAR;AAAczF,aAAK,EAAEmE;AAArB,OAAX,CAAf;AAEAA,eAAS,CAACG,MAAV,CAAiBC,GAAjB,CAAqB3C,MAAM,CAAC5B,KAA5B;AACA;;;;EAxFwBa,W;;;;;;;;;;;;;;;ACV1B;;;;;;;;;;;;;;;;;;;;;;IAEaiE,Y;;;;;;;;;;;;;+BAEDiC,Q,EACX;AACC,UAAMC,SAAS,GAAG,KAAKC,iBAAL,CAAuB,OAAvB,EAAgC;AAACC,eAAO,EAAE;AAAV,OAAhC,CAAlB;AAEAF,eAAS,CAACG,WAAV,CAAsB,MAAtB,EAA8B,MAA9B,EAAsC;AAACC,cAAM,EAAE;AAAT,OAAtC;AACA;;;;EAPgCC,mB;;;;;;;;;;;;;;;ACFlC;;;;;;;;;;;;;;;;;;;;;;;;IAEajC,S;;;;;;;;;;;;;;;;;;;;;;;;;;;;;+BAEK;AAAE,aAAO,CAAC,MAAD,CAAP;AAAiB;;;;EAFNkC,a;;;;;;;;;;;;;;;ACF/B;;;;;;;;;;;;;;;;;;;;IAEaC,I;;;;;AAIZ,gBAAY3H,IAAZ,EAAkBC,MAAlB,EACA;AAAA;;AAAA;;AACC,8BAAMD,IAAN,EAAYC,MAAZ;;AADD,+DAHWqB,OAAO,CAAC,aAAD,CAGlB;;AAAA;AAEC;;;EAPwBL,W;;;;;CCF1B;AAAA;AAAA;AAAA;CCAA;AAAA;AAAA;AAAA;;;;;;;;;;;ACAA;;;;;;;;;;;;;;;;;;;;;;;;IAEawC,W;;;;;;;;;;;;;;;;4DAEJ,C;;;;;;;2BAGR;AACC,UAAG,KAAKmE,QAAL,IAAiB,KAAKhI,WAAL,CAAiBmB,MAArC,EACA;AACC;AACA;;AAED,UAAM8G,KAAI,GAAG,KAAKjI,WAAL,CAAiB,KAAKgI,QAAL,EAAjB,CAAb;AAEA,UAAME,IAAI,GAAG,CACZ,CAACD,KAAI,GAAG,GAAR,KAAuB,CADX,EAEV,CAACA,KAAI,GAAG,EAAR,KAAuB,CAFb,EAGV,CAACA,KAAI,GAAG,EAAR,KAAuB,CAHb,EAIV,CAACA,KAAI,GAAG,EAAR,KAAuB,CAJb,EAKV,CAACA,KAAI,GAAG,CAAR,KAAuB,CALb,EAMV,CAACA,KAAI,GAAG,CAAR,KAAuB,CANb,EAOV,CAACA,KAAI,GAAG,CAAR,KAAuB,CAPb,EAQV,CAACA,KAAI,GAAG,CAAR,KAAuB,CARb,CAAb;;AAWA,+BAAiBC,IAAjB,2BACA;AADI,YAAMC,GAAG,YAAT;AAEH,YAAMC,OAAO,GAAG,KAAKC,SAAL,GAAiB,CAAjC;AAEA,aAAKpI,YAAL,CAAmBmI,OAAO,GAAG,CAA7B,IAAmCD,GAAG,GAAG,GAAzC;AACA,aAAKlI,YAAL,CAAmBmI,OAAO,GAAG,CAA7B,IAAmCD,GAAG,GAAG,GAAzC;AACA,aAAKlI,YAAL,CAAmBmI,OAAO,GAAG,CAA7B,IAAmCD,GAAG,GAAG,GAAzC;AACA,aAAKlI,YAAL,CAAmBmI,OAAO,GAAG,CAA7B,IAAmC,GAAnC;AAEA,aAAKC,SAAL;AACA;;AAED,aAAO,KAAKA,SAAL,GAAiB,CAAjB,GAAqB,KAAKpI,YAAL,CAAkBkB,MAA9C;AACA;;;;EArC+BpB,e;;;;;;;;;;;;;;;ACFjC;;;;;;;;;;;;;;;;;;;;;;;;IAEa6D,Y;;;;;;;;;;;;;;;;4DAEJ,C;;;;;;;2BAGR;AACC,UAAG,KAAKoE,QAAL,IAAiB,KAAKhI,WAAL,CAAiBmB,MAArC,EACA;AACC;AACA;;AAED,UAAM8G,KAAI,GAAG,KAAKjI,WAAL,CAAiB,KAAKgI,QAAL,EAAjB,CAAb;AAEA,UAAMI,OAAO,GAAG,KAAKC,SAAL,GAAiB,CAAjC;AAEA,WAAKpI,YAAL,CAAmBmI,OAAO,GAAG,CAA7B,IAAmCH,KAAnC;AACA,WAAKhI,YAAL,CAAmBmI,OAAO,GAAG,CAA7B,IAAmCH,KAAnC;AACA,WAAKhI,YAAL,CAAmBmI,OAAO,GAAG,CAA7B,IAAmCH,KAAnC;AACA,WAAKhI,YAAL,CAAmBmI,OAAO,GAAG,CAA7B,IAAmC,GAAnC;AAEA,WAAKC,SAAL;AAEA,aAAOD,OAAO,GAAG,KAAKnI,YAAL,CAAkBkB,MAAnC;AACA;;;;EAvBgCpB,e;;;;;;;;;;;;;;;ACFlC;;;;;;;;;;;;;;;;;;;;;;;;IAEagE,W;;;;;;;;;;;;;;;;gEAEC,C;;iEACA,C;;4DACA,C;;;;;;;2BAGb;AACC,UAAG,KAAKiE,QAAL,IAAiB,KAAKhI,WAAL,CAAiBmB,MAArC,EACA;AACC;AACA;;AAED,UAAMmH,OAAO,GAAI,CAChB,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,CADgB,EAEd,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,CAFc,EAGd,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,CAHc,EAId,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,CAJc,CAAjB;AAOA,UAAML,KAAI,GAAG,KAAKjI,WAAL,CAAiB,KAAKgI,QAAL,EAAjB,CAAb;AAEA,UAAMO,SAAS,GAAGC,IAAI,CAACC,KAAL,CAAW,KAAKvI,KAAL,GAAa,KAAKqE,SAA7B,CAAlB;AAEA,UAAM2D,IAAI,GAAG,CACZ,CAACD,KAAI,GAAG,CAAR,KAAuB,CADX,EAEV,CAACA,KAAI,GAAG,CAAR,KAAuB,CAFb,EAGV,CAACA,KAAI,GAAG,CAAR,KAAuB,CAHb,EAIV,CAACA,KAAI,GAAG,CAAR,KAAuB,CAJb,EAKV,CAACA,KAAI,GAAG,EAAR,KAAuB,CALb,EAMV,CAACA,KAAI,GAAG,EAAR,KAAuB,CANb,EAOV,CAACA,KAAI,GAAG,EAAR,KAAuB,CAPb,EAQV,CAACA,KAAI,GAAG,GAAR,KAAuB,CARb,CAAb;AAWA,UAAMpG,QAAQ,GAAG,KAAK0C,SAAL,GAAiB,KAAKC,UAAvC;;AAEA,WAAI,IAAMkE,CAAV,IAAeR,IAAf,EACA;AACC,YAAMS,WAAW,GAAIH,IAAI,CAACC,KAAL,CAAW,KAAKJ,SAAL,GAAiBxG,QAA5B,CAArB;AAEA,YAAM+G,YAAY,GAAGD,WAAW,GAAGJ,SAAnC;AACA,YAAMM,YAAY,GAAGL,IAAI,CAACC,KAAL,CAAWE,WAAW,GAAGJ,SAAzB,CAArB;AAEA,YAAMO,UAAU,GAAK,KAAKT,SAAL,GAAiBxG,QAAtC;AAEA,YAAMkH,SAAS,GAAMP,IAAI,CAACC,KAAL,CAAWK,UAAU,GAAG,KAAKvE,SAA7B,CAArB;AACA,YAAMyE,SAAS,GAAM,KAAKzE,SAAL,GAAkBuE,UAAU,GAAG,KAAKvE,SAAzD;AAEA,YAAM0E,WAAW,GAAIL,YAAY,GAAG,KAAKrE,SAArB,GAAkCyE,SAAtD;AACA,YAAME,WAAW,GAAIL,YAAY,GAAG,KAAKrE,UAArB,GAAmCuE,SAAvD;AAEA,YAAMX,OAAO,GAAGG,SAAS,GAAG,KAAKhE,SAAjB,GAA6B2E,WAA7B,GAA2CD,WAA3D;AAEA,aAAKhJ,YAAL,CAAkBmI,OAAO,GAAG,CAAV,GAAc,CAAhC,IAAqCE,OAAO,CAAEJ,IAAI,CAACQ,CAAD,CAAN,CAAP,CAAmB,CAAnB,CAArC;AACA,aAAKzI,YAAL,CAAkBmI,OAAO,GAAG,CAAV,GAAc,CAAhC,IAAqCE,OAAO,CAAEJ,IAAI,CAACQ,CAAD,CAAN,CAAP,CAAmB,CAAnB,CAArC;AACA,aAAKzI,YAAL,CAAkBmI,OAAO,GAAG,CAAV,GAAc,CAAhC,IAAqCE,OAAO,CAAEJ,IAAI,CAACQ,CAAD,CAAN,CAAP,CAAmB,CAAnB,CAArC;AACA,aAAKzI,YAAL,CAAkBmI,OAAO,GAAG,CAAV,GAAc,CAAhC,IAAqC,GAArC;AAEA,aAAKC,SAAL;AACA;;AAED,aAAO,KAAKA,SAAL,GAAiB,CAAjB,GAAqB,KAAKpI,YAAL,CAAkBkB,MAA9C;AACA;;;;EA/D+BpB,e;;;;;;;;;;;;;;;ACFjC;;;;;;;;;;;;;;;;;;;;;;;;IAEaiE,c;;;;;;;;;;;;;;;;gEAEC,C;;iEACA,C;;4DACA,C;;;;;;;2BAGb;AACC,UAAG,KAAKgE,QAAL,IAAiB,KAAKhI,WAAL,CAAiBmB,MAArC,EACA;AACC;AACA;;AAED,UAAM8G,KAAI,GAAG,KAAKjI,WAAL,CAAiB,KAAKgI,QAAL,EAAjB,CAAb;AAEA,UAAMO,SAAS,GAAGC,IAAI,CAACC,KAAL,CAAW,KAAKvI,KAAL,GAAa,KAAKqE,SAA7B,CAAlB;AAEA,UAAM2D,IAAI,GAAG,CACZ,CAACD,KAAI,GAAG,CAAR,KAAuB,CADX,EAEV,CAACA,KAAI,GAAG,CAAR,KAAuB,CAFb,EAGV,CAACA,KAAI,GAAG,CAAR,KAAuB,CAHb,EAIV,CAACA,KAAI,GAAG,CAAR,KAAuB,CAJb,EAKV,CAACA,KAAI,GAAG,EAAR,KAAuB,CALb,EAMV,CAACA,KAAI,GAAG,EAAR,KAAuB,CANb,EAOV,CAACA,KAAI,GAAG,EAAR,KAAuB,CAPb,EAQV,CAACA,KAAI,GAAG,GAAR,KAAuB,CARb,CAAb;AAWA,UAAMpG,QAAQ,GAAG,KAAK0C,SAAL,GAAiB,KAAKC,UAAvC;;AAEA,WAAI,IAAMkE,CAAV,IAAeR,IAAf,EACA;AACC,YAAMS,WAAW,GAAIH,IAAI,CAACC,KAAL,CAAW,KAAKJ,SAAL,GAAiBxG,QAA5B,CAArB;AAEA,YAAM+G,YAAY,GAAGD,WAAW,GAAGJ,SAAnC;AACA,YAAMM,YAAY,GAAGL,IAAI,CAACC,KAAL,CAAWE,WAAW,GAAGJ,SAAzB,CAArB;AAEA,YAAMO,UAAU,GAAK,KAAKT,SAAL,YAAiB,KAAK9D,SAAtB,EAAiC,CAAjC,CAArB;AAEA,YAAM4E,WAAW,GAAIX,IAAI,CAACC,KAAL,CAAWK,UAAU,GAAG,KAAKvE,SAA7B,CAArB;AACA,YAAM6E,WAAW,GAAIN,UAAU,GAAG,KAAKtE,UAAvC;AAEA,YAAMyE,WAAW,GAAIL,YAAY,GAAG,KAAKrE,SAArB,GAAmC4E,WAAvD;AACA,YAAMD,WAAW,GAAIL,YAAY,GAAG,KAAKrE,UAArB,GAAmC4E,WAAvD;AAEA,YAAMhB,OAAO,GAAG,KAAK,KAAKlI,KAAL,GAAagJ,WAAb,GAA2BD,WAAhC,CAAhB;AAEA,aAAKhJ,YAAL,CAAkBmI,OAAO,GAAC,CAA1B,IAA+BF,IAAI,CAACQ,CAAD,CAAJ,GAAU,GAAV,GAAgB,CAA/C;AACA,aAAKzI,YAAL,CAAkBmI,OAAO,GAAC,CAA1B,IAA+BF,IAAI,CAACQ,CAAD,CAAJ,GAAU,GAAV,GAAgB,CAA/C;AACA,aAAKzI,YAAL,CAAkBmI,OAAO,GAAC,CAA1B,IAA+BF,IAAI,CAACQ,CAAD,CAAJ,GAAU,GAAV,GAAgB,CAA/C;AACA,aAAKzI,YAAL,CAAkBmI,OAAO,GAAC,CAA1B,IAA+BF,IAAI,CAACQ,CAAD,CAAJ,GAAU,GAAV,GAAgB,GAA/C;AAEA,aAAKL,SAAL;AACA;;AAED,aAAO,KAAKA,SAAL,GAAiB,CAAjB,GAAqB,KAAKpI,YAAL,CAAkBkB,MAA9C;AACA;;;;EAxDkC4C,yB;;;;;;;;;;;;;;;ACFpC;;;;;;;;;;;;;;;;;;;;;;;;IAEaD,W;;;;;AAMZ,uBAAY9D,WAAZ,EAAyBC,YAAzB,EAAuCC,KAAvC,EACA;AAAA;;AAAA;;AACC;;AADD,gEALa,CAKb;;AAAA,iEAJa,CAIb;;AAAA,4DAHa,CAGb;;AAGC,UAAKF,WAAL,GAAoBA,WAApB;AACA,UAAKC,YAAL,GAAoBA,YAApB;AAEA,UAAKC,KAAL,GAAaA,KAAb;AAND;AAOC;;;;2BAGD;AACC,UAAG,KAAK8H,QAAL,IAAiB,KAAKhI,WAAL,CAAiBmB,MAArC,EACA;AACC;AACA;;AAED,UAAMmH,OAAO,GAAI,CAChB,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,CADgB,EAEd,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,CAFc,EAGd,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,CAHc,EAId,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,CAJc,CAAjB;AAOA,UAAMe,KAAK,GAAG,KAAKrJ,WAAL,CAAiB,KAAKgI,QAAL,EAAjB,CAAd;AACA,UAAMsB,KAAK,GAAG,KAAKtJ,WAAL,CAAiB,KAAKgI,QAAL,EAAjB,CAAd;AAEA,UAAMO,SAAS,GAAGC,IAAI,CAACC,KAAL,CAAW,KAAKvI,KAAL,GAAa,KAAKqE,SAA7B,CAAlB;AAEA,UAAMgF,QAAQ,GAAG,CAChB,CAAE,CAACF,KAAK,GAAG,GAAT,KAAwB,CAAzB,GAA+BC,KAAK,GAAG,GAAxC,KAAwD,CADxC,EAEd,CAAE,CAACD,KAAK,GAAG,EAAT,KAAwB,CAAzB,GAA+BC,KAAK,GAAG,EAAxC,KAAwD,CAF1C,EAGd,CAAE,CAACD,KAAK,GAAG,EAAT,KAAwB,CAAzB,GAA+BC,KAAK,GAAG,EAAxC,KAAwD,CAH1C,EAId,CAAE,CAACD,KAAK,GAAG,EAAT,KAAwB,CAAzB,GAA+BC,KAAK,GAAG,EAAxC,KAAwD,CAJ1C,EAKd,CAAE,CAACD,KAAK,GAAG,CAAT,KAAwB,CAAzB,GAA+BC,KAAK,GAAG,CAAxC,KAAwD,CAL1C,EAMd,CAAE,CAACD,KAAK,GAAG,CAAT,KAAwB,CAAzB,GAA+BC,KAAK,GAAG,CAAxC,KAAwD,CAN1C,EAOd,CAAE,CAACD,KAAK,GAAG,CAAT,KAAwB,CAAzB,GAA+BC,KAAK,GAAG,CAAxC,KAAwD,CAP1C,EAQd,CAAE,CAACD,KAAK,GAAG,CAAT,KAAwB,CAAzB,GAA+BC,KAAK,GAAG,CAAxC,KAAwD,CAR1C,CAAjB;AAWA,UAAMzH,QAAQ,GAAG,KAAK0C,SAAL,GAAiB,KAAKC,UAAvC;;AAEA,WAAI,IAAMkE,CAAV,IAAea,QAAf,EACA;AACC,YAAMZ,WAAW,GAAIH,IAAI,CAACC,KAAL,CAAW,KAAKJ,SAAL,GAAiBxG,QAA5B,CAArB;AACA,YAAM+G,YAAY,GAAGD,WAAW,GAAGJ,SAAnC;AACA,YAAMM,YAAY,GAAGL,IAAI,CAACC,KAAL,CAAWE,WAAW,GAAGJ,SAAzB,CAArB;AAEA,YAAMiB,QAAQ,GAAO,KAAKnB,SAAL,GAAiBxG,QAAtC;AACA,YAAMkH,SAAS,GAAMP,IAAI,CAACC,KAAL,CAAWe,QAAQ,GAAG,KAAKjF,SAA3B,CAArB;AACA,YAAMyE,SAAS,GAAMQ,QAAQ,GAAG,KAAKjF,SAArC;AAEA,YAAM0E,WAAW,GAAIL,YAAY,GAAG,KAAKrE,SAArB,GAAkCyE,SAAtD;AACA,YAAME,WAAW,GAAIL,YAAY,GAAG,KAAKrE,UAArB,GAAmCuE,SAAvD;AAEA,YAAMX,OAAO,GAAGG,SAAS,GAAG,KAAKhE,SAAjB,GAA6B2E,WAA7B,GAA2CD,WAA3D;AAEA,aAAKhJ,YAAL,CAAkBmI,OAAO,GAAG,CAAV,GAAc,CAAhC,IAAqCE,OAAO,CAAEiB,QAAQ,CAACb,CAAD,CAAV,CAAP,CAAuB,CAAvB,CAArC;AACA,aAAKzI,YAAL,CAAkBmI,OAAO,GAAG,CAAV,GAAc,CAAhC,IAAqCE,OAAO,CAAEiB,QAAQ,CAACb,CAAD,CAAV,CAAP,CAAuB,CAAvB,CAArC;AACA,aAAKzI,YAAL,CAAkBmI,OAAO,GAAG,CAAV,GAAc,CAAhC,IAAqCE,OAAO,CAAEiB,QAAQ,CAACb,CAAD,CAAV,CAAP,CAAuB,CAAvB,CAArC;AACA,aAAKzI,YAAL,CAAkBmI,OAAO,GAAG,CAAV,GAAc,CAAhC,IAAqC,GAArC;AAEA,aAAKC,SAAL;AACA;;AAED,aAAO,KAAKA,SAAL,GAAiB,CAAjB,GAAqB,KAAKpI,YAAL,CAAkBkB,MAA9C;AACA;;;;EAxE+BpB,e;;;;;;;;ACFjC;;AACA;;AAEA;;AACA;;;;;;;;AAEA,IAAMsC,QAAQ,GAAG,SAAXA,QAAW,CAAC4D,IAAD,EAAOzC,OAAP,EAAmB;AAEnC,MAAMiG,MAAM,GAAG,IAAIC,UAAJ,EAAf;AAEAD,QAAM,CAACE,iBAAP,CAAyB1D,IAAzB;;AAEAwD,QAAM,CAACG,MAAP,GAAgB,YAAM;AACrB,QAAMzG,KAAK,GAAG,IAAIV,UAAJ,CAAegH,MAAM,CAACzC,MAAtB,CAAd;AAEA,QAAMrF,MAAM,GAAG6G,IAAI,CAACqB,IAAL,CAAU1G,KAAK,CAAChC,MAAN,GAAeqC,OAAO,CAACpB,MAAR,CAAelC,KAAxC,CAAf;AAEAsD,WAAO,CAACpB,MAAR,CAAeT,MAAf,GAAwBA,MAAxB;AAEA,QAAM2C,MAAM,GAAGd,OAAO,CAACY,eAAR,CAAwBZ,OAAO,CAACpB,MAAR,CAAelC,KAAvC,EAA8CsD,OAAO,CAACpB,MAAR,CAAeT,MAA7D,CAAf;AAEA,QAAImI,CAAC,GAAG,CAAR;;AATqB,+CAWH3G,KAXG;AAAA;;AAAA;AAWrB,0DACA;AAAA,YADU8E,KACV;AACC3D,cAAM,CAACD,IAAP,CAAYyF,CAAC,EAAb,IAAmB7B,KAAnB;AACA3D,cAAM,CAACD,IAAP,CAAYyF,CAAC,EAAb,IAAmB7B,KAAnB;AACA3D,cAAM,CAACD,IAAP,CAAYyF,CAAC,EAAb,IAAmB7B,KAAnB;AACA3D,cAAM,CAACD,IAAP,CAAYyF,CAAC,EAAb,IAAmB,GAAnB;AACA;AAjBoB;AAAA;AAAA;AAAA;AAAA;;AAmBrBtG,WAAO,CAACkB,YAAR,CAAqBJ,MAArB,EAA6B,CAA7B,EAAgC,CAAhC;AACA,GApBD;AAqBA,CA3BD;;AA6BAyF,QAAQ,CAACC,gBAAT,CAA0B,kBAA1B,EAA8C,YAAW;AACxD,MAAMC,IAAI,GAAI,IAAI9E,UAAJ,EAAd;AACA,MAAM3E,KAAK,GAAG,IAAI0J,YAAJ,CAAU;AAACvE,QAAI,EAAE,MAAP;AAAelF,UAAM,EAAEwJ;AAAvB,GAAV,CAAd;AAEAA,MAAI,CAAC7J,IAAL,CAAUI,KAAV,GAAkBA,KAAlB;AAEAA,OAAK,CAAC2J,MAAN,CAAaJ,QAAQ,CAACK,IAAtB;AACA,CAPD;;;;;;;;;;;;;ACnCA;;AACA;;AAEA;;AACA;;AACA;;AAEA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;AAEA;IACavF,I;;;;;AAIZ,gBAAYzE,IAAZ,EAAiBC,MAAjB,EACA;AAAA;;AAAA;;AACC,8BAAMD,IAAN,EAAWC,MAAX;;AADD,+DAHWqB,OAAO,CAAC,aAAD,CAGlB;;AAGC,UAAKtB,IAAL,CAAUiK,KAAV,GAAkB;AAACC,YAAM,EAANA,cAAD;AAASC,SAAG,EAAHA,QAAT;AAAcC,iBAAW,EAAXA;AAAd,KAAlB;AAEAlK,UAAM,CAACC,MAAP,CAAc,MAAKC,KAAL,CAAWJ,IAAzB,EAA+B;AAC9BK,YAAM,+BADwB;AAE5BM,WAAK,EAAE;AAFqB,KAA/B;AALD;AASC;;;;0BAEK6B,K,EAAO6H,S,EAAW1J,K,EACxB;AACC,UAAM4D,SAAS,GAAG,KAAKvE,IAAL,CAAUI,KAA5B;AAEA,UAAMK,KAAK,GAAI,KAAKT,IAAL,CAAUS,KAAzB;AACA,UAAMJ,MAAM,GAAG,IAAIgK,SAAJ,CAAc;AAAC5J,aAAK,EAALA,KAAD;AAAQL,aAAK,EAAEmE;AAAf,OAAd,CAAf;AAEAA,eAAS,CAACG,MAAV,CAAiBC,GAAjB,CAAqBtE,MAAM,CAACD,KAA5B;AAEA,WAAKkK,MAAL;AACA;;;;EA1BwBrJ,W;;;;AA6B1BC,aAAMC,EAAN,CAASsD,IAAT,EAAerD,oBAAf;;;ACxCA;AAAA;AAAA;AAAA;;;;;;;;;ACAA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;IAEa0I,K;;;;;AAIZ,iBAAY9J,IAAZ,EAAkBI,KAAlB,EACA;AAAA;;AAAA;;AACC,8BAAMJ,IAAN,EAAYI,KAAZ;;AADD,+DAHWkB,OAAO,CAAC,cAAD,CAGlB;;AAGC,UAAKiJ,IAAL,GAAY,IAAZ;AAEA,UAAKC,QAAL,GAAgB,CAAhB;AACA,UAAKC,OAAL,GAAgB,CAAhB;AAEA,UAAKzK,IAAL,CAAUW,KAAV,GAAmB,MAAKX,IAAL,CAAUW,KAAV,IAAoB,IAAvC;AACA,UAAKX,IAAL,CAAUK,MAAV,GAAmB,MAAKL,IAAL,CAAUK,MAAV,IAAoB,IAAvC;AACA,UAAKL,IAAL,CAAU0K,IAAV,GAAmB,CAAnB;AACA,UAAK1K,IAAL,CAAU2K,GAAV,GAAmB,CAAnB;AACA,UAAK3K,IAAL,CAAU4K,CAAV,GAAmB,CAAnB;AAEA,UAAKlG,MAAL,GAAc,IAAImG,QAAJ,CAAQ,UAACnB,CAAD,EAAGoB,CAAH,EAAKC,CAAL,EAAW;AAEhC,UAAGA,CAAC,KAAKF,SAAIG,UAAb,EACA;AACC;AACA;;AAEDtB,OAAC,CAACa,IAAF;AAEA,YAAKC,QAAL,IAAiB,EAAjB;AACA,YAAKC,OAAL,IAAiB,EAAjB;AAEAf,OAAC,CAAC1J,IAAF,CAAO0K,IAAP,GAAc,MAAKF,QAAnB;AACAd,OAAC,CAAC1J,IAAF,CAAO2K,GAAP,GAAc,MAAKF,OAAnB;AACAf,OAAC,CAAC1J,IAAF,CAAO4K,CAAP,GAAc1K,MAAM,CAACsG,MAAP,CAAc,MAAK9B,MAAL,CAAYuG,IAA1B,EAAgClK,MAA9C;AAEA,YAAKyJ,QAAL,IAAiBpC,IAAI,CAACC,KAAL,CAAW6C,MAAM,CAACC,UAAP,GAAoB,CAA/B,CAAjB;AACA,YAAKV,OAAL,IAAiBrC,IAAI,CAACC,KAAL,CAAW6C,MAAM,CAACE,WAAP,GAAqB,CAAhC,CAAjB;AAEA1B,OAAC,CAAC2B,QAAF,CAAW;AAAA,eAAI,MAAK3G,MAAL,CAAY4F,MAAZ,CAAmBZ,CAAnB,CAAJ;AAAA,OAAX;AACA,KApBa,CAAd;AAsBA,UAAK1J,IAAL,CAAU0E,MAAV,GAAmB,MAAKA,MAAL,CAAYuG,IAA/B;AApCD;AAqCC;;;;+BAEUzI,K,EACX;AAAA;;AACC,WAAKxC,IAAL,CAAUM,MAAV,CAAiB,CAAC,MAAD,EAAQ,KAAR,CAAjB,EAAiC,UAACC,CAAD,EAAGuB,CAAH,EAAO;AACvC,YAAM1B,KAAK,GAAG,MAAI,CAAC2B,IAAL,CAAU3B,KAAxB;;AAEA,YAAG,CAACA,KAAJ,EACA;AACC;AACA;;AAED,YAAM4J,IAAI,GAAIL,QAAQ,CAACK,IAAvB;AAEA,YAAMsB,IAAI,GAAItB,IAAI,CAACuB,WAAL,GAAoBnL,KAAK,CAACmL,WAAxC;AACA,YAAMC,IAAI,GAAIxB,IAAI,CAACyB,YAAL,GAAoBrL,KAAK,CAACqL,YAAxC;;AAEA,YAAG3J,CAAC,KAAK,MAAN,IAAgBvB,CAAC,GAAG+K,IAAvB,EACA;AACC/K,WAAC,GAAG+K,IAAJ;AACA;;AAED,YAAGxJ,CAAC,KAAK,KAAN,IAAevB,CAAC,GAAGiL,IAAtB,EACA;AACCjL,WAAC,GAAGiL,IAAJ;AACA;;AAED,YAAGjL,CAAC,GAAG,CAAP,EACA;AACCA,WAAC,GAAG,CAAJ;AACA;;AAED,cAAI,CAACP,IAAL,CAAU8B,CAAV,IAAevB,CAAf;;AAEA,cAAI,CAACwB,IAAL,CAAU3B,KAAV,CAAgB+B,KAAhB,iCAA8BL,CAA9B,aAAwCvB,CAAxC;AACA,OA/BD,EA+BE;AAAC2B,YAAI,EAAE;AAAP,OA/BF;AAiCA,WAAKlC,IAAL,CAAUM,MAAV,CAAiB,GAAjB,EAAsB,UAACC,CAAD,EAAGuB,CAAH,EAAO;AAC5B,cAAI,CAACC,IAAL,CAAU3B,KAAV,CAAgB+B,KAAhB,iCAA8BL,CAA9B,aAAwCvB,CAAxC;AACA,OAFD;AAGA;;;8BAESiC,K,EACV;AACC,UAAG,CAAC,KAAK+H,IAAT,EACA;AACC;AACA;;AAED,UAAM7F,MAAM,GAAGxE,MAAM,CAACsG,MAAP,CAAc,KAAK+D,IAAL,CAAU7F,MAAV,CAAiBuG,IAA/B,EAAqCS,IAArC,CAA0C,UAACX,CAAD,EAAGY,CAAH,EAAO;AAC/D,eAAOA,CAAC,CAACf,CAAF,GAAMG,CAAC,CAACH,CAAf;AACA,OAFc,CAAf;;AAKA,WAAI,IAAMlB,CAAV,IAAehF,MAAf,EACA;AACC,YAAGA,MAAM,CAACgF,CAAD,CAAN,KAAc,IAAjB,EACA;AACC,cAAGA,CAAC,KAAK,CAAT,EACA;AACC;AACA;;AACD;AACA;;AAED,YAAGhF,MAAM,CAACgF,CAAD,CAAN,CAAU1J,IAAV,CAAe4K,CAAf,GAAmB,KAAK5K,IAAL,CAAU4K,CAAhC,EACA;AACClG,gBAAM,CAACgF,CAAD,CAAN,CAAU1J,IAAV,CAAe4K,CAAf;AACA;AACD;;AAED,WAAK5K,IAAL,CAAU4K,CAAV,GAAclG,MAAM,CAAC3D,MAArB;AACA;;;kCAGD;AAAA;;AACC,WAAK6K,UAAL,GAAkB,KAAKC,MAAL,CAAYlC,QAAZ,EAAsB,WAAtB,EAAmC,UAAAnH,KAAK,EAAI;AAC7D,cAAI,CAACxC,IAAL,CAAU0K,IAAV,IAAkBlI,KAAK,CAACsJ,SAAxB;AACA,cAAI,CAAC9L,IAAL,CAAU2K,GAAV,IAAkBnI,KAAK,CAACuJ,SAAxB;AACA,OAHiB,CAAlB;AAKA,WAAKF,MAAL,CAAYlC,QAAZ,EAAsB,SAAtB,EAAiC,UAAAnH,KAAK,EAAI;AACzC,cAAI,CAACoJ,UAAL;;AACA,cAAI,CAACA,UAAL,GAAkB,KAAlB;AACA,OAHD,EAGG;AAACI,YAAI,EAAC;AAAN,OAHH;AAIA;;;4BAGD;AACC,UAAG,QAAO,KAAKhM,IAAL,CAAUK,MAAjB,KAA2B,QAA3B,IAAuC,OAAO,KAAKL,IAAL,CAAUK,MAAV,CAAiBiK,MAAxB,IAAkC,UAA5E,EACA;AACC,aAAKtK,IAAL,CAAUK,MAAV,CAAiBiK,MAAjB;AACA;;AAED,WAAKA,MAAL;AACA;;;;EAzIyBrJ,W;;;;;;;;;;;;;ACH3B;;AAEA,IAAMgL,SAAS,GAAGC,MAAM,CAAC,WAAD,CAAxB;AACA,IAAMC,OAAO,GAAKD,MAAM,CAAC,SAAD,CAAxB;AAEO,IAAM9K,SAAS,GAAG;AACxB,MAAIhB,KAAJ,GAAY;AAEX,QAAG,CAAC,KAAK+L,OAAL,CAAJ,EACA;AACC,WAAKA,OAAL,IAAgB,IAAIrC,YAAJ,CAAU,EAAV,EAAc,IAAd,CAAhB;AACA;;AAED,WAAO,KAAKqC,OAAL,CAAP;AACA;;AATuB,CAAlB;;;;ACLP;AAAA;AAAA;AAAA;;;;;;;;;;;ACAA;;AACA;;AACA;;AACA;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;IAEa/B,W;;;;;AAIZ,uBAAYpK,IAAZ,EAAiBC,MAAjB,EACA;AAAA;;AAAA;;AACC,8BAAMD,IAAN,EAAYC,MAAZ;;AADD,+DAHWqB,OAAO,CAAC,oBAAD,CAGlB;;AAGCpB,UAAM,CAACC,MAAP,CAAc,MAAKC,KAAL,CAAWJ,IAAzB,EAA+B;AAACW,WAAK,EAAE;AAAR,KAA/B;AAHD;AAIC;;;;0BAGD;AACC,UAAM4D,SAAS,GAAG,KAAKvE,IAAL,CAAUI,KAA5B;AACA,UAAMgM,QAAQ,GAAI,KAAKpM,IAAL,CAAUS,KAAV,CAAgBT,IAAhB,CAAqBF,KAAvC;AAEA,UAAMc,MAAM,GAAGC,MAAM,CAAC,KAAKb,IAAL,CAAUY,MAAX,CAArB;AACA,UAAMG,MAAM,YAAGqL,QAAH,EAAa,CAAb,CAAZ;AACA,UAAM3L,KAAK,GAAI,IAAI4L,kBAAJ,CAAa,KAAKrM,IAAL,CAAUS,KAAV,CAAgBT,IAAhB,CAAqBgB,MAAlC,CAAf;AAEA,UAAM+C,MAAM,GAAG,IAAI1B,UAAJ,CAAetB,MAAf,CAAf;;AAEA,WAAI,IAAI2I,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAGjJ,KAAK,CAACM,MAAN,GAAe,CAAlC,EAAqC2I,CAAC,EAAtC,EACA;AACC,YAAM4C,EAAE,GAAG7L,KAAK,CAAC8L,GAAN,CAAU,KAAKC,eAAL,CAAqB9C,CAArB,CAAV,CAAX;AACA,YAAM+C,EAAE,GAAGhM,KAAK,CAAC8L,GAAN,CAAU,KAAKC,eAAL,CAAqB9C,CAArB,aAAwB0C,QAAxB,EAAkC,CAAlC,CAAV,CAAX;AACA,YAAMT,CAAC,GAAIW,EAAE,IAAI,CAAN,GAAUG,EAArB;AAEA,YAAMC,MAAM,GAAG,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,EAAa,EAAb,CAAf;AAEA3I,cAAM,CAAC2F,CAAD,CAAN,GAAYgD,MAAM,CAACf,CAAD,CAAlB;AACA;;AAED,UAAMhL,KAAK,GAAI,kBAAkB,KAAKX,IAAL,CAAUQ,SAA3C;AAEA,UAAMH,MAAM,GAAG,IAAIgB,cAAJ,CAAW;AACzBL,cAAM,EAAE+C,MADiB;AACT3D,aAAK,EAAEmE,SADE;AACS5D,aAAK,EAALA,KADT;AAEvBb,aAAK,EAAEsM,QAFgB;AAEN7K,cAAM,EAAE6K,QAFF;AAEY5K,aAAK,EAAE,CAFnB;AAEsBG,eAAO,EAAE;AAF/B,OAAX,CAAf;AAKA4C,eAAS,CAACG,MAAV,CAAiBC,GAAjB,CAAqBtE,MAAM,CAACD,KAA5B;AAEA,WAAKkK,MAAL;AACA;;;oCAEeqC,K,EAChB;AACC,UAAM7M,KAAK,GAAI,KAAKE,IAAL,CAAUS,KAAV,CAAgBT,IAAhB,CAAqBF,KAApC;AACA,UAAM8M,KAAK,GAAID,KAAK,GAAG,CAAR,KAAc,CAA7B;AACA,UAAME,IAAI,GAAKzE,IAAI,CAACC,KAAL,CAAWsE,KAAK,GAAG7M,KAAnB,CAAf;AACA,UAAMgN,KAAK,GAAID,IAAI,GAAG,CAAP,IAAY,CAA3B;AACA,UAAME,IAAI,GAAKJ,KAAK,GAAG7M,KAAvB;AAEA,UAAM8G,MAAM,GAAIiG,IAAI,GAAG,CAAP,GAAWE,IAAI,GAAGjN,KAAnB,IAA6B8M,KAAK,GAAG,CAAH,GAAK,EAAE9M,KAAK,GAAC,CAAR,CAAvC,CAAf;AAEA,aAAO8G,MAAP;AACA;;;;EAxD+B7G,qB;;;;;;;;;;;;;;;ACPjC;;AACA;;AACA;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;IAEamK,M;;;;;AAIZ,kBAAYlK,IAAZ,EAAiBC,MAAjB,EACA;AAAA;;AAAA;;AACC,8BAAMD,IAAN,EAAYC,MAAZ;;AADD,+DAHWqB,OAAO,CAAC,eAAD,CAGlB;;AAGCpB,UAAM,CAACC,MAAP,CAAc,MAAKC,KAAL,CAAWJ,IAAzB,EAA+B;AAACW,WAAK,EAAE;AAAR,KAA/B;AAHD;AAIC;;;;0BAGD;AACC,UAAM4D,SAAS,GAAG,KAAKvE,IAAL,CAAUI,KAA5B;AAEA,UAAMQ,MAAM,GAAGC,MAAM,CAAC,KAAKb,IAAL,CAAUY,MAAX,CAArB;AACA,UAAMG,MAAM,GAAGF,MAAM,CAAC,KAAKb,IAAL,CAAUe,MAAX,CAArB;AACA,UAAMN,KAAK,GAAI,KAAKT,IAAL,CAAUS,KAAV,CAAgBT,IAAhB,CAAqBgB,MAApC;AAEA,UAAM+C,MAAM,GAAG,IAAI1B,UAAJ,CAAetB,MAAf,CAAf;;AAEA,WAAI,IAAI2I,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAG3I,MAAnB,EAA2B2I,CAAC,EAA5B,EACA;AACC3F,cAAM,CAAC2F,CAAD,CAAN,GAAYjJ,KAAK,CAACiJ,CAAC,GAAG9I,MAAL,CAAL,GAAoB,GAAhC;AACA;;AAED,UAAMD,KAAK,GAAI,cAAc,KAAKX,IAAL,CAAUQ,SAAvC;AACA,UAAMH,MAAM,GAAG,IAAIgB,cAAJ,CAAW;AACzBL,cAAM,EAAE+C,MADiB;AACT3D,aAAK,EAAEmE,SADE;AACS5D,aAAK,EAALA,KADT;AAEvBgB,eAAO,EAAE,KAAK3B,IAAL,CAAUS,KAAV,CAAgBT,IAAhB,CAAqB2B,OAFP;AAGvBJ,cAAM,EAAE,KAAKvB,IAAL,CAAUS,KAAV,CAAgBT,IAAhB,CAAqBuB,MAHN;AAIvBzB,aAAK,EAAE,KAAKE,IAAL,CAAUS,KAAV,CAAgBT,IAAhB,CAAqBF,KAJL;AAKvB0B,aAAK,EAAE,KAAKxB,IAAL,CAAUS,KAAV,CAAgBT,IAAhB,CAAqBwB;AALL,OAAX,CAAf;AAQA+C,eAAS,CAACG,MAAV,CAAiBC,GAAjB,CAAqBtE,MAAM,CAACD,KAA5B;AAEA,WAAKkK,MAAL;AACA;;;;EAtC0BvK,qB;;;;;;;;;;;;;;;ACN5B;;AACA;;AACA;;AAEA;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA;AACA;IAEaoK,G;;;;;AAKZ,eAAYnK,IAAZ,EAAiBC,MAAjB,EACA;AAAA;;AAAA;;AACC,8BAAMD,IAAN,EAAYC,MAAZ;;AADD,+DAJWqB,OAAO,CAAC,YAAD,CAIlB;;AAAA,6DAHS,mBAAI0L,KAAK,CAAC,EAAD,CAAT,EAAeC,GAAf,CAAmB,UAACC,CAAD,EAAGxD,CAAH;AAAA,aAAQ,CAAC,KAAKA,CAAN,IAAW,CAAnB;AAAA,KAAnB,CAGT;;AAGC,UAAK0C,QAAL,GAAgB,CAAhB;AACA,UAAKe,QAAL,GAAgB,CAAhB;AAEA,UAAKnN,IAAL,CAAUY,MAAV,GAAmB,KAAnB,CAND,CAM0B;;AAEzBV,UAAM,CAACC,MAAP,CAAc,MAAKC,KAAL,CAAWJ,IAAzB,EAA+B;AAACW,WAAK,EAAE;AAAR,KAA/B;AARD;AASC;;;;0BAGD;AAAA;;AACC,UAAMyM,SAAS,GAAG,KAAKpN,IAAL,CAAUS,KAAV,CAAgBT,IAAhB,CAAqBgB,MAArB,CAA4B8C,KAA5B,CAAkC,KAAK9D,IAAL,CAAUY,MAA5C,CAAlB;AAEA,UAAMkH,IAAI,GAAI,IAAIuE,kBAAJ,CAAae,SAAb,CAAd;AACA,UAAIC,KAAK,GAAGvF,IAAI,CAACzD,IAAL,CAAU,CAAV,KAAgB,CAA5B;AACA,UAAIiJ,KAAK,GAAGxF,IAAI,CAACzD,IAAL,CAAU,CAAV,KAAgB,CAA5B;AAEAgJ,WAAK,IAAI,KAAKF,QAAd;AAEA,UAAMzG,IAAI,GAAI2G,KAAK,GAAGC,KAAtB;AAEAD,WAAK,GAAGA,KAAK,IAAI,EAAT,GAAcA,KAAd,GAAsB,EAA9B;AACAC,WAAK,GAAGA,KAAK,IAAI,CAAT,GAAcA,KAAd,GAAsB,CAA9B;AAEA,WAAKlB,QAAL,GAAgBkB,KAAhB;AAEA,WAAKC,QAAL,GAAgB,SAAC,KAAKnB,QAAN,EAAgB,CAAhB,IAAmB,KAAKe,QAAxC;AAEA,UAAMnM,MAAM,GAAG,IAAIqB,UAAJ,CAAe,KAAKkL,QAAL,GAAc,CAA7B,CAAf;AAEA,WAAKvM,MAAL,GAAeA,MAAf;AAEA,WAAKwM,OAAL,GAAe,IAAInL,UAAJ,CAAerB,MAAM,CAACA,MAAtB,EAA8B,KAAKuM,QAAL,GAAc,CAA5C,EAA+C,KAAKA,QAApD,CAAf;AACA,WAAKE,OAAL,GAAe,IAAIpL,UAAJ,CAAerB,MAAM,CAACA,MAAtB,EAA8B,KAAKuM,QAAL,GAAc,CAA5C,EAA+C,KAAKA,QAAL,GAAc,CAA7D,CAAf;AACA,WAAKG,OAAL,GAAe,IAAIrL,UAAJ,CAAerB,MAAM,CAACA,MAAtB,EAA8B,KAAKuM,QAAL,GAAc,CAA5C,EAA+C,KAAKA,QAAL,GAAc,CAA7D,CAAf;AAEA,UAAMhJ,SAAS,GAAG,KAAKvE,IAAL,CAAUI,KAA5B;AAEA,UAAMO,KAAK,GAAI,uBAAuB,KAAKX,IAAL,CAAUQ,SAAhD;AAEA,UAAMH,MAAM,GAAG,IAAIgB,cAAJ,CAAW;AACzBL,cAAM,EAAE,KAAKA,MADY;AACJZ,aAAK,EAAEmE,SADH;AACc5D,aAAK,EAALA,KADd;AAEvBb,aAAK,EAAE,KAAKsM,QAAL,GAAiB,KAAKe,QAFN;AAGvB5L,cAAM,EAAE,KAAK6K,QAAL,GAAgB,KAAKe,QAArB,GAAgC,CAHjB;AAIvB3L,aAAK,EAAE,CAJgB;AAKvBG,eAAO,EAAE,mBALc;AAMvBgM,cAAM,EAAE;AANe,OAAX,CAAf;AASApJ,eAAS,CAACG,MAAV,CAAiBC,GAAjB,CAAqBtE,MAAM,CAACD,KAA5B;AAEA,WAAKwN,YAAL,GAAoBvN,MAApB;AAEA,UAAMwN,OAAO,GAAG,CAAC,IAAIxB,kBAAJ,CAAa,KAAKoB,OAAlB,CAAD,EAA6B,IAAIpB,kBAAJ,CAAa,KAAKqB,OAAlB,CAA7B,CAAhB;AAEA,UAAMI,KAAK,GAAGhG,IAAI,CAACzD,IAAL,EAAd;AAEA,UAAM0J,IAAI,GAAIF,OAAO,CAACC,KAAD,CAArB;AACA,UAAME,IAAI,GAAIH,OAAO,CAACC,KAAK,GAAG,CAAT,CAArB;AAEAzN,YAAM,CAACuJ,gBAAP,CAAwB,UAAxB,EAAoC,YAAI;AACvC,cAAI,CAACqE,UAAL,CAAgBF,IAAhB,EAAsBjG,IAAtB,EAA4BuF,KAA5B,EAAmC3G,IAAnC,EAAyCjB,IAAzC,CAA8C,YAAI;AAEjD,gBAAI,CAACmI,YAAL,CAAkB3L,QAAlB;;AACA,cAAIiM,IAAI,GAAGpG,IAAI,CAACzD,IAAL,EAAX;;AAEA,cAAG6J,IAAI,KAAK,CAAZ,EACA;AACCA,gBAAI,GAAG,IAAIpG,IAAI,CAACzD,IAAL,EAAX;AACA;;AAED,gBAAI,CAAC4J,UAAL,CAAgBD,IAAhB,EAAsBlG,IAAtB,EAA4BuF,KAA5B,EAAmC3G,IAAnC,EAAyCjB,IAAzC,CAA8C,YAAI;AACjD,gBAAGyI,IAAI,KAAK,CAAZ,EACA;AACC,oBAAI,CAACC,SAAL,CAAeJ,IAAf,EAAqBV,KAArB,EAA4B5H,IAA5B,CAAiC,YAAI;AACpC,uBAAO,MAAI,CAAC0I,SAAL,CAAeJ,IAAf,EAAqBV,KAArB,CAAP;AACA,eAFD,EAEG5H,IAFH,CAEQ,YAAI;AACX,sBAAI,CAAC2I,IAAL,CAAU,IAAI/B,kBAAJ,CAAa,MAAI,CAACoB,OAAlB,CAAV,EAAsC,IAAIpB,kBAAJ,CAAa,MAAI,CAACmB,OAAlB,CAAtC,EAAkEF,KAAlE;;AACA,sBAAI,CAACc,IAAL,CAAU,IAAI/B,kBAAJ,CAAa,MAAI,CAACqB,OAAlB,CAAV,EAAsC,IAAIrB,kBAAJ,CAAa,MAAI,CAACoB,OAAlB,CAAtC,EAAkEH,KAAlE;;AACA,sBAAI,CAACe,KAAL,CAAW,IAAIhC,kBAAJ,CAAa,MAAI,CAACqB,OAAlB,CAAX;;AACA,sBAAI,CAACE,YAAL,CAAkB3L,QAAlB;AACA,eAPD;AAQA,aAVD,MAWK,IAAGiM,IAAI,KAAK,CAAZ,EACL;AACC,oBAAI,CAACC,SAAL,CAAeJ,IAAf,EAAqBV,KAArB,EAA4B5H,IAA5B,CAAiC,YAAI;AACpC,sBAAI,CAAC6I,OAAL,CAAaP,IAAb,EAAmBC,IAAnB;;AACA,sBAAI,CAACI,IAAL,CAAU,IAAI/B,kBAAJ,CAAa,MAAI,CAACoB,OAAlB,CAAV,EAAsC,IAAIpB,kBAAJ,CAAa,MAAI,CAACmB,OAAlB,CAAtC,EAAkEF,KAAlE;;AACA,sBAAI,CAACc,IAAL,CAAU,IAAI/B,kBAAJ,CAAa,MAAI,CAACqB,OAAlB,CAAV,EAAsC,IAAIrB,kBAAJ,CAAa,MAAI,CAACoB,OAAlB,CAAtC,EAAkEH,KAAlE;;AACA,sBAAI,CAACe,KAAL,CAAW,IAAIhC,kBAAJ,CAAa,MAAI,CAACqB,OAAlB,CAAX;;AACA,sBAAI,CAACE,YAAL,CAAkB3L,QAAlB;AACA,eAND;AAOA,aATI,MAUA,IAAGiM,IAAI,IAAI,CAAX,EACL;AACC,oBAAI,CAACC,SAAL,CAAeJ,IAAf,EAAoBV,KAApB,EAA2B5H,IAA3B,CAAgC,YAAI;AACnC,uBAAO,MAAI,CAAC0I,SAAL,CAAeH,IAAf,EAAoBX,KAApB,CAAP;AACA,eAFD,EAEG5H,IAFH,CAEQ,YAAI;AACX,sBAAI,CAAC6I,OAAL,CAAaP,IAAb,EAAmBC,IAAnB;;AACA,sBAAI,CAACJ,YAAL,CAAkB3L,QAAlB;;AACA,sBAAI,CAACmM,IAAL,CAAU,IAAI/B,kBAAJ,CAAa,MAAI,CAACoB,OAAlB,CAAV,EAAsC,IAAIpB,kBAAJ,CAAa,MAAI,CAACmB,OAAlB,CAAtC,EAAkEF,KAAlE;;AACA,sBAAI,CAACc,IAAL,CAAU,IAAI/B,kBAAJ,CAAa,MAAI,CAACqB,OAAlB,CAAV,EAAsC,IAAIrB,kBAAJ,CAAa,MAAI,CAACoB,OAAlB,CAAtC,EAAkEH,KAAlE;;AACA,sBAAI,CAACe,KAAL,CAAW,IAAIhC,kBAAJ,CAAa,MAAI,CAACqB,OAAlB,CAAX;;AACA,sBAAI,CAACE,YAAL,CAAkB3L,QAAlB;AACA,eATD;AAUA;AACD,WAnCD;AAqCA,SA/CD;AAgDA,OAjDD,EAiDG;AAAC+J,YAAI,EAAC;AAAN,OAjDH;AAmDA,WAAK1B,MAAL;AACA;;;+BAEUtJ,M,EAAQ8G,I,EAAMuF,K,EAAO3G,I,EAChC;AAAA;;AACC,aAAO,IAAIL,OAAJ,CAAY,UAAAkI,MAAM,EAAI;AAE5B,YAAMC,OAAO,GAAG9H,IAAI,GAAG,CAAvB;AACA,YAAIwH,IAAI,GAAQpG,IAAI,CAACzD,IAAL,EAAhB;AAEA,YAAIqF,CAAC,GAAG,CAAR;;AAEA,YAAM+E,IAAI,GAAG,SAAPA,IAAO,GAAM;AAElB,cAAGP,IAAI,KAAK,CAAZ,EACA;AACCxE,aAAC,GAAG,MAAI,CAACgF,OAAL,CAAa1N,MAAb,EAAqB8G,IAArB,EAA2B4B,CAA3B,CAAJ;AAEAwE,gBAAI,GAAG,CAAP;AACA,WALD,MAMK,IAAGA,IAAI,KAAK,CAAZ,EACL;AACCxE,aAAC,GAAG,MAAI,CAACiF,QAAL,CAAc3N,MAAd,EAAsB8G,IAAtB,EAA4B4B,CAA5B,CAAJ;AACAwE,gBAAI,GAAG,CAAP;AACA;;AAED,cAAGxE,CAAC,GAAG8E,OAAP,EACA;AACC,gBAAG9E,CAAC,IAAI,MAAI,CAAC0C,QAAL,GAAgB,MAAI,CAACe,QAArB,GAAgC,CAApC,CAAD,KAA4C,CAA/C,EACA;AACCyB,wBAAU,CAAC;AAAA,uBAAMH,IAAI,EAAV;AAAA,eAAD,EAAe,GAAf,CAAV;;AACA,oBAAI,CAACb,YAAL,CAAkB3L,QAAlB;AACA,aAJD,MAMA;AACCwM,kBAAI;AACJ;AACD,WAXD,MAaA;AACC,mBAAOF,MAAM,EAAb;AACA;AACD,SA9BD;;AAgCAE,YAAI;AACJ,OAxCM,CAAP;AA0CA;;;4BAEOzN,M,EAAQ8G,I,EAAM4B,C,EACtB;AACC,UAAImF,EAAE,GAAG,CAAT;AACA,UAAI9G,GAAG,GAAG,EAAV;AACA,UAAI+G,IAAI,GAAG,EAAX;;AAEA,aAAM/G,GAAG,GAAGD,IAAI,CAACzD,IAAL,EAAZ,EACA;AACCyK,YAAI,IAAI/G,GAAR;AACA8G,UAAE;AACF;;AAEDC,UAAI,IAAI/G,GAAR;AAEA,UAAMgH,CAAC,GAAG,KAAKC,MAAL,CAAYH,EAAZ,CAAV;AACA,UAAM9D,CAAC,GAAGjD,IAAI,CAACzD,IAAL,CAAUwK,EAAE,GAAC,CAAb,CAAV;AACA,UAAMI,CAAC,GAAGF,CAAC,GAAGhE,CAAd;;AAEA,WAAI,IAAIzC,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAG2G,CAAnB,EAAsB3G,CAAC,EAAvB,EACA;AACC;AACA;AACAoB,SAAC;AACDA,SAAC;AACD;;AAED,aAAOA,CAAP;AACA;;;6BAEQ1I,M,EAAQ8G,I,EAAM4B,C,EACvB;AACC,UAAM+E,IAAI,GAAG,EAAb;;AAEA,aAAM,IAAN,EACA;AACC,YAAMnC,EAAE,GAAGxE,IAAI,CAACzD,IAAL,EAAX;AACA,YAAMoI,EAAE,GAAG3E,IAAI,CAACzD,IAAL,EAAX;;AAEA,YAAGiI,EAAE,KAAK,CAAP,IAAYG,EAAE,KAAK,CAAtB,EACA;AACC;AACA;;AAEDgC,YAAI,CAAC3I,IAAL,CAAUwG,EAAV,EAAaG,EAAb;AAEAH,UAAE,IAAItL,MAAM,CAACkO,GAAP,CAAWxF,CAAX,EAAc4C,EAAd,CAAN;AACA5C,SAAC;AACD+C,UAAE,IAAIzL,MAAM,CAACkO,GAAP,CAAWxF,CAAX,EAAc+C,EAAd,CAAN;AACA/C,SAAC;AACD;;AAED,aAAOA,CAAP;AACA;;;8BAES5B,I,EAAKuF,K,EACf;AAAA;;AACC,UAAI3D,CAAC,GAAG,CAAR;AAAA,UAAWyF,OAAO,GAAG,CAArB;AACA,UAAMC,GAAG,GAAGtH,IAAI,CAAC/G,MAAjB;AAEA,aAAO,IAAIsF,OAAJ,CAAY,UAAAkI,MAAM,EAAI;AAC5B,YAAME,IAAI,GAAG,SAAPA,IAAO,GAAM;AAClB,cAAG/E,CAAC,IAAI,MAAI,CAAC0C,QAAL,GAAgB,MAAI,CAACe,QAAzB,CAAD,KAAwC,CAA3C,EACA;AACCgC,mBAAO,GAAG,CAAV;AACA;;AAED,cAAMxC,KAAK,GAAG,MAAI,CAACH,eAAL,CAAqB9C,CAArB,CAAd;;AAEA,cAAM3B,GAAG,GAAGD,IAAI,CAACyE,GAAL,CAASI,KAAT,CAAZ;;AAEA,cAAG5E,GAAH,EACA;AACCoH,mBAAO,GAAG,IAAIA,OAAd;AACA;;AAEDrH,cAAI,CAACoH,GAAL,CAASvC,KAAT,EAAgBwC,OAAhB;AAEAzF,WAAC;;AAED,cAAGA,CAAC,GAAG0F,GAAP,EACA;AACC,gBAAG1F,CAAC,GAAG,MAAI,CAAC0C,QAAT,GAAoB,MAAI,CAACe,QAAzB,KAAsC,CAAzC,EACA;AACCyB,wBAAU,CAAC;AAAA,uBAAMH,IAAI,EAAV;AAAA,eAAD,EAAe,CAAf,CAAV;;AACA,oBAAI,CAACb,YAAL,CAAkB3L,QAAlB;AACA,aAJD,MAMA;AACCwM,kBAAI;AACJ;AACD,WAXD,MAaA;AACC,mBAAOF,MAAM,EAAb;AACA;AACD,SAnCD;;AAqCAE,YAAI;AACJ,OAvCM,CAAP;AAwCA;;;qCAEgBY,S,EACjB;AACC,UAAMvP,KAAK,GAAU,KAAKsM,QAAL,GAAgB,KAAKe,QAA1C;AAEA,UAAMmC,SAAS,GAAOD,SAAS,IAAIvP,KAAK,GAAG,CAAZ,CAAV,IAA6BA,KAAlD;AACA,UAAMyP,MAAM,GAASnH,IAAI,CAACC,KAAL,CAAWgH,SAAS,IAAIvP,KAAK,GAAG,CAAZ,CAApB,CAArB;AACA,UAAM0P,YAAY,GAAGD,MAAM,IAAIzP,KAAK,GAAG,CAAZ,CAA3B;AACA,UAAM2P,QAAQ,GAAOJ,SAAS,GAAGG,YAAjC;AAEA,UAAM7C,KAAK,GAAG6C,YAAY,IAAIF,SAAS,GACnC,CAACG,QAAQ,GAAG3P,KAAZ,IAAqB,CAAtB,GAA2B,CADS,GAEpC2P,QAAQ,GAAG,CAFY,CAA1B;AAKA,aAAO9C,KAAP;AACA;;;oCAEeA,K,EAChB;AACC,UAAM7M,KAAK,GAAI,KAAKsM,QAAL,GAAgB,KAAKe,QAApC;AACA,UAAMP,KAAK,GAAID,KAAK,GAAG,CAAR,KAAc,CAA7B;AACA,UAAME,IAAI,GAAKzE,IAAI,CAACC,KAAL,CAAWsE,KAAK,GAAG7M,KAAnB,CAAf;AACA,UAAMgN,KAAK,GAAID,IAAI,GAAG,CAAP,IAAY,CAA3B;AACA,UAAME,IAAI,GAAKJ,KAAK,GAAG7M,KAAvB;AAEA,UAAM8G,MAAM,GAAIiG,IAAI,GAAG,CAAP,GAAWE,IAAI,GAAGjN,KAAnB,IAA6B8M,KAAK,GAAG,CAAH,GAAK,EAAE9M,KAAK,GAAC,CAAR,CAAvC,CAAf;AAEA,aAAO8G,MAAP;AACA;;;yBAEI8I,K,EAAOC,K,EAAOrC,K,EACnB;AACC,UAAM1M,MAAM,GAAG,IAAI0M,KAAnB;;AAEA,WAAI,IAAI5D,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAGgG,KAAK,CAAC3O,MAAzB,EAAiC2I,CAAC,EAAlC,EACA;AACC,YAAMkG,IAAI,GAAGF,KAAK,CAACnD,GAAN,CAAU7C,CAAV,CAAb;AAEAiG,aAAK,CAACT,GAAN,CAAUxF,CAAV,EAAakG,IAAb;AACA;AACD;;;6BAGD,CAEC;;;0BAEK9H,I,EACN;AACC,WAAI,IAAI4B,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAG5B,IAAI,CAAC/G,MAAxB,EAAgC2I,CAAC,EAAjC,EACA;AACC5B,YAAI,CAACoH,GAAL,CAASxF,CAAT,EAAY,CAAZ;AACA;AACD;;;4BAEOgG,K,EAAOC,K,EACf;AACC,WAAI,IAAIjG,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAGgG,KAAK,CAAC3O,MAAzB,EAAiC2I,CAAC,EAAlC,EACA;AACC,YAAMkG,IAAI,GAAGF,KAAK,CAACnD,GAAN,CAAU7C,CAAV,CAAb;AACA,YAAMmG,IAAI,GAAGF,KAAK,CAACpD,GAAN,CAAU7C,CAAV,CAAb;AAEAiG,aAAK,CAACT,GAAN,CAAUxF,CAAV,EAAakG,IAAI,GAACC,IAAlB;AACA;AACD;;;;EA7UuB9P,qB;;;;;CCXzB;AAAA;AAAA;AAAA;CCAA;AAAA;AAAA;AAAA;CCAA;AAAA;AAAA;AAAA;;;;;;;ACAA;AACA,CAAC,YAAW;AACV,MAAI+P,SAAS,GAAG5E,MAAM,CAAC4E,SAAP,IAAoB5E,MAAM,CAAC6E,YAA3C;AACA,MAAIC,EAAE,GAAG9E,MAAM,CAAC+E,MAAP,GAAiB/E,MAAM,CAAC+E,MAAP,IAAiB,EAA3C;AACA,MAAIC,EAAE,GAAGF,EAAE,CAAC,aAAD,CAAF,GAAqBA,EAAE,CAAC,aAAD,CAAF,IAAqB,EAAnD;AACA,MAAI,CAACF,SAAD,IAAcI,EAAE,CAACC,QAArB,EAA+B;AAC/B,MAAIjF,MAAM,CAACkF,GAAX,EAAgB;AAChBlF,QAAM,CAACkF,GAAP,GAAa,IAAb;;AAEA,MAAIC,WAAW,GAAG,SAAdA,WAAc,CAASC,GAAT,EAAa;AAC7B,QAAIC,IAAI,GAAGnI,IAAI,CAACoI,KAAL,CAAWC,IAAI,CAACC,GAAL,KAAa,IAAxB,EAA8B7L,QAA9B,EAAX;AACAyL,OAAG,GAAGA,GAAG,CAACK,OAAJ,CAAY,yBAAZ,EAAuC,EAAvC,CAAN;AACA,WAAOL,GAAG,IAAIA,GAAG,CAACM,OAAJ,CAAY,GAAZ,KAAoB,CAApB,GAAwB,GAAxB,GAA8B,GAAlC,CAAH,GAA2C,cAA3C,GAA4DL,IAAnE;AACD,GAJD;;AAMA,MAAIM,OAAO,GAAGC,SAAS,CAACC,SAAV,CAAoBC,WAApB,EAAd;AACA,MAAIC,YAAY,GAAGf,EAAE,CAACe,YAAH,IAAmBJ,OAAO,CAACD,OAAR,CAAgB,QAAhB,IAA4B,CAAC,CAAnE;AAEA,MAAIM,SAAS,GAAG;AACdC,QAAI,EAAE,gBAAU;AACdjG,YAAM,CAACkG,QAAP,CAAgBC,MAAhB,CAAuB,IAAvB;AACD,KAHa;AAKdC,cAAU,EAAE,sBAAU;AACpB,SAAGxN,KAAH,CACGyN,IADH,CACQ5H,QAAQ,CAAC6H,gBAAT,CAA0B,sBAA1B,CADR,EAEGC,MAFH,CAEU,UAASC,IAAT,EAAe;AACrB,YAAIC,GAAG,GAAGD,IAAI,CAACE,YAAL,CAAkB,iBAAlB,CAAV;AACA,eAAOF,IAAI,CAACG,IAAL,IAAaF,GAAG,IAAI,OAA3B;AACD,OALH,EAMGG,OANH,CAMW,UAASJ,IAAT,EAAe;AACtBA,YAAI,CAACG,IAAL,GAAYxB,WAAW,CAACqB,IAAI,CAACG,IAAN,CAAvB;AACD,OARH,EADoB,CAWpB;;AACA,UAAIZ,YAAJ,EAAkBrC,UAAU,CAAC,YAAW;AAAEjF,gBAAQ,CAACK,IAAT,CAAc+H,YAAd;AAA6B,OAA3C,EAA6C,EAA7C,CAAV;AACnB,KAlBa;AAoBdC,cAAU,EAAE,sBAAU;AACpB,UAAIC,OAAO,GAAG,GAAGnO,KAAH,CAASyN,IAAT,CAAc5H,QAAQ,CAAC6H,gBAAT,CAA0B,QAA1B,CAAd,CAAd;AACA,UAAIU,WAAW,GAAGD,OAAO,CAAChF,GAAR,CAAY,UAASkF,MAAT,EAAiB;AAAE,eAAOA,MAAM,CAACC,IAAd;AAAoB,OAAnD,EAAqDX,MAArD,CAA4D,UAASW,IAAT,EAAe;AAAE,eAAOA,IAAI,CAACrR,MAAL,GAAc,CAArB;AAAwB,OAArG,CAAlB;AACA,UAAIsR,UAAU,GAAGJ,OAAO,CAACR,MAAR,CAAe,UAASU,MAAT,EAAiB;AAAE,eAAOA,MAAM,CAACG,GAAd;AAAmB,OAArD,CAAjB;AAEA,UAAIC,MAAM,GAAG,CAAb;AACA,UAAIjM,GAAG,GAAG+L,UAAU,CAACtR,MAArB;;AACA,UAAIyR,MAAM,GAAG,SAATA,MAAS,GAAW;AACtBD,cAAM,GAAGA,MAAM,GAAG,CAAlB;;AACA,YAAIA,MAAM,KAAKjM,GAAf,EAAoB;AAClB4L,qBAAW,CAACJ,OAAZ,CAAoB,UAASK,MAAT,EAAiB;AAAEM,gBAAI,CAACN,MAAD,CAAJ;AAAe,WAAtD;AACD;AACF,OALD;;AAOAE,gBAAU,CACPP,OADH,CACW,UAASK,MAAT,EAAiB;AACxB,YAAIG,GAAG,GAAGH,MAAM,CAACG,GAAjB;AACAH,cAAM,CAAC7H,MAAP;AACA,YAAIoI,SAAS,GAAG/I,QAAQ,CAACgJ,aAAT,CAAuB,QAAvB,CAAhB;AACAD,iBAAS,CAACJ,GAAV,GAAgBjC,WAAW,CAACiC,GAAD,CAA3B;AACAI,iBAAS,CAACE,KAAV,GAAkB,IAAlB;AACAF,iBAAS,CAAClJ,MAAV,GAAmBgJ,MAAnB;AACA7I,gBAAQ,CAACkJ,IAAT,CAAcC,WAAd,CAA0BJ,SAA1B;AACD,OATH;AAUD;AA5Ca,GAAhB;AA8CA,MAAIK,IAAI,GAAG7C,EAAE,CAAC6C,IAAH,IAAW,IAAtB;AACA,MAAIxI,IAAI,GAAGyF,EAAE,CAACgD,MAAH,IAAa9H,MAAM,CAACkG,QAAP,CAAgB6B,QAA7B,IAAyC,WAApD;;AAEA,MAAIC,OAAO,GAAG,SAAVA,OAAU,GAAU;AACtB,QAAIC,UAAU,GAAG,IAAIrD,SAAJ,CAAc,UAAUvF,IAAV,GAAiB,GAAjB,GAAuBwI,IAArC,CAAjB;;AACAI,cAAU,CAACC,SAAX,GAAuB,UAAS5Q,KAAT,EAAe;AACpC,UAAI0N,EAAE,CAACC,QAAP,EAAiB;AACjB,UAAIkD,OAAO,GAAG7Q,KAAK,CAACyB,IAApB;AACA,UAAIqP,QAAQ,GAAGpC,SAAS,CAACmC,OAAD,CAAT,IAAsBnC,SAAS,CAACC,IAA/C;AACAmC,cAAQ;AACT,KALD;;AAMAH,cAAU,CAACI,OAAX,GAAqB,YAAU;AAC7B,UAAIJ,UAAU,CAACK,UAAf,EAA2BL,UAAU,CAACM,KAAX;AAC5B,KAFD;;AAGAN,cAAU,CAACO,OAAX,GAAqB,YAAU;AAC7BxI,YAAM,CAAC0D,UAAP,CAAkBsE,OAAlB,EAA2B,IAA3B;AACD,KAFD;AAGD,GAdD;;AAeAA,SAAO;AACR,CAlFD;AAmFA","file":"docs/app.js","sourcesContent":["\nrequire.register(\"curvature/base/Bag.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Bag = void 0;\n\nvar _Bindable = require(\"./Bindable\");\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar toId = function toId(_int) {\n  return Number(_int).toString(36);\n};\n\nvar fromId = function fromId(id) {\n  return parseInt(id, 36);\n};\n\nvar Bag = /*#__PURE__*/function () {\n  function Bag() {\n    var changeCallback = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : undefined;\n\n    _classCallCheck(this, Bag);\n\n    this.meta = Symbol('meta');\n    this.content = new Map();\n    this.list = _Bindable.Bindable.makeBindable({});\n    this.current = 0;\n    this.type = undefined;\n    this.changeCallback = changeCallback;\n  }\n\n  _createClass(Bag, [{\n    key: \"add\",\n    value: function add(item) {\n      if (item === undefined || !(item instanceof Object)) {\n        throw new Error('Only objects may be added to Bags.');\n      }\n\n      if (this.type && !(item instanceof this.type)) {\n        console.error(this.type, item);\n        throw new Error(\"Only objects of type \".concat(this.type, \" may be added to this Bag.\"));\n      }\n\n      if (this.content.has(item)) {\n        return;\n      }\n\n      var id = toId(this.current++);\n      this.content.set(item, id);\n      this.list[id] = item;\n\n      if (this.changeCallback) {\n        this.changeCallback(item, this.meta, Bag.ITEM_ADDED, id);\n      }\n    }\n  }, {\n    key: \"remove\",\n    value: function remove(item) {\n      if (item === undefined || !(item instanceof Object)) {\n        throw new Error('Only objects may be removed from Bags.');\n      }\n\n      if (this.type && !(item instanceof this.type)) {\n        console.error(this.type, item);\n        throw new Error(\"Only objects of type \".concat(this.type, \" may be removed from this Bag.\"));\n      }\n\n      if (!this.content.has(item)) {\n        if (this.changeCallback) {\n          this.changeCallback(item, this.meta, 0, undefined);\n        }\n\n        return false;\n      }\n\n      var id = this.content.get(item);\n      delete this.list[id];\n      this.content[\"delete\"](item);\n\n      if (this.changeCallback) {\n        this.changeCallback(item, this.meta, Bag.ITEM_REMOVED, id);\n      }\n\n      return item;\n    }\n  }, {\n    key: \"items\",\n    value: function items() {\n      return Array.from(this.content.entries()).map(function (entry) {\n        return entry[0];\n      });\n    }\n  }]);\n\n  return Bag;\n}();\n\nexports.Bag = Bag;\nObject.defineProperty(Bag, 'ITEM_ADDED', {\n  configurable: false,\n  enumerable: false,\n  writable: true,\n  value: 1\n});\nObject.defineProperty(Bag, 'ITEM_REMOVED', {\n  configurable: false,\n  enumerable: false,\n  writable: true,\n  value: -1\n});\n  })();\n});","\nrequire.register(\"curvature/base/Bindable.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Bindable = void 0;\n\nfunction _construct(Parent, args, Class) { if (_isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar Ref = Symbol('ref');\nvar Original = Symbol('original');\nvar Deck = Symbol('deck');\nvar Binding = Symbol('binding');\nvar SubBinding = Symbol('subBinding');\nvar BindingAll = Symbol('bindingAll');\nvar IsBindable = Symbol('isBindable');\nvar Wrapping = Symbol('wrapping');\nvar Executing = Symbol('executing');\nvar Stack = Symbol('stack');\nvar ObjSymbol = Symbol('object');\nvar Wrapped = Symbol('wrapped');\nvar Unwrapped = Symbol('unwrapped');\nvar GetProto = Symbol('getProto');\nvar OnGet = Symbol('onGet');\nvar OnAllGet = Symbol('onAllGet');\nvar BindChain = Symbol('bindChain');\nvar TypedArray = Object.getPrototypeOf(Int8Array);\nvar win = window || {};\nvar excludedClasses = [win.Node, win.File, win.Map, win.Set, win.ArrayBuffer, win.ResizeObserver, win.MutationObserver, win.PerformanceObserver, win.IntersectionObserver].filter(function (x) {\n  return typeof x === 'function';\n});\n\nvar Bindable = /*#__PURE__*/function () {\n  function Bindable() {\n    _classCallCheck(this, Bindable);\n  }\n\n  _createClass(Bindable, null, [{\n    key: \"isBindable\",\n    value: function isBindable(object) {\n      if (!object || !object[IsBindable]) {\n        return false;\n      }\n\n      return object[IsBindable] === Bindable;\n    }\n  }, {\n    key: \"onDeck\",\n    value: function onDeck(object, key) {\n      return object[Deck][key] || false;\n    }\n  }, {\n    key: \"ref\",\n    value: function ref(object) {\n      return object[Ref] || false;\n    }\n  }, {\n    key: \"makeBindable\",\n    value: function makeBindable(object) {\n      return this.make(object);\n    }\n  }, {\n    key: \"shuck\",\n    value: function shuck(original, seen) {\n      seen = seen || new Map();\n      var clone = {};\n\n      if (original instanceof TypedArray || original instanceof ArrayBuffer) {\n        var _clone = original.slice(0);\n\n        seen.set(original, _clone);\n        return _clone;\n      }\n\n      var properties = Object.keys(original);\n\n      for (var i in properties) {\n        var ii = properties[i];\n\n        if (ii.substring(0, 3) === '___') {\n          continue;\n        }\n\n        var alreadyCloned = seen.get(original[ii]);\n\n        if (alreadyCloned) {\n          clone[ii] = alreadyCloned;\n          continue;\n        }\n\n        if (original[ii] === original) {\n          seen.set(original[ii], clone);\n          clone[ii] = clone;\n          continue;\n        }\n\n        if (original[ii] && _typeof(original[ii]) === 'object') {\n          var originalProp = original[ii];\n\n          if (Bindable.isBindable(original[ii])) {\n            originalProp = original[ii][Original];\n          }\n\n          clone[ii] = this.shuck(originalProp, seen);\n        } else {\n          clone[ii] = original[ii];\n        }\n\n        seen.set(original[ii], clone[ii]);\n      }\n\n      if (Bindable.isBindable(original)) {\n        delete clone.bindTo;\n        delete clone.isBound;\n      }\n\n      return clone;\n    }\n  }, {\n    key: \"make\",\n    value: function make(object) {\n      var _this = this;\n\n      if (!object || !['function', 'object'].includes(_typeof(object))) {\n        return object;\n      }\n\n      if (excludedClasses.filter(function (x) {\n        return object instanceof x;\n      }).length || Object.isSealed(object) || !Object.isExtensible(object)) {\n        return object;\n      }\n\n      if (object[Ref]) {\n        return object;\n      }\n\n      if (object[Binding]) {\n        return object;\n      }\n\n      Object.defineProperty(object, Ref, {\n        configurable: true,\n        enumerable: false,\n        writable: true,\n        value: object\n      });\n      Object.defineProperty(object, Original, {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: object\n      });\n      Object.defineProperty(object, Deck, {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: {}\n      });\n      Object.defineProperty(object, Binding, {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: {}\n      });\n      Object.defineProperty(object, SubBinding, {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: new Map()\n      });\n      Object.defineProperty(object, BindingAll, {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: []\n      });\n      Object.defineProperty(object, IsBindable, {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: Bindable\n      });\n      Object.defineProperty(object, Executing, {\n        enumerable: false,\n        writable: true\n      });\n      Object.defineProperty(object, Wrapping, {\n        enumerable: false,\n        writable: true\n      });\n      Object.defineProperty(object, Stack, {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: []\n      });\n      Object.defineProperty(object, '___before___', {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: []\n      });\n      Object.defineProperty(object, '___after___', {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: []\n      });\n      Object.defineProperty(object, Wrapped, {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: {}\n      });\n      Object.defineProperty(object, Unwrapped, {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: {}\n      });\n\n      var bindTo = function bindTo(property) {\n        var callback = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n        var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n        var bindToAll = false;\n\n        if (Array.isArray(property)) {\n          var debinders = property.map(function (p) {\n            return bindTo(p, callback, options);\n          });\n          return function () {\n            return debinders.map(function (d) {\n              return d();\n            });\n          };\n        }\n\n        if (property instanceof Function) {\n          options = callback || {};\n          callback = property;\n          bindToAll = true;\n        }\n\n        if (options.delay >= 0) {\n          callback = _this.wrapDelayCallback(callback, options.delay);\n        }\n\n        if (options.throttle >= 0) {\n          callback = _this.wrapThrottleCallback(callback, options.throttle);\n        }\n\n        if (options.wait >= 0) {\n          callback = _this.wrapWaitCallback(callback, options.wait);\n        }\n\n        if (options.frame) {\n          callback = _this.wrapFrameCallback(callback, options.frame);\n        }\n\n        if (options.idle) {\n          callback = _this.wrapIdleCallback(callback);\n        }\n\n        if (bindToAll) {\n          var _bindIndex = object[BindingAll].length;\n          object[BindingAll].push(callback);\n\n          if (!('now' in options) || options.now) {\n            for (var i in object) {\n              callback(object[i], i, object, false);\n            }\n          }\n\n          return function () {\n            delete object[BindingAll][_bindIndex];\n          };\n        }\n\n        if (!object[Binding][property]) {\n          object[Binding][property] = [];\n        }\n\n        var bindIndex = object[Binding][property].length;\n\n        if (options.children) {\n          var original = callback;\n\n          callback = function callback() {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var v = args[0];\n            var subDebind = object[SubBinding].get(original);\n\n            if (subDebind) {\n              object[SubBinding][\"delete\"](original);\n              subDebind();\n            }\n\n            if (_typeof(v) !== 'object') {\n              original.apply(void 0, args);\n              return;\n            }\n\n            var vv = Bindable.make(v);\n\n            if (Bindable.isBindable(vv)) {\n              object[SubBinding].set(original, vv.bindTo(function () {\n                for (var _len2 = arguments.length, subArgs = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n                  subArgs[_key2] = arguments[_key2];\n                }\n\n                return original.apply(void 0, args.concat(subArgs));\n              }, Object.assign({}, options, {\n                children: false\n              })));\n            }\n\n            original.apply(void 0, args);\n          };\n        }\n\n        object[Binding][property].push(callback);\n\n        if (!('now' in options) || options.now) {\n          callback(object[property], property, object, false);\n        }\n\n        var cleaned = false;\n\n        var debinder = function debinder() {\n          var subDebind = object[SubBinding].get(callback);\n\n          if (subDebind) {\n            object[SubBinding][\"delete\"](callback);\n            subDebind();\n          }\n\n          if (cleaned) {\n            return;\n          }\n\n          cleaned = true;\n\n          if (!object[Binding][property]) {\n            return;\n          }\n\n          delete object[Binding][property][bindIndex];\n        };\n\n        if (options.removeWith && options.removeWith instanceof View) {\n          options.removeWith.onRemove(function () {\n            return debinder;\n          });\n        }\n\n        return debinder;\n      };\n\n      Object.defineProperty(object, 'bindTo', {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: bindTo\n      });\n\n      var ___before = function ___before(callback) {\n        var beforeIndex = object.___before___.length;\n\n        object.___before___.push(callback);\n\n        var cleaned = false;\n        return function () {\n          if (cleaned) {\n            return;\n          }\n\n          cleaned = true;\n          delete object.___before___[beforeIndex];\n        };\n      };\n\n      var ___after = function ___after(callback) {\n        var afterIndex = object.___after___.length;\n\n        object.___after___.push(callback);\n\n        var cleaned = false;\n        return function () {\n          if (cleaned) {\n            return;\n          }\n\n          cleaned = true;\n          delete object.___after___[afterIndex];\n        };\n      };\n\n      Object.defineProperty(object, BindChain, {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: function value(path, callback) {\n          var parts = path.split('.');\n          var node = parts.shift();\n          var subParts = parts.slice(0);\n          var debind = [];\n          debind.push(object.bindTo(node, function (v, k, t, d) {\n            var rest = subParts.join('.');\n\n            if (subParts.length === 0) {\n              callback(v, k, t, d);\n              return;\n            }\n\n            if (v === undefined) {\n              v = t[k] = _this.makeBindable({});\n            }\n\n            debind = debind.concat(v[BindChain](rest, callback));\n          })); // console.log(debind);\n\n          return function () {\n            return debind.map(function (x) {\n              return x();\n            });\n          };\n        }\n      });\n      Object.defineProperty(object, '___before', {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: ___before\n      });\n      Object.defineProperty(object, '___after', {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: ___after\n      });\n\n      var isBound = function isBound() {\n        for (var i in object[BindingAll]) {\n          if (object[BindingAll][i]) {\n            return true;\n          }\n        }\n\n        for (var _i in object[Binding]) {\n          for (var j in object[Binding][_i]) {\n            if (object[Binding][_i][j]) {\n              return true;\n            }\n          }\n        }\n\n        return false;\n      };\n\n      Object.defineProperty(object, 'isBound', {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: isBound\n      });\n\n      var _loop = function _loop(i) {\n        if (object[i] && object[i] instanceof Object && !object[i] instanceof Promise) {\n          if (!excludedClasses.filter(function (excludeClass) {\n            return object[i] instanceof excludeClass;\n          }).length && Object.isExtensible(object[i]) && !Object.isSealed(object[i])) {\n            object[i] = Bindable.make(object[i]);\n          }\n        }\n      };\n\n      for (var i in object) {\n        _loop(i);\n      }\n\n      var set = function set(target, key, value) {\n        if (key === Original) {\n          return true;\n        }\n\n        if (object[Deck][key] !== undefined && object[Deck][key] === value) {\n          return true;\n        }\n\n        if (typeof key === 'string' && key.substring(0, 3) === '___' && key.slice(-3) === '___') {\n          return true;\n        }\n\n        if (target[key] === value) {\n          return true;\n        }\n\n        if (value && value instanceof Object) {\n          if (!excludedClasses.filter(function (x) {\n            return object instanceof x;\n          }).length && Object.isExtensible(object) && !Object.isSealed(object)) {\n            value = Bindable.makeBindable(value);\n          }\n        }\n\n        object[Deck][key] = value;\n\n        for (var _i2 in object[BindingAll]) {\n          if (!object[BindingAll][_i2]) {\n            continue;\n          }\n\n          object[BindingAll][_i2](value, key, target, false);\n        }\n\n        var stop = false;\n\n        if (key in object[Binding]) {\n          for (var _i3 in object[Binding][key]) {\n            if (!object[Binding][key]) {\n              continue;\n            }\n\n            if (!object[Binding][key][_i3]) {\n              continue;\n            }\n\n            if (object[Binding][key][_i3](value, key, target, false, target[key]) === false) {\n              stop = true;\n            }\n          }\n        }\n\n        delete object[Deck][key];\n\n        if (!stop) {\n          var descriptor = Object.getOwnPropertyDescriptor(target, key);\n          var excluded = target instanceof File && key == 'lastModifiedDate';\n\n          if (!excluded && (!descriptor || descriptor.writable) && target[key] === value) {\n            target[key] = value;\n          }\n        }\n\n        return Reflect.set(target, key, value);\n      };\n\n      var deleteProperty = function deleteProperty(target, key) {\n        if (!(key in target)) {\n          return true;\n        }\n\n        for (var _i4 in object[BindingAll]) {\n          object[BindingAll][_i4](undefined, key, target, true, target[key]);\n        }\n\n        if (key in object[Binding]) {\n          for (var _i5 in object[Binding][key]) {\n            if (!object[Binding][key][_i5]) {\n              continue;\n            }\n\n            object[Binding][key][_i5](undefined, key, target, true, target[key]);\n          }\n        }\n\n        delete target[key];\n        return true;\n      };\n\n      var construct = function construct(target, args) {\n        var key = 'constructor';\n\n        for (var _i6 in target.___before___) {\n          target.___before___[_i6](target, key, target[Stack], undefined, args);\n        }\n\n        var instance = Bindable.make(_construct(target[Original], _toConsumableArray(args)));\n\n        for (var _i7 in target.___after___) {\n          target.___after___[_i7](target, key, target[Stack], instance, args);\n        }\n\n        return instance;\n      };\n\n      var get = function get(target, key) {\n        if (key === Ref || key === Original || key === 'apply' || key === 'isBound' || key === 'bindTo' || key === '__proto__') {\n          return target[key];\n        }\n\n        var descriptor = Object.getOwnPropertyDescriptor(object, key);\n\n        if (descriptor && !descriptor.configurable && !descriptor.writable) {\n          return target[key];\n        }\n\n        if (object[OnAllGet]) {\n          return object[OnAllGet](key);\n        }\n\n        if (object[OnGet] && !(key in object)) {\n          return object[OnGet](key);\n        }\n\n        if (target[Wrapped][key]) {\n          return target[Wrapped][key];\n        }\n\n        if (descriptor && !descriptor.configurable && !descriptor.writable) {\n          target[Wrapped][key] = target[key];\n          return target[Wrapped][key];\n        }\n\n        if (typeof target[key] === 'function') {\n          Object.defineProperty(target[Unwrapped], key, {\n            configurable: false,\n            enumerable: false,\n            writable: false,\n            value: target[key]\n          });\n          target[Wrapped][key] = Bindable.make(function () {\n            var objRef = object instanceof Promise || object instanceof Map || object instanceof Set || typeof Date === 'function' && object instanceof Date || typeof TypedArray === 'function' && object instanceof TypedArray || typeof ArrayBuffer === 'function' && object instanceof ArrayBuffer || typeof EventTarget === 'function' && object instanceof EventTarget || typeof ResizeObserver === 'function' && object instanceof ResizeObserver || typeof MutationObserver === 'function' && object instanceof MutationObserver || typeof PerformanceObserver === 'function' && object instanceof PerformanceObserver || typeof IntersectionObserver === 'function' && object instanceof IntersectionObserver ? object : object[Ref];\n            target[Executing] = key;\n            target[Stack].unshift(key);\n\n            for (var _len3 = arguments.length, providedArgs = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n              providedArgs[_key3] = arguments[_key3];\n            }\n\n            for (var _i8 in target.___before___) {\n              target.___before___[_i8](target, key, target[Stack], object, providedArgs);\n            }\n\n            var ret;\n\n            if (new.target) {\n              ret = _construct(target[Unwrapped][key], providedArgs);\n            } else {\n              var prototype = Object.getPrototypeOf(target);\n              var isMethod = prototype[key] === target[key];\n\n              if (isMethod) {\n                ret = target[key].apply(objRef || object, providedArgs);\n              } else {\n                ret = target[key].apply(target, providedArgs);\n              }\n            }\n\n            for (var _i9 in target.___after___) {\n              target.___after___[_i9](target, key, target[Stack], object, providedArgs);\n            }\n\n            target[Executing] = null;\n            target[Stack].shift();\n            return ret;\n          });\n          return target[Wrapped][key];\n        }\n\n        return target[key];\n      };\n\n      var getPrototypeOf = function getPrototypeOf(target) {\n        if (GetProto in object) {\n          return object[GetProto];\n        }\n\n        return Reflect.getPrototypeOf(target);\n      };\n\n      Object.defineProperty(object, Ref, {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: new Proxy(object, {\n          get: get,\n          set: set,\n          construct: construct,\n          getPrototypeOf: getPrototypeOf,\n          deleteProperty: deleteProperty\n        })\n      });\n      return object[Ref];\n    }\n  }, {\n    key: \"clearBindings\",\n    value: function clearBindings(object) {\n      var clearObj = function clearObj(o) {\n        return Object.keys(o).map(function (k) {\n          return delete o[k];\n        });\n      };\n\n      var maps = function maps(func) {\n        return function () {\n          for (var _len4 = arguments.length, os = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n            os[_key4] = arguments[_key4];\n          }\n\n          return os.map(func);\n        };\n      };\n\n      var clearObjs = maps(clearObj);\n      clearObjs(object[Wrapped], object[Binding], object[BindingAll], object.___after___, object.___before___);\n    }\n  }, {\n    key: \"resolve\",\n    value: function resolve(object, path) {\n      var owner = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var node;\n      var pathParts = path.split('.');\n      var top = pathParts[0];\n\n      while (pathParts.length) {\n        if (owner && pathParts.length === 1) {\n          var obj = this.makeBindable(object);\n          return [obj, pathParts.shift(), top];\n        }\n\n        node = pathParts.shift();\n\n        if (!node in object || !object[node] || !(object[node] instanceof Object)) {\n          object[node] = {};\n        }\n\n        object = this.makeBindable(object[node]);\n      }\n\n      return [this.makeBindable(object), node, top];\n    }\n  }, {\n    key: \"wrapDelayCallback\",\n    value: function wrapDelayCallback(callback, delay) {\n      return function () {\n        for (var _len5 = arguments.length, args = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {\n          args[_key5] = arguments[_key5];\n        }\n\n        return setTimeout(function () {\n          return callback.apply(void 0, args);\n        }, delay);\n      };\n    }\n  }, {\n    key: \"wrapThrottleCallback\",\n    value: function wrapThrottleCallback(callback, throttle) {\n      var _this2 = this;\n\n      this.throttles.set(callback, false);\n      return function (callback) {\n        return function () {\n          if (_this2.throttles.get(callback, true)) {\n            return;\n          }\n\n          callback.apply(void 0, arguments);\n\n          _this2.throttles.set(callback, true);\n\n          setTimeout(function () {\n            _this2.throttles.set(callback, false);\n          }, throttle);\n        };\n      }(callback);\n    }\n  }, {\n    key: \"wrapWaitCallback\",\n    value: function wrapWaitCallback(callback, wait) {\n      var waiter = false;\n      return function () {\n        for (var _len6 = arguments.length, args = new Array(_len6), _key6 = 0; _key6 < _len6; _key6++) {\n          args[_key6] = arguments[_key6];\n        }\n\n        if (waiter) {\n          clearTimeout(waiter);\n          waiter = false;\n        }\n\n        waiter = setTimeout(function () {\n          return callback.apply(void 0, args);\n        }, wait);\n      };\n    }\n  }, {\n    key: \"wrapFrameCallback\",\n    value: function wrapFrameCallback(callback, frames) {\n      return function () {\n        for (var _len7 = arguments.length, args = new Array(_len7), _key7 = 0; _key7 < _len7; _key7++) {\n          args[_key7] = arguments[_key7];\n        }\n\n        requestAnimationFrame(function () {\n          return callback.apply(void 0, args);\n        });\n      };\n    }\n  }, {\n    key: \"wrapIdleCallback\",\n    value: function wrapIdleCallback(callback) {\n      return function () {\n        for (var _len8 = arguments.length, args = new Array(_len8), _key8 = 0; _key8 < _len8; _key8++) {\n          args[_key8] = arguments[_key8];\n        }\n\n        // Compatibility for Safari 08/2020\n        var req = window.requestIdleCallback || requestAnimationFrame;\n        req(function () {\n          return callback.apply(void 0, args);\n        });\n      };\n    }\n  }]);\n\n  return Bindable;\n}();\n\nexports.Bindable = Bindable;\n\n_defineProperty(Bindable, \"throttles\", new WeakMap());\n\nObject.defineProperty(Bindable, 'OnGet', {\n  configurable: false,\n  enumerable: false,\n  writable: false,\n  value: OnGet\n});\nObject.defineProperty(Bindable, 'GetProto', {\n  configurable: false,\n  enumerable: false,\n  writable: false,\n  value: GetProto\n});\nObject.defineProperty(Bindable, 'OnAllGet', {\n  configurable: false,\n  enumerable: false,\n  writable: false,\n  value: OnAllGet\n});\n  })();\n});","\nrequire.register(\"curvature/base/Cache.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Cache = void 0;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar Cache = /*#__PURE__*/function () {\n  function Cache() {\n    _classCallCheck(this, Cache);\n  }\n\n  _createClass(Cache, null, [{\n    key: \"store\",\n    value: function store(key, value, expiry) {\n      var bucket = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 'standard';\n      var expiration = 0;\n\n      if (expiry) {\n        expiration = expiry * 1000 + new Date().getTime();\n      } // console.log(\n      // \t`Caching ${key} until ${expiration} in ${bucket}.`\n      // \t, value\n      // \t, this.bucket\n      // );\n\n\n      if (!this.bucket) {\n        this.bucket = {};\n      }\n\n      if (!this.bucket[bucket]) {\n        this.bucket[bucket] = {};\n      }\n\n      this.bucket[bucket][key] = {\n        expiration: expiration,\n        value: value\n      };\n    }\n  }, {\n    key: \"load\",\n    value: function load(key) {\n      var defaultvalue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var bucket = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'standard';\n\n      // console.log(\n      // \t`Checking cache for ${key} in ${bucket}.`\n      // \t, this.bucket\n      // );\n      if (this.bucket && this.bucket[bucket] && this.bucket[bucket][key]) {\n        // console.log(this.bucket[bucket][key].expiration, (new Date).getTime());\n        if (this.bucket[bucket][key].expiration == 0 || this.bucket[bucket][key].expiration > new Date().getTime()) {\n          return this.bucket[bucket][key].value;\n        }\n      }\n\n      return defaultvalue;\n    }\n  }]);\n\n  return Cache;\n}();\n\nexports.Cache = Cache;\n  })();\n});","\nrequire.register(\"curvature/base/Config.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Config = void 0;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar AppConfig = {};\n\ntry {\n  AppConfig = require('/Config').Config || {};\n} catch (error) {\n  window.devMode === true && console.error(error);\n}\n\nvar Config = /*#__PURE__*/function () {\n  function Config() {\n    _classCallCheck(this, Config);\n  }\n\n  _createClass(Config, null, [{\n    key: \"get\",\n    value: function get(name) {\n      return this.configs[name];\n    }\n  }, {\n    key: \"set\",\n    value: function set(name, value) {\n      this.configs[name] = value;\n      return this;\n    }\n  }, {\n    key: \"dump\",\n    value: function dump() {\n      return this.configs;\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      for (var _len = arguments.length, configs = new Array(_len), _key = 0; _key < _len; _key++) {\n        configs[_key] = arguments[_key];\n      }\n\n      for (var i in configs) {\n        var config = configs[i];\n\n        if (typeof config === 'string') {\n          config = JSON.parse(config);\n        }\n\n        for (var name in config) {\n          var value = config[name];\n          return this.configs[name] = value;\n        }\n      }\n\n      return this;\n    }\n  }]);\n\n  return Config;\n}();\n\nexports.Config = Config;\nObject.defineProperty(Config, 'configs', {\n  configurable: false,\n  enumerable: false,\n  writable: false,\n  value: AppConfig\n});\n  })();\n});","\nrequire.register(\"curvature/base/Dom.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Dom = void 0;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar traversals = 0;\n\nvar Dom = /*#__PURE__*/function () {\n  function Dom() {\n    _classCallCheck(this, Dom);\n  }\n\n  _createClass(Dom, null, [{\n    key: \"mapTags\",\n    value: function mapTags(doc, selector, callback, startNode, endNode) {\n      var result = [];\n      var started = true;\n\n      if (startNode) {\n        started = false;\n      }\n\n      var ended = false;\n      var treeWalker = document.createTreeWalker(doc, NodeFilter.SHOW_ELEMENT | NodeFilter.SHOW_TEXT, {\n        acceptNode: function acceptNode(node, walker) {\n          if (!started) {\n            if (node === startNode) {\n              started = true;\n            } else {\n              return NodeFilter.FILTER_SKIP;\n            }\n          }\n\n          if (endNode && node === endNode) {\n            ended = true;\n          }\n\n          if (ended) {\n            return NodeFilter.FILTER_SKIP;\n          }\n\n          if (selector) {\n            if (node instanceof Element) {\n              if (node.matches(selector)) {\n                return NodeFilter.FILTER_ACCEPT;\n              }\n            }\n\n            return NodeFilter.FILTER_SKIP;\n          }\n\n          return NodeFilter.FILTER_ACCEPT;\n        }\n      }, false);\n      var traversal = traversals++;\n\n      while (treeWalker.nextNode()) {\n        result.push(callback(treeWalker.currentNode, treeWalker));\n      }\n\n      return result;\n    }\n  }, {\n    key: \"dispatchEvent\",\n    value: function dispatchEvent(doc, event) {\n      doc.dispatchEvent(event);\n      Dom.mapTags(doc, false, function (node) {\n        node.dispatchEvent(event);\n      });\n    }\n  }]);\n\n  return Dom;\n}();\n\nexports.Dom = Dom;\n  })();\n});","\nrequire.register(\"curvature/base/Mixin.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Mixin = void 0;\n\nvar _Bindable = require(\"./Bindable\");\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar Constructor = Symbol('constructor');\nvar MixinList = Symbol('mixinList');\n\nvar Mixin = /*#__PURE__*/function () {\n  function Mixin() {\n    _classCallCheck(this, Mixin);\n  }\n\n  _createClass(Mixin, null, [{\n    key: \"from\",\n    value: function from(baseClass) {\n      for (var _len = arguments.length, mixins = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        mixins[_key - 1] = arguments[_key];\n      }\n\n      var constructors = [];\n\n      var newClass = /*#__PURE__*/function (_baseClass) {\n        _inherits(newClass, _baseClass);\n\n        var _super = _createSuper(newClass);\n\n        function newClass() {\n          var _this;\n\n          _classCallCheck(this, newClass);\n\n          for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n            args[_key2] = arguments[_key2];\n          }\n\n          var instance = _this = _super.call.apply(_super, [this].concat(args));\n\n          var _iterator = _createForOfIteratorHelper(mixins),\n              _step;\n\n          try {\n            for (_iterator.s(); !(_step = _iterator.n()).done;) {\n              var mixin = _step.value;\n\n              if (mixin[Mixin.Constructor]) {\n                mixin[Mixin.Constructor].apply(_assertThisInitialized(_this));\n              }\n\n              switch (_typeof(mixin)) {\n                // case 'function':\n                // \tthis.mixClass(mixin, newClass);\n                // \tbreak;\n                case 'object':\n                  Mixin.mixObject(mixin, _assertThisInitialized(_this));\n                  break;\n              }\n            }\n          } catch (err) {\n            _iterator.e(err);\n          } finally {\n            _iterator.f();\n          }\n\n          return _possibleConstructorReturn(_this, instance);\n        }\n\n        return newClass;\n      }(baseClass);\n\n      return newClass;\n    }\n  }, {\n    key: \"to\",\n    value: function to(base) {\n      for (var _len3 = arguments.length, mixins = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n        mixins[_key3 - 1] = arguments[_key3];\n      }\n\n      mixins.map(function (mixin) {\n        // const staticSymbols = Object.getOwnPropertyNames(mixin.prototype);\n        // const staticNames   = Object.getOwnPropertySymbols(mixin.prototype);\n        // const symbols = Object.getOwnPropertyNames(mixin);\n        // const names   = Object.getOwnPropertySymbols(mixin);\n        // const properties = [...staticNames, ...staticSymbols];\n        // const properties = Object.keys(mixin);\n        // properties.map(property => {\n        // \tconsole.log(property, mixin.prototype[property]);\n        // });\n        switch (_typeof(mixin)) {\n          case 'object':\n            var descriptors = Object.getOwnPropertyDescriptors(mixin);\n            console.log(descriptors);\n            Object.defineProperties(base.prototype, descriptors);\n            break;\n\n          case 'function':\n            break;\n        }\n      });\n    }\n  }, {\n    key: \"with\",\n    value: function _with() {\n      for (var _len4 = arguments.length, mixins = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n        mixins[_key4] = arguments[_key4];\n      }\n\n      return this.from.apply(this, [Object].concat(mixins));\n    }\n  }, {\n    key: \"mixObject\",\n    value: function mixObject(mixin, instance) {\n      var _iterator2 = _createForOfIteratorHelper(Object.getOwnPropertyNames(mixin)),\n          _step2;\n\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var func = _step2.value;\n\n          if (typeof mixin[func] === 'function') {\n            instance[func] = mixin[func].bind(instance);\n            continue;\n          }\n\n          instance[func] = mixin[func];\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n\n      var _iterator3 = _createForOfIteratorHelper(Object.getOwnPropertySymbols(mixin)),\n          _step3;\n\n      try {\n        for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n          var _func = _step3.value;\n\n          if (typeof mixin[_func] === 'function') {\n            instance[_func] = mixin[_func].bind(instance);\n            continue;\n          }\n\n          instance[_func] = mixin[_func];\n        }\n      } catch (err) {\n        _iterator3.e(err);\n      } finally {\n        _iterator3.f();\n      }\n    }\n  }, {\n    key: \"mixClass\",\n    value: function mixClass(cls, newClass) {\n      var _iterator4 = _createForOfIteratorHelper(Object.getOwnPropertyNames(cls.prototype)),\n          _step4;\n\n      try {\n        for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n          var func = _step4.value;\n          newClass.prototype[func] = cls.prototype[func].bind(newClass.prototype);\n        }\n      } catch (err) {\n        _iterator4.e(err);\n      } finally {\n        _iterator4.f();\n      }\n\n      var _iterator5 = _createForOfIteratorHelper(Object.getOwnPropertySymbols(cls.prototype)),\n          _step5;\n\n      try {\n        for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n          var _func2 = _step5.value;\n          newClass.prototype[_func2] = cls.prototype[_func2].bind(newClass.prototype);\n        }\n      } catch (err) {\n        _iterator5.e(err);\n      } finally {\n        _iterator5.f();\n      }\n\n      var _iterator6 = _createForOfIteratorHelper(Object.getOwnPropertyNames(cls)),\n          _step6;\n\n      try {\n        var _loop = function _loop() {\n          var func = _step6.value;\n\n          if (typeof cls[func] !== 'function') {\n            return \"continue\";\n          }\n\n          var prev = newClass[func] || false;\n          var meth = cls[func].bind(newClass);\n\n          newClass[func] = function () {\n            prev && prev.apply(void 0, arguments);\n            return meth.apply(void 0, arguments);\n          };\n        };\n\n        for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {\n          var _ret = _loop();\n\n          if (_ret === \"continue\") continue;\n        }\n      } catch (err) {\n        _iterator6.e(err);\n      } finally {\n        _iterator6.f();\n      }\n\n      var _iterator7 = _createForOfIteratorHelper(Object.getOwnPropertySymbols(cls)),\n          _step7;\n\n      try {\n        var _loop2 = function _loop2() {\n          var func = _step7.value;\n\n          if (typeof cls[func] !== 'function') {\n            return \"continue\";\n          }\n\n          var prev = newClass[func] || false;\n          var meth = cls[func].bind(newClass);\n\n          newClass[func] = function () {\n            prev && prev.apply(void 0, arguments);\n            return meth.apply(void 0, arguments);\n          };\n        };\n\n        for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {\n          var _ret2 = _loop2();\n\n          if (_ret2 === \"continue\") continue;\n        }\n      } catch (err) {\n        _iterator7.e(err);\n      } finally {\n        _iterator7.f();\n      }\n    }\n  }, {\n    key: \"mix\",\n    value: function mix(mixinTo) {\n      var constructors = [];\n      var allStatic = {};\n      var allInstance = {};\n\n      var mixable = _Bindable.Bindable.makeBindable(mixinTo);\n\n      var _loop3 = function _loop3(base) {\n        var instanceNames = Object.getOwnPropertyNames(base.prototype);\n        var staticNames = Object.getOwnPropertyNames(base);\n        var prefix = /^(before|after)__(.+)/;\n\n        var _iterator8 = _createForOfIteratorHelper(staticNames),\n            _step8;\n\n        try {\n          var _loop5 = function _loop5() {\n            var methodName = _step8.value;\n            var match = methodName.match(prefix);\n\n            if (match) {\n              switch (match[1]) {\n                case 'before':\n                  mixable.___before(function (t, e, s, o, a) {\n                    if (e !== match[2]) {\n                      return;\n                    }\n\n                    var method = base[methodName].bind(o);\n                    return method.apply(void 0, _toConsumableArray(a));\n                  });\n\n                  break;\n\n                case 'after':\n                  mixable.___after(function (t, e, s, o, a) {\n                    if (e !== match[2]) {\n                      return;\n                    }\n\n                    var method = base[methodName].bind(o);\n                    return method.apply(void 0, _toConsumableArray(a));\n                  });\n\n                  break;\n              }\n\n              return \"continue\";\n            }\n\n            if (allStatic[methodName]) {\n              return \"continue\";\n            }\n\n            if (typeof base[methodName] !== 'function') {\n              return \"continue\";\n            }\n\n            allStatic[methodName] = base[methodName];\n          };\n\n          for (_iterator8.s(); !(_step8 = _iterator8.n()).done;) {\n            var _ret3 = _loop5();\n\n            if (_ret3 === \"continue\") continue;\n          }\n        } catch (err) {\n          _iterator8.e(err);\n        } finally {\n          _iterator8.f();\n        }\n\n        var _iterator9 = _createForOfIteratorHelper(instanceNames),\n            _step9;\n\n        try {\n          var _loop6 = function _loop6() {\n            var methodName = _step9.value;\n            var match = methodName.match(prefix);\n\n            if (match) {\n              switch (match[1]) {\n                case 'before':\n                  mixable.___before(function (t, e, s, o, a) {\n                    if (e !== match[2]) {\n                      return;\n                    }\n\n                    var method = base.prototype[methodName].bind(o);\n                    return method.apply(void 0, _toConsumableArray(a));\n                  });\n\n                  break;\n\n                case 'after':\n                  mixable.___after(function (t, e, s, o, a) {\n                    if (e !== match[2]) {\n                      return;\n                    }\n\n                    var method = base.prototype[methodName].bind(o);\n                    return method.apply(void 0, _toConsumableArray(a));\n                  });\n\n                  break;\n              }\n\n              return \"continue\";\n            }\n\n            if (allInstance[methodName]) {\n              return \"continue\";\n            }\n\n            if (typeof base.prototype[methodName] !== 'function') {\n              return \"continue\";\n            }\n\n            allInstance[methodName] = base.prototype[methodName];\n          };\n\n          for (_iterator9.s(); !(_step9 = _iterator9.n()).done;) {\n            var _ret4 = _loop6();\n\n            if (_ret4 === \"continue\") continue;\n          }\n        } catch (err) {\n          _iterator9.e(err);\n        } finally {\n          _iterator9.f();\n        }\n      };\n\n      for (var base = this; base && base.prototype; base = Object.getPrototypeOf(base)) {\n        _loop3(base);\n      }\n\n      for (var methodName in allStatic) {\n        mixinTo[methodName] = allStatic[methodName].bind(mixinTo);\n      }\n\n      var _loop4 = function _loop4(_methodName) {\n        mixinTo.prototype[_methodName] = function () {\n          for (var _len5 = arguments.length, args = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {\n            args[_key5] = arguments[_key5];\n          }\n\n          return allInstance[_methodName].apply(this, args);\n        };\n      };\n\n      for (var _methodName in allInstance) {\n        _loop4(_methodName);\n      }\n\n      return mixable;\n    }\n  }]);\n\n  return Mixin;\n}();\n\nexports.Mixin = Mixin;\nMixin.Constructor = Constructor;\n  })();\n});","\nrequire.register(\"curvature/base/Router.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Router = void 0;\n\nvar _View = require(\"./View\");\n\nvar _Cache = require(\"./Cache\");\n\nvar _Config = require(\"./Config\");\n\nvar _Routes = require(\"./Routes\");\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar NotFoundError = Symbol('NotFound');\nvar InternalError = Symbol('Internal');\n\nvar Router = /*#__PURE__*/function () {\n  function Router() {\n    _classCallCheck(this, Router);\n  }\n\n  _createClass(Router, null, [{\n    key: \"wait\",\n    value: function wait(view) {\n      var _this = this;\n\n      var event = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'DOMContentLoaded';\n      var node = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : document;\n      node.addEventListener(event, function () {\n        _this.listen(view);\n      });\n    }\n  }, {\n    key: \"listen\",\n    value: function listen(listener) {\n      var _this2 = this;\n\n      var routes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      this.routes = routes;\n      Object.assign(this.query, this.queryOver({}));\n\n      var listen = function listen(event) {\n        event.preventDefault();\n\n        if (event.state && 'routedId' in event.state) {\n          if (event.state.routedId <= _this2.routeCount) {\n            _this2.history.splice(event.state.routedId);\n\n            _this2.routeCount = event.state.routedId;\n          } else if (event.state.routedId > _this2.routeCount) {\n            _this2.history.push(event.state.prev);\n\n            _this2.routeCount = event.state.routedId;\n          }\n        } else {\n          if (_this2.prevPath !== null && _this2.prevPath !== location.pathname) {\n            _this2.history.push(_this2.prevPath);\n          }\n        }\n\n        if (location.origin !== 'null') {\n          _this2.match(location.pathname, listener);\n        } else {\n          _this2.match(_this2.nextPath, listener);\n        }\n\n        for (var i in _this2.query) {\n          delete _this2.query[i];\n        }\n\n        Object.assign(_this2.query, _this2.queryOver({}));\n      };\n\n      window.addEventListener('popstate', listen);\n      window.addEventListener('cvUrlChanged', listen);\n      var route = location.origin !== 'null' ? location.pathname + location.search : false;\n\n      if (location.origin && location.hash) {\n        route += location.hash;\n      }\n\n      this.go(route !== false ? route : '/');\n    }\n  }, {\n    key: \"go\",\n    value: function go(path, silent) {\n      var configTitle = _Config.Config.get('title');\n\n      if (configTitle) {\n        document.title = configTitle;\n      }\n\n      if (location.origin === 'null') {\n        this.nextPath = path;\n      } else if (silent === 2 && location.pathname !== path) {\n        history.replaceState({\n          routedId: this.routeCount,\n          prev: this.prevPath,\n          url: location.pathname\n        }, null, path);\n      } else if (location.pathname !== path) {\n        history.pushState({\n          routedId: ++this.routeCount,\n          prev: this.prevPath,\n          url: location.pathname\n        }, null, path);\n      }\n\n      if (!silent) {\n        if (silent === false) {\n          this.path = null;\n        }\n\n        if (path.substring(0, 1) === '#') {\n          window.dispatchEvent(new HashChangeEvent('hashchange'));\n        } else {\n          window.dispatchEvent(new CustomEvent('cvUrlChanged'));\n        }\n      }\n\n      for (var i in this.query) {\n        delete this.query[i];\n      }\n\n      Object.assign(this.query, this.queryOver({}));\n      this.prevPath = path;\n    }\n  }, {\n    key: \"match\",\n    value: function match(path, listener) {\n      var _this3 = this;\n\n      var forceRefresh = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n      if (this.path === path && !forceRefresh) {\n        return;\n      }\n\n      this.queryString = location.search;\n      this.path = path;\n      var prev = this.prevPath;\n      var current = listener.args.content;\n\n      var routes = this.routes || listener.routes || _Routes.Routes.dump();\n\n      var query = new URLSearchParams(location.search);\n\n      for (var i in this.query) {\n        delete this.query[i];\n      }\n\n      Object.assign(this.query, this.queryOver({}));\n      var args = {},\n          selected = false,\n          result = '';\n      path = path.substr(1).split('/');\n\n      for (var _i in this.query) {\n        args[_i] = this.query[_i];\n      }\n\n      L1: for (var _i2 in routes) {\n        var route = _i2.split('/');\n\n        if (route.length < path.length && route[route.length - 1] !== '*') {\n          continue;\n        }\n\n        L2: for (var j in route) {\n          if (route[j].substr(0, 1) == '%') {\n            var argName = null;\n            var groups = /^%(\\w+)\\??/.exec(route[j]);\n\n            if (groups && groups[1]) {\n              argName = groups[1];\n            }\n\n            if (!argName) {\n              throw new Error(\"\".concat(route[j], \" is not a valid argument segment in route \\\"\").concat(_i2, \"\\\"\"));\n            }\n\n            if (!path[j]) {\n              if (route[j].substr(route[j].length - 1, 1) == '?') {\n                args[argName] = '';\n              } else {\n                continue L1;\n              }\n            } else {\n              args[argName] = path[j];\n            }\n          } else if (route[j] !== '*' && path[j] !== route[j]) {\n            continue L1;\n          }\n        }\n\n        selected = _i2;\n        result = routes[_i2];\n\n        if (route[route.length - 1] === '*') {\n          args.pathparts = path.slice(route.length - 1);\n        }\n\n        break;\n      }\n\n      var eventStart = new CustomEvent('cvRouteStart', {\n        cancelable: true,\n        detail: {\n          path: path,\n          prev: prev,\n          root: listener,\n          selected: selected,\n          routes: routes\n        }\n      });\n\n      if (!document.dispatchEvent(eventStart)) {\n        return;\n      }\n\n      if (!forceRefresh && listener && current && result instanceof Object && current instanceof result && !(result instanceof Promise) && current.update(args)) {\n        listener.args.content = current;\n        return true;\n      }\n\n      try {\n        if (!(selected in routes)) {\n          routes[selected] = routes[NotFoundError];\n        }\n\n        var processRoute = function processRoute(selected) {\n          var result = false;\n\n          if (typeof routes[selected] === 'function') {\n            if (routes[selected].prototype instanceof _View.View) {\n              result = new routes[selected](args);\n            } else {\n              result = routes[selected](args);\n            }\n          } else {\n            result = routes[selected];\n          }\n\n          return result;\n        };\n\n        result = processRoute(selected);\n\n        if (result === false) {\n          result = processRoute(NotFoundError);\n        }\n\n        if (result instanceof Promise) {\n          return result.then(function (realResult) {\n            _this3.update(listener, path, realResult, routes, selected, args, forceRefresh);\n          })[\"catch\"](function (error) {\n            document.dispatchEvent(new CustomEvent('cvRouteError', {\n              detail: {\n                error: error,\n                path: path,\n                prev: prev,\n                view: listener,\n                routes: routes,\n                selected: selected\n              }\n            }));\n\n            _this3.update(listener, path, window['devMode'] ? String(error) : 'Error: 500', routes, selected, args, forceRefresh);\n\n            throw error;\n          });\n        } else {\n          return this.update(listener, path, result, routes, selected, args, forceRefresh);\n        }\n      } catch (error) {\n        document.dispatchEvent(new CustomEvent('cvRouteError', {\n          detail: {\n            error: error,\n            path: path,\n            prev: prev,\n            view: listener,\n            routes: routes,\n            selected: selected\n          }\n        }));\n        this.update(listener, path, window['devMode'] ? String(error) : 'Error: 500', routes, selected, args, forceRefresh);\n        throw error;\n      }\n    }\n  }, {\n    key: \"update\",\n    value: function update(listener, path, result, routes, selected, args, forceRefresh) {\n      if (!listener) {\n        return;\n      }\n\n      var prev = this.prevPath;\n      var event = new CustomEvent('cvRoute', {\n        cancelable: true,\n        detail: {\n          result: result,\n          path: path,\n          prev: prev,\n          view: listener,\n          routes: routes,\n          selected: selected\n        }\n      });\n\n      if (result !== false) {\n        if (listener.args.content instanceof _View.View) {\n          listener.args.content.pause(true);\n          listener.args.content.remove();\n        }\n\n        if (document.dispatchEvent(event)) {\n          listener.args.content = result;\n        }\n\n        if (result instanceof _View.View) {\n          result.pause(false);\n          result.update(args, forceRefresh);\n        }\n      }\n\n      var eventEnd = new CustomEvent('cvRouteEnd', {\n        cancelable: true,\n        detail: {\n          result: result,\n          path: path,\n          prev: prev,\n          view: listener,\n          routes: routes,\n          selected: selected\n        }\n      });\n      document.dispatchEvent(eventEnd);\n    }\n  }, {\n    key: \"queryOver\",\n    value: function queryOver() {\n      var args = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var params = new URLSearchParams(location.search);\n      var finalArgs = {};\n      var query = {};\n\n      var _iterator = _createForOfIteratorHelper(params),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var pair = _step.value;\n          query[pair[0]] = pair[1];\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      finalArgs = Object.assign(finalArgs, query, args);\n      delete finalArgs['api'];\n      return finalArgs; // for(let i in query)\n      // {\n      // \tfinalArgs[i] = query[i];\n      // }\n      // for(let i in args)\n      // {\n      // \tfinalArgs[i] = args[i];\n      // }\n    }\n  }, {\n    key: \"queryToString\",\n    value: function queryToString() {\n      var args = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var fresh = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var parts = [],\n          finalArgs = args;\n\n      if (!fresh) {\n        finalArgs = this.queryOver(args);\n      }\n\n      for (var i in finalArgs) {\n        if (finalArgs[i] === '') {\n          continue;\n        }\n\n        parts.push(i + '=' + encodeURIComponent(finalArgs[i]));\n      }\n\n      return parts.join('&');\n    }\n  }, {\n    key: \"setQuery\",\n    value: function setQuery(name, value, silent) {\n      var args = this.queryOver();\n      args[name] = value;\n\n      if (value === undefined) {\n        delete args[name];\n      }\n\n      var queryString = this.queryToString(args, true);\n      this.go(location.pathname + (queryString ? '?' + queryString : ''), silent);\n    }\n  }]);\n\n  return Router;\n}();\n\nexports.Router = Router;\nObject.defineProperty(Router, 'query', {\n  configurable: false,\n  enumerable: false,\n  writable: false,\n  value: {}\n});\nObject.defineProperty(Router, 'history', {\n  configurable: false,\n  enumerable: false,\n  writable: false,\n  value: []\n});\nObject.defineProperty(Router, 'routeCount', {\n  configurable: false,\n  enumerable: false,\n  writable: true,\n  value: 0\n});\nObject.defineProperty(Router, 'prevPath', {\n  configurable: false,\n  enumerable: false,\n  writable: true,\n  value: null\n});\nObject.defineProperty(Router, 'queryString', {\n  configurable: false,\n  enumerable: false,\n  writable: true,\n  value: null\n});\nObject.defineProperty(Router, 'InternalError', {\n  configurable: false,\n  enumerable: false,\n  writable: false,\n  value: InternalError\n});\nObject.defineProperty(Router, 'NotFoundError', {\n  configurable: false,\n  enumerable: false,\n  writable: false,\n  value: NotFoundError\n});\n  })();\n});","\nrequire.register(\"curvature/base/Routes.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Routes = void 0;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar AppRoutes = {};\n\ntry {\n  Object.assign(AppRoutes, require('Routes').Routes || {});\n} catch (error) {\n  window.devMode === true && console.warn(error);\n}\n\nvar Routes = /*#__PURE__*/function () {\n  function Routes() {\n    _classCallCheck(this, Routes);\n  }\n\n  _createClass(Routes, null, [{\n    key: \"get\",\n    value: function get(name) {\n      return this.routes[name];\n    }\n  }, {\n    key: \"dump\",\n    value: function dump() {\n      return this.routes;\n    }\n  }]);\n\n  return Routes;\n}();\n\nexports.Routes = Routes;\nObject.defineProperty(Routes, 'routes', {\n  configurable: false,\n  enumerable: false,\n  writable: false,\n  value: AppRoutes\n});\n  })();\n});","\nrequire.register(\"curvature/base/RuleSet.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.RuleSet = void 0;\n\nvar _Dom = require(\"./Dom\");\n\nvar _Tag = require(\"./Tag\");\n\nvar _View = require(\"./View\");\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar RuleSet = /*#__PURE__*/function () {\n  function RuleSet() {\n    _classCallCheck(this, RuleSet);\n  }\n\n  _createClass(RuleSet, [{\n    key: \"add\",\n    value: function add(selector, callback) {\n      this.rules = this.rules || {};\n      this.rules[selector] = this.rules[selector] || [];\n      this.rules[selector].push(callback);\n      return this;\n    }\n  }, {\n    key: \"apply\",\n    value: function apply() {\n      var doc = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : document;\n      var view = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n      RuleSet.apply(doc, view);\n\n      for (var selector in this.rules) {\n        for (var i in this.rules[selector]) {\n          var callback = this.rules[selector][i];\n          var wrapped = RuleSet.wrap(doc, callback, view);\n          var nodes = doc.querySelectorAll(selector);\n\n          var _iterator = _createForOfIteratorHelper(nodes),\n              _step;\n\n          try {\n            for (_iterator.s(); !(_step = _iterator.n()).done;) {\n              var node = _step.value;\n              wrapped(node);\n            }\n          } catch (err) {\n            _iterator.e(err);\n          } finally {\n            _iterator.f();\n          }\n        }\n      }\n    }\n  }], [{\n    key: \"add\",\n    value: function add(selector, callback) {\n      this.globalRules = this.globalRules || {};\n      this.globalRules[selector] = this.globalRules[selector] || [];\n      this.globalRules[selector].push(callback);\n      return this;\n    }\n  }, {\n    key: \"apply\",\n    value: function apply() {\n      var doc = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : document;\n      var view = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n      for (var selector in this.globalRules) {\n        for (var i in this.globalRules[selector]) {\n          var callback = this.globalRules[selector][i];\n          var wrapped = this.wrap(doc, callback, view);\n          var nodes = doc.querySelectorAll(selector);\n\n          var _iterator2 = _createForOfIteratorHelper(nodes),\n              _step2;\n\n          try {\n            for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n              var node = _step2.value;\n              wrapped(node);\n            }\n          } catch (err) {\n            _iterator2.e(err);\n          } finally {\n            _iterator2.f();\n          }\n        }\n      }\n    }\n  }, {\n    key: \"wait\",\n    value: function wait() {\n      var _this = this;\n\n      var event = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'DOMContentLoaded';\n      var node = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : document;\n\n      var listener = function (event, node) {\n        return function () {\n          node.removeEventListener(event, listener);\n          return _this.apply();\n        };\n      }(event, node);\n\n      node.addEventListener(event, listener);\n    }\n  }, {\n    key: \"wrap\",\n    value: function wrap(doc, callback) {\n      var view = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n      if (callback instanceof _View.View || callback && callback.prototype && callback.prototype instanceof _View.View) {\n        callback = function (callback) {\n          return function () {\n            return callback;\n          };\n        }(callback);\n      }\n\n      return function (element) {\n        if (typeof element.___cvApplied___ === 'undefined') {\n          Object.defineProperty(element, '___cvApplied___', {\n            enumerable: false,\n            writable: false,\n            value: []\n          });\n        }\n\n        for (var i in element.___cvApplied___) {\n          if (callback == element.___cvApplied___[i]) {\n            return;\n          }\n        }\n\n        var direct, parentView;\n\n        if (view) {\n          direct = parentView = view;\n\n          if (view.viewList) {\n            parentView = view.viewList.parent;\n          }\n        }\n\n        if (parentView) {\n          parentView.onRemove(function () {\n            return element.___cvApplied___.splice(0);\n          });\n        }\n\n        var tag = new _Tag.Tag(element, parentView, null, undefined, direct);\n        var parent = tag.element.parentNode;\n        var sibling = tag.element.nextSibling;\n        var result = callback(tag);\n\n        if (result !== false) {\n          element.___cvApplied___.push(callback);\n        }\n\n        if (result instanceof HTMLElement) {\n          result = new _Tag.Tag(result);\n        }\n\n        if (result instanceof _Tag.Tag) {\n          if (!result.element.contains(tag.element)) {\n            while (tag.element.firstChild) {\n              result.element.appendChild(tag.element.firstChild);\n            }\n\n            tag.remove();\n          }\n\n          if (sibling) {\n            parent.insertBefore(result.element, sibling);\n          } else {\n            parent.appendChild(result.element);\n          }\n        }\n\n        if (result && result.prototype && result.prototype instanceof _View.View) {\n          result = new result({}, view);\n        }\n\n        if (result instanceof _View.View) {\n          if (view) {\n            view.cleanup.push(function (r) {\n              return function () {\n                r.remove();\n              };\n            }(result));\n            view.cleanup.push(view.args.bindTo(function (v, k, t) {\n              t[k] = v;\n              result.args[k] = v;\n            }));\n            view.cleanup.push(result.args.bindTo(function (v, k, t, d) {\n              t[k] = v;\n              view.args[k] = v;\n            }));\n          }\n\n          tag.clear();\n          result.render(tag.element);\n        }\n      };\n    }\n  }]);\n\n  return RuleSet;\n}();\n\nexports.RuleSet = RuleSet;\n  })();\n});","\nrequire.register(\"curvature/base/Tag.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Tag = void 0;\n\nvar _Bindable = require(\"./Bindable\");\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar Tag = /*#__PURE__*/function () {\n  function Tag(element, parent, ref, index, direct) {\n    var _this2 = this;\n\n    _classCallCheck(this, Tag);\n\n    if (typeof element === 'string') {\n      var subdoc = document.createRange().createContextualFragment(element);\n      element = subdoc.firstChild;\n    }\n\n    this.element = _Bindable.Bindable.makeBindable(element);\n    this.node = this.element;\n    this.parent = parent;\n    this.direct = direct;\n    this.ref = ref;\n    this.index = index;\n    this.cleanup = [];\n\n    this[_Bindable.Bindable.OnAllGet] = function (name) {\n      if (typeof _this2[name] === 'function') {\n        return _this2[name];\n      }\n\n      if (_this2.node && typeof _this2.node[name] === 'function') {\n        return function () {\n          var _this2$node;\n\n          return (_this2$node = _this2.node)[name].apply(_this2$node, arguments);\n        };\n      }\n\n      if (_this2.node && name in _this2.node) {\n        return _this2.node[name];\n      }\n\n      return _this2[name];\n    };\n\n    this.style = function (_this) {\n      return _Bindable.Bindable.make(function (styles) {\n        if (!_this.node) {\n          return;\n        }\n\n        var styleEvent = new CustomEvent('cvStyle', {\n          detail: {\n            styles: styles\n          }\n        });\n\n        if (!_this.node.dispatchEvent(styleEvent)) {\n          return;\n        }\n\n        for (var property in styles) {\n          if (property[0] === '-') {\n            _this.node.style.setProperty(property, styles[property]);\n          }\n\n          _this.node.style[property] = styles[property];\n        }\n      });\n    }(this);\n\n    this.proxy = _Bindable.Bindable.make(this);\n    this.proxy.style.bindTo(function (v, k) {\n      _this2.element.style[k] = v;\n    });\n    this.proxy.bindTo(function (v, k) {\n      if (k in element) {\n        element[k] = v;\n      }\n\n      return false;\n    });\n    return this.proxy;\n  }\n\n  _createClass(Tag, [{\n    key: \"attr\",\n    value: function attr(attributes) {\n      for (var attribute in attributes) {\n        if (attributes[attribute] === undefined) {\n          this.node.removeAttribute(attribute);\n        } else if (attributes[attribute] === null) {\n          this.node.setAttribute(attribute, '');\n        } else {\n          this.node.setAttribute(attribute, attributes[attribute]);\n        }\n      }\n    }\n  }, {\n    key: \"remove\",\n    value: function remove() {\n      if (this.node) {\n        this.node.remove();\n      }\n\n      _Bindable.Bindable.clearBindings(this);\n\n      var cleanup;\n\n      while (cleanup = this.cleanup.shift()) {\n        cleanup();\n      }\n\n      this.clear();\n\n      if (!this.node) {\n        return;\n      }\n\n      var detachEvent = new Event('cvDomDetached');\n      this.node.dispatchEvent(detachEvent);\n      this.node = this.element = this.ref = this.parent = undefined;\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      if (!this.node) {\n        return;\n      }\n\n      var detachEvent = new Event('cvDomDetached');\n\n      while (this.node.firstChild) {\n        this.node.firstChild.dispatchEvent(detachEvent);\n        this.node.removeChild(this.node.firstChild);\n      }\n    }\n  }, {\n    key: \"pause\",\n    value: function pause() {\n      var paused = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n    }\n  }, {\n    key: \"listen\",\n    value: function listen(eventName, callback, options) {\n      var node = this.node;\n      node.addEventListener(eventName, callback, options);\n\n      var remove = function remove() {\n        node.removeEventListener(eventName, callback, options);\n      };\n\n      var remover = function remover() {\n        remove();\n\n        remove = function remove() {\n          return console.warn('Already removed!');\n        };\n      };\n\n      this.parent.onRemove(function () {\n        return remover();\n      });\n      return remover;\n    }\n  }]);\n\n  return Tag;\n}();\n\nexports.Tag = Tag;\n  })();\n});","\nrequire.register(\"curvature/base/View.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.View = void 0;\n\nvar _Bindable = require(\"./Bindable\");\n\nvar _ViewList = require(\"./ViewList\");\n\nvar _Router = require(\"./Router\");\n\nvar _Dom = require(\"./Dom\");\n\nvar _Tag = require(\"./Tag\");\n\nvar _Bag = require(\"./Bag\");\n\nvar _RuleSet = require(\"./RuleSet\");\n\nvar _Mixin = require(\"./Mixin\");\n\nvar _PromiseMixin = require(\"../mixin/PromiseMixin\");\n\nvar _EventTargetMixin = require(\"../mixin/EventTargetMixin\");\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _iterableToArrayLimit(arr, i) { if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e2) { throw _e2; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e3) { didErr = true; err = _e3; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar dontParse = Symbol('dontParse');\nvar expandBind = Symbol('expandBind');\nvar uuid = Symbol('uuid');\nvar moveIndex = 0;\n\nvar View = /*#__PURE__*/function (_Mixin$with) {\n  _inherits(View, _Mixin$with);\n\n  var _super = _createSuper(View);\n\n  _createClass(View, [{\n    key: \"_id\",\n    get: function get() {\n      return this[uuid];\n    }\n  }], [{\n    key: \"from\",\n    value: function from(template) {\n      var args = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var parent = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n      var view = new this(args, parent);\n      view.template = template;\n      return view;\n    }\n  }]);\n\n  function View() {\n    var _this;\n\n    var args = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var mainView = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n    _classCallCheck(this, View);\n\n    _this = _super.call(this, args, mainView);\n    Object.defineProperty(_assertThisInitialized(_this), 'args', {\n      value: _Bindable.Bindable.make(args)\n    });\n    Object.defineProperty(_assertThisInitialized(_this), uuid, {\n      value: _this.uuid()\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'attach', {\n      value: new _Bag.Bag(function (i, s, a) {})\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'detach', {\n      value: new _Bag.Bag(function (i, s, a) {})\n    });\n    Object.defineProperty(_assertThisInitialized(_this), '_onRemove', {\n      value: new _Bag.Bag(function (i, s, a) {})\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'cleanup', {\n      value: []\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'parent', {\n      value: mainView\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'views', {\n      value: new Map()\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'viewLists', {\n      value: new Map()\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'withViews', {\n      value: new Map()\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'tags', {\n      value: _Bindable.Bindable.make({})\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'nodes', {\n      value: _Bindable.Bindable.make([])\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'intervals', {\n      value: []\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'timeouts', {\n      value: []\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'frames', {\n      value: []\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'ruleSet', {\n      value: new _RuleSet.RuleSet()\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'preRuleSet', {\n      value: new _RuleSet.RuleSet()\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'subBindings', {\n      value: {}\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'templates', {\n      value: {}\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'eventCleanup', {\n      value: []\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'interpolateRegex', {\n      value: /(\\[\\[((?:\\$+)?[\\w\\.\\|-]+)\\]\\])/g\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'rendered', {\n      value: new Promise(function (accept, reject) {\n        return Object.defineProperty(_assertThisInitialized(_this), 'renderComplete', {\n          value: accept\n        });\n      })\n    });\n    _this.template = \"\";\n    _this.firstNode = null;\n    _this.lastNode = null;\n    _this.viewList = null;\n    _this.mainView = null;\n    _this.preserve = false;\n    _this.removed = false;\n    return _possibleConstructorReturn(_this, _Bindable.Bindable.make(_assertThisInitialized(_this)));\n  }\n\n  _createClass(View, [{\n    key: \"onFrame\",\n    value: function onFrame(callback) {\n      var _this2 = this;\n\n      var stopped = false;\n\n      var cancel = function cancel() {\n        stopped = true;\n      };\n\n      var c = function c(timestamp) {\n        if (_this2.removed || stopped) {\n          return;\n        }\n\n        if (!_this2.paused) {\n          callback(Date.now());\n        }\n\n        requestAnimationFrame(c);\n      };\n\n      requestAnimationFrame(function () {\n        return c(Date.now());\n      });\n      this.frames.push(cancel);\n      return cancel;\n    }\n  }, {\n    key: \"onNextFrame\",\n    value: function onNextFrame(callback) {\n      return requestAnimationFrame(function () {\n        return callback(Date.now());\n      });\n    }\n  }, {\n    key: \"onIdle\",\n    value: function onIdle(callback) {\n      return requestIdleCallback(function () {\n        return callback(Date.now());\n      });\n    }\n  }, {\n    key: \"onTimeout\",\n    value: function onTimeout(time, callback) {\n      var _this3 = this;\n\n      var wrappedCallback = function wrappedCallback() {\n        _this3.timeouts[index].fired = true;\n        _this3.timeouts[index].callback = null;\n        callback();\n      };\n\n      var timeout = setTimeout(wrappedCallback, time);\n      var index = this.timeouts.length;\n      this.timeouts.push({\n        timeout: timeout,\n        callback: wrappedCallback,\n        time: time,\n        fired: false,\n        created: new Date().getTime(),\n        paused: false\n      });\n      return timeout;\n    }\n  }, {\n    key: \"clearTimeout\",\n    value: function (_clearTimeout) {\n      function clearTimeout(_x) {\n        return _clearTimeout.apply(this, arguments);\n      }\n\n      clearTimeout.toString = function () {\n        return _clearTimeout.toString();\n      };\n\n      return clearTimeout;\n    }(function (timeout) {\n      for (var i in this.timeouts) {\n        if (timeout === this.timeouts[i].timeout) {\n          clearTimeout(this.timeouts[i].timeout);\n          delete this.timeouts[i];\n        }\n      }\n    })\n  }, {\n    key: \"onInterval\",\n    value: function onInterval(time, callback) {\n      var timeout = setInterval(callback, time);\n      this.intervals.push({\n        timeout: timeout,\n        callback: callback,\n        time: time,\n        paused: false\n      });\n      return timeout;\n    }\n  }, {\n    key: \"clearInterval\",\n    value: function (_clearInterval) {\n      function clearInterval(_x2) {\n        return _clearInterval.apply(this, arguments);\n      }\n\n      clearInterval.toString = function () {\n        return _clearInterval.toString();\n      };\n\n      return clearInterval;\n    }(function (timeout) {\n      for (var i in this.intervals) {\n        if (timeout === this.intervals[i].timeout) {\n          clearInterval(this.intervals[i].timeout);\n          delete this.intervals[i];\n        }\n      }\n    })\n  }, {\n    key: \"pause\",\n    value: function pause() {\n      var paused = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : undefined;\n\n      if (paused === undefined) {\n        this.paused = !this.paused;\n      }\n\n      this.paused = paused;\n\n      if (this.paused) {\n        for (var i in this.timeouts) {\n          if (this.timeouts[i].fired) {\n            delete this.timeouts[i];\n            continue;\n          }\n\n          clearTimeout(this.timeouts[i].timeout);\n        }\n\n        for (var _i in this.intervals) {\n          clearInterval(this.intervals[_i].timeout);\n        }\n      } else {\n        for (var _i2 in this.timeouts) {\n          if (!this.timeouts[_i2].timeout.paused) {\n            continue;\n          }\n\n          if (this.timeouts[_i2].fired) {\n            delete this.timeouts[_i2];\n            continue;\n          }\n\n          this.timeouts[_i2].timeout = setTimeout(this.timeouts[_i2].callback, this.timeouts[_i2].time);\n        }\n\n        for (var _i3 in this.intervals) {\n          if (!this.intervals[_i3].timeout.paused) {\n            continue;\n          }\n\n          this.intervals[_i3].timeout.paused = false;\n          this.intervals[_i3].timeout = setInterval(this.intervals[_i3].callback, this.intervals[_i3].time);\n        }\n      }\n\n      var _iterator = _createForOfIteratorHelper(this.viewLists),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var _step$value = _slicedToArray(_step.value, 2),\n              tag = _step$value[0],\n              viewList = _step$value[1];\n\n          viewList.pause(!!paused);\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      for (var _i4 in this.tags) {\n        if (Array.isArray(this.tags[_i4])) {\n          for (var j in this.tags[_i4]) {\n            this.tags[_i4][j].pause(!!paused);\n          }\n\n          continue;\n        }\n\n        this.tags[_i4].pause(!!paused);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$nodes,\n          _this4 = this;\n\n      var parentNode = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      var insertPoint = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n      if (parentNode instanceof View) {\n        parentNode = parentNode.firstNode.parentNode;\n      }\n\n      if (insertPoint instanceof View) {\n        insertPoint = insertPoint.firstNode;\n      }\n\n      if (this.firstNode) {\n        return this.reRender(parentNode, insertPoint);\n      }\n\n      this.dispatchEvent(new CustomEvent('render'));\n      var templateParsed = this.template instanceof DocumentFragment ? this.template.cloneNode(true) : View.templates.has(this.template);\n      var subDoc = templateParsed ? this.template instanceof DocumentFragment ? templateParsed : View.templates.get(this.template).cloneNode(true) : document.createRange().createContextualFragment(this.template);\n\n      if (!templateParsed && !(this.template instanceof DocumentFragment)) {\n        View.templates.set(this.template, subDoc.cloneNode(true));\n      }\n\n      this.mainView || this.preRuleSet.apply(subDoc, this);\n      this.mapTags(subDoc);\n      this.mainView || this.ruleSet.apply(subDoc, this);\n\n      if (window.devMode === true) {\n        this.firstNode = document.createComment(\"Template \".concat(this._id, \" Start\"));\n        this.lastNode = document.createComment(\"Template \".concat(this._id, \" End\"));\n      } else {\n        this.firstNode = document.createTextNode('');\n        this.lastNode = document.createTextNode('');\n      }\n\n      (_this$nodes = this.nodes).push.apply(_this$nodes, [this.firstNode].concat(_toConsumableArray(Array.from(subDoc.childNodes)), [this.lastNode]));\n\n      this.postRender(parentNode);\n      this.dispatchEvent(new CustomEvent('rendered'));\n\n      if (!this.dispatchAttach()) {\n        return;\n      }\n\n      if (parentNode) {\n        var rootNode = parentNode.getRootNode();\n        var moveType = 'internal';\n        var toRoot = false;\n\n        if (rootNode.isConnected) {\n          toRoot = true;\n          moveType = 'external';\n        }\n\n        if (insertPoint) {\n          parentNode.insertBefore(this.firstNode, insertPoint);\n          parentNode.insertBefore(this.lastNode, insertPoint);\n        } else {\n          parentNode.appendChild(this.firstNode);\n          parentNode.appendChild(this.lastNode);\n        }\n\n        parentNode.insertBefore(subDoc, this.lastNode);\n        moveIndex++;\n\n        if (toRoot) {\n          this.attached(rootNode, parentNode);\n          this.dispatchAttached(rootNode, parentNode);\n        } else {\n          parentNode.addEventListener('cvDomAttached', function () {\n            _this4.attached(rootNode, parentNode);\n\n            _this4.dispatchAttached(rootNode, parentNode);\n          }, {\n            once: true\n          });\n        }\n      }\n\n      this.renderComplete(this.nodes);\n      return this.nodes;\n    }\n  }, {\n    key: \"dispatchAttach\",\n    value: function dispatchAttach() {\n      return this.dispatchEvent(new CustomEvent('attach', {\n        cancelable: true,\n        target: this\n      }));\n    }\n  }, {\n    key: \"dispatchAttached\",\n    value: function dispatchAttached(rootNode, parentNode) {\n      this.dispatchEvent(new CustomEvent('attached', {\n        target: this\n      }));\n      var attach = this.attach.items();\n\n      for (var i in attach) {\n        attach[i](rootNode, parentNode);\n      }\n\n      this.nodes.filter(function (n) {\n        return n.nodeType !== Node.COMMENT_NODE;\n      }).map(function (child) {\n        if (!child.matches) {\n          return;\n        }\n\n        _Dom.Dom.mapTags(child, false, function (tag, walker) {\n          if (!tag.matches) {\n            return;\n          }\n\n          tag.dispatchEvent(new Event('cvDomAttached', {\n            target: tag\n          }));\n        });\n\n        child.dispatchEvent(new Event('cvDomAttached', {\n          target: child\n        }));\n      });\n    }\n  }, {\n    key: \"reRender\",\n    value: function reRender(parentNode, insertPoint) {\n      var willReRender = this.dispatchEvent(new CustomEvent('reRender'), {\n        cancelable: true,\n        target: this\n      });\n\n      if (!willReRender) {\n        return;\n      }\n\n      var subDoc = new DocumentFragment();\n\n      if (this.firstNode.isConnected) {\n        var detach = this.detach.items();\n\n        for (var i in detach) {\n          detach[i]();\n        }\n      }\n\n      subDoc.append.apply(subDoc, _toConsumableArray(this.nodes));\n\n      if (parentNode) {\n        if (insertPoint) {\n          parentNode.insertBefore(this.firstNode, insertPoint);\n          parentNode.insertBefore(this.lastNode, insertPoint);\n        } else {\n          parentNode.appendChild(this.firstNode);\n          parentNode.appendChild(this.lastNode);\n        }\n\n        parentNode.insertBefore(subDoc, this.lastNode);\n        this.dispatchEvent(new CustomEvent('reRendered'), {\n          cancelable: true,\n          target: this\n        });\n        var rootNode = parentNode.getRootNode();\n\n        if (rootNode.isConnected) {\n          this.attached(rootNode, parentNode);\n          this.dispatchAttached(rootNode, parentNode);\n        }\n      }\n\n      return this.nodes;\n    }\n  }, {\n    key: \"mapTags\",\n    value: function mapTags(subDoc) {\n      var _this5 = this;\n\n      _Dom.Dom.mapTags(subDoc, false, function (tag, walker) {\n        if (tag[dontParse]) {\n          return;\n        }\n\n        if (tag.matches) {\n          tag = _this5.mapInterpolatableTag(tag);\n          tag = tag.matches('[cv-template]') && _this5.mapTemplateTag(tag) || tag;\n          tag = tag.matches('[cv-slot]') && _this5.mapSlotTag(tag) || tag;\n          tag = tag.matches('[cv-prerender]') && _this5.mapPrendererTag(tag) || tag;\n          tag = tag.matches('[cv-link]') && _this5.mapLinkTag(tag) || tag;\n          tag = tag.matches('[cv-attr]') && _this5.mapAttrTag(tag) || tag;\n          tag = tag.matches('[cv-expand]') && _this5.mapExpandableTag(tag) || tag;\n          tag = tag.matches('[cv-ref]') && _this5.mapRefTag(tag) || tag;\n          tag = tag.matches('[cv-on]') && _this5.mapOnTag(tag) || tag;\n          tag = tag.matches('[cv-each]') && _this5.mapEachTag(tag) || tag;\n          tag = tag.matches('[cv-bind]') && _this5.mapBindTag(tag) || tag;\n          tag = tag.matches('[cv-with]') && _this5.mapWithTag(tag) || tag;\n          tag = tag.matches('[cv-if]') && _this5.mapIfTag(tag) || tag;\n          tag = tag.matches('[cv-view]') && _this5.mapViewTag(tag) || tag;\n        } else {\n          tag = _this5.mapInterpolatableTag(tag);\n        }\n\n        if (tag !== walker.currentNode) {\n          walker.currentNode = tag;\n        }\n      });\n    }\n  }, {\n    key: \"mapExpandableTag\",\n    value: function mapExpandableTag(tag) {\n      /*/\n      const tagCompiler = this.compileExpandableTag(tag);\n      \tconst newTag = tagCompiler(this);\n      \ttag.replaceWith(newTag);\n      \treturn newTag;\n      /*/\n      var existing = tag[expandBind];\n\n      if (existing) {\n        existing();\n        tag[expandBind] = false;\n      }\n\n      var _Bindable$resolve = _Bindable.Bindable.resolve(this.args, tag.getAttribute('cv-expand'), true),\n          _Bindable$resolve2 = _slicedToArray(_Bindable$resolve, 2),\n          proxy = _Bindable$resolve2[0],\n          expandProperty = _Bindable$resolve2[1];\n\n      tag.removeAttribute('cv-expand');\n\n      if (!proxy[expandProperty]) {\n        proxy[expandProperty] = {};\n      }\n\n      this.onRemove(tag[expandBind] = proxy[expandProperty].bindTo(function (v, k, t, d, p) {\n        if (d || v === undefined) {\n          tag.removeAttribute(k, v);\n          return;\n        }\n\n        if (v === null) {\n          tag.setAttribute(k, '');\n          return;\n        }\n\n        tag.setAttribute(k, v);\n      })); // let expandProperty = tag.getAttribute('cv-expand');\n      // let expandArg = Bindable.makeBindable(\n      // \tthis.args[expandProperty] || {}\n      // );\n      // tag.removeAttribute('cv-expand');\n      // for(let i in expandArg)\n      // {\n      // \tif(i === 'name' || i === 'type')\n      // \t{\n      // \t\tcontinue;\n      // \t}\n      // \tlet debind = expandArg.bindTo(i, ((tag,i)=>(v)=>{\n      // \t\ttag.setAttribute(i, v);\n      // \t})(tag,i));\n      // \tthis.onRemove(()=>{\n      // \t\tdebind();\n      // \t\tif(expandArg.isBound())\n      // \t\t{\n      // \t\t\tBindable.clearBindings(expandArg);\n      // \t\t}\n      // \t});\n      // }\n\n      return tag; //*/\n    }\n  }, {\n    key: \"compileExpandableTag\",\n    value: function compileExpandableTag(sourceTag) {\n      return function (bindingView) {\n        var tag = sourceTag.cloneNode(true);\n        var expandProperty = tag.getAttribute('cv-expand');\n\n        var expandArg = _Bindable.Bindable.make(bindingView.args[expandProperty] || {});\n\n        tag.removeAttribute('cv-expand');\n\n        var _loop = function _loop(i) {\n          if (i === 'name' || i === 'type') {\n            return \"continue\";\n          }\n\n          var debind = expandArg.bindTo(i, function (tag, i) {\n            return function (v) {\n              tag.setAttribute(i, v);\n            };\n          }(tag, i));\n          bindingView.onRemove(function () {\n            debind();\n\n            if (expandArg.isBound()) {\n              _Bindable.Bindable.clearBindings(expandArg);\n            }\n          });\n        };\n\n        for (var i in expandArg) {\n          var _ret = _loop(i);\n\n          if (_ret === \"continue\") continue;\n        }\n\n        return tag;\n      };\n    }\n  }, {\n    key: \"mapAttrTag\",\n    value: function mapAttrTag(tag) {\n      //*/\n      var tagCompiler = this.compileAttrTag(tag);\n      var newTag = tagCompiler(this);\n      tag.replaceWith(newTag);\n      return newTag;\n      /*/\n      \tlet attrProperty = tag.getAttribute('cv-attr');\n      \ttag.removeAttribute('cv-attr');\n      \tlet pairs = attrProperty.split(',');\n      let attrs = pairs.map((p) => p.split(':'));\n      \tfor (let i in attrs)\n      {\n      \tlet proxy        = this.args;\n      \tlet bindProperty = attrs[i][1];\n      \tlet property     = bindProperty;\n      \t\tif(bindProperty.match(/\\./))\n      \t{\n      \t\t[proxy, property] = Bindable.resolve(\n      \t\t\tthis.args\n      \t\t\t, bindProperty\n      \t\t\t, true\n      \t\t);\n      \t}\n      \t\tlet attrib = attrs[i][0];\n      \t\tthis.onRemove(proxy.bindTo(\n      \t\tproperty\n      \t\t, (v)=>{\n      \t\t\tif(v == null)\n      \t\t\t{\n      \t\t\t\ttag.setAttribute(attrib, '');\n      \t\t\t\treturn;\n      \t\t\t}\n      \t\t\ttag.setAttribute(attrib, v);\n      \t\t}\n      \t));\n      }\n      \treturn tag;\n      \t//*/\n    }\n  }, {\n    key: \"compileAttrTag\",\n    value: function compileAttrTag(sourceTag) {\n      var attrProperty = sourceTag.getAttribute('cv-attr');\n      var pairs = attrProperty.split(',');\n      var attrs = pairs.map(function (p) {\n        return p.split(':');\n      });\n      sourceTag.removeAttribute('cv-attr');\n      return function (bindingView) {\n        var tag = sourceTag.cloneNode(true);\n\n        var _loop2 = function _loop2(i) {\n          var bindProperty = attrs[i][1] || attrs[i][0];\n\n          var _Bindable$resolve3 = _Bindable.Bindable.resolve(bindingView.args, bindProperty, true),\n              _Bindable$resolve4 = _slicedToArray(_Bindable$resolve3, 2),\n              proxy = _Bindable$resolve4[0],\n              property = _Bindable$resolve4[1];\n\n          var attrib = attrs[i][0];\n          bindingView.onRemove(proxy.bindTo(property, function (v, k, t, d) {\n            if (d || v === undefined) {\n              tag.removeAttribute(attrib, v);\n              return;\n            }\n\n            if (v === null) {\n              tag.setAttribute(attrib, '');\n              return;\n            }\n\n            tag.setAttribute(attrib, v);\n          }));\n        };\n\n        for (var i in attrs) {\n          _loop2(i);\n        }\n\n        return tag;\n      };\n    }\n  }, {\n    key: \"mapInterpolatableTag\",\n    value: function mapInterpolatableTag(tag) {\n      var _this6 = this;\n\n      var regex = this.interpolateRegex;\n\n      if (tag.nodeType === Node.TEXT_NODE) {\n        var original = tag.nodeValue;\n\n        if (!this.interpolatable(original)) {\n          return tag;\n        }\n\n        var header = 0;\n        var match;\n\n        var _loop3 = function _loop3() {\n          var bindProperty = match[2];\n          var unsafeHtml = false;\n          var unsafeView = false;\n          var propertySplit = bindProperty.split('|');\n          var transformer = false;\n\n          if (propertySplit.length > 1) {\n            transformer = _this6.stringTransformer(propertySplit.slice(1));\n            bindProperty = propertySplit[0];\n          }\n\n          if (bindProperty.substr(0, 2) === '$$') {\n            unsafeHtml = true;\n            unsafeView = true;\n            bindProperty = bindProperty.substr(2);\n          }\n\n          if (bindProperty.substr(0, 1) === '$') {\n            unsafeHtml = true;\n            bindProperty = bindProperty.substr(1);\n          }\n\n          if (bindProperty.substr(0, 3) === '000') {\n            expand = true;\n            bindProperty = bindProperty.substr(3);\n            return \"continue\";\n          }\n\n          var staticPrefix = original.substring(header, match.index);\n          header = match.index + match[1].length;\n          var staticNode = document.createTextNode(staticPrefix);\n          staticNode[dontParse] = true;\n          tag.parentNode.insertBefore(staticNode, tag);\n          var dynamicNode = void 0;\n\n          if (unsafeHtml) {\n            dynamicNode = document.createElement('div');\n          } else {\n            dynamicNode = document.createTextNode('');\n          }\n\n          dynamicNode[dontParse] = true;\n          var proxy = _this6.args;\n          var property = bindProperty;\n\n          if (bindProperty.match(/\\./)) {\n            var _Bindable$resolve5 = _Bindable.Bindable.resolve(_this6.args, bindProperty, true);\n\n            var _Bindable$resolve6 = _slicedToArray(_Bindable$resolve5, 2);\n\n            proxy = _Bindable$resolve6[0];\n            property = _Bindable$resolve6[1];\n          }\n\n          tag.parentNode.insertBefore(dynamicNode, tag);\n          var debind = proxy.bindTo(property, function (v, k, t) {\n            if (t[k] !== v && (t[k] instanceof View || t[k] instanceof Node || t[k] instanceof _Tag.Tag)) {\n              if (!t[k].preserve) {\n                t[k].remove();\n              }\n            }\n\n            dynamicNode.nodeValue = '';\n\n            if (unsafeView && !(v instanceof View)) {\n              var unsafeTemplate = v;\n              v = new View(_this6.args, _this6);\n              v.template = unsafeTemplate;\n            }\n\n            if (transformer) {\n              v = transformer(v);\n            }\n\n            if (v instanceof View) {\n              var onAttach = function onAttach(parentNode) {\n                if (v.dispatchAttach()) {\n                  v.attached(parentNode);\n                  v.dispatchAttached();\n                }\n              };\n\n              _this6.attach.add(onAttach);\n\n              v.render(tag.parentNode, dynamicNode);\n\n              var cleanup = function cleanup() {\n                if (!v.preserve) {\n                  v.remove();\n                }\n              };\n\n              _this6.onRemove(cleanup);\n\n              v.onRemove(function () {\n                _this6.attach.remove(onAttach);\n\n                _this6._onRemove.remove(cleanup);\n              });\n            } else if (v instanceof Node) {\n              tag.parentNode.insertBefore(v, dynamicNode);\n\n              _this6.onRemove(function () {\n                return v.remove();\n              });\n            } else if (v instanceof _Tag.Tag) {\n              tag.parentNode.insertBefore(v.node, dynamicNode);\n\n              _this6.onRemove(function () {\n                return v.remove();\n              });\n            } else {\n              if (v instanceof Object && v.__toString instanceof Function) {\n                v = v.__toString();\n              }\n\n              if (unsafeHtml) {\n                dynamicNode.innerHTML = v;\n              } else {\n                dynamicNode.nodeValue = v;\n              }\n            }\n\n            dynamicNode[dontParse] = true;\n          });\n\n          _this6.onRemove(debind);\n        };\n\n        while (match = regex.exec(original)) {\n          var _ret2 = _loop3();\n\n          if (_ret2 === \"continue\") continue;\n        }\n\n        var staticSuffix = original.substring(header);\n        var staticNode = document.createTextNode(staticSuffix);\n        staticNode[dontParse] = true;\n        tag.parentNode.insertBefore(staticNode, tag);\n        tag.nodeValue = '';\n      }\n\n      if (tag.nodeType === Node.ELEMENT_NODE) {\n        var _loop4 = function _loop4(i) {\n          if (!_this6.interpolatable(tag.attributes[i].value)) {\n            return \"continue\";\n          }\n\n          var header = 0;\n          var match = void 0;\n          var original = tag.attributes[i].value;\n          var attribute = tag.attributes[i];\n          var bindProperties = {};\n          var segments = [];\n\n          while (match = regex.exec(original)) {\n            segments.push(original.substring(header, match.index));\n\n            if (!bindProperties[match[2]]) {\n              bindProperties[match[2]] = [];\n            }\n\n            bindProperties[match[2]].push(segments.length);\n            segments.push(match[1]);\n            header = match.index + match[1].length;\n          }\n\n          segments.push(original.substring(header));\n\n          var _loop5 = function _loop5(j) {\n            var proxy = _this6.args;\n            var property = j;\n            var propertySplit = j.split('|');\n            var transformer = false;\n            var longProperty = j;\n\n            if (propertySplit.length > 1) {\n              transformer = _this6.stringTransformer(propertySplit.slice(1));\n              property = propertySplit[0];\n            }\n\n            if (property.match(/\\./)) {\n              var _Bindable$resolve7 = _Bindable.Bindable.resolve(_this6.args, property, true);\n\n              var _Bindable$resolve8 = _slicedToArray(_Bindable$resolve7, 2);\n\n              proxy = _Bindable$resolve8[0];\n              property = _Bindable$resolve8[1];\n            } // if(property.match(/\\./))\n            // {\n            // \t[proxy, property] = Bindable.resolve(\n            // \t\tthis.args\n            // \t\t, property\n            // \t\t, true\n            // \t);\n            // }\n            // console.log(this.args, property);\n\n\n            var matching = [];\n            var bindProperty = j;\n            var matchingSegments = bindProperties[longProperty];\n\n            _this6.onRemove(proxy.bindTo(property, function (v, k, t, d) {\n              if (transformer) {\n                v = transformer(v);\n              }\n\n              for (var _i5 in bindProperties) {\n                for (var _j in bindProperties[longProperty]) {\n                  segments[bindProperties[longProperty][_j]] = t[_i5];\n\n                  if (k === property) {\n                    segments[bindProperties[longProperty][_j]] = v;\n                  }\n                }\n              }\n\n              tag.setAttribute(attribute.name, segments.join(''));\n            }));\n\n            _this6.onRemove(function () {\n              if (!proxy.isBound()) {\n                _Bindable.Bindable.clearBindings(proxy);\n              }\n            });\n          };\n\n          for (var j in bindProperties) {\n            _loop5(j);\n          }\n        };\n\n        for (var i = 0; i < tag.attributes.length; i++) {\n          var _ret3 = _loop4(i);\n\n          if (_ret3 === \"continue\") continue;\n        }\n      }\n\n      return tag;\n    }\n  }, {\n    key: \"mapRefTag\",\n    value: function mapRefTag(tag) {\n      var refAttr = tag.getAttribute('cv-ref');\n\n      var _refAttr$split = refAttr.split(':'),\n          _refAttr$split2 = _slicedToArray(_refAttr$split, 3),\n          refProp = _refAttr$split2[0],\n          _refAttr$split2$ = _refAttr$split2[1],\n          refClassname = _refAttr$split2$ === void 0 ? null : _refAttr$split2$,\n          _refAttr$split2$2 = _refAttr$split2[2],\n          refKey = _refAttr$split2$2 === void 0 ? null : _refAttr$split2$2;\n\n      var refClass = _Tag.Tag;\n\n      if (refClassname) {\n        refClass = this.stringToClass(refClassname);\n      }\n\n      tag.removeAttribute('cv-ref');\n      Object.defineProperty(tag, '___tag___', {\n        enumerable: false,\n        writable: true\n      });\n      this.onRemove(function () {\n        tag.___tag___ = null;\n        tag.remove();\n      });\n      var parent = this;\n      var direct = this;\n\n      if (this.viewList) {\n        parent = this.viewList.parent; // if(!this.viewList.parent.tags[refProp])\n        // {\n        // \tthis.viewList.parent.tags[refProp] = [];\n        // }\n        // let refKeyVal = this.args[refKey];\n        // this.viewList.parent.tags[refProp][refKeyVal] = new refClass(\n        // \ttag, this, refProp, refKeyVal\n        // );\n      } else {// this.tags[refProp] = new refClass(\n          // \ttag, this, refProp\n          // );\n        }\n\n      var tagObject = new refClass(tag, this, refProp, undefined, direct);\n      tag.___tag___ = tagObject;\n      this.tags[refProp] = tagObject;\n\n      while (parent) {\n        if (!parent.parent) {}\n\n        var refKeyVal = this.args[refKey];\n\n        if (refKeyVal !== undefined) {\n          if (!parent.tags[refProp]) {\n            parent.tags[refProp] = [];\n          }\n\n          parent.tags[refProp][refKeyVal] = tagObject;\n        } else {\n          parent.tags[refProp] = tagObject;\n        }\n\n        parent = parent.parent;\n      }\n\n      return tag;\n    }\n  }, {\n    key: \"mapBindTag\",\n    value: function mapBindTag(tag) {\n      var _this7 = this;\n\n      var bindArg = tag.getAttribute('cv-bind');\n      var proxy = this.args;\n      var property = bindArg;\n      var top = null;\n\n      if (bindArg.match(/\\./)) {\n        var _Bindable$resolve9 = _Bindable.Bindable.resolve(this.args, bindArg, true);\n\n        var _Bindable$resolve10 = _slicedToArray(_Bindable$resolve9, 3);\n\n        proxy = _Bindable$resolve10[0];\n        property = _Bindable$resolve10[1];\n        top = _Bindable$resolve10[2];\n      }\n\n      if (proxy !== this.args) {\n        this.subBindings[bindArg] = this.subBindings[bindArg] || [];\n        this.onRemove(this.args.bindTo(top, function () {\n          while (_this7.subBindings.length) {\n            _this7.subBindings.shift()();\n          }\n        }));\n      }\n\n      var unsafeHtml = false;\n\n      if (property.substr(0, 1) === '$') {\n        property = property.substr(1);\n        unsafeHtml = true;\n      }\n\n      var debind = proxy.bindTo(property, function (v, k, t, d, p) {\n        if ((p instanceof View || p instanceof Node || p instanceof _Tag.Tag) && p !== v) {\n          p.remove();\n        }\n\n        var autoChangedEvent = new CustomEvent('cvAutoChanged', {\n          bubbles: true\n        });\n\n        if (['INPUT', 'SELECT', 'TEXTAREA'].includes(tag.tagName)) {\n          var _type = tag.getAttribute('type');\n\n          if (_type && _type.toLowerCase() === 'checkbox') {\n            tag.checked = !!v;\n            tag.dispatchEvent(autoChangedEvent);\n          } else if (_type && _type.toLowerCase() === 'radio') {\n            tag.checked = v == tag.value;\n            tag.dispatchEvent(autoChangedEvent);\n          } else if (_type !== 'file') {\n            if (tag.tagName === 'SELECT') {\n              var selectOption = function selectOption() {\n                for (var i = 0; i < tag.options.length; i++) {\n                  var option = tag.options[i];\n\n                  if (option.value == v) {\n                    tag.selectedIndex = i;\n                  }\n                }\n              };\n\n              selectOption();\n\n              _this7.attach.add(selectOption);\n            } else {\n              tag.value = v == null ? '' : v;\n            }\n\n            tag.dispatchEvent(autoChangedEvent);\n          }\n        } else {\n          if (v instanceof View) {\n            var _iterator2 = _createForOfIteratorHelper(tag.childNodes),\n                _step2;\n\n            try {\n              for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n                var node = _step2.value;\n                node.remove();\n              }\n            } catch (err) {\n              _iterator2.e(err);\n            } finally {\n              _iterator2.f();\n            }\n\n            var onAttach = function onAttach(parentNode) {\n              if (v.dispatchAttach()) {\n                v.attached(parentNode);\n                v.dispatchAttached();\n              }\n            };\n\n            _this7.attach.add(onAttach);\n\n            v.render(tag);\n            v.onRemove(function () {\n              return _this7.attach.remove(onAttach);\n            });\n          } else if (v instanceof Node) {\n            tag.insert(v);\n          } else if (v instanceof _Tag.Tag) {\n            tag.append(v.node);\n          } else if (unsafeHtml) {\n            if (tag.innerHTML !== v) {\n              v = String(v);\n\n              if (tag.innerHTML === v.substring(0, tag.innerHTML.length)) {\n                tag.innerHTML += v.substring(tag.innerHTML.length);\n              } else {\n                var _iterator3 = _createForOfIteratorHelper(tag.childNodes),\n                    _step3;\n\n                try {\n                  for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n                    var _node = _step3.value;\n\n                    _node.remove();\n                  }\n                } catch (err) {\n                  _iterator3.e(err);\n                } finally {\n                  _iterator3.f();\n                }\n\n                tag.innerHTML = v;\n              }\n\n              _Dom.Dom.mapTags(tag, false, function (t) {\n                return t[dontParse] = true;\n              });\n            }\n          } else {\n            if (tag.textContent !== v) {\n              var _iterator4 = _createForOfIteratorHelper(tag.childNodes),\n                  _step4;\n\n              try {\n                for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n                  var _node2 = _step4.value;\n\n                  _node2.remove();\n                }\n              } catch (err) {\n                _iterator4.e(err);\n              } finally {\n                _iterator4.f();\n              }\n\n              tag.textContent = v;\n            }\n          }\n        }\n      });\n\n      if (proxy !== this.args) {\n        this.subBindings[bindArg].push(debind);\n      }\n\n      this.onRemove(debind);\n      var type = tag.getAttribute('type');\n      var multi = tag.getAttribute('multiple');\n\n      var inputListener = function inputListener(event) {\n        if (event.target !== tag) {\n          return;\n        }\n\n        if (type && type.toLowerCase() === 'checkbox') {\n          if (tag.checked) {\n            proxy[property] = event.target.getAttribute('value');\n          } else {\n            proxy[property] = false;\n          }\n        } else if (event.target.matches('[contenteditable=true]')) {\n          proxy[property] = event.target.innerHTML;\n        } else if (type === 'file' && multi) {\n          var files = Array.from(event.target.files);\n\n          var current = proxy[property] || _Bindable.Bindable.onDeck(proxy, property);\n\n          if (!current || !files.length) {\n            proxy[property] = files;\n          } else {\n            var _loop6 = function _loop6(i) {\n              if (files[i] !== current[i]) {\n                files[i].toJSON = function () {\n                  return {\n                    name: file[i].name,\n                    size: file[i].size,\n                    type: file[i].type,\n                    date: file[i].lastModified\n                  };\n                };\n\n                current[i] = files[i];\n                return \"break\";\n              }\n            };\n\n            for (var i in files) {\n              var _ret4 = _loop6(i);\n\n              if (_ret4 === \"break\") break;\n            }\n          }\n        } else if (type === 'file' && !multi) {\n          var _file = event.target.files.item(0);\n\n          _file.toJSON = function () {\n            return {\n              name: _file.name,\n              size: _file.size,\n              type: _file.type,\n              date: _file.lastModified\n            };\n          };\n\n          proxy[property] = _file;\n        } else {\n          proxy[property] = event.target.value;\n        }\n      };\n\n      if (type === 'file' || type === 'radio') {\n        tag.addEventListener('change', inputListener);\n      } else {\n        tag.addEventListener('input', inputListener);\n        tag.addEventListener('change', inputListener);\n        tag.addEventListener('value-changed', inputListener);\n      }\n\n      this.onRemove(function () {\n        if (type === 'file' || type === 'radio') {\n          tag.removeEventListener('change', inputListener);\n        } else {\n          tag.removeEventListener('input', inputListener);\n          tag.removeEventListener('change', inputListener);\n          tag.removeEventListener('value-changed', inputListener);\n        }\n      });\n      tag.removeAttribute('cv-bind');\n      return tag;\n    }\n  }, {\n    key: \"mapOnTag\",\n    value: function mapOnTag(tag) {\n      var _this8 = this;\n\n      var referents = String(tag.getAttribute('cv-on'));\n      referents.split(';').map(function (a) {\n        return a.split(':');\n      }).map(function (a) {\n        a = a.map(function (a) {\n          return a.trim();\n        });\n        var argLen = a.length;\n        var eventName = String(a.shift()).trim();\n        var callbackName = String(a.shift() || eventName).trim();\n        var eventFlags = String(a.shift() || '').trim();\n        var argList = [];\n        var groups = /(\\w+)(?:\\(([$\\w\\s-'\",]+)\\))?/.exec(callbackName);\n\n        if (groups) {\n          callbackName = groups[1].replace(/(^[\\s\\n]+|[\\s\\n]+$)/, '');\n\n          if (groups[2]) {\n            argList = groups[2].split(',').map(function (s) {\n              return s.trim();\n            });\n          }\n\n          if (groups.length) {}\n        } else {\n          argList.push('$event');\n        }\n\n        if (!eventName || argLen === 1) {\n          eventName = callbackName;\n        }\n\n        var eventMethod;\n        var parent = _this8;\n\n        while (parent) {\n          if (typeof parent[callbackName] === 'function') {\n            var _ret5 = function () {\n              var _parent = parent;\n              var _callBackName = callbackName;\n\n              eventMethod = function eventMethod() {\n                _parent[_callBackName].apply(_parent, arguments);\n              };\n\n              return \"break\";\n            }();\n\n            if (_ret5 === \"break\") break;\n          }\n\n          if (parent.parent) {\n            parent = parent.parent;\n          } else {\n            break;\n          }\n        }\n\n        var eventListener = function eventListener(event) {\n          var argRefs = argList.map(function (arg) {\n            var match;\n\n            if (parseInt(arg) == arg) {\n              return arg;\n            } else if (arg === 'event' || arg === '$event') {\n              return event;\n            } else if (arg === '$view') {\n              return parent;\n            } else if (arg === '$tag') {\n              return tag;\n            } else if (arg === '$parent') {\n              return _this8.parent;\n            } else if (arg === '$subview') {\n              return _this8;\n            } else if (arg in _this8.args) {\n              return _this8.args[arg];\n            } else if (match = /^['\"]([\\w-]+?)[\"']$/.exec(arg)) {\n              return match[1];\n            }\n          });\n\n          if (!(typeof eventMethod === 'function')) {\n            throw new Error(\"\".concat(callbackName, \" is not defined on View object.\") + \"\\n\" + \"Tag:\" + \"\\n\" + \"\".concat(tag.outerHTML));\n          }\n\n          eventMethod.apply(void 0, _toConsumableArray(argRefs));\n        };\n\n        var eventOptions = {};\n\n        if (eventFlags.includes('p')) {\n          eventOptions.passive = true;\n        } else if (eventFlags.includes('P')) {\n          eventOptions.passive = false;\n        }\n\n        if (eventFlags.includes('c')) {\n          eventOptions.capture = true;\n        } else if (eventFlags.includes('C')) {\n          eventOptions.capture = false;\n        }\n\n        if (eventFlags.includes('o')) {\n          eventOptions.once = true;\n        } else if (eventFlags.includes('O')) {\n          eventOptions.once = false;\n        }\n\n        switch (eventName) {\n          case '_init':\n            eventListener();\n            break;\n\n          case '_attach':\n            _this8.attach.add(eventListener);\n\n            break;\n\n          case '_detach':\n            _this8.detach.add(eventListener);\n\n            break;\n\n          default:\n            tag.addEventListener(eventName, eventListener, eventOptions);\n\n            _this8.onRemove(function () {\n              tag.removeEventListener(eventName, eventListener, eventOptions);\n            });\n\n            break;\n        }\n\n        return [eventName, callbackName, argList];\n      });\n      tag.removeAttribute('cv-on');\n      return tag;\n    }\n  }, {\n    key: \"mapLinkTag\",\n    value: function mapLinkTag(tag) {\n      /*/\n      const tagCompiler = this.compileLinkTag(tag);\n      \tconst newTag = tagCompiler(this);\n      \ttag.replaceWith(newTag);\n      \treturn newTag;\n      /*/\n      var linkAttr = tag.getAttribute('cv-link');\n      tag.setAttribute('href', linkAttr);\n\n      var linkClick = function linkClick(event) {\n        event.preventDefault();\n\n        if (linkAttr.substring(0, 4) === 'http' || linkAttr.substring(0, 2) === '//') {\n          window.open(tag.getAttribute('href', linkAttr));\n          return;\n        }\n\n        _Router.Router.go(tag.getAttribute('href'));\n      };\n\n      tag.addEventListener('click', linkClick);\n      this.onRemove(function (tag, eventListener) {\n        return function () {\n          tag.removeEventListener('click', eventListener);\n          tag = undefined;\n          eventListener = undefined;\n        };\n      }(tag, linkClick));\n      tag.removeAttribute('cv-link');\n      return tag; //*/\n    }\n  }, {\n    key: \"compileLinkTag\",\n    value: function compileLinkTag(sourceTag) {\n      var linkAttr = sourceTag.getAttribute('cv-link');\n      sourceTag.removeAttribute('cv-link');\n      return function (bindingView) {\n        var tag = sourceTag.cloneNode(true);\n        tag.setAttribute('href', linkAttr);\n        return tag;\n      };\n    }\n  }, {\n    key: \"mapPrendererTag\",\n    value: function mapPrendererTag(tag) {\n      var prerenderAttr = tag.getAttribute('cv-prerender');\n      var prerendering = window.prerenderer || navigator.userAgent.match(/prerender/i);\n\n      if (prerendering) {\n        window.prerenderer = window.prerenderer || true;\n      }\n\n      if (prerenderAttr === 'never' && prerendering || prerenderAttr === 'only' && !prerendering) {\n        tag.parentNode.removeChild(tag);\n      }\n\n      return tag;\n    }\n  }, {\n    key: \"mapWithTag\",\n    value: function mapWithTag(tag) {\n      var _this9 = this;\n\n      var withAttr = tag.getAttribute('cv-with');\n      var carryAttr = tag.getAttribute('cv-carry');\n      var viewAttr = tag.getAttribute('cv-view');\n      tag.removeAttribute('cv-with');\n      tag.removeAttribute('cv-carry');\n      tag.removeAttribute('cv-view');\n      var viewClass = viewAttr ? this.stringToClass(viewAttr) : View;\n      var subTemplate = new DocumentFragment();\n\n      _toConsumableArray(tag.childNodes).map(function (n) {\n        return subTemplate.appendChild(n);\n      });\n\n      var carryProps = [];\n\n      if (carryAttr) {\n        carryProps = carryAttr.split(',').map(function (s) {\n          return s.trim();\n        });\n      }\n\n      var debind = this.args.bindTo(withAttr, function (v, k, t, d) {\n        if (_this9.withViews.has(tag)) {\n          _this9.withViews[\"delete\"](tag);\n        }\n\n        while (tag.firstChild) {\n          tag.removeChild(tag.firstChild);\n        }\n\n        var view = new viewClass({}, _this9);\n\n        _this9.onRemove(function (view) {\n          return function () {\n            view.remove();\n          };\n        }(view));\n\n        view.template = subTemplate;\n\n        var _loop7 = function _loop7(i) {\n          var debind = _this9.args.bindTo(carryProps[i], function (v, k) {\n            view.args[k] = v;\n          });\n\n          view.onRemove(debind);\n\n          _this9.onRemove(function () {\n            debind();\n            view.remove();\n          });\n        };\n\n        for (var i in carryProps) {\n          _loop7(i);\n        }\n\n        var _loop8 = function _loop8(_i6) {\n          var debind = v.bindTo(_i6, function (vv, kk) {\n            view.args[kk] = vv;\n          });\n          var debindUp = view.args.bindTo(_i6, function (vv, kk) {\n            v[kk] = vv;\n          });\n\n          _this9.onRemove(function () {\n            debind();\n\n            if (!v.isBound()) {\n              _Bindable.Bindable.clearBindings(v);\n            }\n\n            view.remove();\n          });\n\n          view.onRemove(function () {\n            debind();\n\n            if (!v.isBound()) {\n              _Bindable.Bindable.clearBindings(v);\n            }\n          });\n        };\n\n        for (var _i6 in v) {\n          _loop8(_i6);\n        }\n\n        view.render(tag);\n\n        _this9.withViews.set(tag, view);\n      });\n      this.onRemove(function () {\n        _this9.withViews[\"delete\"](tag);\n\n        debind();\n      });\n      return tag;\n    }\n  }, {\n    key: \"mapViewTag\",\n    value: function mapViewTag(tag) {\n      var _this10 = this;\n\n      var viewAttr = tag.getAttribute('cv-view');\n      tag.removeAttribute('cv-view');\n      var subTemplate = new DocumentFragment();\n\n      _toConsumableArray(tag.childNodes).map(function (n) {\n        return subTemplate.appendChild(n);\n      });\n\n      var parts = viewAttr.split(':');\n      var viewClass = parts.pop() ? this.stringToClass(viewAttr) : View;\n      var viewName = parts.shift();\n      var view = new viewClass(this.args, this);\n      this.views.set(tag, view);\n\n      if (viewName) {\n        this.views.set(viewName, view);\n      }\n\n      this.onRemove(function (view) {\n        return function () {\n          view.remove();\n\n          _this10.views[\"delete\"](tag);\n\n          _this10.views[\"delete\"](viewName);\n        };\n      }(view));\n      view.template = subTemplate;\n      view.render(tag);\n      return tag;\n    }\n  }, {\n    key: \"mapEachTag\",\n    value: function mapEachTag(tag) {\n      var _this11 = this;\n\n      var eachAttr = tag.getAttribute('cv-each');\n      var viewAttr = tag.getAttribute('cv-view');\n      tag.removeAttribute('cv-each');\n      tag.removeAttribute('cv-view');\n      var viewClass = viewAttr ? this.stringToClass(viewAttr) : View;\n      var subTemplate = new DocumentFragment();\n      Array.from(tag.childNodes).map(function (n) {\n        return subTemplate.appendChild(n);\n      });\n\n      var _eachAttr$split = eachAttr.split(':'),\n          _eachAttr$split2 = _slicedToArray(_eachAttr$split, 3),\n          eachProp = _eachAttr$split2[0],\n          asProp = _eachAttr$split2[1],\n          keyProp = _eachAttr$split2[2];\n\n      var debind = this.args.bindTo(eachProp, function (v, k, t, d, p) {\n        if (_this11.viewLists.has(tag)) {\n          _this11.viewLists.get(tag).remove();\n        }\n\n        var viewList = new _ViewList.ViewList(subTemplate, asProp, v, _this11, keyProp, viewClass);\n\n        var viewListRemover = function viewListRemover() {\n          return viewList.remove();\n        };\n\n        _this11.onRemove(viewListRemover);\n\n        viewList.onRemove(function () {\n          return _this11._onRemove.remove(viewListRemover);\n        });\n\n        var debindA = _this11.args.bindTo(function (v, k, t, d) {\n          if (k === '_id') {\n            return;\n          }\n\n          if (d) {\n            delete viewList.subArgs[k];\n          }\n\n          viewList.subArgs[k] = v;\n        });\n\n        var debindB = viewList.args.bindTo(function (v, k, t, d, p) {\n          if (k === '_id' || k === 'value' || k.substring(0, 3) === '___') {\n            return;\n          }\n\n          if (d) {\n            delete _this11.args[k];\n          }\n\n          if (k in _this11.args) {\n            _this11.args[k] = v;\n          }\n        });\n        viewList.onRemove(debindA);\n        viewList.onRemove(debindB);\n\n        _this11.onRemove(debindA);\n\n        _this11.onRemove(debindB);\n\n        while (tag.firstChild) {\n          tag.removeChild(tag.firstChild);\n        }\n\n        _this11.viewLists.set(tag, viewList);\n\n        viewList.render(tag);\n      });\n      this.onRemove(debind);\n      return tag;\n    }\n  }, {\n    key: \"mapIfTag\",\n    value: function mapIfTag(tag) {\n      var _this12 = this;\n\n      var sourceTag = tag;\n      var viewProperty = tag.getAttribute('cv-view');\n      var ifProperty = sourceTag.getAttribute('cv-if');\n      var inverted = false;\n      var defined = false;\n      sourceTag.removeAttribute('cv-view');\n      sourceTag.removeAttribute('cv-if');\n      var viewClass = viewProperty ? this.stringToClass(viewProperty) : View;\n\n      if (ifProperty.substr(0, 1) === '!') {\n        ifProperty = ifProperty.substr(1);\n        inverted = true;\n      }\n\n      if (ifProperty.substr(0, 1) === '?') {\n        ifProperty = ifProperty.substr(1);\n        defined = true;\n      }\n\n      var subTemplate = new DocumentFragment();\n      Array.from(sourceTag.childNodes).map(function (n) {\n        return subTemplate.appendChild(n);\n      } // n => subTemplate.appendChild(n.cloneNode(true))\n      );\n      var bindingView = this;\n      var ifDoc = new DocumentFragment();\n      var view = new viewClass(this.args, bindingView);\n      this.onRemove(view.tags.bindTo(function (v, k) {\n        console.log(k);\n        _this12.tags[k] = v;\n      }));\n      view.template = subTemplate;\n      var proxy = bindingView.args;\n      var property = ifProperty;\n\n      if (ifProperty.match(/\\./)) {\n        var _Bindable$resolve11 = _Bindable.Bindable.resolve(bindingView.args, ifProperty, true);\n\n        var _Bindable$resolve12 = _slicedToArray(_Bindable$resolve11, 2);\n\n        proxy = _Bindable$resolve12[0];\n        property = _Bindable$resolve12[1];\n      }\n\n      view.render(ifDoc);\n      var propertyDebind = proxy.bindTo(property, function (v, k) {\n        var o = v;\n\n        if (defined) {\n          v = v !== null && v !== undefined;\n        }\n\n        if (Array.isArray(v)) {\n          v = !!v.length;\n        }\n\n        if (inverted) {\n          v = !v;\n        }\n\n        if (v) {\n          tag.appendChild(ifDoc);\n        } else {\n          view.nodes.map(function (n) {\n            return ifDoc.appendChild(n);\n          });\n        }\n      }, {\n        wait: 0,\n        children: Array.isArray(proxy[property])\n      }); // const propertyDebind = this.args.bindChain(property, onUpdate);\n\n      bindingView.onRemove(propertyDebind);\n\n      var bindableDebind = function bindableDebind() {\n        if (!proxy.isBound()) {\n          _Bindable.Bindable.clearBindings(proxy);\n        }\n      };\n\n      var viewDebind = function viewDebind() {\n        propertyDebind();\n        bindableDebind();\n\n        bindingView._onRemove.remove(propertyDebind);\n\n        bindingView._onRemove.remove(bindableDebind);\n      };\n\n      bindingView.onRemove(viewDebind);\n      this.onRemove(function () {\n        view.remove();\n\n        if (bindingView !== _this12) {\n          bindingView.remove();\n        }\n      });\n      return tag; //*/\n    }\n  }, {\n    key: \"compileIfTag\",\n    value: function compileIfTag(sourceTag) {\n      var ifProperty = sourceTag.getAttribute('cv-if');\n      var inverted = false;\n      sourceTag.removeAttribute('cv-if');\n\n      if (ifProperty.substr(0, 1) === '!') {\n        ifProperty = ifProperty.substr(1);\n        inverted = true;\n      }\n\n      var subTemplate = new DocumentFragment();\n      Array.from(sourceTag.childNodes).map(function (n) {\n        return subTemplate.appendChild(n.cloneNode(true));\n      });\n      return function (bindingView) {\n        var tag = sourceTag.cloneNode();\n        var ifDoc = new DocumentFragment();\n        var view = new View({}, bindingView);\n        view.template = subTemplate; // view.parent   = bindingView;\n\n        bindingView.syncBind(view);\n        var proxy = bindingView.args;\n        var property = ifProperty;\n\n        if (ifProperty.match(/\\./)) {\n          var _Bindable$resolve13 = _Bindable.Bindable.resolve(bindingView.args, ifProperty, true);\n\n          var _Bindable$resolve14 = _slicedToArray(_Bindable$resolve13, 2);\n\n          proxy = _Bindable$resolve14[0];\n          property = _Bindable$resolve14[1];\n        }\n\n        var hasRendered = false;\n        var propertyDebind = proxy.bindTo(property, function (v, k) {\n          if (!hasRendered) {\n            var renderDoc = bindingView.args[property] || inverted ? tag : ifDoc;\n            view.render(renderDoc);\n            hasRendered = true;\n            return;\n          }\n\n          if (Array.isArray(v)) {\n            v = !!v.length;\n          }\n\n          if (inverted) {\n            v = !v;\n          }\n\n          if (v) {\n            tag.appendChild(ifDoc);\n          } else {\n            view.nodes.map(function (n) {\n              return ifDoc.appendChild(n);\n            });\n          }\n        }); // let cleaner = bindingView;\n        // while(cleaner.parent)\n        // {\n        // \tcleaner = cleaner.parent;\n        // }\n\n        bindingView.onRemove(propertyDebind);\n\n        var bindableDebind = function bindableDebind() {\n          if (!proxy.isBound()) {\n            _Bindable.Bindable.clearBindings(proxy);\n          }\n        };\n\n        var viewDebind = function viewDebind() {\n          propertyDebind();\n          bindableDebind();\n\n          bindingView._onRemove.remove(propertyDebind);\n\n          bindingView._onRemove.remove(bindableDebind);\n        };\n\n        view.onRemove(viewDebind);\n        return tag;\n      };\n    }\n  }, {\n    key: \"mapTemplateTag\",\n    value: function mapTemplateTag(tag) {\n      var templateName = tag.getAttribute('cv-template');\n      tag.removeAttribute('cv-template');\n\n      this.templates[templateName] = function () {\n        return tag.tagName === 'TEMPLATE' ? tag.content.cloneNode(true) : new DocumentFragment(tag.innerHTML);\n      };\n\n      this.rendered.then(function () {\n        return tag.remove();\n      });\n      return tag;\n    }\n  }, {\n    key: \"mapSlotTag\",\n    value: function mapSlotTag(tag) {\n      var templateName = tag.getAttribute('cv-slot');\n      var getTemplate = this.templates[templateName];\n\n      if (!getTemplate) {\n        var parent = this;\n\n        while (parent) {\n          getTemplate = parent.templates[templateName];\n\n          if (getTemplate) {\n            break;\n          }\n\n          parent = this.parent;\n        }\n\n        if (!getTemplate) {\n          console.error(\"Template \".concat(templateName, \" not found.\"));\n          return;\n        }\n      }\n\n      var template = getTemplate();\n      tag.removeAttribute('cv-slot');\n\n      while (tag.firstChild) {\n        tag.firstChild.remove();\n      }\n\n      tag.appendChild(template);\n      return tag;\n    }\n  }, {\n    key: \"syncBind\",\n    value: function syncBind(subView) {\n      var _this13 = this;\n\n      var debindA = this.args.bindTo(function (v, k, t, d) {\n        if (k === '_id') {\n          return;\n        }\n\n        if (subView.args[k] !== v) {\n          subView.args[k] = v;\n        }\n      }); // for(let i in this.args)\n      // {\n      // \tif(i == '_id')\n      // \t{\n      // \t\tcontinue;\n      // \t}\n      // \tsubView.args[i] = this.args[i];\n      // }\n\n      var debindB = subView.args.bindTo(function (v, k, t, d, p) {\n        if (k === '_id') {\n          return;\n        }\n\n        var newRef = v;\n        var oldRef = p;\n\n        if (newRef instanceof View) {\n          newRef = newRef.___ref___;\n        }\n\n        if (oldRef instanceof View) {\n          oldRef = oldRef.___ref___;\n        }\n\n        if (newRef !== oldRef && oldRef instanceof View) {\n          p.remove();\n        }\n\n        if (k in _this13.args) {\n          _this13.args[k] = v;\n        }\n      });\n      this.onRemove(debindA);\n      this.onRemove(debindB);\n      subView.onRemove(function () {\n        _this13._onRemove.remove(debindA);\n\n        _this13._onRemove.remove(debindB);\n      });\n    }\n  }, {\n    key: \"postRender\",\n    value: function postRender(parentNode) {}\n  }, {\n    key: \"attached\",\n    value: function attached(parentNode) {}\n  }, {\n    key: \"interpolatable\",\n    value: function interpolatable(str) {\n      return !!String(str).match(this.interpolateRegex);\n    }\n  }, {\n    key: \"uuid\",\n    value: function uuid() {\n      return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, function (c) {\n        return (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16);\n      });\n    }\n  }, {\n    key: \"remove\",\n    value: function remove() {\n      var _this14 = this;\n\n      var now = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n      var remover = function remover() {\n        for (var _i7 in _this14.tags) {\n          if (Array.isArray(_this14.tags[_i7])) {\n            _this14.tags[_i7] && _this14.tags[_i7].map(function (t) {\n              return t.remove();\n            });\n\n            _this14.tags[_i7].splice(0);\n          } else {\n            _this14.tags[_i7] && _this14.tags[_i7].remove();\n            _this14.tags[_i7] = undefined;\n          }\n        }\n\n        for (var _i8 in _this14.nodes) {\n          _this14.nodes[_i8] && _this14.nodes[_i8].dispatchEvent(new Event('cvDomDetached'));\n          _this14.nodes[_i8] && _this14.nodes[_i8].remove();\n          _this14.nodes[_i8] = undefined;\n        }\n\n        _this14.nodes.splice(0);\n\n        _this14.firstNode = _this14.lastNode = undefined;\n      };\n\n      if (now) {\n        remover();\n      } else {\n        requestAnimationFrame(remover);\n      }\n\n      var callbacks = this._onRemove.items();\n\n      var _iterator5 = _createForOfIteratorHelper(callbacks),\n          _step5;\n\n      try {\n        for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n          var callback = _step5.value;\n\n          this._onRemove.remove(callback);\n\n          callback();\n        }\n      } catch (err) {\n        _iterator5.e(err);\n      } finally {\n        _iterator5.f();\n      }\n\n      var cleanup;\n\n      while (cleanup = this.cleanup.shift()) {\n        cleanup && cleanup();\n      }\n\n      var _iterator6 = _createForOfIteratorHelper(this.viewLists),\n          _step6;\n\n      try {\n        for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {\n          var _step6$value = _slicedToArray(_step6.value, 2),\n              tag = _step6$value[0],\n              viewList = _step6$value[1];\n\n          viewList.remove();\n        }\n      } catch (err) {\n        _iterator6.e(err);\n      } finally {\n        _iterator6.f();\n      }\n\n      this.viewLists.clear();\n\n      for (var _i9 in this.timeouts) {\n        clearTimeout(this.timeouts[_i9].timeout);\n        delete this.timeouts[_i9];\n      }\n\n      for (var i in this.intervals) {\n        clearInterval(this.intervals[i].timeout);\n        delete this.intervals[i];\n      }\n\n      for (var i in this.frames) {\n        this.frames[i]();\n        delete this.frames[i];\n      }\n\n      this.removed = true;\n    }\n  }, {\n    key: \"findTag\",\n    value: function findTag(selector) {\n      for (var i in this.nodes) {\n        var result = void 0;\n\n        if (!this.nodes[i].querySelector) {\n          continue;\n        }\n\n        if (this.nodes[i].matches(selector)) {\n          return new _Tag.Tag(this.nodes[i], this, undefined, undefined, this);\n        }\n\n        if (result = this.nodes[i].querySelector(selector)) {\n          return new _Tag.Tag(result, this, undefined, undefined, this);\n        }\n      }\n    }\n  }, {\n    key: \"findTags\",\n    value: function findTags(selector) {\n      var _this15 = this;\n\n      return this.nodes.filter(function (n) {\n        return n.querySelectorAll;\n      }).map(function (n) {\n        return _toConsumableArray(n.querySelectorAll(selector));\n      }).flat().map(function (n) {\n        return new _Tag.Tag(n, _this15, undefined, undefined, _this15);\n      });\n    }\n  }, {\n    key: \"onRemove\",\n    value: function onRemove(callback) {\n      this._onRemove.add(callback);\n    }\n  }, {\n    key: \"update\",\n    value: function update() {}\n  }, {\n    key: \"beforeUpdate\",\n    value: function beforeUpdate(args) {}\n  }, {\n    key: \"afterUpdate\",\n    value: function afterUpdate(args) {}\n  }, {\n    key: \"stringTransformer\",\n    value: function stringTransformer(methods) {\n      var _this16 = this;\n\n      return function (x) {\n        for (var m in methods) {\n          var parent = _this16;\n          var method = methods[m];\n\n          while (parent && !parent[method]) {\n            parent = parent.parent;\n          }\n\n          if (!parent) {\n            return;\n          }\n\n          x = parent[methods[m]](x);\n        }\n\n        return x;\n      };\n    }\n  }, {\n    key: \"stringToClass\",\n    value: function stringToClass(refClassname) {\n      if (View.refClasses.has(refClassname)) {\n        return View.refClasses.get(refClassname);\n      }\n\n      var refClassSplit = refClassname.split('/');\n      var refShortClass = refClassSplit[refClassSplit.length - 1];\n\n      var refClass = require(refClassname);\n\n      View.refClasses.set(refClassname, refClass[refShortClass]);\n      return refClass[refShortClass];\n    }\n  }, {\n    key: \"preventParsing\",\n    value: function preventParsing(node) {\n      node[dontParse] = true;\n    }\n  }, {\n    key: \"toString\",\n    value: function toString() {\n      return this.nodes.map(function (n) {\n        return n.outerHTML;\n      }).join(' ');\n    }\n  }, {\n    key: \"listen\",\n    value: function listen(node, eventName, callback, options) {\n      var _this17 = this;\n\n      if (typeof node === 'string') {\n        options = callback;\n        callback = eventName;\n        eventName = node;\n        node = this;\n      }\n\n      if (node instanceof View) {\n        return this.listen(node.nodes, eventName, callback, options);\n      }\n\n      if (Array.isArray(node)) {\n        var removers = node.map(function (n) {\n          return _this17.listen(n, eventName, callback, options);\n        });\n        return function () {\n          return removers.map(function (r) {\n            return r();\n          });\n        };\n      }\n\n      if (node instanceof _Tag.Tag) {\n        return this.listen(node.element, eventName, callback, options);\n      }\n\n      node.addEventListener(eventName, callback, options);\n\n      var remove = function remove() {\n        node.removeEventListener(eventName, callback, options);\n      };\n\n      var remover = function remover() {\n        remove();\n\n        remove = function remove() {};\n      };\n\n      this.onRemove(function () {\n        return remover();\n      });\n      return remover;\n    }\n  }], [{\n    key: \"isView\",\n    value: function isView() {\n      return View;\n    }\n  }]);\n\n  return View;\n}(_Mixin.Mixin[\"with\"](_EventTargetMixin.EventTargetMixin));\n\nexports.View = View;\nObject.defineProperty(View, 'templates', {\n  value: new Map()\n});\nObject.defineProperty(View, 'refClasses', {\n  value: new Map()\n});\n  })();\n});","\nrequire.register(\"curvature/base/ViewList.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ViewList = void 0;\n\nvar _Bindable = require(\"./Bindable\");\n\nvar _View = require(\"./View\");\n\nvar _Bag = require(\"./Bag\");\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar ViewList = /*#__PURE__*/function () {\n  function ViewList(template, subProperty, list, parent) {\n    var _this = this;\n\n    var keyProperty = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : null;\n    var viewClass = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : null;\n\n    _classCallCheck(this, ViewList);\n\n    this.removed = false;\n    this.args = _Bindable.Bindable.makeBindable({});\n    this.args.value = _Bindable.Bindable.makeBindable(list || {});\n    this.subArgs = _Bindable.Bindable.makeBindable({});\n    this.views = [];\n    this.cleanup = [];\n    this.viewClass = viewClass || _View.View;\n    this._onRemove = new _Bag.Bag();\n    this.template = template;\n    this.subProperty = subProperty;\n    this.keyProperty = keyProperty;\n    this.tag = null;\n    this.paused = false;\n    this.parent = parent;\n    this.rendered = new Promise(function (accept, reject) {\n      Object.defineProperty(_this, 'renderComplete', {\n        configurable: false,\n        writable: true,\n        value: accept\n      });\n    });\n    this.willReRender = false;\n\n    this.args.___before(function (t, e, s, o, a) {\n      if (e == 'bindTo') {\n        return;\n      }\n\n      _this.paused = true;\n    });\n\n    this.args.___after(function (t, e, s, o, a) {\n      if (e == 'bindTo') {\n        return;\n      }\n\n      _this.paused = s.length > 1;\n\n      _this.reRender();\n    });\n\n    var debind = this.args.value.bindTo(function (v, k, t, d) {\n      if (_this.paused) {\n        return;\n      }\n\n      var kk = k;\n\n      if (_typeof(k) === 'symbol') {\n        return;\n      }\n\n      if (isNaN(k)) {\n        kk = '_' + k;\n      }\n\n      if (d) {\n        if (_this.views[kk]) {\n          _this.views[kk].remove();\n        }\n\n        delete _this.views[kk];\n\n        for (var i in _this.views) {\n          if (typeof i === 'string') {\n            _this.views[i].args[_this.keyProperty] = i.substr(1);\n            continue;\n          }\n\n          _this.views[i].args[_this.keyProperty] = i;\n        }\n      } else if (!_this.views[kk] && !_this.willReRender) {\n        cancelAnimationFrame(_this.willReRender);\n        _this.willReRender = requestAnimationFrame(function () {\n          _this.reRender();\n        });\n      } else if (_this.views[kk] && _this.views[kk].args) {\n        _this.views[kk].args[_this.keyProperty] = k;\n        _this.views[kk].args[_this.subProperty] = v;\n      }\n    });\n\n    this._onRemove.add(debind);\n  }\n\n  _createClass(ViewList, [{\n    key: \"render\",\n    value: function render(tag) {\n      var _this2 = this;\n\n      var renders = [];\n\n      var _iterator = _createForOfIteratorHelper(this.views),\n          _step;\n\n      try {\n        var _loop = function _loop() {\n          var view = _step.value;\n          view.render(tag);\n          renders.push(view.rendered.then(function () {\n            return view;\n          }));\n        };\n\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          _loop();\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      this.tag = tag;\n      Promise.all(renders).then(function (views) {\n        return _this2.renderComplete(views);\n      });\n    }\n  }, {\n    key: \"reRender\",\n    value: function reRender() {\n      var _this3 = this;\n\n      if (this.paused || !this.tag) {\n        return;\n      }\n\n      var views = [];\n\n      for (var i in this.views) {\n        views[i] = this.views[i];\n      }\n\n      var finalViews = [];\n      this.upDebind && this.upDebind.map(function (d) {\n        return d && d();\n      });\n      this.downDebind && this.downDebind.map(function (d) {\n        return d && d();\n      });\n      this.upDebind = [];\n      this.downDebind = [];\n      var minKey = Infinity;\n      var anteMinKey = Infinity;\n\n      var _loop2 = function _loop2(_i) {\n        var found = false;\n        var k = _i;\n\n        if (isNaN(k)) {\n          k = '_' + _i;\n        } else if (String(k).length) {\n          k = Number(k);\n        }\n\n        for (var _j = views.length - 1; _j >= 0; _j--) {\n          if (views[_j] && _this3.args.value[_i] !== undefined && _this3.args.value[_i] === views[_j].args[_this3.subProperty]) {\n            found = true;\n            finalViews[k] = views[_j];\n\n            if (!isNaN(k)) {\n              minKey = Math.min(minKey, k);\n              k > 0 && (anteMinKey = Math.min(anteMinKey, k));\n            }\n\n            finalViews[k].args[_this3.keyProperty] = _i;\n            delete views[_j];\n            break;\n          }\n        }\n\n        if (!found) {\n          var viewArgs = {};\n          var view = finalViews[k] = new _this3.viewClass(viewArgs, _this3.parent);\n\n          if (!isNaN(k)) {\n            minKey = Math.min(minKey, k);\n            k > 0 && (anteMinKey = Math.min(anteMinKey, k));\n          }\n\n          finalViews[k].template = _this3.template instanceof Object ? _this3.template : _this3.template;\n          finalViews[k].viewList = _this3;\n          finalViews[k].args[_this3.keyProperty] = _i;\n          finalViews[k].args[_this3.subProperty] = _this3.args.value[_i];\n          _this3.upDebind[k] = viewArgs.bindTo(_this3.subProperty, function (v, k, t, d) {\n            var index = viewArgs[_this3.keyProperty];\n\n            if (d) {\n              delete _this3.args.value[index];\n              return;\n            }\n\n            _this3.args.value[index] = v;\n          });\n          _this3.downDebind[k] = _this3.subArgs.bindTo(function (v, k, t, d) {\n            if (d) {\n              delete viewArgs[k];\n              return;\n            }\n\n            viewArgs[k] = v;\n          });\n          view.onRemove(function () {\n            _this3.upDebind[k] && _this3.upDebind[k]();\n            _this3.downDebind[k] && _this3.downDebind[k]();\n            delete _this3.downDebind[k];\n            delete _this3.upDebind[k];\n          });\n\n          _this3._onRemove.add(function () {\n            _this3.upDebind.filter(function (x) {\n              return x;\n            }).map(function (d) {\n              return d();\n            });\n\n            _this3.upDebind.splice(0);\n          });\n\n          _this3._onRemove.add(function () {\n            _this3.downDebind.filter(function (x) {\n              return x;\n            }).map(function (d) {\n              return d();\n            });\n\n            _this3.downDebind.splice(0);\n          });\n\n          viewArgs[_this3.subProperty] = _this3.args.value[_i];\n        }\n      };\n\n      for (var _i in this.args.value) {\n        _loop2(_i);\n      }\n\n      for (var _i2 in views) {\n        var found = false;\n\n        for (var j in finalViews) {\n          if (views[_i2] === finalViews[j]) {\n            found = true;\n            break;\n          }\n        }\n\n        if (!found) {\n          views[_i2].remove();\n        }\n      }\n\n      if (Array.isArray(this.args.value)) {\n        var localMin = minKey === 0 && finalViews[1] !== undefined && finalViews.length > 1 || anteMinKey === Infinity ? minKey : anteMinKey;\n\n        var renderRecurse = function renderRecurse() {\n          var i = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n          var ii = finalViews.length - i - 1;\n\n          while (ii > localMin && finalViews[ii] === undefined) {\n            ii--;\n          }\n\n          if (ii < localMin) {\n            return Promise.resolve();\n          }\n\n          if (finalViews[ii] === _this3.views[ii]) {\n            if (!finalViews[ii].firstNode) {\n              finalViews[ii].render(_this3.tag, finalViews[ii + 1]);\n              return finalViews[ii].rendered.then(function () {\n                return renderRecurse(Number(i) + 1);\n              });\n            }\n\n            return renderRecurse(Number(i) + 1);\n          }\n\n          finalViews[ii].render(_this3.tag, finalViews[ii + 1]);\n\n          _this3.views.splice(ii, 0, finalViews[ii]);\n\n          return finalViews[ii].rendered.then(function () {\n            return renderRecurse(Number(i) + 1);\n          });\n        };\n\n        this.rendered = renderRecurse();\n      } else {\n        var renders = [];\n        var leftovers = Object.assign({}, finalViews);\n\n        var _loop3 = function _loop3(_i3) {\n          delete leftovers[_i3];\n\n          if (finalViews[_i3].firstNode && finalViews[_i3] === _this3.views[_i3]) {\n            return \"continue\";\n          }\n\n          finalViews[_i3].render(_this3.tag);\n\n          renders.push(finalViews[_i3].rendered.then(function () {\n            return finalViews[_i3];\n          }));\n        };\n\n        for (var _i3 in finalViews) {\n          var _ret = _loop3(_i3);\n\n          if (_ret === \"continue\") continue;\n        }\n\n        for (var _i4 in leftovers) {\n          delete this.args.views[_i4];\n          leftovers.remove();\n        }\n\n        this.rendered = Promise.all(renders);\n      }\n\n      this.views = finalViews;\n\n      for (var _i5 in finalViews) {\n        if (isNaN(_i5)) {\n          finalViews[_i5].args[this.keyProperty] = _i5.substr(1);\n          continue;\n        }\n\n        finalViews[_i5].args[this.keyProperty] = _i5;\n      }\n\n      this.willReRender = false;\n    }\n  }, {\n    key: \"pause\",\n    value: function pause() {\n      var _pause = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n\n      for (var i in this.views) {\n        this.views[i].pause(_pause);\n      }\n    }\n  }, {\n    key: \"onRemove\",\n    value: function onRemove(callback) {\n      this._onRemove.add(callback);\n    }\n  }, {\n    key: \"remove\",\n    value: function remove() {\n      for (var i in this.views) {\n        this.views[i].remove();\n      }\n\n      var onRemove = this._onRemove.items();\n\n      for (var _i6 in onRemove) {\n        this._onRemove.remove(onRemove[_i6]);\n\n        onRemove[_i6]();\n      }\n\n      var cleanup;\n\n      while (this.cleanup.length) {\n        cleanup = this.cleanup.pop();\n        cleanup();\n      }\n\n      this.views = [];\n\n      while (this.tag && this.tag.firstChild) {\n        this.tag.removeChild(this.tag.firstChild);\n      }\n\n      if (this.subArgs) {\n        _Bindable.Bindable.clearBindings(this.subArgs);\n      }\n\n      _Bindable.Bindable.clearBindings(this.args);\n\n      if (this.args.value && !this.args.value.isBound()) {\n        _Bindable.Bindable.clearBindings(this.args.value);\n      }\n\n      this.removed = true;\n    }\n  }]);\n\n  return ViewList;\n}();\n\nexports.ViewList = ViewList;\n  })();\n});","\nrequire.register(\"curvature/mixin/EventTargetMixin.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.EventTargetMixin = void 0;\n\nvar _Mixin = require(\"../base/Mixin\");\n\nvar _EventTargetMixin;\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar _EventTarget = Symbol('Target');\n\nvar EventTargetMixin = (_EventTargetMixin = {}, _defineProperty(_EventTargetMixin, _Mixin.Mixin.Constructor, function () {\n  try {\n    this[_EventTarget] = new EventTarget();\n  } catch (error) {\n    this[_EventTarget] = document.createDocumentFragment();\n  }\n}), _defineProperty(_EventTargetMixin, \"dispatchEvent\", function dispatchEvent() {\n  var _this$_EventTarget;\n\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  var event = args[0];\n\n  (_this$_EventTarget = this[_EventTarget]).dispatchEvent.apply(_this$_EventTarget, args);\n\n  var defaultHandler = \"on\".concat(event.type[0].toUpperCase() + event.type.slice(1));\n\n  if (typeof this[defaultHandler] === 'function') {\n    this[defaultHandler](event);\n  }\n\n  return event.returnValue;\n}), _defineProperty(_EventTargetMixin, \"addEventListener\", function addEventListener() {\n  var _this$_EventTarget2;\n\n  (_this$_EventTarget2 = this[_EventTarget]).addEventListener.apply(_this$_EventTarget2, arguments);\n}), _defineProperty(_EventTargetMixin, \"removeEventListener\", function removeEventListener() {\n  var _this$_EventTarget3;\n\n  (_this$_EventTarget3 = this[_EventTarget]).removeEventListener.apply(_this$_EventTarget3, arguments);\n}), _EventTargetMixin);\nexports.EventTargetMixin = EventTargetMixin;\n  })();\n});","\nrequire.register(\"curvature/mixin/PromiseMixin.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.PromiseMixin = void 0;\n\nvar _Mixin = require(\"../base/Mixin\");\n\nvar _PromiseMixin;\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar _Promise = Symbol('Promise');\n\nvar Accept = Symbol('Accept');\nvar Reject = Symbol('Reject');\nvar PromiseMixin = (_PromiseMixin = {}, _defineProperty(_PromiseMixin, _Mixin.Mixin.Constructor, function () {\n  var _this = this;\n\n  this[_Promise] = new Promise(function (accept, reject) {\n    _this[Accept] = accept;\n    _this[Reject] = reject;\n  });\n}), _defineProperty(_PromiseMixin, \"then\", function then() {\n  var _this$_Promise;\n\n  return (_this$_Promise = this[_Promise]).then.apply(_this$_Promise, arguments);\n}), _defineProperty(_PromiseMixin, \"catch\", function _catch() {\n  var _this$_Promise2;\n\n  return (_this$_Promise2 = this[_Promise])[\"catch\"].apply(_this$_Promise2, arguments);\n}), _defineProperty(_PromiseMixin, \"finally\", function _finally() {\n  var _this$_Promise3;\n\n  return (_this$_Promise3 = this[_Promise])[\"finally\"].apply(_this$_Promise3, arguments);\n}), _PromiseMixin);\nexports.PromiseMixin = PromiseMixin;\nObject.defineProperty(PromiseMixin, 'Reject', {\n  value: Reject\n});\nObject.defineProperty(PromiseMixin, 'Accept', {\n  value: Accept\n});\n  })();\n});","\nrequire.register(\"curvature/model/Database.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Database = void 0;\n\nvar _Bindable = require(\"../base/Bindable\");\n\nvar _Mixin = require(\"../base/Mixin\");\n\nvar _EventTargetMixin = require(\"../mixin/EventTargetMixin\");\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar BeforeWrite = Symbol('BeforeWrite');\nvar AfterWrite = Symbol('AfterWrite');\nvar BeforeInsert = Symbol('BeforeInsert');\nvar AfterInsert = Symbol('AfterInsert');\nvar BeforeUpdate = Symbol('BeforeUpdate');\nvar AfterUpdate = Symbol('AfterUpdate');\nvar BeforeRead = Symbol('BeforeRead');\nvar AfterRead = Symbol('AfterRead');\nvar PrimaryKey = Symbol('PrimaryKey');\nvar Connection = Symbol('Connection');\nvar Instances = Symbol('Instances');\nvar HighWater = Symbol('HighWater');\nvar Metadata = Symbol('Metadata');\nvar Timers = Symbol('Timers');\nvar Target = Symbol('Target');\nvar Store = Symbol('Store');\nvar Fetch = Symbol('Each');\nvar Name = Symbol('Name');\nvar Bank = Symbol('Bank');\n\nvar Database = /*#__PURE__*/function (_Mixin$with) {\n  _inherits(Database, _Mixin$with);\n\n  var _super = _createSuper(Database);\n\n  function Database(connection) {\n    var _this;\n\n    _classCallCheck(this, Database);\n\n    _this = _super.call(this);\n    Object.defineProperty(_assertThisInitialized(_this), Connection, {\n      value: connection\n    });\n    Object.defineProperty(_assertThisInitialized(_this), Name, {\n      value: connection.name\n    });\n    Object.defineProperty(_assertThisInitialized(_this), Timers, {\n      value: {}\n    });\n    Object.defineProperty(_assertThisInitialized(_this), Metadata, {\n      value: {}\n    });\n    Object.defineProperty(_assertThisInitialized(_this), Bank, {\n      value: {}\n    });\n    return _this;\n  }\n\n  _createClass(Database, [{\n    key: \"select\",\n    value: function select(_ref) {\n      var _this2 = this;\n\n      var store = _ref.store,\n          index = _ref.index,\n          _ref$range = _ref.range,\n          range = _ref$range === void 0 ? null : _ref$range,\n          _ref$direction = _ref.direction,\n          direction = _ref$direction === void 0 ? 'next' : _ref$direction,\n          _ref$limit = _ref.limit,\n          limit = _ref$limit === void 0 ? 0 : _ref$limit,\n          _ref$offset = _ref.offset,\n          offset = _ref$offset === void 0 ? 0 : _ref$offset,\n          _ref$type = _ref.type,\n          type = _ref$type === void 0 ? false : _ref$type,\n          _ref$origin = _ref.origin,\n          origin = _ref$origin === void 0 ? undefined : _ref$origin;\n      var t = this[Connection].transaction(store, \"readonly\");\n      var s = t.objectStore(store);\n      var i = index ? s.index(index) : s;\n      return {\n        each: this[Fetch](type, i, direction, range, limit, offset, origin),\n        one: this[Fetch](type, i, direction, range, 1, offset, origin),\n        then: function then(c) {\n          return _this2[Fetch](type, i, direction, range, limit, offset, origin)(function (e) {\n            return e;\n          }).then(c);\n        }\n      };\n    }\n  }, {\n    key: \"insert\",\n    value: function insert(storeName, record) {\n      var _this3 = this;\n\n      var origin = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      return new Promise(function (accept, reject) {\n        _this3[Bank][storeName] = _this3[Bank][storeName] || {};\n\n        var trans = _this3[Connection].transaction([storeName], 'readwrite');\n\n        var store = trans.objectStore(storeName);\n        var bank = _this3[Bank][storeName];\n        record = _Bindable.Bindable.make(record);\n        var detail = {\n          database: _this3[Name],\n          record: record,\n          store: storeName,\n          type: 'write',\n          subType: 'insert',\n          origin: origin\n        };\n        var beforeWriteResult = record[Database.BeforeWrite] ? record[Database.BeforeWrite](detail) : null;\n        var beforeInsertResult = record[Database.BeforeInsert] ? record[Database.BeforeInsert](detail) : null;\n        var request = store.add(Object.assign({}, _Bindable.Bindable.shuck(record)));\n\n        if (beforeWriteResult === false || beforeInsertResult === false) {\n          return;\n        }\n\n        request.onerror = function (error) {\n          _this3.dispatchEvent(new CustomEvent('writeError', {\n            detail: detail\n          }));\n\n          reject(error);\n        };\n\n        request.onsuccess = function (event) {\n          var pk = event.target.result;\n          bank[pk] = record;\n          var cancelable = true;\n          detail.key = Database.getPrimaryKey(record);\n\n          var eventResult = _this3.dispatchEvent(new CustomEvent('write', {\n            cancelable: cancelable,\n            detail: detail\n          }));\n\n          if (eventResult) {\n            record[PrimaryKey] = Symbol[\"for\"](pk);\n\n            if (!_this3[Metadata][storeName]) {\n              _this3[Metadata][storeName] = _this3.getStoreMeta(storeName, 'store', {});\n            }\n\n            if (_this3[Metadata][storeName]) {\n              var currentHighMark = _this3.checkHighWaterMark(storeName, record);\n\n              var currentLowMark = _this3.checkLowWaterMark(storeName, record);\n\n              var metadata = _this3[Metadata][storeName];\n              var recordMark = record[metadata.highWater];\n\n              if (origin.setHighWater && currentHighMark < recordMark) {\n                _this3.setHighWaterMark(storeName, record, origin, 'insert');\n              }\n\n              if (origin.setLowWater && currentLowMark > recordMark) {\n                _this3.setLowWaterMark(storeName, record, origin, 'insert');\n              }\n            }\n\n            trans.commit && trans.commit();\n            record[Database.AfterInsert] && record[Database.AfterInsert](detail);\n            record[Database.AfterWrite] && record[Database.AfterWrite](detail);\n          } else {\n            trans.abort();\n          }\n\n          accept(record);\n        };\n      });\n    }\n  }, {\n    key: \"update\",\n    value: function update(storeName, record) {\n      var _this4 = this;\n\n      var origin = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n      if (!record[PrimaryKey]) {\n        throw Error('Value provided is not a DB record!');\n      }\n\n      return new Promise(function (accept, reject) {\n        var trans = _this4[Connection].transaction([storeName], 'readwrite');\n\n        var store = trans.objectStore(storeName);\n        var detail = {\n          database: _this4[Name],\n          key: Database.getPrimaryKey(record),\n          record: record,\n          store: storeName,\n          type: 'write',\n          subType: 'update',\n          origin: origin\n        };\n        record[Database.AfterInsert] && record[Database.AfterInsert](detail);\n        record[Database.AfterWrite] && record[Database.AfterWrite](detail);\n        var beforeWriteResult = record[Database.BeforeWrite] ? record[Database.BeforeWrite](detail) : null;\n        var beforeUpdateResult = record[Database.BeforeUpdate] ? record[Database.BeforeUpdate](detail) : null;\n\n        if (beforeWriteResult === false || beforeUpdateResult === false) {\n          return;\n        }\n\n        var request = store.put(Object.assign({}, _Bindable.Bindable.shuck(record)));\n\n        request.onerror = function (error) {\n          _this4.dispatchEvent(new CustomEvent('writeError', {\n            detail: detail\n          }));\n\n          reject(error);\n        };\n\n        request.onsuccess = function (event) {\n          var cancelable = true;\n\n          var eventResult = _this4.dispatchEvent(new CustomEvent('write', {\n            cancelable: cancelable,\n            detail: detail\n          }));\n\n          if (eventResult) {\n            if (!_this4[Metadata][storeName]) {\n              _this4[Metadata][storeName] = _this4.getStoreMeta(storeName, 'store', {});\n            }\n\n            if (_this4[Metadata][storeName]) {\n              var currentHighMark = _this4.checkHighWaterMark(storeName, record);\n\n              var currentLowMark = _this4.checkLowWaterMark(storeName, record);\n\n              var metadata = _this4[Metadata][storeName];\n              var recordMark = record[metadata.highWater];\n\n              if (origin.setHighWater && currentHighMark < recordMark) {\n                _this4.setHighWaterMark(storeName, record, origin, 'insert');\n              }\n\n              if (origin.setLowWater && currentLowMark > recordMark) {\n                _this4.setLowWaterMark(storeName, record, origin, 'insert');\n              }\n            }\n\n            trans.commit && trans.commit();\n          } else {\n            trans.abort();\n          }\n\n          accept(event);\n        };\n      });\n    }\n  }, {\n    key: \"delete\",\n    value: function _delete(storeName, record) {\n      var _this5 = this;\n\n      var origin = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;\n\n      if (!record[PrimaryKey]) {\n        throw Error('Value provided is not a DB record!');\n      }\n\n      return new Promise(function (accept, reject) {\n        var trans = _this5[Connection].transaction([storeName], 'readwrite');\n\n        var store = trans.objectStore(storeName);\n        var detail = {\n          database: _this5[Name],\n          record: record,\n          key: Database.getPrimaryKey(record),\n          store: storeName,\n          type: 'write',\n          subType: 'delete',\n          origin: origin\n        };\n        var beforeDeleteResult = record[Database.beforeDelete] ? record[Database.beforeDelete](detail) : null;\n\n        if (beforeDeleteResult === false) {\n          return;\n        }\n\n        var request = store[\"delete\"](Number(record[PrimaryKey].description));\n        record[PrimaryKey] = undefined;\n        record[Database.AfterDelete] && record[Database.AfterDelete](detail);\n\n        request.onerror = function (error) {\n          detail.original = error;\n          var deleteEvent = new CustomEvent('writeError', {\n            detail: detail\n          });\n\n          _this5.dispatchEvent(deleteEvent);\n\n          reject(error);\n        };\n\n        request.onsuccess = function (event) {\n          detail.original = event;\n          var writeEvent = new CustomEvent('write', {\n            detail: detail\n          });\n\n          _this5.dispatchEvent(writeEvent);\n\n          trans.commit && trans.commit();\n          accept(writeEvent);\n        };\n      });\n    }\n  }, {\n    key: \"clear\",\n    value: function clear(storeName) {\n      var _this6 = this;\n\n      return new Promise(function (accept, reject) {\n        var trans = _this6[Connection].transaction([storeName], 'readwrite');\n\n        var store = trans.objectStore(storeName);\n        var request = store.clear();\n        var detail = {\n          database: _this6[Name],\n          store: storeName,\n          type: 'write',\n          subType: 'clear',\n          origin: origin\n        };\n\n        request.onerror = function (error) {\n          detail.original = error;\n          var deleteEvent = new CustomEvent('writeError', {\n            detail: detail\n          });\n\n          _this6.dispatchEvent(deleteEvent);\n\n          reject(error);\n        };\n\n        request.onsuccess = function (event) {\n          detail.original = event;\n          var writeEvent = new CustomEvent('write', {\n            detail: detail\n          });\n\n          _this6.dispatchEvent(writeEvent);\n\n          trans.commit && trans.commit();\n          accept(writeEvent);\n        };\n      });\n    }\n  }, {\n    key: \"listStores\",\n    value: function listStores() {\n      return _toConsumableArray(this[Connection].objectStoreNames);\n    }\n  }, {\n    key: \"listIndexes\",\n    value: function listIndexes(storeName) {\n      var trans = this[Connection].transaction([storeName]);\n      var store = trans.objectStore(storeName);\n      return _toConsumableArray(store.indexNames);\n    }\n  }, {\n    key: Fetch,\n    value: function value(type, index, direction, range, limit, offset, origin) {\n      var _this7 = this;\n\n      return function (callback) {\n        return new Promise(function (accept, reject) {\n          var i = 0;\n          var request = index.openCursor(range, direction);\n          request.addEventListener('success', function (event) {\n            var cursor = event.target.result;\n\n            if (!cursor) {\n              return accept({\n                record: null,\n                result: null,\n                index: i\n              });\n            }\n\n            _this7[Bank][storeName] = _this7[Bank][storeName] || {};\n            var bank = _this7[Bank][storeName];\n            var pk = cursor.primaryKey;\n            var value = type ? type.from(cursor.value) : cursor.value;\n\n            var bindableValue = _Bindable.Bindable.makeBindable(value);\n\n            var detail = {\n              database: _this7[Name],\n              key: Database.getPrimaryKey(bindableValue),\n              record: value,\n              store: index.name,\n              type: 'read',\n              subType: 'select',\n              origin: origin\n            };\n            var beforeReadResult = value[Database.BeforeRead] ? value[Database.BeforeRead](detail) : null;\n\n            if (offset > i++ || beforeReadResult === false) {\n              return cursor[\"continue\"]();\n            }\n\n            if (bank[pk]) {\n              Object.assign(bank[pk], value);\n            } else {\n              value[PrimaryKey] = Symbol[\"for\"](pk);\n              bank[pk] = value;\n            }\n\n            var source = cursor.source;\n            var storeName = source.objectStore ? source.objectStore.name : index.name;\n            bank[pk][Database.AfterRead] && bank[pk][Database.AfterRead](detail);\n            detail.record = value;\n            var cancelable = true;\n\n            var eventResult = _this7.dispatchEvent(new CustomEvent('read', {\n              detail: detail,\n              cancelable: cancelable\n            }));\n\n            if (eventResult) {\n              var record = type ? type.from(bank[pk]) : bank[pk];\n              record[PrimaryKey] = Symbol[\"for\"](pk);\n              var result = callback ? callback(record, i) : record;\n\n              if (limit && i - offset >= limit) {\n                offset += limit;\n                return accept({\n                  record: record,\n                  result: result,\n                  index: i\n                });\n              }\n            }\n\n            cursor[\"continue\"]();\n          });\n        });\n      };\n    }\n  }, {\n    key: \"setStoreMeta\",\n    value: function setStoreMeta(storeName, key, value) {\n      localStorage.setItem(\"::::cvdb::\".concat(storeName, \"::\").concat(key), JSON.stringify(value));\n    }\n  }, {\n    key: \"getStoreMeta\",\n    value: function getStoreMeta(storeName, key) {\n      var notFound = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n      var source = localStorage.getItem(\"::::cvdb::\".concat(storeName, \"::\").concat(key));\n      var value = source !== null ? JSON.parse(source) : notFound;\n\n      if (value === null) {\n        return notFound;\n      }\n\n      return value;\n    }\n  }, {\n    key: \"createObjectStore\",\n    value: function createObjectStore(storeName, options) {\n      var eventLog = this[Connection].createObjectStore(storeName, options);\n      this.setStoreMeta(storeName, 'store', options);\n      return eventLog;\n    }\n  }, {\n    key: \"deleteObjectStore\",\n    value: function deleteObjectStore(storeName) {\n      return this[Connection].deleteObjectStore(storeName);\n    }\n  }, {\n    key: \"checkHighWaterMark\",\n    value: function checkHighWaterMark(storeName, record) {\n      var origin = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;\n      var currentMark = this.getStoreMeta(storeName, 'highWater', 0);\n      return currentMark;\n    }\n  }, {\n    key: \"setHighWaterMark\",\n    value: function setHighWaterMark(storeName, record) {\n      var origin = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;\n      var subType = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : undefined;\n      var metadata = this[Metadata][storeName];\n      var recordMark = record[metadata.highWater];\n      var currentMark = this.getStoreMeta(storeName, 'highWater', 0);\n      this.setStoreMeta(storeName, 'highWater', recordMark);\n      this.dispatchEvent(new CustomEvent('highWaterMoved', {\n        detail: {\n          database: this[Name],\n          record: record,\n          store: storeName,\n          type: 'highWaterMoved',\n          subType: subType,\n          origin: origin,\n          oldValue: currentMark,\n          value: recordMark\n        }\n      }));\n    }\n  }, {\n    key: \"checkLowWaterMark\",\n    value: function checkLowWaterMark(storeName, record) {\n      var origin = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;\n      var currentMark = this.getStoreMeta(storeName, 'lowWater', Infinity);\n      return currentMark;\n    }\n  }, {\n    key: \"setLowWaterMark\",\n    value: function setLowWaterMark(storeName, record) {\n      var origin = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;\n      var subType = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : undefined;\n      var metadata = this[Metadata][storeName];\n      var recordMark = record[metadata.highWater];\n      var currentMark = this.getStoreMeta(storeName, 'lowWater', null);\n      this.setStoreMeta(storeName, 'lowWater', recordMark);\n      this.dispatchEvent(new CustomEvent('lowWaterMoved', {\n        detail: {\n          database: this[Name],\n          record: record,\n          store: storeName,\n          type: 'lowWaterMoved',\n          subType: subType,\n          origin: origin,\n          oldValue: currentMark,\n          value: recordMark\n        }\n      }));\n    }\n  }], [{\n    key: \"open\",\n    value: function open(dbName) {\n      var _this8 = this;\n\n      var version = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      if (this[Instances][dbName]) {\n        return Promise.resolve(this[Instances][dbName]);\n      }\n\n      return new Promise(function (accept, reject) {\n        var request = indexedDB.open(dbName, version);\n\n        request.onerror = function (error) {\n          Database.dispatchEvent(new CustomEvent('error', {\n            detail: {\n              database: _this8[Name],\n              error: error,\n              store: undefined,\n              type: 'read',\n              subType: 'select'\n            }\n          }));\n          reject(error);\n        };\n\n        request.onsuccess = function (event) {\n          var instance = new _this8(event.target.result);\n          _this8[Instances][dbName] = instance;\n          accept(instance);\n        };\n\n        request.onupgradeneeded = function (event) {\n          var connection = event.target.result;\n          connection.addEventListener('error', function (error) {\n            return console.error(error);\n          });\n          var instance = new _this8(connection);\n\n          for (var v = event.oldVersion + 1; v <= version; v += 1) {\n            instance['_version_' + v](connection);\n          }\n\n          _this8[Instances][dbName] = instance;\n        };\n      });\n    }\n  }, {\n    key: \"getPrimaryKey\",\n    value: function getPrimaryKey(record) {\n      return record[PrimaryKey] ? record[PrimaryKey].description : null;\n    }\n  }, {\n    key: \"destroyDatabase\",\n    value: function destroyDatabase() {\n      var _this9 = this;\n\n      return new Promise(function (accept, reject) {\n        var request = indexedDB[\"delete\"](dbName);\n\n        request.onerror = function (error) {\n          Database.dispatchEvent(new CustomEvent('error', {\n            detail: {\n              database: dbName,\n              error: error,\n              type: 'destroy'\n            }\n          }));\n          reject(error);\n        };\n\n        request.onsuccess = function (event) {\n          delete _this9[Instances][dbName];\n          accept(dbName);\n        };\n      });\n    }\n  }]);\n\n  return Database;\n}(_Mixin.Mixin[\"with\"](_EventTargetMixin.EventTargetMixin));\n\nexports.Database = Database;\nObject.defineProperty(Database, Instances, {\n  value: []\n});\nObject.defineProperty(Database, Target, {\n  value: document.createDocumentFragment()\n});\nObject.defineProperty(Database, 'BeforeWrite', {\n  value: BeforeWrite\n});\nObject.defineProperty(Database, 'AfterWrite', {\n  value: AfterWrite\n});\nObject.defineProperty(Database, 'BeforeInsert', {\n  value: BeforeInsert\n});\nObject.defineProperty(Database, 'AfterInsert', {\n  value: AfterInsert\n});\nObject.defineProperty(Database, 'BeforeUpdate', {\n  value: BeforeUpdate\n});\nObject.defineProperty(Database, 'AfterUpdate', {\n  value: AfterUpdate\n});\nObject.defineProperty(Database, 'BeforeRead', {\n  value: BeforeRead\n});\nObject.defineProperty(Database, 'AfterRead', {\n  value: AfterRead\n});\n\nvar _loop = function _loop(method) {\n  Object.defineProperty(Database, method, {\n    value: function value() {\n      var _Database$Target;\n\n      return (_Database$Target = Database[Target])[method].apply(_Database$Target, arguments);\n    }\n  });\n};\n\nfor (var method in ['addEventListener', 'removeEventListener', 'dispatchEvent']) {\n  _loop(method);\n}\n  })();\n});","\nrequire.register(\"curvature/model/Model.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Model = void 0;\n\nvar _Cache = require(\"../base/Cache\");\n\nvar _Bindable = require(\"../base/Bindable\");\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar Saved = Symbol('Saved');\nvar Changed = Symbol('Changed');\n\nvar Model = /*#__PURE__*/function () {\n  _createClass(Model, null, [{\n    key: \"keyProps\",\n    value: function keyProps() {\n      return ['id', 'class'];\n    }\n  }]);\n\n  function Model() {\n    _classCallCheck(this, Model);\n\n    Object.defineProperty(this, Changed, {\n      value: _Bindable.Bindable.make({})\n    });\n    Object.defineProperty(this, Saved, {\n      writable: true,\n      value: false\n    }); // return Bindable.makeBindable(this);\n  }\n\n  _createClass(Model, [{\n    key: \"consume\",\n    value: function consume(skeleton) {\n      var _this = this;\n\n      var override = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      var keyProps = this.__proto__.constructor.keyProps();\n\n      var setProp = function setProp(property, value) {\n        if (value && _typeof(value) === 'object' && value.__proto__.constructor.keyProps) {\n          var subKeyProps = value.__proto__.constructor.keyProps();\n\n          var propCacheKey = subKeyProps.map(function (prop) {\n            return value[prop];\n          }).join('::');\n          var bucket = 'models-by-type-and-publicId';\n\n          var propCached = _Cache.Cache.load(propCacheKey, false, bucket);\n\n          if (propCached) {\n            propCached.consume(value);\n            value = propCached;\n          }\n        }\n\n        _this[property] = value;\n      };\n\n      for (var property in skeleton) {\n        if (!override && this[Changed][property]) {\n          continue;\n        }\n\n        if (keyProps.includes(property)) {\n          continue;\n        }\n\n        setProp(property, skeleton[property]);\n      }\n    }\n  }, {\n    key: \"changed\",\n    value: function changed() {\n      this[Saved] = false;\n    }\n  }, {\n    key: \"stored\",\n    value: function stored() {\n      for (var property in this[Changed]) {\n        this[Changed][property] = false;\n      }\n\n      this[Saved] = true;\n    }\n  }, {\n    key: \"isSaved\",\n    value: function isSaved() {\n      return this[Saved];\n    }\n  }], [{\n    key: \"from\",\n    value: function from(skeleton) {\n      var _this2 = this;\n\n      var keyProps = this.keyProps();\n      var cacheKey = keyProps.map(function (prop) {\n        return skeleton[prop];\n      }).join('::');\n      var bucket = 'models-by-type-and-publicId';\n\n      var cached = _Cache.Cache.load(cacheKey, false, bucket);\n\n      var instance = cached ? cached : _Bindable.Bindable.makeBindable(new this());\n\n      var _iterator = _createForOfIteratorHelper(keyProps),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var _ref, _instance$keyProp;\n\n          var keyProp = _step.value;\n          instance[keyProp] = (_ref = (_instance$keyProp = instance[keyProp]) !== null && _instance$keyProp !== void 0 ? _instance$keyProp : skeleton[keyProp]) !== null && _ref !== void 0 ? _ref : null;\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      instance.consume(skeleton);\n\n      _Cache.Cache.store(cacheKey, instance, 0, bucket);\n\n      if (!cached) {\n        var changed = false;\n        instance.bindTo(function (v, k, t) {\n          if (_typeof(k) === 'symbol') {\n            return;\n          }\n\n          if (v === t[k]) {\n            return;\n          }\n\n          instance[Changed][k] = changed;\n          instance[Saved] = !!(changed ? false : _this2[Saved]);\n        });\n        changed = true;\n      }\n\n      return instance;\n    }\n  }]);\n\n  return Model;\n}();\n\nexports.Model = Model;\nObject.defineProperty(Model, 'Saved', {\n  value: Saved\n});\nObject.defineProperty(Model, 'Changed', {\n  value: Changed\n});\n  })();\n});","\nrequire.register(\"pokemon-parser/BitArray.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"pokemon-parser\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.BitArray = void 0;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar BitArray = /*#__PURE__*/function () {\n  function BitArray() {\n    var buffer = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : undefined;\n\n    _classCallCheck(this, BitArray);\n\n    if (buffer === undefined) {\n      buffer = [];\n    }\n\n    if (typeof buffer === 'number') {\n      buffer = Array.from(Array(buffer));\n    }\n\n    if (Array.isArray(buffer)) {\n      buffer = new Uint8Array(buffer);\n    }\n\n    if (buffer instanceof BitArray) {\n      buffer = buffer.buffer;\n    }\n\n    this.buffer = buffer;\n    this.done = false;\n    this.i = this.j = 0;\n  }\n\n  _createClass(BitArray, [{\n    key: \"clone\",\n    value: function clone() {\n      return new this.constructor(this);\n    }\n  }, {\n    key: \"get\",\n    value: function get(address) {\n      var byteAddress = Math.floor(address / 8);\n      var bitOffset = address % 8;\n      var getMask = 0x1 << bitOffset; // console.log(getMask.toString(2), this.buffer[ byteAddress ].toString(2));\n\n      return (getMask & this.buffer[byteAddress]) >> bitOffset;\n    } // read()\n    // {\n    // \tyield 0;\n    // \tyield 1;\n    // \tyield 2;\n    // \tyield 3;\n    // }\n\n  }, {\n    key: \"set\",\n    value: function set(address, value) {\n      var byteAddress = Math.floor(address / 8);\n      var bitOffset = address % 8;\n      var setMask = value ? 0x1 << bitOffset : ~(0x1 << bitOffset);\n\n      if (value) {\n        this.buffer[byteAddress] |= setMask;\n      } else {\n        this.buffer[byteAddress] &= setMask;\n      }\n    }\n  }, {\n    key: \"next\",\n    value: function next() {\n      var x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n      var result = 0;\n      var count = x;\n      var _byte = this.buffer[this.i];\n\n      while (x-- > 0) {\n        var bit = _byte >> 7 - this.j & 0x1; // console.log('Got, %d from %s.%d', bit, byte.toString(2).padStart(8,'0'), this.j);\n\n        this.j++;\n\n        if (this.j > 7) {\n          this.j = 0;\n          _byte = this.buffer[++this.i];\n        }\n\n        if (this.i >= this.buffer.length) {\n          this.done = true;\n        }\n\n        result <<= 1;\n        result |= bit;\n      }\n\n      return result;\n    }\n  }, {\n    key: \"length\",\n    get: function get() {\n      return this.buffer.length * 8;\n    }\n  }]);\n\n  return BitArray;\n}();\n\nexports.BitArray = BitArray;\n  })();\n});","export class Format\n{\n\ttileWidth  = 1;\n\ttileHeight = 1;\n\toutputPos  = 0;\n\tinputPos   = 0;\n\tdepth      = 1;\n\n\tconstructor(inputBuffer, outputBuffer, width)\n\t{\n\t\tthis.inputBuffer  = inputBuffer;\n\t\tthis.outputBuffer = outputBuffer;\n\n\t\tthis.width = width;\n\t}\n}\n","import { Mixin }  from 'curvature/base/Mixin';\nimport { View }   from 'curvature/base/View';\n\nimport { Panelable } from './panel/Panelable';\n\nexport class Processor extends View\n{\n\tconstructor(args,parent)\n\t{\n\t\tsuper(args, parent);\n\n\t\tObject.assign(this.panel.args, {widget:  this});\n\n\t\tthis.args.bindTo('input', v => {\n\t\t\tif(!v)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.args.inputName = v.args.input ? v.args.input.name : v.args.title;\n\t\t\tthis.args.offset    = Number(v.args.firstByte);\n\t\t\tthis.args.length    = Number(v.args.buffer.length) - this.args.offset;\n\t\t});\n\t}\n}\n\nMixin.to(Processor, Panelable);\n","import { Mixin }  from 'curvature/base/Mixin';\nimport { View }   from 'curvature/base/View';\n\nimport { Invert } from '../processor/Invert';\nimport { Menu }   from '../menu/Menu';\n\nimport { Panelable } from '../panel/Panelable';\nimport { Panel }     from '../panel/Panel';\n\nimport { BytePerPixel } from '../format/BytePerPixel';\nimport { BitPerPixel  } from '../format/BitPerPixel';\n\nimport { Gameboy1bpp } from '../format/Gameboy1bpp';\nimport { Gameboy2bpp } from '../format/Gameboy2bpp';\n\nimport { Gameboy1bppCol } from '../format/Gameboy1bppCol';\n\nexport class Canvas extends View\n{\n\ttemplate = require('./canvas.html');\n\n\tconstructor(args, parent)\n\t{\n\t\tsuper(args, parent);\n\n\t\tthis.args.height = args.height || 128;\n\t\tthis.args.width  = args.width  || 128;\n\t\tthis.args.scale  = args.scale  || 2;\n\n\t\tthis.args.tileArea = 1;\n\t\tthis.args.offset   = 0;\n\t\tthis.scrollDelta   = 1;\n\n\t\tthis.args.decoder  = args.decoder || 'gameboy';\n\t\tthis.args.showSettings = false;\n\n\t\tthis.args.input = args.input || false;\n\n\t\tthis.args.firstByte = '0000';\n\n\t\tObject.assign(this.panel.args, {\n\t\t\twidget:  this\n\t\t\t, title: args.title || args.input && args.input.name || 'Canvas'\n\t\t});\n\t}\n\n\tonRendered()\n\t{\n\t\tconst canvasStyle = {\n\t\t\t'--scale':    this.args.scale\n\t\t\t, '--width':  this.args.width\n\t\t\t, '--height': this.args.height\n\t\t};\n\n\t\tthis.args.bindTo('offset', (v,k) => {\n\t\t\tif(!this.args.buffer || !this.tags.canvas)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.drawDots(this.args.buffer);\n\t\t}, {wait: 0});\n\n\t\tthis.args.bindTo('scale', (v,k) => {\n\t\t\tif(this.tags.canvas)\n\t\t\t{\n\t\t\t\tcanvasStyle['--scale'] = v;\n\t\t\t\tthis.tags.canvas.style(canvasStyle);\n\t\t\t}\n\n\t\t\tif(this.args.buffer)\n\t\t\t{\n\t\t\t\tthis.drawDots(this.args.buffer);\n\t\t\t}\n\t\t}, {wait: 0});\n\n\t\tthis.args.bindTo('width', (v,k) => {\n\n\t\t\tv = Number(v);\n\n\t\t\tif(this.tags.canvas)\n\t\t\t{\n\t\t\t\tcanvasStyle['--width'] = v;\n\t\t\t\tthis.tags.canvas.width = v;\n\t\t\t\tthis.tags.canvas.style(canvasStyle);\n\t\t\t}\n\n\t\t\tif(this.args.buffer)\n\t\t\t{\n\t\t\t\tthis.drawDots(this.args.buffer);\n\t\t\t}\n\t\t}, {wait: 0});\n\n\t\tthis.args.bindTo('height', (v,k) => {\n\n\t\t\tv = Number(v);\n\n\t\t\tif(this.tags.canvas)\n\t\t\t{\n\t\t\t\tcanvasStyle['--height'] = v;\n\t\t\t\tthis.tags.canvas.height = v;\n\t\t\t\tthis.tags.canvas.style(canvasStyle);\n\t\t\t}\n\n\t\t\tif(this.args.buffer)\n\t\t\t{\n\t\t\t\tthis.drawDots(this.args.buffer);\n\t\t\t}\n\n\t\t}, {wait: 0});\n\n\t\tthis.args.bindTo('input', v => {\n\t\t\tif(!v)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.args.filename = v.name;\n\n\t\t\tthis.args.buffer = new Uint8Array(v.buffer);\n\n\t\t\tthis.onTimeout(0, () => {\n\t\t\t\tthis.drawDots(this.args.buffer);\n\t\t\t});\n\t\t});\n\n\t\tthis.args.bindTo('decoder', v => {\n\n\t\t\tif(!this.args.buffer)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.drawDots(this.args.buffer);\n\n\t\t}, {frame: true});\n\t}\n\n\twheel(event)\n\t{\n\t\tevent.preventDefault();\n\n\t\tif(event.deltaY < 1 && this.args.offset > 0)\n\t\t{\n\t\t\tthis.args.offset -= this.args.width * this.depth;\n\t\t}\n\t\telse if(event.deltaY > 1)\n\t\t{\n\t\t\tthis.args.offset += this.args.width * this.depth;\n\t\t}\n\n\t\tif(0 > this.args.offset)\n\t\t{\n\t\t\tthis.args.offset = 0;\n\t\t}\n\t}\n\n\tkeydown(event)\n\t{\n\t\tif(event.key === 'PageDown')\n\t\t{\n\t\t\tthis.args.offset += this.args.width * this.args.height * (this.depth / 8);\n\t\t\tthis.drawDots();\n\t\t}\n\t\telse if(event.key === 'PageUp')\n\t\t{\n\t\t\tthis.args.offset -= this.args.width * this.args.height * (this.depth / 8);\n\n\t\t\tif(this.args.offset < 0)\n\t\t\t{\n\t\t\t\tthis.args.offset = 0;\n\t\t\t}\n\n\t\t\tthis.drawDots();\n\t\t}\n\t\telse if(event.key === 'ArrowDown')\n\t\t{\n\t\t\tif(event.ctrlKey)\n\t\t\t{\n\t\t\t\tthis.args.offset += this.depth;\n\t\t\t}\n\t\t\telse if(event.shiftKey)\n\t\t\t{\n\t\t\t\tthis.args.offset += this.args.width  * this.depth * 2;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.args.offset += this.args.width * this.depth;\n\t\t\t}\n\n\t\t\tthis.drawDots();\n\t\t}\n\t\telse if(event.key === 'ArrowUp')\n\t\t{\n\t\t\tif(event.ctrlKey)\n\t\t\t{\n\t\t\t\tthis.args.offset -= this.depth;\n\t\t\t}\n\t\t\telse if(event.shiftKey)\n\t\t\t{\n\t\t\t\tthis.args.offset -= this.args.width  * this.depth * 2;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.args.offset -= this.args.width * this.depth;\n\t\t\t}\n\n\t\t\tif(this.args.offset < 0)\n\t\t\t{\n\t\t\t\tthis.args.offset = 0;\n\t\t\t}\n\t\t\tthis.drawDots();\n\t\t}\n\t\telse if(event.key === 'ArrowRight')\n\t\t{\n\t\t\tif(event.ctrlKey)\n\t\t\t{\n\t\t\t\tthis.args.offset++;\n\t\t\t}\n\t\t\telse if(event.shiftKey)\n\t\t\t{\n\t\t\t\tthis.args.offset += this.tileArea * (this.depth / 8) * 2;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.args.offset += this.tileArea * (this.depth / 8);\n\t\t\t}\n\n\t\t\tthis.drawDots();\n\t\t}\n\t\telse if(event.key === 'ArrowLeft')\n\t\t{\n\t\t\tif(event.ctrlKey)\n\t\t\t{\n\t\t\t\tthis.args.offset--;\n\t\t\t}\n\t\t\telse if(event.shiftKey)\n\t\t\t{\n\t\t\t\tthis.args.offset -= this.tileArea * (this.depth / 8) * 2;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.args.offset -= this.tileArea * (this.depth / 8);\n\t\t\t}\n\n\t\t\tif(this.args.offset < 0)\n\t\t\t{\n\t\t\t\tthis.args.offset = 0;\n\t\t\t}\n\t\t\tthis.drawDots();\n\t\t}\n\t\telse if(event.key === 'Home')\n\t\t{\n\t\t\tthis.args.offset = 0;\n\t\t\tthis.drawDots();\n\t\t}\n\t\telse if(event.key === 'End')\n\t\t{\n\t\t\tthis.args.offset = this.args.buffer.length;\n\t\t\tthis.drawDots();\n\t\t}\n\t}\n\n\tdrawDots(bytes = undefined)\n\t{\n\t\tif(this.willDraw)\n\t\t{\n\t\t\tcancelAnimationFrame(this.willDraw);\n\t\t}\n\n\t\tthis.willDraw = requestAnimationFrame(()=>{\n\t\t\tif(bytes === undefined)\n\t\t\t{\n\t\t\t\tbytes = this.args.buffer;\n\t\t\t}\n\n\t\t\tconst canvas  = this.tags.canvas;\n\t\t\tconst context = canvas.getContext('2d');\n\n\t\t\trequestAnimationFrame(()=>context.clearRect(0, 0, canvas.width, canvas.height));\n\n\t\t\tlet formatter = null;\n\n\t\t\tswitch(this.args.decoder)\n\t\t\t{\n\t\t\t\tcase 'bytes':\n\t\t\t\t\tformatter = BytePerPixel;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'bits':\n\t\t\t\t\tformatter = BitPerPixel;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'gameboy':\n\t\t\t\t\tformatter = Gameboy2bpp;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'gameboy-1bit':\n\t\t\t\t\tformatter = Gameboy1bpp;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'gameboy-1bit-cols':\n\t\t\t\t\tformatter = Gameboy1bppCol;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tthis.format(formatter, bytes)\n\t\t});\n\t};\n\n\tformat(formatter, bytes)\n\t{\n\t\tconst canvas  = this.tags.canvas;\n\t\tconst context = canvas.getContext('2d');\n\n\t\tconst inputBuffer  = bytes.slice(this.args.offset);\n\t\tconst output       = context.createImageData(this.args.width, this.args.height);\n\t\tconst outputBuffer = output.data;\n\n\t\tconst pixels = new formatter(\n\t\t\tinputBuffer\n\t\t\t, outputBuffer\n\t\t\t, this.args.width\n\t\t);\n\n\t\tthis.tileArea = pixels.tileWidth * pixels.tileHeight;\n\t\tthis.depth    = pixels.depth;\n\n\t\twhile( pixels.next() );\n\n\t\trequestAnimationFrame(\n\t\t\t()=>context.putImageData(output, 0, 0)\n\t\t);\n\t}\n\n\ttoggleSettings()\n\t{\n\t\tthis.args.showSettings = !this.args.showSettings;\n\t}\n\n\tzoomIn()\n\t{\n\t\tthis.args.scale++;\n\t}\n\n\tzoomOut()\n\t{\n\t\tthis.args.scale--;\n\t}\n\n\trun(event)\n\t{\n\t\tconst rootPanel = this.args.panel;\n\n\t\tconst input = this;\n\t\tconst menu  = new Menu({input, panel: rootPanel}, this);\n\n\t\trootPanel.panels.add(menu.panel);\n\t}\n\n\thex(x)\n\t{\n\t\treturn Number(x).toString(16).padStart(4, '0');\n\t}\n}\n\nMixin.to(Canvas, Panelable);\n","module.exports = \"<div data-module = \\\"canvas [[module]]\\\">\\n\\n\\t<label cv-if = \\\"buffer\\\">\\n\\t\\t<div>\\n\\t\\t\\t<div class = \\\"icon inline-icon gear-icon\\\" cv-on = \\\"click:toggleSettings(event)\\\"></div>\\n\\t\\t\\t<div class = \\\"icon inline-icon save-icon\\\"cv-on = \\\"click:save(event)\\\"></div>\\n\\t\\t\\t<div class = \\\"icon inline-icon run-icon\\\" cv-on = \\\"click:run(event)\\\"></div>\\n\\t\\t\\t<!-- <div class = \\\"icon inline-icon folder-icon\\\"></div> -->\\n\\t\\t</div>\\n\\t</label>\\n\\n\\t<span cv-if = \\\"showSettings\\\">\\n\\n\\t\\t<label cv-if = \\\"buffer\\\">\\n\\t\\t\\t<p>width</p>\\n\\t\\t\\t<input cv-bind = \\\"width\\\" type = \\\"number\\\" min = \\\"0\\\">\\n\\t\\t</label>\\n\\n\\t\\t<label cv-if = \\\"buffer\\\">\\n\\t\\t\\t<p>height</p>\\n\\t\\t\\t<input cv-bind = \\\"height\\\" type = \\\"number\\\" min = \\\"0\\\">\\n\\t\\t</label>\\n\\n\\t\\t<label cv-if = \\\"buffer\\\">\\n\\t\\t\\t<p>scale</p>\\n\\t\\t\\t<input cv-bind = \\\"scale\\\" type = \\\"number\\\" min = \\\"1\\\">\\n\\t\\t</label>\\n\\n\\t\\t<label cv-if = \\\"buffer\\\">\\n\\t\\t\\t<p>row</p>\\n\\t\\t\\t<input cv-bind = \\\"offset\\\" type = \\\"number\\\" min = \\\"0\\\">\\n\\t\\t</label>\\n\\t</span>\\n\\n\\t<label cv-if = \\\"!buffer\\\">\\n\\t\\t<input type = \\\"file\\\" cv-bind = \\\"input\\\">\\n\\t</label>\\n\\n\\t<label cv-if = \\\"buffer\\\">\\n\\t\\t<p>encoding</p>\\n\\t\\t<select cv-bind = \\\"decoder\\\">\\n\\t\\t\\t<optgroup label = \\\"streams\\\">\\n\\t\\t\\t\\t<!-- <option value = \\\"\\\">32 bit color (R,G,B,A...)*</option> -->\\n\\t\\t\\t\\t<!-- <option value = \\\"\\\">24 bit color (R,G,B...)*</option> -->\\n\\t\\t\\t\\t<!-- <option value = \\\"\\\">16 bit greyscale*</option> -->\\n\\t\\t\\t\\t<option value = \\\"bytes\\\">8 bit greyscale</option>\\n\\t\\t\\t\\t<!-- <option value = \\\"\\\">4 bit greyscale*</option> -->\\n\\t\\t\\t\\t<!-- <option value = \\\"\\\">2 bit greyscale*</option> -->\\n\\t\\t\\t\\t<option value = \\\"bits\\\">1 bit black & white</option>\\n\\t\\t\\t</optgroup>\\n\\t\\t\\t<optgroup label = \\\"tiles\\\">\\n\\t\\t\\t\\t<option value = \\\"gameboy\\\">2 bit tiles (2bpp gameboy)</option>\\n\\t\\t\\t\\t<option value = \\\"gameboy-1bit\\\">1 bit tiles (1bpp gameboy)</option>\\n\\t\\t\\t\\t<option value = \\\"gameboy-1bit-cols\\\">1 bit columns (1bpp gameboy)</option>\\n\\t\\t\\t</optgroup>\\n\\t\\t</select>\\n\\t</label>\\n\\n\\t<label cv-if = \\\"buffer\\\">\\n\\t\\t<p>buffer</p>\\n\\t\\t<div class = \\\"canvas-window\\\">\\n\\t\\t\\t<canvas tabindex = \\\"0\\\" cv-ref = \\\"canvas\\\" cv-on = \\\"wheel(event);keydown(event)\\\"></canvas>\\n\\t\\t\\t<div class = \\\"row\\\">\\n\\t\\t\\t\\t<div><code>0x[[offset|hex]]</code></div>\\n\\t\\t\\t\\t<div class = \\\"right\\\">\\n\\t\\t\\t\\t\\t<div class = \\\"icon inline-icon zoom-out-icon\\\" cv-on = \\\"click:zoomOut(event)\\\"></div>\\n\\t\\t\\t\\t\\t<div class = \\\"icon inline-icon zoom-in-icon\\\" cv-on = \\\"click:zoomIn(event)\\\"></div>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t</div>\\n\\t\\t</div>\\n\\t</label>\\n</div>\\n\"","import { Bindable } from 'curvature/base/Bindable';\n\nimport { View } from 'curvature/base/View';\nimport { Panel } from '../panel/Panel';\nimport { Canvas } from '../canvas/Canvas';\n\nimport { Icon } from './Icon';\nimport { FileModel } from './FileModel';\nimport { FileDatabase } from './FileDatabase';\n\nexport class Drop extends View\n{\n\ttemplate = require('./drop.html');\n\n\tconstructor(args, parent)\n\t{\n\t\tsuper(args, parent);\n\n\t\tthis.args.files = [];\n\n\t\tthis.fileDb = FileDatabase.open('files', 1);\n\n\t\tconst query = {\n\t\t\tstore: 'files'\n\t\t\t, index: 'name'\n\t\t\t, type:  FileModel\n\t\t};\n\n\t\tthis.fileDb.then((db)=> db.select(query).each(file => {\n\t\t\tfile && this.args.files.push(file);\n\t\t\tfile && console.log(file, Bindable.shuck(file));\n\t\t}));\n\t}\n\n\tdrop(event)\n\t{\n\t\tevent.preventDefault();\n\n\t\tconst file   = event.dataTransfer.files[0];\n\t\tconst buffer = file.arrayBuffer();\n\t\tconst fileDb = this.fileDb;\n\n\t\tPromise.all([buffer, fileDb]).then(([buffer, fileDb])=>{\n\n\t\t\tconst query = {\n\t\t\t\tstore: 'files'\n\t\t\t\t, index: 'name'\n\t\t\t\t, range: file.name\n\t\t\t\t, type:  FileModel\n\t\t\t};\n\n\t\t\tconst values = {\n\t\t\t\tname: file.name\n\t\t\t\t, lastModified: file.lastModified\n\t\t\t\t, size: file.size\n\t\t\t\t, type: file.type\n\t\t\t\t, buffer: buffer\n\t\t\t};\n\n\t\t\tfileDb.select(query).one().then(result => {\n\n\t\t\t\tlet record = result.record;\n\n\t\t\t\tif(!record)\n\t\t\t\t{\n\t\t\t\t\trecord = FileModel.from(values);\n\t\t\t\t\tfileDb.insert('files', record);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\trecord.consume(values);\n\t\t\t\t\tfileDb.update('files', record);\n\t\t\t\t}\n\n\t\t\t\tthis.args.files.push(record);\n\n\t\t\t\tthis.openCanvasPanel(record);\n\t\t\t});\n\t\t});\n\t}\n\n\tdragover(event)\n\t{\n\t\tevent.preventDefault();\n\t}\n\n\ticonClicked(event, file)\n\t{\n\t\tthis.openCanvasPanel(file);\n\t}\n\n\topenCanvasPanel(file)\n\t{\n\t\tconst rootPanel = this.args.panel;\n\n\t\tconst canvas = new Canvas({input: file, panel: rootPanel});\n\n\t\trootPanel.panels.add(canvas.panel);\n\t}\n}\n","import { Database } from 'curvature/model/Database';\n\nexport class FileDatabase extends Database\n{\n\t_version_1(database)\n\t{\n\t\tconst fileStore = this.createObjectStore('files', {keyPath: 'name'});\n\n\t\tfileStore.createIndex('name', 'name', {unique: true});\n\t}\n}\n","import { Model } from 'curvature/model/Model';\n\nexport class FileModel extends Model\n{\n\tstatic keyProps(){ return ['name'] }\n\n\tlastModified;\n\tname;\n\tsize;\n\ttype;\n}\n","import { View } from 'curvature/base/View';\n\nexport class Icon extends View\n{\n\ttemplate = require('./icon.html');\n\n\tconstructor(args, parent)\n\t{\n\t\tsuper(args, parent);\n\t}\n}\n","module.exports = \"<div data-module = \\\"file-drop\\\" cv-on = \\\"drop(event);dragover(event)\\\">\\n\\tdrop files here.\\n</div>\\n\\n<div data-module = \\\"file-list\\\" cv-each = \\\"files:file\\\" cv-view = \\\"/file/Icon\\\">\\n\\t<div tabindex = \\\"0\\\" class = \\\"file\\\" cv-on = \\\"dblclick:iconClicked(event, file)\\\">\\n\\t\\t<img src = \\\"/gameboy.ico\\\">\\n\\t\\t<span>[[file.name]]</span>\\n\\t</div>\\n</div>\\n\"","module.exports = \"<div class = \\\"file\\\" tabindex = \\\"0\\\">\\n\\t<img src = \\\"/gameboy.ico\\\">\\n\\t<span>[[file.name]]</span>\\n</div>\\n\"","import { Format } from '../Format';\n\nexport class BitPerPixel extends Format\n{\n\tdepth = 1;\n\n\tnext()\n\t{\n\t\tif(this.inputPos >= this.inputBuffer.length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst byte = this.inputBuffer[this.inputPos++];\n\n\t\tconst bits = [\n\t\t\t(byte & 0b10000000) >> 7\n\t\t\t, (byte & 0b01000000) >> 6\n\t\t\t, (byte & 0b00100000) >> 5\n\t\t\t, (byte & 0b00010000) >> 4\n\t\t\t, (byte & 0b00001000) >> 3\n\t\t\t, (byte & 0b00000100) >> 2\n\t\t\t, (byte & 0b00000010) >> 1\n\t\t\t, (byte & 0b00000001) >> 0\n\t\t];\n\n\t\tfor(const bit of bits)\n\t\t{\n\t\t\tconst address = this.outputPos * 4;\n\n\t\t\tthis.outputBuffer[ address + 0 ] = bit * 255;\n\t\t\tthis.outputBuffer[ address + 1 ] = bit * 255;\n\t\t\tthis.outputBuffer[ address + 2 ] = bit * 255;\n\t\t\tthis.outputBuffer[ address + 3 ] = 255;\n\n\t\t\tthis.outputPos++;\n\t\t}\n\n\t\treturn this.outputPos * 4 < this.outputBuffer.length;\n\t}\n}\n","import { Format } from '../Format';\n\nexport class BytePerPixel extends Format\n{\n\tdepth = 8;\n\n\tnext()\n\t{\n\t\tif(this.inputPos >= this.inputBuffer.length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst byte = this.inputBuffer[this.inputPos++];\n\n\t\tconst address = this.outputPos * 4;\n\n\t\tthis.outputBuffer[ address + 0 ] = byte;\n\t\tthis.outputBuffer[ address + 1 ] = byte;\n\t\tthis.outputBuffer[ address + 2 ] = byte;\n\t\tthis.outputBuffer[ address + 3 ] = 255;\n\n\t\tthis.outputPos++;\n\n\t\treturn address < this.outputBuffer.length;\n\t}\n}\n","import { Format } from '../Format';\n\nexport class Gameboy1bpp extends Format\n{\n\ttileWidth  = 8;\n\ttileHeight = 8;\n\tdepth      = 1;\n\n\tnext()\n\t{\n\t\tif(this.inputPos >= this.inputBuffer.length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst palette  = [\n\t\t\t[0xFF, 0xFF, 0xFF]\n\t\t\t, [0x44, 0x44, 0x44]\n\t\t\t, [0xCC, 0xCC, 0xCC]\n\t\t\t, [0x00, 0x00, 0x00]\n\t\t];\n\n\t\tconst byte = this.inputBuffer[this.inputPos++];\n\n\t\tconst maxTilesX = Math.floor(this.width / this.tileWidth);\n\n\t\tconst bits = [\n\t\t\t(byte & 0b00000001) >> 0\n\t\t\t, (byte & 0b00000010) >> 1\n\t\t\t, (byte & 0b00000100) >> 2\n\t\t\t, (byte & 0b00001000) >> 3\n\t\t\t, (byte & 0b00010000) >> 4\n\t\t\t, (byte & 0b00100000) >> 5\n\t\t\t, (byte & 0b01000000) >> 6\n\t\t\t, (byte & 0b10000000) >> 7\n\t\t];\n\n\t\tconst tileArea = this.tileWidth * this.tileHeight;\n\n\t\tfor(const j in bits)\n\t\t{\n\t\t\tconst currentTile  = Math.floor(this.outputPos / tileArea);\n\n\t\t\tconst currentTileX = currentTile % maxTilesX;\n\t\t\tconst currentTileY = Math.floor(currentTile / maxTilesX);\n\n\t\t\tconst tileOffset   = this.outputPos % tileArea;\n\n\t\t\tconst fromTileY    = Math.floor(tileOffset / this.tileWidth);\n\t\t\tconst fromTileX    = this.tileWidth - (tileOffset % this.tileWidth);\n\n\t\t\tconst fromOriginX = (currentTileX * this.tileWidth) + fromTileX;\n\t\t\tconst fromOriginY = (currentTileY * this.tileHeight) + fromTileY;\n\n\t\t\tconst address = maxTilesX * this.tileWidth * fromOriginY + fromOriginX;\n\n\t\t\tthis.outputBuffer[address * 4 + 0] = palette[ bits[j] ][0];\n\t\t\tthis.outputBuffer[address * 4 + 1] = palette[ bits[j] ][1];\n\t\t\tthis.outputBuffer[address * 4 + 2] = palette[ bits[j] ][2];\n\t\t\tthis.outputBuffer[address * 4 + 3] = 255;\n\n\t\t\tthis.outputPos++;\n\t\t}\n\n\t\treturn this.outputPos * 4 < this.outputBuffer.length;\n\t}\n}\n","import { Gameboy1bpp } from './Gameboy1bpp';\n\nexport class Gameboy1bppCol extends Gameboy1bpp\n{\n\ttileWidth  = 2;\n\ttileHeight = 2;\n\tdepth      = 1;\n\n\tnext()\n\t{\n\t\tif(this.inputPos >= this.inputBuffer.length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst byte = this.inputBuffer[this.inputPos++];\n\n\t\tconst maxTilesX = Math.floor(this.width / this.tileWidth);\n\n\t\tconst bits = [\n\t\t\t(byte & 0b00000001) >> 0\n\t\t\t, (byte & 0b00000010) >> 1\n\t\t\t, (byte & 0b00000100) >> 2\n\t\t\t, (byte & 0b00001000) >> 3\n\t\t\t, (byte & 0b00010000) >> 4\n\t\t\t, (byte & 0b00100000) >> 5\n\t\t\t, (byte & 0b01000000) >> 6\n\t\t\t, (byte & 0b10000000) >> 7\n\t\t];\n\n\t\tconst tileArea = this.tileWidth * this.tileHeight;\n\n\t\tfor(const j in bits)\n\t\t{\n\t\t\tconst currentTile  = Math.floor(this.outputPos / tileArea);\n\n\t\t\tconst currentTileX = currentTile % maxTilesX;\n\t\t\tconst currentTileY = Math.floor(currentTile / maxTilesX);\n\n\t\t\tconst tileOffset   = this.outputPos % this.tileWidth**2;\n\n\t\t\tconst tileOffsetX  = Math.floor(tileOffset / this.tileWidth);\n\t\t\tconst tileOffsetY  = tileOffset % this.tileHeight;\n\n\t\t\tconst fromOriginX = (currentTileX * this.tileWidth)  + tileOffsetX;\n\t\t\tconst fromOriginY = (currentTileY * this.tileHeight) + tileOffsetY;\n\n\t\t\tconst address = 4 * (this.width * fromOriginY + fromOriginX);\n\n\t\t\tthis.outputBuffer[address+0] = bits[j] ? 255 : 0;\n\t\t\tthis.outputBuffer[address+1] = bits[j] ? 255 : 0;\n\t\t\tthis.outputBuffer[address+2] = bits[j] ? 255 : 0;\n\t\t\tthis.outputBuffer[address+3] = bits[j] ? 255 : 255;\n\n\t\t\tthis.outputPos++;\n\t\t}\n\n\t\treturn this.outputPos * 4 < this.outputBuffer.length;\n\t}\n}\n","import { Format } from '../Format';\n\nexport class Gameboy2bpp extends Format\n{\n\ttileWidth  = 8;\n\ttileHeight = 8;\n\tdepth      = 2;\n\n\tconstructor(inputBuffer, outputBuffer, width)\n\t{\n\t\tsuper();\n\n\t\tthis.inputBuffer  = inputBuffer;\n\t\tthis.outputBuffer = outputBuffer;\n\n\t\tthis.width = width;\n\t}\n\n\tnext()\n\t{\n\t\tif(this.inputPos >= this.inputBuffer.length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst palette  = [\n\t\t\t[0xFF, 0xFF, 0xFF]\n\t\t\t, [0x66, 0x66, 0x66]\n\t\t\t, [0xBB, 0xBB, 0xBB]\n\t\t\t, [0x00, 0x00, 0x00]\n\t\t];\n\n\t\tconst byteA = this.inputBuffer[this.inputPos++];\n\t\tconst byteB = this.inputBuffer[this.inputPos++];\n\n\t\tconst maxTilesX = Math.floor(this.width / this.tileWidth);\n\n\t\tconst bitPairs = [\n\t\t\t(((byteA & 0b10000000) << 1) | (byteB & 0b10000000)) >> 7\n\t\t\t, (((byteA & 0b01000000) << 1) | (byteB & 0b01000000)) >> 6\n\t\t\t, (((byteA & 0b00100000) << 1) | (byteB & 0b00100000)) >> 5\n\t\t\t, (((byteA & 0b00010000) << 1) | (byteB & 0b00010000)) >> 4\n\t\t\t, (((byteA & 0b00001000) << 1) | (byteB & 0b00001000)) >> 3\n\t\t\t, (((byteA & 0b00000100) << 1) | (byteB & 0b00000100)) >> 2\n\t\t\t, (((byteA & 0b00000010) << 1) | (byteB & 0b00000010)) >> 1\n\t\t\t, (((byteA & 0b00000001) << 1) | (byteB & 0b00000001)) >> 0\n\t\t];\n\n\t\tconst tileArea = this.tileWidth * this.tileHeight;\n\n\t\tfor(const j in bitPairs)\n\t\t{\n\t\t\tconst currentTile  = Math.floor(this.outputPos / tileArea);\n\t\t\tconst currentTileX = currentTile % maxTilesX;\n\t\t\tconst currentTileY = Math.floor(currentTile / maxTilesX);\n\n\t\t\tconst fromTile     = this.outputPos % tileArea;\n\t\t\tconst fromTileY    = Math.floor(fromTile / this.tileWidth);\n\t\t\tconst fromTileX    = fromTile % this.tileWidth;\n\n\t\t\tconst fromOriginX = (currentTileX * this.tileWidth) + fromTileX;\n\t\t\tconst fromOriginY = (currentTileY * this.tileHeight) + fromTileY;\n\n\t\t\tconst address = maxTilesX * this.tileWidth * fromOriginY + fromOriginX;\n\n\t\t\tthis.outputBuffer[address * 4 + 0] = palette[ bitPairs[j] ][0];\n\t\t\tthis.outputBuffer[address * 4 + 1] = palette[ bitPairs[j] ][1];\n\t\t\tthis.outputBuffer[address * 4 + 2] = palette[ bitPairs[j] ][2];\n\t\t\tthis.outputBuffer[address * 4 + 3] = 255;\n\n\t\t\tthis.outputPos++;\n\t\t}\n\n\t\treturn this.outputPos * 4 < this.outputBuffer.length;\n\t}\n}\n","import { View } from 'curvature/base/View';\nimport { Tag  } from 'curvature/base/Tag';\n\nimport { Panel } from './panel/Panel';\nimport { Drop } from './file/Drop';\n\nconst drawDots = (file, context) => {\n\n\tconst reader = new FileReader();\n\n\treader.readAsArrayBuffer(file);\n\n\treader.onload = () => {\n\t\tconst bytes = new Uint8Array(reader.result);\n\n\t\tconst height = Math.ceil(bytes.length / context.canvas.width);\n\n\t\tcontext.canvas.height = height;\n\n\t\tconst pixels = context.createImageData(context.canvas.width, context.canvas.height);\n\n\t\tlet i = 0;\n\n\t\tfor(const byte of bytes)\n\t\t{\n\t\t\tpixels.data[i++] = byte;\n\t\t\tpixels.data[i++] = byte;\n\t\t\tpixels.data[i++] = byte;\n\t\t\tpixels.data[i++] = 255;\n\t\t}\n\n\t\tcontext.putImageData(pixels, 0, 0);\n\t};\n};\n\ndocument.addEventListener('DOMContentLoaded', function() {\n\tconst drop  = new Drop();\n\tconst panel = new Panel({type: 'root', widget: drop});\n\n\tdrop.args.panel = panel;\n\n\tpanel.render(document.body);\n});\n","import { Mixin }  from 'curvature/base/Mixin';\nimport { View }   from 'curvature/base/View';\n\nimport { Deinterlace } from '../processor/Deinterlace';\nimport { Invert }      from '../processor/Invert';\nimport { RLE }         from '../processor/RLE';\n\nimport { Panelable } from '../panel/Panelable';\nimport { Panel }     from '../panel/Panel';\n\n// export class Menu extends View\nexport class Menu extends View\n{\n\ttemplate = require('./menu.html');\n\n\tconstructor(args,parent)\n\t{\n\t\tsuper(args,parent);\n\n\t\tthis.args.links = {Invert, RLE, Deinterlace};\n\n\t\tObject.assign(this.panel.args, {\n\t\t\twidget:  this\n\t\t\t, title: 'Select a Processor'\n\t\t});\n\t}\n\n\tclick(event, processor, title)\n\t{\n\t\tconst rootPanel = this.args.panel;\n\n\t\tconst input  = this.args.input;\n\t\tconst widget = new processor({input, panel: rootPanel});\n\n\t\trootPanel.panels.add(widget.panel);\n\n\t\tthis.remove();\n\t}\n}\n\nMixin.to(Menu, Panelable);\n","module.exports = \"<div data-module = \\\"menu\\\" cv-each = \\\"links:processor:title\\\">\\n\\t<div>\\n\\t\\t<a cv-link = \\\"/process/[[title]]\\\" cv-on = \\\"click(event, processor, title)\\\">\\n\\t\\t\\t[[title]]\\n\\t\\t</a>\\n\\t</div>\\n</div>\\n\"","import { View } from 'curvature/base/View';\nimport { Bag  } from 'curvature/base/Bag';\n\nexport class Panel extends View\n{\n\ttemplate = require('./panel.html');\n\n\tconstructor(args, panel)\n\t{\n\t\tsuper(args, panel);\n\n\t\tthis.host = null;\n\n\t\tthis.openLeft = 0;\n\t\tthis.openTop  = 0;\n\n\t\tthis.args.title  = this.args.title  || null;\n\t\tthis.args.widget = this.args.widget || null;\n\t\tthis.args.left   = 0;\n\t\tthis.args.top    = 0;\n\t\tthis.args.z      = 0;\n\n\t\tthis.panels = new Bag((i,s,a) => {\n\n\t\t\tif(a !== Bag.ITEM_ADDED)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ti.host = this;\n\n\t\t\tthis.openLeft += 57;\n\t\t\tthis.openTop  += 93;\n\n\t\t\ti.args.left = this.openLeft;\n\t\t\ti.args.top  = this.openTop;\n\t\t\ti.args.z    = Object.values(this.panels.list).length;\n\n\t\t\tthis.openLeft %= Math.floor(window.innerWidth / 2);\n\t\t\tthis.openTop  %= Math.floor(window.innerHeight / 2);\n\n\t\t\ti.onRemove(()=>this.panels.remove(i));\n\t\t});\n\n\t\tthis.args.panels = this.panels.list;\n\t}\n\n\tonAttached(event)\n\t{\n\t\tthis.args.bindTo(['left','top'], (v,k)=>{\n\t\t\tconst panel = this.tags.panel;\n\n\t\t\tif(!panel)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst body  = document.body;\n\n\t\t\tconst maxX  = body.clientWidth  - panel.clientWidth;\n\t\t\tconst maxY  = body.clientHeight - panel.clientHeight;\n\n\t\t\tif(k === 'left' && v > maxX)\n\t\t\t{\n\t\t\t\tv = maxX;\n\t\t\t}\n\n\t\t\tif(k === 'top' && v > maxY)\n\t\t\t{\n\t\t\t\tv = maxY;\n\t\t\t}\n\n\t\t\tif(v < 0)\n\t\t\t{\n\t\t\t\tv = 0;\n\t\t\t}\n\n\t\t\tthis.args[k] = v;\n\n\t\t\tthis.tags.panel.style({ [`--${k}`] : `${v}px` });\n\t\t},{wait: 0});\n\n\t\tthis.args.bindTo('z', (v,k)=>{\n\t\t\tthis.tags.panel.style({ [`--${k}`] : `${v}` });\n\t\t});\n\t}\n\n\tmousedown(event)\n\t{\n\t\tif(!this.host)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst panels = Object.values(this.host.panels.list).sort((a,b)=>{\n\t\t\treturn b.z > a.z;\n\t\t});\n\n\n\t\tfor(const i in panels)\n\t\t{\n\t\t\tif(panels[i] === this)\n\t\t\t{\n\t\t\t\tif(i === 0)\n\t\t\t\t{\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(panels[i].args.z > this.args.z)\n\t\t\t{\n\t\t\t\tpanels[i].args.z--;\n\t\t\t}\n\t\t}\n\n\t\tthis.args.z = panels.length;\n\t}\n\n\tstartFollow()\n\t{\n\t\tthis.stopMoving = this.listen(document, 'mousemove', event => {\n\t\t\tthis.args.left += event.movementX;\n\t\t\tthis.args.top  += event.movementY;\n\t\t});\n\n\t\tthis.listen(document, 'mouseup', event => {\n\t\t\tthis.stopMoving();\n\t\t\tthis.stopMoving = false;\n\t\t}, {once:true});\n\t}\n\n\tclose()\n\t{\n\t\tif(typeof this.args.widget == 'object' && typeof this.args.widget.remove == 'function')\n\t\t{\n\t\t\tthis.args.widget.remove();\n\t\t}\n\n\t\tthis.remove();\n\t}\n}\n","import { Panel } from './Panel';\n\nconst RootPanel = Symbol('RootPanel');\nconst MyPanel   = Symbol('MyPanel');\n\nexport const Panelable = {\n\tget panel() {\n\n\t\tif(!this[MyPanel])\n\t\t{\n\t\t\tthis[MyPanel] = new Panel({}, this);\n\t\t}\n\n\t\treturn this[MyPanel];\n\t}\n};\n","module.exports = \"<div data-module = \\\"panel\\\" data-panel-type = \\\"[[type]]\\\" cv-ref = \\\"panel\\\" cv-on = \\\"mousedown:mousedown(event):c\\\">\\n\\t<div class = \\\"titlebar\\\" cv-on = \\\"mousedown:startFollow(event)\\\" cv-if = \\\"title\\\">\\n\\t\\t<span class = \\\"icon inline-icon\\\"></span>\\n\\t\\t<span>[[title]]</span>\\n\\t\\t<div class = \\\"right\\\">\\n\\t\\t\\t<div class = \\\"icon inline-icon x-icon\\\" cv-on = \\\"click:close(event)\\\"></div>\\n\\t\\t</div>\\n\\t</div>\\n\\t<div class = \\\"widget\\\">[[widget]]</div>\\n\\t<div class = \\\"panels\\\" cv-each = \\\"panels:panel\\\">[[panel]]</div>\\n</div>\\n\"","import { View } from 'curvature/base/View';\nimport { Panel } from '../panel/Panel';\nimport { Canvas } from '../canvas/Canvas';\nimport { BitArray } from 'pokemon-parser/BitArray';\n\nimport { Processor } from '../Processor';\n\nexport class Deinterlace extends Processor\n{\n\ttemplate = require('./deinterlace.html');\n\n\tconstructor(args,parent)\n\t{\n\t\tsuper(args, parent);\n\n\t\tObject.assign(this.panel.args, {title: 'Deinterlace'});\n\t}\n\n\trun()\n\t{\n\t\tconst rootPanel = this.args.panel;\n\t\tconst sideSize  = this.args.input.args.width;\n\n\t\tconst offset = Number(this.args.offset);\n\t\tconst length = sideSize**2;\n\t\tconst input  = new BitArray(this.args.input.args.buffer);\n\n\t\tconst output = new Uint8Array(length);\n\n\t\tfor(let i = 0; i < input.length / 2; i++)\n\t\t{\n\t\t\tconst b1 = input.get(this.pixelToRowPixel(i));\n\t\t\tconst b2 = input.get(this.pixelToRowPixel(i)+sideSize**2);\n\t\t\tconst b  = b1 << 1 | b2;\n\n\t\t\tconst pallet = [255,128,196,64];\n\n\t\t\toutput[i] = pallet[b];\n\t\t}\n\n\t\tconst title  = 'Deinterlaced ' + this.args.inputName;\n\n\t\tconst widget = new Canvas({\n\t\t\tbuffer: output, panel: rootPanel, title\n\t\t\t, width: sideSize, height: sideSize, scale: 4, decoder: 'bytes'\n\t\t});\n\n\t\trootPanel.panels.add(widget.panel);\n\n\t\tthis.remove();\n\t}\n\n\tpixelToRowPixel(pixel)\n\t{\n\t\tconst width  = this.args.input.args.width;\n\t\tconst pEven  = pixel % 2 === 0;\n\t\tconst xOff   = Math.floor(pixel / width);\n\t\tconst xEven  = xOff % 2 == 0;\n\t\tconst yOff   = pixel % width;\n\n\t\tconst result = (xOff * 2 + yOff * width) + (pEven ? 0:-(width-1));\n\n\t\treturn result;\n\t}\n}\n","import { View } from 'curvature/base/View';\nimport { Panel } from '../panel/Panel';\nimport { Canvas } from '../canvas/Canvas';\n\nimport { Processor } from '../Processor';\n\nexport class Invert extends Processor\n{\n\ttemplate = require('./invert.html');\n\n\tconstructor(args,parent)\n\t{\n\t\tsuper(args, parent);\n\n\t\tObject.assign(this.panel.args, {title: 'Invert'});\n\t}\n\n\trun()\n\t{\n\t\tconst rootPanel = this.args.panel;\n\n\t\tconst offset = Number(this.args.offset);\n\t\tconst length = Number(this.args.length);\n\t\tconst input  = this.args.input.args.buffer;\n\n\t\tconst output = new Uint8Array(length);\n\n\t\tfor(let i = 0; i < length; i++)\n\t\t{\n\t\t\toutput[i] = input[i + offset] ^ 0b11111111;\n\t\t}\n\n\t\tconst title  = 'Inverted ' + this.args.inputName;\n\t\tconst widget = new Canvas({\n\t\t\tbuffer: output, panel: rootPanel, title\n\t\t\t, decoder: this.args.input.args.decoder\n\t\t\t, height: this.args.input.args.height\n\t\t\t, width: this.args.input.args.width\n\t\t\t, scale: this.args.input.args.scale\n\t\t});\n\n\t\trootPanel.panels.add(widget.panel);\n\n\t\tthis.remove();\n\t}\n}\n","import { View } from 'curvature/base/View';\nimport { Panel } from '../panel/Panel';\nimport { Canvas } from '../canvas/Canvas';\n\nimport { Processor } from '../Processor';\n\nimport { BitArray } from 'pokemon-parser/BitArray';\n\n// 1176 byte buffer\n// 3 392 byte sub-buffers\n\nexport class RLE extends Processor\n{\n\ttemplate = require('./rle.html');\n\ttable1 = [...Array(16)].map((_,i)=> (2 << i) - 1);\n\n\tconstructor(args,parent)\n\t{\n\t\tsuper(args, parent);\n\n\t\tthis.sideSize = 7;\n\t\tthis.tileSize = 8;\n\n\t\tthis.args.offset = 16658;//220252;\n\n\t\tObject.assign(this.panel.args, {title: 'RLE + Delta'});\n\t}\n\n\trun()\n\t{\n\t\tconst bitBuffer = this.args.input.args.buffer.slice(this.args.offset);\n\n\t\tconst bits  = new BitArray(bitBuffer);\n\t\tlet xSize = bits.next(4) || 7;\n\t\tlet ySize = bits.next(4) || 7;\n\n\t\txSize *= this.tileSize;\n\n\t\tconst size  = xSize * ySize;\n\n\t\txSize = xSize <= 56 ? xSize : 56;\n\t\tySize = ySize <= 7  ? ySize : 7;\n\n\t\tthis.sideSize = ySize;\n\n\t\tthis.buffSize = (this.sideSize**2)*this.tileSize;\n\n\t\tconst buffer = new Uint8Array(this.buffSize*3);\n\n\t\tthis.buffer  = buffer;\n\n\t\tthis.bufferA = new Uint8Array(buffer.buffer, this.buffSize*0, this.buffSize);\n\t\tthis.bufferB = new Uint8Array(buffer.buffer, this.buffSize*1, this.buffSize*2);\n\t\tthis.bufferC = new Uint8Array(buffer.buffer, this.buffSize*2, this.buffSize*1);\n\n\t\tconst rootPanel = this.args.panel;\n\n\t\tconst title  = 'RLE+Delta Decoded ' + this.args.inputName;\n\n\t\tconst widget = new Canvas({\n\t\t\tbuffer: this.buffer, panel: rootPanel, title\n\t\t\t, width: this.sideSize  * this.tileSize\n\t\t\t, height: this.sideSize * this.tileSize * 3\n\t\t\t, scale: 4\n\t\t\t, decoder: 'gameboy-1bit-cols'\n\t\t\t, module: 'rle'\n\t\t});\n\n\t\trootPanel.panels.add(widget.panel);\n\n\t\tthis.outputWidget = widget;\n\n\t\tconst buffers = [new BitArray(this.bufferB), new BitArray(this.bufferC)];\n\n\t\tconst order = bits.next();\n\n\t\tconst bufB  = buffers[order];\n\t\tconst bufC  = buffers[order ^ 1];\n\n\t\twidget.addEventListener('attached', ()=>{\n\t\t\tthis.fillBuffer(bufB, bits, xSize, size).then(()=>{\n\n\t\t\t\tthis.outputWidget.drawDots();\n\t\t\t\tlet mode = bits.next();\n\n\t\t\t\tif(mode === 1)\n\t\t\t\t{\n\t\t\t\t\tmode = 1 + bits.next();\n\t\t\t\t}\n\n\t\t\t\tthis.fillBuffer(bufC, bits, xSize, size).then(()=>{\n\t\t\t\t\tif(mode === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.deltaFill(bufB, xSize).then(()=>{\n\t\t\t\t\t\t\treturn this.deltaFill(bufB, xSize);\n\t\t\t\t\t\t}).then(()=>{\n\t\t\t\t\t\t\tthis.copy(new BitArray(this.bufferB), new BitArray(this.bufferA), ySize);\n\t\t\t\t\t\t\tthis.copy(new BitArray(this.bufferC), new BitArray(this.bufferB), ySize);\n\t\t\t\t\t\t\tthis.empty(new BitArray(this.bufferC));\n\t\t\t\t\t\t\tthis.outputWidget.drawDots();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse if(mode === 1)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.deltaFill(bufB, xSize).then(()=>{\n\t\t\t\t\t\t\tthis.xorFill(bufB, bufC);\n\t\t\t\t\t\t\tthis.copy(new BitArray(this.bufferB), new BitArray(this.bufferA), ySize);\n\t\t\t\t\t\t\tthis.copy(new BitArray(this.bufferC), new BitArray(this.bufferB), ySize);\n\t\t\t\t\t\t\tthis.empty(new BitArray(this.bufferC));\n\t\t\t\t\t\t\tthis.outputWidget.drawDots();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse if(mode == 2)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.deltaFill(bufB,xSize).then(()=>{\n\t\t\t\t\t\t\treturn this.deltaFill(bufC,xSize);\n\t\t\t\t\t\t}).then(()=>{\n\t\t\t\t\t\t\tthis.xorFill(bufB, bufC);\n\t\t\t\t\t\t\tthis.outputWidget.drawDots();\n\t\t\t\t\t\t\tthis.copy(new BitArray(this.bufferB), new BitArray(this.bufferA), ySize);\n\t\t\t\t\t\t\tthis.copy(new BitArray(this.bufferC), new BitArray(this.bufferB), ySize);\n\t\t\t\t\t\t\tthis.empty(new BitArray(this.bufferC));\n\t\t\t\t\t\t\tthis.outputWidget.drawDots();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t});\n\t\t}, {once:true});\n\n\t\tthis.remove();\n\t}\n\n\tfillBuffer(buffer, bits, xSize, size)\n\t{\n\t\treturn new Promise(accept => {\n\n\t\t\tconst bitSize = size * 8;\n\t\t\tlet mode      = bits.next();\n\n\t\t\tlet i = 0;\n\n\t\t\tconst fill = () =>\t{\n\n\t\t\t\tif(mode === 0)\n\t\t\t\t{\n\t\t\t\t\ti = this.rleFill(buffer, bits, i);\n\n\t\t\t\t\tmode = 1;\n\t\t\t\t}\n\t\t\t\telse if(mode === 1)\n\t\t\t\t{\n\t\t\t\t\ti = this.dataFill(buffer, bits, i);\n\t\t\t\t\tmode = 0;\n\t\t\t\t}\n\n\t\t\t\tif(i < bitSize)\n\t\t\t\t{\n\t\t\t\t\tif(i % (this.sideSize * this.tileSize * 1) === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tsetTimeout(() => fill(), 100);\n\t\t\t\t\t\tthis.outputWidget.drawDots();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tfill();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treturn accept();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfill();\n\t\t});\n\n\t}\n\n\trleFill(buffer, bits, i)\n\t{\n\t\tlet ii = 0;\n\t\tlet bit = '';\n\t\tlet read = '';\n\n\t\twhile(bit = bits.next())\n\t\t{\n\t\t\tread += bit;\n\t\t\tii++;\n\t\t}\n\n\t\tread += bit;\n\n\t\tconst n = this.table1[ii];\n\t\tconst a = bits.next(ii+1);\n\t\tconst m = n + a;\n\n\t\tfor(let j = 0; j < m; j++)\n\t\t{\n\t\t\t// buffer.set(i++, 0);\n\t\t\t// buffer.set(i++, 0);\n\t\t\ti++;\n\t\t\ti++;\n\t\t}\n\n\t\treturn i;\n\t}\n\n\tdataFill(buffer, bits, i)\n\t{\n\t\tconst fill = [];\n\n\t\twhile(true)\n\t\t{\n\t\t\tconst b1 = bits.next();\n\t\t\tconst b2 = bits.next();\n\n\t\t\tif(b1 === 0 && b2 === 0)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tfill.push(b1,b2);\n\n\t\t\tb1 && buffer.set(i, b1);\n\t\t\ti++;\n\t\t\tb2 && buffer.set(i, b2);\n\t\t\ti++;\n\t\t}\n\n\t\treturn i;\n\t}\n\n\tdeltaFill(bits,xSize)\n\t{\n\t\tlet i = 0, lastBit = 0;\n\t\tconst max = bits.length;\n\n\t\treturn new Promise(accept => {\n\t\t\tconst fill = () => {\n\t\t\t\tif(i % (this.sideSize * this.tileSize) === 0)\n\t\t\t\t{\n\t\t\t\t\tlastBit = 0;\n\t\t\t\t}\n\n\t\t\t\tconst pixel = this.pixelToRowPixel(i);\n\n\t\t\t\tconst bit = bits.get(pixel);\n\n\t\t\t\tif(bit)\n\t\t\t\t{\n\t\t\t\t\tlastBit = 1 ^ lastBit;\n\t\t\t\t}\n\n\t\t\t\tbits.set(pixel, lastBit);\n\n\t\t\t\ti++;\n\n\t\t\t\tif(i < max)\n\t\t\t\t{\n\t\t\t\t\tif(i % this.sideSize * this.tileSize === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tsetTimeout(() => fill(), 1);\n\t\t\t\t\t\tthis.outputWidget.drawDots();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tfill();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treturn accept();\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tfill();\n\t\t});\n\t}\n\n\ttilePixelToPixel(tilePixel)\n\t{\n\t\tconst width        = this.sideSize * this.tileSize;\n\n\t\tconst oddColumn    = (tilePixel % (width * 2)) >= width;\n\t\tconst column       = Math.floor(tilePixel / (width * 2));\n\t\tconst columnOffset = column * (width * 2);\n\t\tconst inColumn     = tilePixel - columnOffset;\n\n\t\tconst pixel = columnOffset + (oddColumn\n\t\t\t? ((inColumn - width) * 2) + 1\n\t\t\t: inColumn * 2\n\t\t);\n\n\t\treturn pixel;\n\t}\n\n\tpixelToRowPixel(pixel)\n\t{\n\t\tconst width  = this.sideSize * this.tileSize;\n\t\tconst pEven  = pixel % 2 === 0;\n\t\tconst xOff   = Math.floor(pixel / width);\n\t\tconst xEven  = xOff % 2 == 0;\n\t\tconst yOff   = pixel % width;\n\n\t\tconst result = (xOff * 2 + yOff * width) + (pEven ? 0:-(width-1));\n\n\t\treturn result;\n\t}\n\n\tcopy(bitsA, bitsB, ySize)\n\t{\n\t\tconst offset = 7 - ySize;\n\n\t\tfor(let i = 0; i < bitsA.length; i++)\n\t\t{\n\t\t\tconst bitA = bitsA.get(i);\n\n\t\t\tbitsB.set(i, bitA);\n\t\t}\n\t}\n\n\tuntile()\n\t{\n\n\t}\n\n\tempty(bits)\n\t{\n\t\tfor(let i = 0; i < bits.length; i++)\n\t\t{\n\t\t\tbits.set(i, 0);\n\t\t}\n\t}\n\n\txorFill(bitsA, bitsB)\n\t{\n\t\tfor(let i = 0; i < bitsA.length; i++)\n\t\t{\n\t\t\tconst bitA = bitsA.get(i);\n\t\t\tconst bitB = bitsB.get(i);\n\n\t\t\tbitsB.set(i, bitA^bitB);\n\t\t}\n\t}\n}\n","module.exports = \"<div data-module = \\\"canvas invert\\\">\\n\\t<div class = \\\"column\\\">\\n\\t\\t<label><p>input buffer: [[inputName]]</p></label>\\n\\t\\t<div class = \\\"row right\\\">\\n\\t\\t\\t<button cv-on = \\\"click:run(event)\\\">deinterlace</button>\\n\\t\\t</div>\\n\\t</div>\\n</div>\\n\"","module.exports = \"<div data-module = \\\"canvas invert\\\">\\n\\t<div class = \\\"column\\\">\\n\\t\\t<label><p>input buffer: [[inputName]]</p></label>\\n\\t\\t<label class = \\\"column\\\">\\n\\t\\t\\t<p>offset</p>\\n\\t\\t\\t<input type = \\\"number\\\" cv-bind = \\\"offset\\\">\\n\\t\\t</label>\\n\\t\\t<label class = \\\"column\\\">\\n\\t\\t\\t<p>length</p>\\n\\t\\t\\t<input type = \\\"number\\\" cv-bind = \\\"length\\\">\\n\\t\\t</label>\\n\\t\\t<div class = \\\"row right\\\">\\n\\t\\t\\t<button cv-on = \\\"click:run(event)\\\">invert</button>\\n\\t\\t</div>\\n\\t</div>\\n</div>\\n\"","module.exports = \"<div data-module = \\\"canvas invert\\\">\\n\\t<div class = \\\"column\\\">\\n\\n\\t\\t<label><p>input buffer: [[inputName]]</p></label>\\n\\n\\t\\t<label class = \\\"column\\\">\\n\\t\\t\\t<p>offset</p>\\n\\t\\t\\t<input cv-bind = \\\"offset\\\">\\n\\t\\t</label>\\n\\n\\t\\t<div class = \\\"row right\\\">\\n\\t\\t\\t<button cv-on = \\\"click:run(event)\\\">decompress</button>\\n\\t\\t</div>\\n\\n\\t</div>\\n</div>\\n\"","/* jshint ignore:start */\n(function() {\n  var WebSocket = window.WebSocket || window.MozWebSocket;\n  var br = window.brunch = (window.brunch || {});\n  var ar = br['auto-reload'] = (br['auto-reload'] || {});\n  if (!WebSocket || ar.disabled) return;\n  if (window._ar) return;\n  window._ar = true;\n\n  var cacheBuster = function(url){\n    var date = Math.round(Date.now() / 1000).toString();\n    url = url.replace(/(\\&|\\\\?)cacheBuster=\\d*/, '');\n    return url + (url.indexOf('?') >= 0 ? '&' : '?') +'cacheBuster=' + date;\n  };\n\n  var browser = navigator.userAgent.toLowerCase();\n  var forceRepaint = ar.forceRepaint || browser.indexOf('chrome') > -1;\n\n  var reloaders = {\n    page: function(){\n      window.location.reload(true);\n    },\n\n    stylesheet: function(){\n      [].slice\n        .call(document.querySelectorAll('link[rel=stylesheet]'))\n        .filter(function(link) {\n          var val = link.getAttribute('data-autoreload');\n          return link.href && val != 'false';\n        })\n        .forEach(function(link) {\n          link.href = cacheBuster(link.href);\n        });\n\n      // Hack to force page repaint after 25ms.\n      if (forceRepaint) setTimeout(function() { document.body.offsetHeight; }, 25);\n    },\n\n    javascript: function(){\n      var scripts = [].slice.call(document.querySelectorAll('script'));\n      var textScripts = scripts.map(function(script) { return script.text }).filter(function(text) { return text.length > 0 });\n      var srcScripts = scripts.filter(function(script) { return script.src });\n\n      var loaded = 0;\n      var all = srcScripts.length;\n      var onLoad = function() {\n        loaded = loaded + 1;\n        if (loaded === all) {\n          textScripts.forEach(function(script) { eval(script); });\n        }\n      }\n\n      srcScripts\n        .forEach(function(script) {\n          var src = script.src;\n          script.remove();\n          var newScript = document.createElement('script');\n          newScript.src = cacheBuster(src);\n          newScript.async = true;\n          newScript.onload = onLoad;\n          document.head.appendChild(newScript);\n        });\n    }\n  };\n  var port = ar.port || 9485;\n  var host = br.server || window.location.hostname || 'localhost';\n\n  var connect = function(){\n    var connection = new WebSocket('ws://' + host + ':' + port);\n    connection.onmessage = function(event){\n      if (ar.disabled) return;\n      var message = event.data;\n      var reloader = reloaders[message] || reloaders.page;\n      reloader();\n    };\n    connection.onerror = function(){\n      if (connection.readyState) connection.close();\n    };\n    connection.onclose = function(){\n      window.setTimeout(connect, 1000);\n    };\n  };\n  connect();\n})();\n/* jshint ignore:end */\n"]}