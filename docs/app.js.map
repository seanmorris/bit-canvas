{"version":3,"sources":["node_modules/curvature/base/Bag.js","node_modules/curvature/base/Bindable.js","node_modules/curvature/base/Cache.js","node_modules/curvature/base/Config.js","node_modules/curvature/base/Dom.js","node_modules/curvature/base/Mixin.js","node_modules/curvature/base/Router.js","node_modules/curvature/base/Routes.js","node_modules/curvature/base/RuleSet.js","node_modules/curvature/base/SetMap.js","node_modules/curvature/base/Tag.js","node_modules/curvature/base/Uuid.js","node_modules/curvature/base/View.js","node_modules/curvature/base/ViewList.js","node_modules/curvature/mixin/EventTargetMixin.js","node_modules/curvature/mixin/PromiseMixin.js","node_modules/curvature/model/Database.js","node_modules/curvature/model/Model.js","node_modules/curvature/net/Elicit.js","node_modules/pokemon-parser/BitArray.js","node_modules/pokemon-parser/PokemonRom.js","node_modules/pokemon-parser/base/Rom.js","node_modules/pokemon-parser/decompress/Gameboy2bpp.js","node_modules/pokemon-parser/decompress/Merge.js","node_modules/pokemon-parser/decompress/RleDelta.js","node_modules/pokemon-parser/factory/fsRom.js","node_modules/pokemon-parser/gameboy/GbcLicensees.js","node_modules/pokemon-parser/gameboy/Licensees.js","node_modules/pokemon-parser/gameboy/Rom.js","node_modules/process/browser.js","app/Format.js","app/Processor.js","app/canvas/Canvas.js","app/canvas/canvas.html","app/file/Drop.js","app/file/FileDatabase.js","app/file/FileModel.js","app/file/Icon.js","app/file/drop.html","app/file/icon.html","app/format/BitPerPixel.js","app/format/BytePerPixel.js","app/format/Gameboy1bpp.js","app/format/Gameboy1bppCol.js","app/format/Gameboy2bpp.js","app/initialize.js","app/menu/Menu.js","app/menu/menu.html","app/panel/Panel.js","app/panel/Panelable.js","app/panel/panel.html","app/processor/DeleteConfirm.js","app/processor/Invert.js","app/processor/RLE.js","app/processor/Slice.js","app/processor/delete-confirm.html","app/processor/invert.html","app/processor/rle.html","app/processor/slice.html","node_modules/auto-reload-brunch/vendor/auto-reload.js"],"names":["Format","inputBuffer","outputBuffer","width","console","warn","constructor","name","Processor","args","parent","Object","assign","panel","widgets","bindTo","v","inputName","input","title","offset","Number","firstByte","length","buffer","View","Mixin","to","Panelable","Canvas","require","height","scale","tileArea","scrollDelta","decoder","showSettings","rootPanel","toolBar","icon","action","event","toggleSettings","panels","add","RLE","Slice","save","canvasStyle","k","tags","canvas","drawDots","wait","style","Math","ceil","Uint8Array","min","log","filename","onTimeout","crypto","subtle","digest","then","digestBytes","Array","from","map","b","toString","padStart","join","pokemonHashes","includes","rom","PokemonRom","spriteOffsets","preload","getAllPokemon","allPokemon","filter","a","number","sort","pokemon","frontOffset","sprites","front","backOffset","back","frame","preventDefault","deltaY","depth","key","ctrlKey","shiftKey","bytes","undefined","willDraw","cancelAnimationFrame","requestAnimationFrame","context","getContext","clearRect","formatter","BytePerPixel","BitPerPixel","Gameboy2bpp","Gameboy1bpp","Gameboy1bppCol","format","slice","output","createImageData","data","pixels","tileWidth","tileHeight","next","putImageData","target","value","split","link","document","createElement","blob","Blob","oURL","URL","createObjectURL","setAttribute","click","button","x","Drop","files","fileDb","FileDatabase","open","refresh","query","store","index","type","FileModel","db","select","each","file","push","importFiles","dataTransfer","openCanvasPanel","addEventListener","once","arrayBuffer","Promise","all","range","values","lastModified","size","one","result","record","insert","consume","update","database","fileStore","createObjectStore","keyPath","createIndex","unique","Database","Model","Icon","inputPos","byte","bits","bit","address","outputPos","palette","maxTilesX","floor","j","currentTile","currentTileX","currentTileY","tileOffset","fromTileY","fromTileX","fromOriginX","fromOriginY","tileOffsetX","tileOffsetY","byteA","byteB","bitPairs","fromTile","drop","Panel","contextMenu","render","body","results","sampleUrls","getSamples","u","e","Elicit","defer","pool","s","inserts","id","Date","now","mapped","Menu","links","Invert","processor","widget","remove","host","openLeft","openTop","Bindable","make","left","top","z","Bag","i","ITEM_ADDED","list","window","innerWidth","innerHeight","onRemove","maxX","clientWidth","maxY","clientHeight","stopPropagation","callback","importFile","openDeleteDialog","contextMenuX","pageX","docWidth","offsetWidth","docHeight","offsetHeight","contextMenuXR","contextMenuXL","pageY","contextMenuYB","contextMenuYT","item","deleteConfirm","DeleteConfirm","stopMoving","listen","moving","MyPanel","Symbol","_","close","sideSize","tileSize","slow","openRleWidget","rleDelta","rleWidget","loading","openMergeWidget","merge","mergeWidget","rendered","runRle","runMerge","RleDelta","toUpperCase","xSize","iterate","accept","setTimeout","decompress","resolve","Merge","start","end","startHex","endHex","WebSocket","MozWebSocket","br","brunch","ar","disabled","_ar","cacheBuster","url","date","round","replace","indexOf","browser","navigator","userAgent","toLowerCase","forceRepaint","reloaders","page","location","reload","stylesheet","call","querySelectorAll","val","getAttribute","href","forEach","javascript","scripts","textScripts","script","text","srcScripts","src","loaded","onLoad","eval","newScript","async","onload","head","appendChild","port","server","hostname","connect","connection","onmessage","message","reloader","onerror","readyState","onclose"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/OA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACz0BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACldA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/MA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC7FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpxEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/NA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACl0BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnmBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1qCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAC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","file":"docs/app.js","sourcesContent":["\nrequire.register(\"curvature/base/Bag.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Bag = void 0;\nvar _Bindable = require(\"./Bindable\");\nvar _Mixin = require(\"./Mixin\");\nvar _EventTargetMixin = require(\"../mixin/EventTargetMixin\");\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nvar toId = function toId(int) {\n  return Number(int);\n};\nvar fromId = function fromId(id) {\n  return parseInt(id);\n};\nvar Mapped = Symbol('Mapped');\nvar Has = Symbol('Has');\nvar Add = Symbol('Add');\nvar Remove = Symbol('Remove');\nvar Delete = Symbol('Delete');\nvar Bag = /*#__PURE__*/function (_Mixin$with) {\n  _inherits(Bag, _Mixin$with);\n  var _super = _createSuper(Bag);\n  function Bag() {\n    var _this;\n    var changeCallback = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : undefined;\n    _classCallCheck(this, Bag);\n    _this = _super.call(this);\n    _this.changeCallback = changeCallback;\n    _this.content = new Map();\n    _this.current = 0;\n    _this.length = 0;\n    _this.list = _Bindable.Bindable.makeBindable([]);\n    _this.meta = Symbol('meta');\n    _this.type = undefined;\n    return _this;\n  }\n  _createClass(Bag, [{\n    key: \"has\",\n    value: function has(item) {\n      if (this[Mapped]) {\n        return this[Mapped].has(item);\n      }\n      return this[Has](item);\n    }\n  }, {\n    key: Has,\n    value: function value(item) {\n      return this.content.has(item);\n    }\n  }, {\n    key: \"add\",\n    value: function add(item) {\n      if (this[Mapped]) {\n        return this[Mapped].add(item);\n      }\n      return this[Add](item);\n    }\n  }, {\n    key: Add,\n    value: function value(item) {\n      if (item === undefined || !(item instanceof Object)) {\n        throw new Error('Only objects may be added to Bags.');\n      }\n      if (this.type && !(item instanceof this.type)) {\n        console.error(this.type, item);\n        throw new Error(\"Only objects of type \".concat(this.type, \" may be added to this Bag.\"));\n      }\n      item = _Bindable.Bindable.make(item);\n      if (this.content.has(item)) {\n        return;\n      }\n      var adding = new CustomEvent('adding', {\n        detail: {\n          item: item\n        }\n      });\n      if (!this.dispatchEvent(adding)) {\n        return;\n      }\n      var id = toId(this.current++);\n      this.content.set(item, id);\n      this.list[id] = item;\n      if (this.changeCallback) {\n        this.changeCallback(item, this.meta, Bag.ITEM_ADDED, id);\n      }\n      var add = new CustomEvent('added', {\n        detail: {\n          item: item,\n          id: id\n        }\n      });\n      this.dispatchEvent(add);\n      this.length = this.size;\n      return id;\n    }\n  }, {\n    key: \"remove\",\n    value: function remove(item) {\n      if (this[Mapped]) {\n        return this[Mapped].remove(item);\n      }\n      return this[Remove](item);\n    }\n  }, {\n    key: Remove,\n    value: function value(item) {\n      if (item === undefined || !(item instanceof Object)) {\n        throw new Error('Only objects may be removed from Bags.');\n      }\n      if (this.type && !(item instanceof this.type)) {\n        console.error(this.type, item);\n        throw new Error(\"Only objects of type \".concat(this.type, \" may be removed from this Bag.\"));\n      }\n      item = _Bindable.Bindable.make(item);\n      if (!this.content.has(item)) {\n        if (this.changeCallback) {\n          this.changeCallback(item, this.meta, 0, undefined);\n        }\n        return false;\n      }\n      var removing = new CustomEvent('removing', {\n        detail: {\n          item: item\n        }\n      });\n      if (!this.dispatchEvent(removing)) {\n        return;\n      }\n      var id = this.content.get(item);\n      delete this.list[id];\n      this.content.delete(item);\n      if (this.changeCallback) {\n        this.changeCallback(item, this.meta, Bag.ITEM_REMOVED, id);\n      }\n      var remove = new CustomEvent('removed', {\n        detail: {\n          item: item,\n          id: id\n        }\n      });\n      this.dispatchEvent(remove);\n      this.length = this.size;\n      return item;\n    }\n  }, {\n    key: \"delete\",\n    value: function _delete(item) {\n      if (this[Mapped]) {\n        return this[Mapped].delete(item);\n      }\n      this[Delete](item);\n    }\n  }, {\n    key: Delete,\n    value: function value(item) {\n      this.remove(item);\n    }\n  }, {\n    key: \"map\",\n    value: function map() {\n      var mapper = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : function (x) {\n        return x;\n      };\n      var filter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function (x) {\n        return x;\n      };\n      var mappedItems = new WeakMap();\n      var mappedBag = new Bag();\n      mappedBag[Mapped] = this;\n      this.addEventListener('added', function (event) {\n        var item = event.detail.item;\n        if (!filter(item)) {\n          return;\n        }\n        if (mappedItems.has(item)) {\n          return;\n        }\n        var mapped = mapper(item);\n        mappedItems.set(item, mapped);\n        mappedBag[Add](mapped);\n      });\n      this.addEventListener('removed', function (event) {\n        var item = event.detail.item;\n        if (!mappedItems.has(item)) {\n          return;\n        }\n        var mapped = mappedItems.get(item);\n        mappedItems.delete(item);\n        mappedBag[Remove](mapped);\n      });\n      return mappedBag;\n    }\n  }, {\n    key: \"size\",\n    get: function get() {\n      return this.content.size;\n    }\n  }, {\n    key: \"items\",\n    value: function items() {\n      return Array.from(this.content.entries()).map(function (entry) {\n        return entry[0];\n      });\n    }\n  }]);\n  return Bag;\n}(_Mixin.Mixin.with(_EventTargetMixin.EventTargetMixin));\nexports.Bag = Bag;\nObject.defineProperty(Bag, 'ITEM_ADDED', {\n  configurable: false,\n  enumerable: false,\n  writable: true,\n  value: 1\n});\nObject.defineProperty(Bag, 'ITEM_REMOVED', {\n  configurable: false,\n  enumerable: false,\n  writable: true,\n  value: -1\n});\n  })();\n});","\nrequire.register(\"curvature/base/Bindable.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Bindable = void 0;\nfunction _construct(Parent, args, Class) { if (_isNativeReflectConstruct()) { _construct = Reflect.construct.bind(); } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nvar Ref = Symbol('ref');\nvar Original = Symbol('original');\nvar Deck = Symbol('deck');\nvar Binding = Symbol('binding');\nvar SubBinding = Symbol('subBinding');\nvar BindingAll = Symbol('bindingAll');\nvar IsBindable = Symbol('isBindable');\nvar Wrapping = Symbol('wrapping');\nvar Names = Symbol('Names');\nvar Executing = Symbol('executing');\nvar Stack = Symbol('stack');\nvar ObjSymbol = Symbol('object');\nvar Wrapped = Symbol('wrapped');\nvar Unwrapped = Symbol('unwrapped');\nvar GetProto = Symbol('getProto');\nvar OnGet = Symbol('onGet');\nvar OnAllGet = Symbol('onAllGet');\nvar BindChain = Symbol('bindChain');\nvar Descriptors = Symbol('Descriptors');\nvar Before = Symbol('Before');\nvar After = Symbol('After');\nvar NoGetters = Symbol('NoGetters');\nvar TypedArray = Object.getPrototypeOf(Int8Array);\nvar SetIterator = Set.prototype[Symbol.iterator];\nvar MapIterator = Map.prototype[Symbol.iterator];\nvar win = (typeof globalThis === \"undefined\" ? \"undefined\" : _typeof(globalThis)) === 'object' ? globalThis : (typeof window === \"undefined\" ? \"undefined\" : _typeof(window)) === 'object' ? window : (typeof self === \"undefined\" ? \"undefined\" : _typeof(self)) === 'object' ? self : void 0;\nvar excludedClasses = [win.Node, win.File, win.Map, win.Set, win.WeakMap, win.WeakSet, win.ArrayBuffer, win.ResizeObserver, win.MutationObserver, win.PerformanceObserver, win.IntersectionObserver, win.IDBCursor, win.IDBCursorWithValue, win.IDBDatabase, win.IDBFactory, win.IDBIndex, win.IDBKeyRange, win.IDBObjectStore, win.IDBOpenDBRequest, win.IDBRequest, win.IDBTransaction, win.IDBVersionChangeEvent, win.Event, win.CustomEvent, win.FileSystemFileHandle].filter(function (x) {\n  return typeof x === 'function';\n});\nvar Bindable = /*#__PURE__*/function () {\n  function Bindable() {\n    _classCallCheck(this, Bindable);\n  }\n  _createClass(Bindable, null, [{\n    key: \"isBindable\",\n    value: function isBindable(object) {\n      if (!object || !object[IsBindable]) {\n        return false;\n      }\n      return object[IsBindable] === Bindable;\n    }\n  }, {\n    key: \"onDeck\",\n    value: function onDeck(object, key) {\n      return object[Deck][key] || false;\n    }\n  }, {\n    key: \"ref\",\n    value: function ref(object) {\n      return object[Ref] || object || false;\n    }\n  }, {\n    key: \"makeBindable\",\n    value: function makeBindable(object) {\n      return this.make(object);\n    }\n  }, {\n    key: \"shuck\",\n    value: function shuck(original, seen) {\n      seen = seen || new Map();\n      var clone = Object.create({});\n      if (original instanceof TypedArray || original instanceof ArrayBuffer) {\n        var _clone = original.slice(0);\n        seen.set(original, _clone);\n        return _clone;\n      }\n      var properties = Object.keys(original);\n      for (var i in properties) {\n        var ii = properties[i];\n        if (ii.substring(0, 3) === '___') {\n          continue;\n        }\n        var alreadyCloned = seen.get(original[ii]);\n        if (alreadyCloned) {\n          clone[ii] = alreadyCloned;\n          continue;\n        }\n        if (original[ii] === original) {\n          seen.set(original[ii], clone);\n          clone[ii] = clone;\n          continue;\n        }\n        if (original[ii] && _typeof(original[ii]) === 'object') {\n          var originalProp = original[ii];\n          if (Bindable.isBindable(original[ii])) {\n            originalProp = original[ii][Original];\n          }\n          clone[ii] = this.shuck(originalProp, seen);\n        } else {\n          clone[ii] = original[ii];\n        }\n        seen.set(original[ii], clone[ii]);\n      }\n      if (Bindable.isBindable(original)) {\n        delete clone.bindTo;\n        delete clone.isBound;\n      }\n      return clone;\n    }\n  }, {\n    key: \"make\",\n    value: function make(object) {\n      var _this = this;\n      if (!object || !['function', 'object'].includes(_typeof(object))) {\n        return object;\n      }\n      if (object[Ref]) {\n        return object[Ref];\n      }\n      if (object[IsBindable]) {\n        return object;\n      }\n      if (Object.isSealed(object) || Object.isFrozen(object) || !Object.isExtensible(object) || excludedClasses.find(function (x) {\n        return object instanceof x;\n      })) {\n        return object;\n      }\n      Object.defineProperty(object, IsBindable, {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: Bindable\n      });\n      Object.defineProperty(object, Ref, {\n        configurable: true,\n        enumerable: false,\n        writable: true,\n        value: false\n      });\n      Object.defineProperty(object, Original, {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: object\n      });\n      Object.defineProperty(object, Deck, {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: Object.create(null)\n      });\n      Object.defineProperty(object, Binding, {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: Object.create(null)\n      });\n      Object.defineProperty(object, SubBinding, {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: new Map()\n      });\n      Object.defineProperty(object, BindingAll, {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: new Set()\n      });\n      Object.defineProperty(object, Executing, {\n        enumerable: false,\n        writable: true\n      });\n      Object.defineProperty(object, Wrapping, {\n        enumerable: false,\n        writable: true\n      });\n      Object.defineProperty(object, Stack, {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: []\n      });\n      Object.defineProperty(object, Before, {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: []\n      });\n      Object.defineProperty(object, After, {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: []\n      });\n      Object.defineProperty(object, Wrapped, {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: Object.preventExtensions(new Map())\n      });\n      Object.defineProperty(object, Unwrapped, {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: Object.create(null)\n      });\n      Object.defineProperty(object, Descriptors, {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: Object.preventExtensions(new Map())\n      });\n      var bindTo = function bindTo(property) {\n        var callback = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n        var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n        var bindToAll = false;\n        if (Array.isArray(property)) {\n          var debinders = property.map(function (p) {\n            return bindTo(p, callback, options);\n          });\n          return function () {\n            return debinders.forEach(function (d) {\n              return d();\n            });\n          };\n        }\n        if (property instanceof Function) {\n          options = callback || {};\n          callback = property;\n          bindToAll = true;\n        }\n        if (options.delay >= 0) {\n          callback = _this.wrapDelayCallback(callback, options.delay);\n        }\n        if (options.throttle >= 0) {\n          callback = _this.wrapThrottleCallback(callback, options.throttle);\n        }\n        if (options.wait >= 0) {\n          callback = _this.wrapWaitCallback(callback, options.wait);\n        }\n        if (options.frame) {\n          callback = _this.wrapFrameCallback(callback, options.frame);\n        }\n        if (options.idle) {\n          callback = _this.wrapIdleCallback(callback);\n        }\n        if (bindToAll) {\n          object[BindingAll].add(callback);\n          if (!('now' in options) || options.now) {\n            for (var i in object) {\n              callback(object[i], i, object, false);\n            }\n          }\n          return function () {\n            object[BindingAll].delete(callback);\n          };\n        }\n        if (!object[Binding][property]) {\n          object[Binding][property] = new Set();\n        }\n\n        // let bindIndex = object[Binding][property].length;\n\n        if (options.children) {\n          var original = callback;\n          callback = function callback() {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n            var v = args[0];\n            var subDebind = object[SubBinding].get(original);\n            if (subDebind) {\n              object[SubBinding].delete(original);\n              subDebind();\n            }\n            if (_typeof(v) !== 'object') {\n              original.apply(void 0, args);\n              return;\n            }\n            var vv = Bindable.make(v);\n            if (Bindable.isBindable(vv)) {\n              object[SubBinding].set(original, vv.bindTo(function () {\n                for (var _len2 = arguments.length, subArgs = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n                  subArgs[_key2] = arguments[_key2];\n                }\n                return original.apply(void 0, args.concat(subArgs));\n              }, Object.assign({}, options, {\n                children: false\n              })));\n            }\n            original.apply(void 0, args);\n          };\n        }\n        object[Binding][property].add(callback);\n        if (!('now' in options) || options.now) {\n          callback(object[property], property, object, false);\n        }\n        var debinder = function debinder() {\n          var subDebind = object[SubBinding].get(callback);\n          if (subDebind) {\n            object[SubBinding].delete(callback);\n            subDebind();\n          }\n          if (!object[Binding][property]) {\n            return;\n          }\n          if (!object[Binding][property].has(callback)) {\n            return;\n          }\n          object[Binding][property].delete(callback);\n        };\n        if (options.removeWith && options.removeWith instanceof View) {\n          options.removeWith.onRemove(function () {\n            return debinder;\n          });\n        }\n        return debinder;\n      };\n      Object.defineProperty(object, 'bindTo', {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: bindTo\n      });\n      var ___before = function ___before(callback) {\n        var beforeIndex = object[Before].length;\n        object[Before].push(callback);\n        var cleaned = false;\n        return function () {\n          if (cleaned) {\n            return;\n          }\n          cleaned = true;\n          delete object[Before][beforeIndex];\n        };\n      };\n      var ___after = function ___after(callback) {\n        var afterIndex = object[After].length;\n        object[After].push(callback);\n        var cleaned = false;\n        return function () {\n          if (cleaned) {\n            return;\n          }\n          cleaned = true;\n          delete object[After][afterIndex];\n        };\n      };\n      Object.defineProperty(object, BindChain, {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: function value(path, callback) {\n          var parts = path.split('.');\n          var node = parts.shift();\n          var subParts = parts.slice(0);\n          var debind = [];\n          debind.push(object.bindTo(node, function (v, k, t, d) {\n            var rest = subParts.join('.');\n            if (subParts.length === 0) {\n              callback(v, k, t, d);\n              return;\n            }\n            if (v === undefined) {\n              v = t[k] = _this.make({});\n            }\n            debind = debind.concat(v[BindChain](rest, callback));\n          }));\n          return function () {\n            return debind.forEach(function (x) {\n              return x();\n            });\n          };\n        }\n      });\n      Object.defineProperty(object, '___before', {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: ___before\n      });\n      Object.defineProperty(object, '___after', {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: ___after\n      });\n      var isBound = function isBound() {\n        if (object[BindingAll].size) {\n          return true;\n        }\n        for (var i in object[Binding]) {\n          var _iterator = _createForOfIteratorHelper(object[Binding][i]),\n            _step;\n          try {\n            for (_iterator.s(); !(_step = _iterator.n()).done;) {\n              var callback = _step.value;\n              if (callback) {\n                return true;\n              }\n            }\n          } catch (err) {\n            _iterator.e(err);\n          } finally {\n            _iterator.f();\n          }\n        }\n        return false;\n      };\n      Object.defineProperty(object, 'isBound', {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: isBound\n      });\n      var _loop = function _loop(i) {\n        if (object[i] && object[i] instanceof Object && !object[i] instanceof Promise) {\n          if (!excludedClasses.find(function (excludeClass) {\n            return object[i] instanceof excludeClass;\n          }) && Object.isExtensible(object[i]) && !Object.isSealed(object[i])) {\n            object[i] = Bindable.make(object[i]);\n          }\n        }\n      };\n      for (var i in object) {\n        _loop(i);\n      }\n      var descriptors = object[Descriptors];\n      var wrapped = object[Wrapped];\n      var stack = object[Stack];\n      var set = function set(target, key, value) {\n        if (wrapped.has(key)) {\n          wrapped.delete(key);\n        }\n        if (key === Original) {\n          return true;\n        }\n        var onDeck = object[Deck];\n\n        // if(onDeck[key] !== undefined && onDeck[key] === value)\n        if (key in onDeck && onDeck[key] === value) {\n          return true;\n        }\n        if (key.slice && key.slice(-3) === '___') {\n          return true;\n        }\n        if (target[key] === value || typeof value === 'number' && isNaN(onDeck[key]) && isNaN(value)) {\n          return true;\n        }\n        if (value && value instanceof Object && Object.isExtensible(object) && !Object.isSealed(object) && !excludedClasses.find(function (x) {\n          return object instanceof x;\n        })) {\n          value = Bindable.make(value);\n          if (target[key] === value) {\n            return true;\n          }\n        }\n        onDeck[key] = value;\n        var _iterator2 = _createForOfIteratorHelper(object[BindingAll]),\n          _step2;\n        try {\n          for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n            var _callback2 = _step2.value;\n            _callback2(value, key, target, false);\n          }\n        } catch (err) {\n          _iterator2.e(err);\n        } finally {\n          _iterator2.f();\n        }\n        if (key in object[Binding]) {\n          var _iterator3 = _createForOfIteratorHelper(object[Binding][key]),\n            _step3;\n          try {\n            for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n              var callback = _step3.value;\n              callback(value, key, target, false, target[key]);\n            }\n          } catch (err) {\n            _iterator3.e(err);\n          } finally {\n            _iterator3.f();\n          }\n        }\n        delete onDeck[key];\n        var excluded = target instanceof File && key == 'lastModifiedDate';\n        if (!excluded) {\n          Reflect.set(target, key, value);\n        }\n        if (Array.isArray(target) && object[Binding]['length']) {\n          for (var _i in object[Binding]['length']) {\n            var _callback = object[Binding]['length'][_i];\n            _callback(target.length, 'length', target, false, target.length);\n          }\n        }\n        return true;\n      };\n      var deleteProperty = function deleteProperty(target, key) {\n        var onDeck = object[Deck];\n        if (onDeck[key] !== undefined) {\n          return true;\n        }\n        if (!(key in target)) {\n          return true;\n        }\n        if (descriptors.has(key)) {\n          var descriptor = descriptors.get(key);\n          if (descriptor && !descriptor.configurable) {\n            return false;\n          }\n          descriptors.delete(key);\n        }\n        onDeck[key] = null;\n        if (wrapped.has(key)) {\n          wrapped.delete(key);\n        }\n        var _iterator4 = _createForOfIteratorHelper(object[BindingAll]),\n          _step4;\n        try {\n          for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n            var callback = _step4.value;\n            callback(undefined, key, target, true, target[key]);\n          }\n        } catch (err) {\n          _iterator4.e(err);\n        } finally {\n          _iterator4.f();\n        }\n        if (key in object[Binding]) {\n          var _iterator5 = _createForOfIteratorHelper(object[Binding][key]),\n            _step5;\n          try {\n            for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n              var binding = _step5.value;\n              binding(undefined, key, target, true, target[key]);\n            }\n          } catch (err) {\n            _iterator5.e(err);\n          } finally {\n            _iterator5.f();\n          }\n        }\n        delete onDeck[key];\n        delete target[key];\n        return true;\n      };\n      var construct = function construct(target, args) {\n        var key = 'constructor';\n        for (var _i2 in target[Before]) {\n          target[Before][_i2](target, key, object[Stack], undefined, args);\n        }\n        var instance = Bindable.make(_construct(target[Original], _toConsumableArray(args)));\n        for (var _i3 in target[After]) {\n          target[After][_i3](target, key, object[Stack], instance, args);\n        }\n        return instance;\n      };\n      var get = function get(target, key) {\n        if (wrapped.has(key)) {\n          return wrapped.get(key);\n        }\n        if (key === Ref || key === Original || key === 'apply' || key === 'isBound' || key === 'bindTo' || key === '__proto__' || key === 'constructor') {\n          return object[key];\n        }\n        var descriptor;\n        if (descriptors.has(key)) {\n          descriptor = descriptors.get(key);\n        } else {\n          descriptor = Object.getOwnPropertyDescriptor(object, key);\n          descriptors.set(key, descriptor);\n        }\n        if (descriptor && !descriptor.configurable && !descriptor.writable) {\n          return object[key];\n        }\n        if (OnAllGet in object) {\n          return object[OnAllGet](key);\n        }\n        if (OnGet in object && !(key in object)) {\n          return object[OnGet](key);\n        }\n        if (descriptor && !descriptor.configurable && !descriptor.writable) {\n          wrapped.set(key, object[key]);\n          return object[key];\n        }\n        if (typeof object[key] === 'function') {\n          if (Names in object[key]) {\n            return object[key];\n          }\n          Object.defineProperty(object[Unwrapped], key, {\n            configurable: false,\n            enumerable: false,\n            writable: true,\n            value: object[key]\n          });\n          var prototype = Object.getPrototypeOf(object);\n          var isMethod = prototype[key] === object[key];\n          var objRef = typeof Promise === 'function' && object instanceof Promise || typeof Map === 'function' && object instanceof Map || typeof Set === 'function' && object instanceof Set || typeof MapIterator === 'function' && object.prototype === MapIterator || typeof SetIterator === 'function' && object.prototype === SetIterator || typeof SetIterator === 'function' && object.prototype === SetIterator || typeof WeakMap === 'function' && object instanceof WeakMap || typeof WeakSet === 'function' && object instanceof WeakSet || typeof Date === 'function' && object instanceof Date || typeof TypedArray === 'function' && object instanceof TypedArray || typeof ArrayBuffer === 'function' && object instanceof ArrayBuffer || typeof EventTarget === 'function' && object instanceof EventTarget || typeof ResizeObserver === 'function' && object instanceof ResizeObserver || typeof MutationObserver === 'function' && object instanceof MutationObserver || typeof PerformanceObserver === 'function' && object instanceof PerformanceObserver || typeof IntersectionObserver === 'function' && object instanceof IntersectionObserver || typeof object[Symbol.iterator] === 'function' && key === 'next' ? object : object[Ref];\n          var wrappedMethod = function _target() {\n            object[Executing] = key;\n            stack.unshift(key);\n            for (var _len3 = arguments.length, providedArgs = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n              providedArgs[_key3] = arguments[_key3];\n            }\n            var _iterator6 = _createForOfIteratorHelper(object[Before]),\n              _step6;\n            try {\n              for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {\n                var beforeCallback = _step6.value;\n                beforeCallback(object, key, stack, object, providedArgs);\n              }\n            } catch (err) {\n              _iterator6.e(err);\n            } finally {\n              _iterator6.f();\n            }\n            var ret;\n            if (this instanceof _target ? this.constructor : void 0) {\n              ret = _construct(object[Unwrapped][key], providedArgs);\n            } else {\n              var func = object[Unwrapped][key];\n              if (isMethod) {\n                ret = func.apply(objRef || object, providedArgs);\n              } else {\n                ret = func.apply(void 0, providedArgs);\n              }\n            }\n            var _iterator7 = _createForOfIteratorHelper(object[After]),\n              _step7;\n            try {\n              for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {\n                var afterCallback = _step7.value;\n                afterCallback(object, key, stack, object, providedArgs);\n              }\n            } catch (err) {\n              _iterator7.e(err);\n            } finally {\n              _iterator7.f();\n            }\n            object[Executing] = null;\n            stack.shift();\n            return ret;\n          };\n          wrappedMethod[Names] = wrappedMethod[Names] || new WeakMap();\n          wrappedMethod[Names].set(object, key);\n          wrappedMethod[OnAllGet] = function (key) {\n            var selfName = wrappedMethod[Names].get(object);\n            return object[selfName][key];\n          };\n          var result = Bindable.make(wrappedMethod);\n          wrapped.set(key, result);\n          return result;\n        }\n        return object[key];\n      };\n      var getPrototypeOf = function getPrototypeOf(target) {\n        if (GetProto in object) {\n          return object[GetProto];\n        }\n        return Reflect.getPrototypeOf(target);\n      };\n      var handler = {\n        get: get,\n        set: set,\n        construct: construct,\n        getPrototypeOf: getPrototypeOf,\n        deleteProperty: deleteProperty\n      };\n      if (object[NoGetters]) {\n        delete handler.getPrototypeOf;\n        delete handler.get;\n      }\n      Object.defineProperty(object, Ref, {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: new Proxy(object, handler)\n      });\n      return object[Ref];\n    }\n  }, {\n    key: \"clearBindings\",\n    value: function clearBindings(object) {\n      var clearObj = function clearObj(o) {\n        return Object.keys(o).map(function (k) {\n          return delete o[k];\n        });\n      };\n      var maps = function maps(func) {\n        return function () {\n          for (var _len4 = arguments.length, os = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n            os[_key4] = arguments[_key4];\n          }\n          return os.map(func);\n        };\n      };\n      var clearObjs = maps(clearObj);\n      object[BindingAll].clear();\n      clearObjs(object[Wrapped], object[Binding], object[After], object[Before]);\n    }\n  }, {\n    key: \"resolve\",\n    value: function resolve(object, path) {\n      var owner = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var node;\n      var pathParts = path.split('.');\n      var top = pathParts[0];\n      while (pathParts.length) {\n        if (owner && pathParts.length === 1) {\n          var obj = this.make(object);\n          return [obj, pathParts.shift(), top];\n        }\n        node = pathParts.shift();\n        if (!(node in object) || !object[node] || !(object[node] instanceof Object)) {\n          object[node] = Object.create(null);\n        }\n        object = this.make(object[node]);\n      }\n      return [this.make(object), node, top];\n    }\n  }, {\n    key: \"wrapDelayCallback\",\n    value: function wrapDelayCallback(callback, delay) {\n      return function () {\n        for (var _len5 = arguments.length, args = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {\n          args[_key5] = arguments[_key5];\n        }\n        return setTimeout(function () {\n          return callback.apply(void 0, args);\n        }, delay);\n      };\n    }\n  }, {\n    key: \"wrapThrottleCallback\",\n    value: function wrapThrottleCallback(callback, throttle) {\n      var _this2 = this;\n      this.throttles.set(callback, false);\n      return function () {\n        if (_this2.throttles.get(callback, true)) {\n          return;\n        }\n        callback.apply(void 0, arguments);\n        _this2.throttles.set(callback, true);\n        setTimeout(function () {\n          _this2.throttles.set(callback, false);\n        }, throttle);\n      };\n    }\n  }, {\n    key: \"wrapWaitCallback\",\n    value: function wrapWaitCallback(callback, wait) {\n      var _this3 = this;\n      return function () {\n        for (var _len6 = arguments.length, args = new Array(_len6), _key6 = 0; _key6 < _len6; _key6++) {\n          args[_key6] = arguments[_key6];\n        }\n        var waiter;\n        if (waiter = _this3.waiters.get(callback)) {\n          _this3.waiters.delete(callback);\n          clearTimeout(waiter);\n        }\n        waiter = setTimeout(function () {\n          return callback.apply(void 0, args);\n        }, wait);\n        _this3.waiters.set(callback, waiter);\n      };\n    }\n  }, {\n    key: \"wrapFrameCallback\",\n    value: function wrapFrameCallback(callback, frames) {\n      return function () {\n        for (var _len7 = arguments.length, args = new Array(_len7), _key7 = 0; _key7 < _len7; _key7++) {\n          args[_key7] = arguments[_key7];\n        }\n        requestAnimationFrame(function () {\n          return callback.apply(void 0, args);\n        });\n      };\n    }\n  }, {\n    key: \"wrapIdleCallback\",\n    value: function wrapIdleCallback(callback) {\n      return function () {\n        for (var _len8 = arguments.length, args = new Array(_len8), _key8 = 0; _key8 < _len8; _key8++) {\n          args[_key8] = arguments[_key8];\n        }\n        // Compatibility for Safari 08/2020\n        var req = window.requestIdleCallback || requestAnimationFrame;\n        req(function () {\n          return callback.apply(void 0, args);\n        });\n      };\n    }\n  }]);\n  return Bindable;\n}();\nexports.Bindable = Bindable;\n_defineProperty(Bindable, \"waiters\", new WeakMap());\n_defineProperty(Bindable, \"throttles\", new WeakMap());\nObject.defineProperty(Bindable, 'OnGet', {\n  configurable: false,\n  enumerable: false,\n  writable: false,\n  value: OnGet\n});\nObject.defineProperty(Bindable, 'NoGetters', {\n  configurable: false,\n  enumerable: false,\n  writable: false,\n  value: NoGetters\n});\nObject.defineProperty(Bindable, 'GetProto', {\n  configurable: false,\n  enumerable: false,\n  writable: false,\n  value: GetProto\n});\nObject.defineProperty(Bindable, 'OnAllGet', {\n  configurable: false,\n  enumerable: false,\n  writable: false,\n  value: OnAllGet\n});\n  })();\n});","\nrequire.register(\"curvature/base/Cache.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Cache = void 0;\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar Cache = /*#__PURE__*/function () {\n  function Cache() {\n    _classCallCheck(this, Cache);\n  }\n  _createClass(Cache, null, [{\n    key: \"store\",\n    value: function store(key, value, expiry) {\n      var bucket = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 'standard';\n      var expiration = 0;\n      if (expiry) {\n        expiration = expiry * 1000 + new Date().getTime();\n      }\n      if (!this.buckets) {\n        this.buckets = new Map();\n      }\n      if (!this.buckets.has(bucket)) {\n        this.buckets.set(bucket, new Map());\n      }\n      var eventEnd = new CustomEvent('cvCacheStore', {\n        cancelable: true,\n        detail: {\n          key: key,\n          value: value,\n          expiry: expiry,\n          bucket: bucket\n        }\n      });\n      if (document.dispatchEvent(eventEnd)) {\n        this.buckets.get(bucket).set(key, {\n          value: value,\n          expiration: expiration\n        });\n      }\n    }\n  }, {\n    key: \"load\",\n    value: function load(key) {\n      var defaultvalue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var bucket = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'standard';\n      var eventEnd = new CustomEvent('cvCacheLoad', {\n        cancelable: true,\n        detail: {\n          key: key,\n          defaultvalue: defaultvalue,\n          bucket: bucket\n        }\n      });\n      if (!document.dispatchEvent(eventEnd)) {\n        return defaultvalue;\n      }\n      if (this.buckets && this.buckets.has(bucket) && this.buckets.get(bucket).has(key)) {\n        var entry = this.buckets.get(bucket).get(key);\n        // console.log(this.bucket[bucket][key].expiration, (new Date).getTime());\n        if (entry.expiration === 0 || entry.expiration > new Date().getTime()) {\n          return this.buckets.get(bucket).get(key).value;\n        }\n      }\n      return defaultvalue;\n    }\n  }]);\n  return Cache;\n}();\nexports.Cache = Cache;\n  })();\n});","\nrequire.register(\"curvature/base/Config.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Config = void 0;\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nvar AppConfig = {};\nvar _require = require;\nvar win = (typeof globalThis === \"undefined\" ? \"undefined\" : _typeof(globalThis)) === 'object' ? globalThis : (typeof window === \"undefined\" ? \"undefined\" : _typeof(window)) === 'object' ? window : (typeof self === \"undefined\" ? \"undefined\" : _typeof(self)) === 'object' ? self : void 0;\ntry {\n  AppConfig = _require('/Config').Config;\n} catch (error) {\n  win.devMode === true && console.error(error);\n  AppConfig = {};\n}\nvar Config = /*#__PURE__*/function () {\n  function Config() {\n    _classCallCheck(this, Config);\n  }\n  _createClass(Config, null, [{\n    key: \"get\",\n    value: function get(name) {\n      return this.configs[name];\n    }\n  }, {\n    key: \"set\",\n    value: function set(name, value) {\n      this.configs[name] = value;\n      return this;\n    }\n  }, {\n    key: \"dump\",\n    value: function dump() {\n      return this.configs;\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      for (var _len = arguments.length, configs = new Array(_len), _key = 0; _key < _len; _key++) {\n        configs[_key] = arguments[_key];\n      }\n      for (var i in configs) {\n        var config = configs[i];\n        if (typeof config === 'string') {\n          config = JSON.parse(config);\n        }\n        for (var name in config) {\n          var value = config[name];\n          return this.configs[name] = value;\n        }\n      }\n      return this;\n    }\n  }]);\n  return Config;\n}();\nexports.Config = Config;\nObject.defineProperty(Config, 'configs', {\n  configurable: false,\n  enumerable: false,\n  writable: false,\n  value: AppConfig\n});\n  })();\n});","\nrequire.register(\"curvature/base/Dom.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Dom = void 0;\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar traversals = 0;\nvar Dom = /*#__PURE__*/function () {\n  function Dom() {\n    _classCallCheck(this, Dom);\n  }\n  _createClass(Dom, null, [{\n    key: \"mapTags\",\n    value: function mapTags(doc, selector, callback, startNode, endNode) {\n      var result = [];\n      var started = true;\n      if (startNode) {\n        started = false;\n      }\n      var ended = false;\n      var treeWalker = document.createTreeWalker(doc, NodeFilter.SHOW_ELEMENT | NodeFilter.SHOW_TEXT, {\n        acceptNode: function acceptNode(node, walker) {\n          if (!started) {\n            if (node === startNode) {\n              started = true;\n            } else {\n              return NodeFilter.FILTER_SKIP;\n            }\n          }\n          if (endNode && node === endNode) {\n            ended = true;\n          }\n          if (ended) {\n            return NodeFilter.FILTER_SKIP;\n          }\n          if (selector) {\n            if (node instanceof Element) {\n              if (node.matches(selector)) {\n                return NodeFilter.FILTER_ACCEPT;\n              }\n            }\n            return NodeFilter.FILTER_SKIP;\n          }\n          return NodeFilter.FILTER_ACCEPT;\n        }\n      }, false);\n      var traversal = traversals++;\n      while (treeWalker.nextNode()) {\n        result.push(callback(treeWalker.currentNode, treeWalker));\n      }\n      return result;\n    }\n  }, {\n    key: \"dispatchEvent\",\n    value: function dispatchEvent(doc, event) {\n      doc.dispatchEvent(event);\n      Dom.mapTags(doc, false, function (node) {\n        node.dispatchEvent(event);\n      });\n    }\n  }]);\n  return Dom;\n}();\nexports.Dom = Dom;\n  })();\n});","\nrequire.register(\"curvature/base/Mixin.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Mixin = void 0;\nvar _Bindable = require(\"./Bindable\");\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar Constructor = Symbol('constructor');\nvar MixinList = Symbol('mixinList');\nvar Mixin = /*#__PURE__*/function () {\n  function Mixin() {\n    _classCallCheck(this, Mixin);\n  }\n  _createClass(Mixin, null, [{\n    key: \"from\",\n    value: function from(baseClass) {\n      for (var _len = arguments.length, mixins = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        mixins[_key - 1] = arguments[_key];\n      }\n      var newClass = /*#__PURE__*/function (_baseClass) {\n        _inherits(newClass, _baseClass);\n        var _super = _createSuper(newClass);\n        function newClass() {\n          var _this;\n          _classCallCheck(this, newClass);\n          for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n            args[_key2] = arguments[_key2];\n          }\n          var instance = baseClass.constructor ? _this = _super.call.apply(_super, [this].concat(args)) : null;\n          var _iterator = _createForOfIteratorHelper(mixins),\n            _step;\n          try {\n            for (_iterator.s(); !(_step = _iterator.n()).done;) {\n              var mixin = _step.value;\n              if (mixin[Mixin.Constructor]) {\n                mixin[Mixin.Constructor].apply(_assertThisInitialized(_this));\n              }\n              switch (_typeof(mixin)) {\n                case 'function':\n                  Mixin.mixClass(mixin, newClass);\n                  break;\n                case 'object':\n                  Mixin.mixObject(mixin, _assertThisInitialized(_this));\n                  break;\n              }\n            }\n          } catch (err) {\n            _iterator.e(err);\n          } finally {\n            _iterator.f();\n          }\n          return _possibleConstructorReturn(_this, instance);\n        }\n        return _createClass(newClass);\n      }(baseClass);\n      return newClass;\n    }\n  }, {\n    key: \"make\",\n    value: function make() {\n      for (var _len3 = arguments.length, classes = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n        classes[_key3] = arguments[_key3];\n      }\n      var base = classes.pop();\n      return Mixin.to.apply(Mixin, [base].concat(classes));\n    }\n  }, {\n    key: \"to\",\n    value: function to(base) {\n      var descriptors = {};\n      for (var _len4 = arguments.length, mixins = new Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {\n        mixins[_key4 - 1] = arguments[_key4];\n      }\n      mixins.map(function (mixin) {\n        switch (_typeof(mixin)) {\n          case 'object':\n            Object.assign(descriptors, Object.getOwnPropertyDescriptors(mixin));\n            break;\n          case 'function':\n            Object.assign(descriptors, Object.getOwnPropertyDescriptors(mixin.prototype));\n            break;\n        }\n        delete descriptors.constructor;\n        Object.defineProperties(base.prototype, descriptors);\n      });\n    }\n  }, {\n    key: \"with\",\n    value: function _with() {\n      for (var _len5 = arguments.length, mixins = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {\n        mixins[_key5] = arguments[_key5];\n      }\n      return this.from.apply(this, [/*#__PURE__*/function () {\n        function _class() {\n          _classCallCheck(this, _class);\n        }\n        return _createClass(_class);\n      }()].concat(mixins));\n    }\n  }, {\n    key: \"mixObject\",\n    value: function mixObject(mixin, instance) {\n      var _iterator2 = _createForOfIteratorHelper(Object.getOwnPropertyNames(mixin)),\n        _step2;\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var func = _step2.value;\n          if (typeof mixin[func] === 'function') {\n            instance[func] = mixin[func].bind(instance);\n            continue;\n          }\n          instance[func] = mixin[func];\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n      var _iterator3 = _createForOfIteratorHelper(Object.getOwnPropertySymbols(mixin)),\n        _step3;\n      try {\n        for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n          var _func = _step3.value;\n          if (typeof mixin[_func] === 'function') {\n            instance[_func] = mixin[_func].bind(instance);\n            continue;\n          }\n          instance[_func] = mixin[_func];\n        }\n      } catch (err) {\n        _iterator3.e(err);\n      } finally {\n        _iterator3.f();\n      }\n    }\n  }, {\n    key: \"mixClass\",\n    value: function mixClass(cls, newClass) {\n      var _iterator4 = _createForOfIteratorHelper(Object.getOwnPropertyNames(cls.prototype)),\n        _step4;\n      try {\n        for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n          var func = _step4.value;\n          if (['name', 'prototype', 'length'].includes(func)) {\n            continue;\n          }\n          var descriptor = Object.getOwnPropertyDescriptor(newClass, func);\n          if (descriptor && !descriptor.writable) {\n            continue;\n          }\n          if (typeof cls[func] !== 'function') {\n            newClass.prototype[func] = cls.prototype[func];\n            continue;\n          }\n          newClass.prototype[func] = cls.prototype[func].bind(newClass.prototype);\n        }\n      } catch (err) {\n        _iterator4.e(err);\n      } finally {\n        _iterator4.f();\n      }\n      var _iterator5 = _createForOfIteratorHelper(Object.getOwnPropertySymbols(cls.prototype)),\n        _step5;\n      try {\n        for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n          var _func2 = _step5.value;\n          if (typeof cls[_func2] !== 'function') {\n            newClass.prototype[_func2] = cls.prototype[_func2];\n            continue;\n          }\n          newClass.prototype[_func2] = cls.prototype[_func2].bind(newClass.prototype);\n        }\n      } catch (err) {\n        _iterator5.e(err);\n      } finally {\n        _iterator5.f();\n      }\n      var _iterator6 = _createForOfIteratorHelper(Object.getOwnPropertyNames(cls)),\n        _step6;\n      try {\n        var _loop = function _loop() {\n          var func = _step6.value;\n          if (['name', 'prototype', 'length'].includes(func)) {\n            return \"continue\";\n          }\n          var descriptor = Object.getOwnPropertyDescriptor(newClass, func);\n          if (descriptor && !descriptor.writable) {\n            return \"continue\";\n          }\n          if (typeof cls[func] !== 'function') {\n            newClass[func] = cls[func];\n            return \"continue\";\n          }\n          var prev = newClass[func] || false;\n          var meth = cls[func].bind(newClass);\n          newClass[func] = function () {\n            prev && prev.apply(void 0, arguments);\n            return meth.apply(void 0, arguments);\n          };\n        };\n        for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {\n          var _ret = _loop();\n          if (_ret === \"continue\") continue;\n        }\n      } catch (err) {\n        _iterator6.e(err);\n      } finally {\n        _iterator6.f();\n      }\n      var _iterator7 = _createForOfIteratorHelper(Object.getOwnPropertySymbols(cls)),\n        _step7;\n      try {\n        var _loop2 = function _loop2() {\n          var func = _step7.value;\n          if (typeof cls[func] !== 'function') {\n            newClass.prototype[func] = cls[func];\n            return \"continue\";\n          }\n          var prev = newClass[func] || false;\n          var meth = cls[func].bind(newClass);\n          newClass[func] = function () {\n            prev && prev.apply(void 0, arguments);\n            return meth.apply(void 0, arguments);\n          };\n        };\n        for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {\n          var _ret2 = _loop2();\n          if (_ret2 === \"continue\") continue;\n        }\n      } catch (err) {\n        _iterator7.e(err);\n      } finally {\n        _iterator7.f();\n      }\n    }\n  }, {\n    key: \"mix\",\n    value: function mix(mixinTo) {\n      var constructors = [];\n      var allStatic = {};\n      var allInstance = {};\n      var mixable = _Bindable.Bindable.makeBindable(mixinTo);\n      var _loop3 = function _loop3(base) {\n        var instanceNames = Object.getOwnPropertyNames(base.prototype);\n        var staticNames = Object.getOwnPropertyNames(base);\n        var prefix = /^(before|after)__(.+)/;\n        var _iterator8 = _createForOfIteratorHelper(staticNames),\n          _step8;\n        try {\n          var _loop5 = function _loop5() {\n            var methodName = _step8.value;\n            var match = methodName.match(prefix);\n            if (match) {\n              switch (match[1]) {\n                case 'before':\n                  mixable.___before(function (t, e, s, o, a) {\n                    if (e !== match[2]) {\n                      return;\n                    }\n                    var method = base[methodName].bind(o);\n                    return method.apply(void 0, _toConsumableArray(a));\n                  });\n                  break;\n                case 'after':\n                  mixable.___after(function (t, e, s, o, a) {\n                    if (e !== match[2]) {\n                      return;\n                    }\n                    var method = base[methodName].bind(o);\n                    return method.apply(void 0, _toConsumableArray(a));\n                  });\n                  break;\n              }\n              return \"continue\";\n            }\n            if (allStatic[methodName]) {\n              return \"continue\";\n            }\n            if (typeof base[methodName] !== 'function') {\n              return \"continue\";\n            }\n            allStatic[methodName] = base[methodName];\n          };\n          for (_iterator8.s(); !(_step8 = _iterator8.n()).done;) {\n            var _ret3 = _loop5();\n            if (_ret3 === \"continue\") continue;\n          }\n        } catch (err) {\n          _iterator8.e(err);\n        } finally {\n          _iterator8.f();\n        }\n        var _iterator9 = _createForOfIteratorHelper(instanceNames),\n          _step9;\n        try {\n          var _loop6 = function _loop6() {\n            var methodName = _step9.value;\n            var match = methodName.match(prefix);\n            if (match) {\n              switch (match[1]) {\n                case 'before':\n                  mixable.___before(function (t, e, s, o, a) {\n                    if (e !== match[2]) {\n                      return;\n                    }\n                    var method = base.prototype[methodName].bind(o);\n                    return method.apply(void 0, _toConsumableArray(a));\n                  });\n                  break;\n                case 'after':\n                  mixable.___after(function (t, e, s, o, a) {\n                    if (e !== match[2]) {\n                      return;\n                    }\n                    var method = base.prototype[methodName].bind(o);\n                    return method.apply(void 0, _toConsumableArray(a));\n                  });\n                  break;\n              }\n              return \"continue\";\n            }\n            if (allInstance[methodName]) {\n              return \"continue\";\n            }\n            if (typeof base.prototype[methodName] !== 'function') {\n              return \"continue\";\n            }\n            allInstance[methodName] = base.prototype[methodName];\n          };\n          for (_iterator9.s(); !(_step9 = _iterator9.n()).done;) {\n            var _ret4 = _loop6();\n            if (_ret4 === \"continue\") continue;\n          }\n        } catch (err) {\n          _iterator9.e(err);\n        } finally {\n          _iterator9.f();\n        }\n      };\n      for (var base = this; base && base.prototype; base = Object.getPrototypeOf(base)) {\n        _loop3(base);\n      }\n      for (var methodName in allStatic) {\n        mixinTo[methodName] = allStatic[methodName].bind(mixinTo);\n      }\n      var _loop4 = function _loop4(_methodName) {\n        mixinTo.prototype[_methodName] = function () {\n          for (var _len6 = arguments.length, args = new Array(_len6), _key6 = 0; _key6 < _len6; _key6++) {\n            args[_key6] = arguments[_key6];\n          }\n          return allInstance[_methodName].apply(this, args);\n        };\n      };\n      for (var _methodName in allInstance) {\n        _loop4(_methodName);\n      }\n      return mixable;\n    }\n  }]);\n  return Mixin;\n}();\nexports.Mixin = Mixin;\nMixin.Constructor = Constructor;\n  })();\n});","\nrequire.register(\"curvature/base/Router.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Router = void 0;\nvar _View = require(\"./View\");\nvar _Cache = require(\"./Cache\");\nvar _Config = require(\"./Config\");\nvar _Routes = require(\"./Routes\");\nvar _win$CustomEvent;\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _iterableToArrayLimit(arr, i) { var _i = null == arr ? null : \"undefined\" != typeof Symbol && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (null != _i) { var _s, _e, _x, _r, _arr = [], _n = !0, _d = !1; try { if (_x = (_i = _i.call(arr)).next, 0 === i) { if (Object(_i) !== _i) return; _n = !1; } else for (; !(_n = (_s = _x.call(_i)).done) && (_arr.push(_s.value), _arr.length !== i); _n = !0); } catch (err) { _d = !0, _e = err; } finally { try { if (!_n && null != _i.return && (_r = _i.return(), Object(_r) !== _r)) return; } finally { if (_d) throw _e; } } return _arr; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e2) { throw _e2; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e3) { didErr = true; err = _e3; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nvar NotFoundError = Symbol('NotFound');\nvar InternalError = Symbol('Internal');\nvar win = (typeof globalThis === \"undefined\" ? \"undefined\" : _typeof(globalThis)) === 'object' ? globalThis : (typeof window === \"undefined\" ? \"undefined\" : _typeof(window)) === 'object' ? window : (typeof self === \"undefined\" ? \"undefined\" : _typeof(self)) === 'object' ? self : void 0;\nwin.CustomEvent = (_win$CustomEvent = win.CustomEvent) !== null && _win$CustomEvent !== void 0 ? _win$CustomEvent : win.Event;\nvar Router = /*#__PURE__*/function () {\n  function Router() {\n    _classCallCheck(this, Router);\n  }\n  _createClass(Router, null, [{\n    key: \"wait\",\n    value: function wait(view) {\n      var _this = this;\n      var event = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'DOMContentLoaded';\n      var node = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : document;\n      node.addEventListener(event, function () {\n        _this.listen(view);\n      });\n    }\n  }, {\n    key: \"listen\",\n    value: function listen(listener) {\n      var _this2 = this;\n      var routes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      this.listener = listener || this.listener;\n      this.routes = routes || listener.routes;\n      Object.assign(this.query, this.queryOver({}));\n      var listen = function listen(event) {\n        event.preventDefault();\n        if (event.state && 'routedId' in event.state) {\n          if (event.state.routedId <= _this2.routeCount) {\n            _this2.history.splice(event.state.routedId);\n            _this2.routeCount = event.state.routedId;\n          } else if (event.state.routedId > _this2.routeCount) {\n            _this2.history.push(event.state.prev);\n            _this2.routeCount = event.state.routedId;\n          }\n          _this2.state = event.state;\n        } else {\n          if (_this2.prevPath !== null && _this2.prevPath !== location.pathname) {\n            _this2.history.push(_this2.prevPath);\n          }\n        }\n        if (!_this2.isOriginLimited(location)) {\n          _this2.match(location.pathname, listener);\n        } else {\n          _this2.match(_this2.nextPath, listener);\n        }\n      };\n      window.addEventListener('cvUrlChanged', listen);\n      window.addEventListener('popstate', listen);\n      var route = !this.isOriginLimited(location) ? location.pathname + location.search : false;\n      if (!this.isOriginLimited(location) && location.hash) {\n        route += location.hash;\n      }\n      var state = {\n        routedId: this.routeCount,\n        url: location.pathname,\n        prev: this.prevPath\n      };\n      if (!this.isOriginLimited(location)) {\n        history.replaceState(state, null, location.pathname);\n      }\n      this.go(route !== false ? route : '/');\n    }\n  }, {\n    key: \"go\",\n    value: function go(path) {\n      var silent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var configTitle = _Config.Config.get('title');\n      if (configTitle) {\n        document.title = configTitle;\n      }\n      var state = {\n        routedId: this.routeCount,\n        prev: this.prevPath,\n        url: location.pathname\n      };\n      if (silent === -1) {\n        this.match(path, this.listener, true);\n      } else if (this.isOriginLimited(location)) {\n        this.nextPath = path;\n      } else if (silent === 2 && location.pathname !== path) {\n        history.replaceState(state, null, path);\n      } else if (location.pathname !== path) {\n        history.pushState(state, null, path);\n      }\n      if (!silent || silent < 0) {\n        if (silent === false) {\n          this.path = null;\n        }\n        if (!silent) {\n          if (path.substring(0, 1) === '#') {\n            window.dispatchEvent(new HashChangeEvent('hashchange'));\n          } else {\n            window.dispatchEvent(new CustomEvent('cvUrlChanged'));\n          }\n        }\n      }\n      this.prevPath = path;\n    }\n  }, {\n    key: \"processRoute\",\n    value: function processRoute(routes, selected, args) {\n      var result = false;\n      if (typeof routes[selected] === 'function') {\n        if (routes[selected].prototype instanceof _View.View) {\n          result = new routes[selected](args);\n        } else {\n          result = routes[selected](args);\n        }\n      } else {\n        result = routes[selected];\n      }\n      return result;\n    }\n  }, {\n    key: \"handleError\",\n    value: function handleError(error, routes, selected, args, listener, path, prev, forceRefresh) {\n      if (typeof document !== 'undefined') {\n        document.dispatchEvent(new CustomEvent('cvRouteError', {\n          detail: {\n            error: error,\n            path: path,\n            prev: prev,\n            view: listener,\n            routes: routes,\n            selected: selected\n          }\n        }));\n      }\n      var result = win['devMode'] ? 'Unexpected error: ' + String(error) : 'Unexpected error.';\n      if (routes[InternalError]) {\n        args[InternalError] = error;\n        result = this.processRoute(routes, InternalError, args);\n      }\n      this.update(listener, path, result, routes, selected, args, forceRefresh);\n    }\n  }, {\n    key: \"match\",\n    value: function match(path, listener) {\n      var _this3 = this;\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var event = null,\n        request = null,\n        forceRefresh = false;\n      if (options === true) {\n        forceRefresh = options;\n      }\n      if (options && _typeof(options) === 'object') {\n        forceRefresh = options.forceRefresh;\n        event = options.event;\n      }\n      if (typeof document !== 'undefined' && this.path === path && !forceRefresh) {\n        return;\n      }\n      var origin = 'http://example.com';\n      if (typeof document !== 'undefined') {\n        origin = this.isOriginLimited(location) ? origin : location.origin;\n        this.queryString = location.search;\n      }\n      var url = new URL(path, origin);\n      path = this.path = url.pathname;\n      if (typeof document === 'undefined') {\n        this.queryString = url.search;\n      }\n      var prev = this.prevPath;\n      var current = listener && listener.args ? listener.args.content : null;\n      var routes = this.routes || listener && listener.routes || _Routes.Routes.dump();\n      var query = new URLSearchParams(this.queryString);\n      if (event && event.request) {\n        this.request = event.request;\n      }\n      for (var key in Object.keys(this.query)) {\n        delete this.query[key];\n      }\n      var _iterator = _createForOfIteratorHelper(query),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var _step$value = _slicedToArray(_step.value, 2),\n            _key = _step$value[0],\n            value = _step$value[1];\n          this.query[_key] = value;\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n      var args = {},\n        selected = false,\n        result = '';\n      if (path.substring(0, 1) === '/') {\n        path = path.substring(1);\n      }\n      path = path.split('/');\n      for (var i in this.query) {\n        args[i] = this.query[i];\n      }\n      L1: for (var _i in routes) {\n        var route = _i.split('/');\n        if (route.length < path.length && route[route.length - 1] !== '*') {\n          continue;\n        }\n        L2: for (var j in route) {\n          if (route[j].substr(0, 1) == '%') {\n            var argName = null;\n            var groups = /^%(\\w+)\\??/.exec(route[j]);\n            if (groups && groups[1]) {\n              argName = groups[1];\n            }\n            if (!argName) {\n              throw new Error(\"\".concat(route[j], \" is not a valid argument segment in route \\\"\").concat(_i, \"\\\"\"));\n            }\n            if (!path[j]) {\n              if (route[j].substr(route[j].length - 1, 1) == '?') {\n                args[argName] = '';\n              } else {\n                continue L1;\n              }\n            } else {\n              args[argName] = path[j];\n            }\n          } else if (route[j] !== '*' && path[j] !== route[j]) {\n            continue L1;\n          }\n        }\n        selected = _i;\n        result = routes[_i];\n        if (route[route.length - 1] === '*') {\n          args.pathparts = path.slice(route.length - 1);\n        }\n        break;\n      }\n      var eventStart = new CustomEvent('cvRouteStart', {\n        cancelable: true,\n        detail: {\n          path: path,\n          prev: prev,\n          root: listener,\n          selected: selected,\n          routes: routes\n        }\n      });\n      if (typeof document !== 'undefined') {\n        if (!document.dispatchEvent(eventStart)) {\n          return;\n        }\n      }\n      if (!forceRefresh && listener && current && result instanceof Object && current instanceof result && !(result instanceof Promise) && current.update(args)) {\n        listener.args.content = current;\n        return true;\n      }\n      if (!(selected in routes)) {\n        routes[selected] = routes[NotFoundError];\n      }\n      try {\n        result = this.processRoute(routes, selected, args);\n        if (result === false) {\n          result = this.processRoute(routes, NotFoundError, args);\n        }\n        if (typeof document === 'undefined') {\n          if (!(result instanceof Promise)) {\n            return Promise.resolve(result);\n          }\n          return result;\n        }\n        if (!(result instanceof Promise)) {\n          return this.update(listener, path, result, routes, selected, args, forceRefresh);\n        }\n        return result.then(function (realResult) {\n          return _this3.update(listener, path, realResult, routes, selected, args, forceRefresh);\n        }).catch(function (error) {\n          _this3.handleError(error, routes, selected, args, listener, path, prev, forceRefresh);\n        });\n      } catch (error) {\n        this.handleError(error, routes, selected, args, listener, path, prev, forceRefresh);\n      }\n    }\n  }, {\n    key: \"update\",\n    value: function update(listener, path, result, routes, selected, args, forceRefresh) {\n      if (!listener) {\n        return;\n      }\n      var prev = this.prevPath;\n      var event = new CustomEvent('cvRoute', {\n        cancelable: true,\n        detail: {\n          result: result,\n          path: path,\n          prev: prev,\n          view: listener,\n          routes: routes,\n          selected: selected\n        }\n      });\n      if (result !== false) {\n        if (listener.args.content instanceof _View.View) {\n          listener.args.content.pause(true);\n          listener.args.content.remove();\n        }\n        if (document.dispatchEvent(event)) {\n          listener.args.content = result;\n        }\n        if (result instanceof _View.View) {\n          result.pause(false);\n          result.update(args, forceRefresh);\n        }\n      }\n      var eventEnd = new CustomEvent('cvRouteEnd', {\n        cancelable: true,\n        detail: {\n          result: result,\n          path: path,\n          prev: prev,\n          view: listener,\n          routes: routes,\n          selected: selected\n        }\n      });\n      document.dispatchEvent(eventEnd);\n    }\n  }, {\n    key: \"isOriginLimited\",\n    value: function isOriginLimited(_ref) {\n      var origin = _ref.origin;\n      return origin === 'null' || origin === 'file://';\n    }\n  }, {\n    key: \"queryOver\",\n    value: function queryOver() {\n      var args = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var params = new URLSearchParams(location.search);\n      var finalArgs = {};\n      var query = {};\n      var _iterator2 = _createForOfIteratorHelper(params),\n        _step2;\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var pair = _step2.value;\n          query[pair[0]] = pair[1];\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n      finalArgs = Object.assign(finalArgs, query, args);\n      delete finalArgs['api'];\n      return finalArgs;\n\n      // for(let i in query)\n      // {\n      // \tfinalArgs[i] = query[i];\n      // }\n\n      // for(let i in args)\n      // {\n      // \tfinalArgs[i] = args[i];\n      // }\n    }\n  }, {\n    key: \"queryToString\",\n    value: function queryToString() {\n      var args = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var fresh = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var parts = [],\n        finalArgs = args;\n      if (!fresh) {\n        finalArgs = this.queryOver(args);\n      }\n      for (var i in finalArgs) {\n        if (finalArgs[i] === '') {\n          continue;\n        }\n        parts.push(i + '=' + encodeURIComponent(finalArgs[i]));\n      }\n      return parts.join('&');\n    }\n  }, {\n    key: \"setQuery\",\n    value: function setQuery(name, value, silent) {\n      var args = this.queryOver();\n      args[name] = value;\n      if (value === undefined) {\n        delete args[name];\n      }\n      var queryString = this.queryToString(args, true);\n      this.go(location.pathname + (queryString ? '?' + queryString : '?'), silent);\n    }\n  }]);\n  return Router;\n}();\nexports.Router = Router;\nObject.defineProperty(Router, 'query', {\n  configurable: false,\n  enumerable: false,\n  writable: false,\n  value: {}\n});\nObject.defineProperty(Router, 'history', {\n  configurable: false,\n  enumerable: false,\n  writable: false,\n  value: []\n});\nObject.defineProperty(Router, 'routeCount', {\n  configurable: false,\n  enumerable: false,\n  writable: true,\n  value: 0\n});\nObject.defineProperty(Router, 'prevPath', {\n  configurable: false,\n  enumerable: false,\n  writable: true,\n  value: null\n});\nObject.defineProperty(Router, 'queryString', {\n  configurable: false,\n  enumerable: false,\n  writable: true,\n  value: null\n});\nObject.defineProperty(Router, 'InternalError', {\n  configurable: false,\n  enumerable: false,\n  writable: false,\n  value: InternalError\n});\nObject.defineProperty(Router, 'NotFoundError', {\n  configurable: false,\n  enumerable: false,\n  writable: false,\n  value: NotFoundError\n});\n  })();\n});","\nrequire.register(\"curvature/base/Routes.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Routes = void 0;\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar AppRoutes = {};\nvar _require = require;\nvar imported = false;\nvar runImport = function runImport() {\n  if (imported) {\n    return;\n  }\n  ;\n  try {\n    Object.assign(AppRoutes, _require('Routes').Routes || {});\n  } catch (error) {\n    globalThis.devMode === true && console.warn(error);\n  }\n  imported = true;\n};\nvar Routes = /*#__PURE__*/function () {\n  function Routes() {\n    _classCallCheck(this, Routes);\n  }\n  _createClass(Routes, null, [{\n    key: \"get\",\n    value: function get(name) {\n      runImport();\n      return this.routes[name];\n    }\n  }, {\n    key: \"dump\",\n    value: function dump() {\n      runImport();\n      return this.routes;\n    }\n  }]);\n  return Routes;\n}();\nexports.Routes = Routes;\nObject.defineProperty(Routes, 'routes', {\n  configurable: false,\n  enumerable: false,\n  writable: false,\n  value: AppRoutes\n});\n  })();\n});","\nrequire.register(\"curvature/base/RuleSet.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.RuleSet = void 0;\nvar _Dom = require(\"./Dom\");\nvar _Tag = require(\"./Tag\");\nvar _View = require(\"./View\");\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _iterableToArrayLimit(arr, i) { var _i = null == arr ? null : \"undefined\" != typeof Symbol && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (null != _i) { var _s, _e, _x, _r, _arr = [], _n = !0, _d = !1; try { if (_x = (_i = _i.call(arr)).next, 0 === i) { if (Object(_i) !== _i) return; _n = !1; } else for (; !(_n = (_s = _x.call(_i)).done) && (_arr.push(_s.value), _arr.length !== i); _n = !0); } catch (err) { _d = !0, _e = err; } finally { try { if (!_n && null != _i.return && (_r = _i.return(), Object(_r) !== _r)) return; } finally { if (_d) throw _e; } } return _arr; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e2) { throw _e2; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e3) { didErr = true; err = _e3; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar RuleSet = /*#__PURE__*/function () {\n  function RuleSet() {\n    _classCallCheck(this, RuleSet);\n  }\n  _createClass(RuleSet, [{\n    key: \"add\",\n    value: function add(selector, callback) {\n      this.rules = this.rules || {};\n      this.rules[selector] = this.rules[selector] || [];\n      this.rules[selector].push(callback);\n      return this;\n    }\n  }, {\n    key: \"apply\",\n    value: function apply() {\n      var doc = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : document;\n      var view = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n      RuleSet.apply(doc, view);\n      for (var selector in this.rules) {\n        for (var i in this.rules[selector]) {\n          var callback = this.rules[selector][i];\n          var wrapped = RuleSet.wrap(doc, callback, view);\n          var nodes = doc.querySelectorAll(selector);\n          var _iterator = _createForOfIteratorHelper(nodes),\n            _step;\n          try {\n            for (_iterator.s(); !(_step = _iterator.n()).done;) {\n              var node = _step.value;\n              wrapped(node);\n            }\n          } catch (err) {\n            _iterator.e(err);\n          } finally {\n            _iterator.f();\n          }\n        }\n      }\n    }\n  }, {\n    key: \"purge\",\n    value: function purge() {\n      if (!this.rules) {\n        return;\n      }\n      for (var _i = 0, _Object$entries = Object.entries(this.rules); _i < _Object$entries.length; _i++) {\n        var _Object$entries$_i = _slicedToArray(_Object$entries[_i], 2),\n          k = _Object$entries$_i[0],\n          v = _Object$entries$_i[1];\n        if (!this.rules[k]) {\n          continue;\n        }\n        for (var kk in this.rules[k]) {\n          delete this.rules[k][kk];\n        }\n      }\n    }\n  }], [{\n    key: \"add\",\n    value: function add(selector, callback) {\n      this.globalRules = this.globalRules || {};\n      this.globalRules[selector] = this.globalRules[selector] || [];\n      this.globalRules[selector].push(callback);\n      return this;\n    }\n  }, {\n    key: \"apply\",\n    value: function apply() {\n      var doc = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : document;\n      var view = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n      for (var selector in this.globalRules) {\n        for (var i in this.globalRules[selector]) {\n          var callback = this.globalRules[selector][i];\n          var wrapped = this.wrap(doc, callback, view);\n          var nodes = doc.querySelectorAll(selector);\n          var _iterator2 = _createForOfIteratorHelper(nodes),\n            _step2;\n          try {\n            for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n              var node = _step2.value;\n              wrapped(node);\n            }\n          } catch (err) {\n            _iterator2.e(err);\n          } finally {\n            _iterator2.f();\n          }\n        }\n      }\n    }\n  }, {\n    key: \"wait\",\n    value: function wait() {\n      var _this = this;\n      var event = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'DOMContentLoaded';\n      var node = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : document;\n      var listener = function (event, node) {\n        return function () {\n          node.removeEventListener(event, listener);\n          return _this.apply();\n        };\n      }(event, node);\n      node.addEventListener(event, listener);\n    }\n  }, {\n    key: \"wrap\",\n    value: function wrap(doc, originalCallback) {\n      var view = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n      var callback = originalCallback;\n      if (originalCallback instanceof _View.View || originalCallback && originalCallback.prototype && originalCallback.prototype instanceof _View.View) {\n        callback = function callback() {\n          return originalCallback;\n        };\n      }\n      return function (element) {\n        if (typeof element.___cvApplied___ === 'undefined') {\n          Object.defineProperty(element, '___cvApplied___', {\n            enumerable: false,\n            writable: false,\n            value: new WeakSet()\n          });\n        }\n        if (element.___cvApplied___.has(originalCallback)) {\n          return;\n        }\n        var direct, parentView;\n        if (view) {\n          direct = parentView = view;\n          if (view.viewList) {\n            parentView = view.viewList.parent;\n          }\n        }\n        var tag = new _Tag.Tag(element, parentView, null, undefined, direct);\n        var parent = tag.element.parentNode;\n        var sibling = tag.element.nextSibling;\n        var result = callback(tag);\n        if (result !== false) {\n          element.___cvApplied___.add(originalCallback);\n        }\n        if (result instanceof HTMLElement) {\n          result = new _Tag.Tag(result);\n        }\n        if (result instanceof _Tag.Tag) {\n          if (!result.element.contains(tag.element)) {\n            while (tag.element.firstChild) {\n              result.element.appendChild(tag.element.firstChild);\n            }\n            tag.remove();\n          }\n          if (sibling) {\n            parent.insertBefore(result.element, sibling);\n          } else {\n            parent.appendChild(result.element);\n          }\n        }\n        if (result && result.prototype && result.prototype instanceof _View.View) {\n          result = new result({}, view);\n        }\n        if (result instanceof _View.View) {\n          if (view) {\n            view.cleanup.push(function () {\n              return result.remove();\n            });\n            view.cleanup.push(view.args.bindTo(function (v, k, t) {\n              t[k] = v;\n              result.args[k] = v;\n            }));\n            view.cleanup.push(result.args.bindTo(function (v, k, t, d) {\n              t[k] = v;\n              view.args[k] = v;\n            }));\n          }\n          tag.clear();\n          result.render(tag.element);\n        }\n      };\n    }\n  }]);\n  return RuleSet;\n}();\nexports.RuleSet = RuleSet;\n  })();\n});","\nrequire.register(\"curvature/base/SetMap.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.SetMap = void 0;\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction _construct(Parent, args, Class) { if (_isNativeReflectConstruct()) { _construct = Reflect.construct.bind(); } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar SetMap = /*#__PURE__*/function () {\n  function SetMap() {\n    _classCallCheck(this, SetMap);\n    _defineProperty(this, \"_map\", new Map());\n  }\n  _createClass(SetMap, [{\n    key: \"has\",\n    value: function has(key) {\n      return this._map.has(key);\n    }\n  }, {\n    key: \"get\",\n    value: function get(key) {\n      return this._map.get(key);\n    }\n  }, {\n    key: \"getOne\",\n    value: function getOne(key) {\n      var set = this.get(key);\n      var _iterator = _createForOfIteratorHelper(set),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var entry = _step.value;\n          return entry;\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n    }\n  }, {\n    key: \"add\",\n    value: function add(key, value) {\n      var set = this._map.get(key);\n      if (!set) {\n        this._map.set(key, set = new Set());\n      }\n      return set.add(value);\n    }\n  }, {\n    key: \"remove\",\n    value: function remove(key, value) {\n      var set = this._map.get(key);\n      if (!set) {\n        return;\n      }\n      var res = set.delete(value);\n      if (!set.size) {\n        this._map.delete(key);\n      }\n      return res;\n    }\n  }, {\n    key: \"values\",\n    value: function values() {\n      return _construct(Set, _toConsumableArray(_toConsumableArray(this._map.values()).map(function (set) {\n        return _toConsumableArray(set.values());\n      })));\n    }\n  }]);\n  return SetMap;\n}();\nexports.SetMap = SetMap;\n  })();\n});","\nrequire.register(\"curvature/base/Tag.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Tag = void 0;\nvar _Bindable = require(\"./Bindable\");\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar CurrentStyle = Symbol('CurrentStyle');\nvar styler = function styler(styles) {\n  if (!this.node) {\n    return;\n  }\n  for (var property in styles) {\n    var stringedProperty = String(styles[property]);\n    if (this[CurrentStyle].has(property) && this[CurrentStyle].get(property) === styles[property]) {\n      continue;\n    }\n    if (property[0] === '-') {\n      this.node.style.setProperty(property, stringedProperty);\n    } else {\n      this.node.style[property] = stringedProperty;\n    }\n    if (styles[property] !== undefined) {\n      this[CurrentStyle].set(property, styles[property]);\n    } else {\n      this[CurrentStyle].delete(property);\n    }\n  }\n};\nvar getter = function getter(name) {\n  var _this = this;\n  if (typeof this[name] === 'function') {\n    return this[name];\n  }\n  if (this.node && typeof this.node[name] === 'function') {\n    return function () {\n      var _this$node;\n      return (_this$node = _this.node)[name].apply(_this$node, arguments);\n    };\n  }\n  if (name === 'style') {\n    return this.proxy.style;\n  }\n  if (this.node && name in this.node) {\n    return this.node[name];\n  }\n  return this[name];\n};\nvar Tag = /*#__PURE__*/function () {\n  function Tag(element, parent, ref, index, direct) {\n    var _this2 = this;\n    _classCallCheck(this, Tag);\n    if (typeof element === 'string') {\n      var subdoc = document.createRange().createContextualFragment(element);\n      element = subdoc.firstChild;\n    }\n    this.element = _Bindable.Bindable.makeBindable(element);\n    this.node = this.element;\n    this.parent = parent;\n    this.direct = direct;\n    this.ref = ref;\n    this.index = index;\n    this.cleanup = [];\n    this[_Bindable.Bindable.OnAllGet] = getter.bind(this);\n    this[CurrentStyle] = new Map();\n    var boundStyler = _Bindable.Bindable.make(styler.bind(this));\n    Object.defineProperty(this, 'style', {\n      value: boundStyler\n    });\n    this.proxy = _Bindable.Bindable.make(this);\n    this.proxy.style.bindTo(function (v, k, t, d) {\n      if (_this2[CurrentStyle].has(k) && _this2[CurrentStyle].get(k) === v) {\n        return;\n      }\n      _this2.node.style[k] = v;\n      if (!d && v !== undefined) {\n        _this2[CurrentStyle].set(k, v);\n      } else {\n        _this2[CurrentStyle].delete(k);\n      }\n    });\n    this.proxy.bindTo(function (v, k) {\n      if (k === 'index') {\n        return;\n      }\n      if (k in element && element[k] !== v) {\n        element[k] = v;\n      }\n      return false;\n    });\n    return this.proxy;\n  }\n  _createClass(Tag, [{\n    key: \"attr\",\n    value: function attr(attributes) {\n      for (var attribute in attributes) {\n        if (attributes[attribute] === undefined) {\n          this.node.removeAttribute(attribute);\n        } else if (attributes[attribute] === null) {\n          this.node.setAttribute(attribute, '');\n        } else {\n          this.node.setAttribute(attribute, attributes[attribute]);\n        }\n      }\n      return this;\n    }\n  }, {\n    key: \"remove\",\n    value: function remove() {\n      if (this.node) {\n        this.node.remove();\n      }\n      _Bindable.Bindable.clearBindings(this);\n      var cleanup;\n      while (cleanup = this.cleanup.shift()) {\n        cleanup();\n      }\n      this.clear();\n      if (!this.node) {\n        return;\n      }\n      var detachEvent = new Event('cvDomDetached');\n      this.node.dispatchEvent(detachEvent);\n      this.node = this.element = this.ref = this.parent = undefined;\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      if (!this.node) {\n        return;\n      }\n      var detachEvent = new Event('cvDomDetached');\n      while (this.node.firstChild) {\n        this.node.firstChild.dispatchEvent(detachEvent);\n        this.node.removeChild(this.node.firstChild);\n      }\n    }\n  }, {\n    key: \"pause\",\n    value: function pause() {\n      var paused = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n    }\n  }, {\n    key: \"listen\",\n    value: function listen(eventName, callback, options) {\n      var node = this.node;\n      node.addEventListener(eventName, callback, options);\n      var remove = function remove() {\n        node.removeEventListener(eventName, callback, options);\n      };\n      var remover = function remover() {\n        remove();\n        remove = function remove() {\n          return console.warn('Already removed!');\n        };\n      };\n      this.parent.onRemove(function () {\n        return remover();\n      });\n      return remover;\n    }\n  }]);\n  return Tag;\n}();\nexports.Tag = Tag;\n  })();\n});","\nrequire.register(\"curvature/base/Uuid.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Uuid = void 0;\nvar _Symbol$toPrimitive;\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nvar win = (typeof globalThis === \"undefined\" ? \"undefined\" : _typeof(globalThis)) === 'object' ? globalThis : (typeof window === \"undefined\" ? \"undefined\" : _typeof(window)) === 'object' ? window : (typeof self === \"undefined\" ? \"undefined\" : _typeof(self)) === 'object' ? self : void 0;\nvar crypto = win.crypto;\n_Symbol$toPrimitive = Symbol.toPrimitive;\nvar Uuid = /*#__PURE__*/function () {\n  function Uuid() {\n    var uuid = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    var version = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 4;\n    _classCallCheck(this, Uuid);\n    _defineProperty(this, \"uuid\", null);\n    _defineProperty(this, \"version\", 4);\n    if (uuid) {\n      if (typeof uuid !== 'string' && !(uuid instanceof Uuid) || !uuid.match(/[0-9A-Fa-f]{8}(-[0-9A-Fa-f]{4}){3}-[0-9A-Fa-f]{12}/)) {\n        throw new Error(\"Invalid input for Uuid: \\\"\".concat(uuid, \"\\\"\"));\n      }\n      this.version = version;\n      this.uuid = uuid;\n    } else if (crypto && typeof crypto.randomUUID === 'function') {\n      this.uuid = crypto.randomUUID();\n    } else {\n      var init = [1e7] + -1e3 + -4e3 + -8e3 + -1e11;\n      var rand = crypto && typeof crypto.randomUUID === 'function' ? function () {\n        return crypto.getRandomValues(new Uint8Array(1))[0];\n      } : function () {\n        return Math.trunc(Math.random() * 256);\n      };\n      this.uuid = init.replace(/[018]/g, function (c) {\n        return (c ^ rand() & 15 >> c / 4).toString(16);\n      });\n    }\n    Object.freeze(this);\n  }\n  _createClass(Uuid, [{\n    key: _Symbol$toPrimitive,\n    value: function value() {\n      return this.toString();\n    }\n  }, {\n    key: \"toString\",\n    value: function toString() {\n      return this.uuid;\n    }\n  }, {\n    key: \"toJson\",\n    value: function toJson() {\n      return {\n        version: this.version,\n        uuid: this.uuid\n      };\n    }\n  }]);\n  return Uuid;\n}();\nexports.Uuid = Uuid;\n  })();\n});","\nrequire.register(\"curvature/base/View.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.View = void 0;\nvar _Bindable = require(\"./Bindable\");\nvar _ViewList = require(\"./ViewList\");\nvar _Router = require(\"./Router\");\nvar _Uuid = require(\"./Uuid\");\nvar _Dom = require(\"./Dom\");\nvar _Tag = require(\"./Tag\");\nvar _Bag = require(\"./Bag\");\nvar _RuleSet = require(\"./RuleSet\");\nvar _Mixin = require(\"./Mixin\");\nvar _EventTargetMixin = require(\"../mixin/EventTargetMixin\");\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _iterableToArrayLimit(arr, i) { var _i = null == arr ? null : \"undefined\" != typeof Symbol && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (null != _i) { var _s, _e, _x, _r, _arr = [], _n = !0, _d = !1; try { if (_x = (_i = _i.call(arr)).next, 0 === i) { if (Object(_i) !== _i) return; _n = !1; } else for (; !(_n = (_s = _x.call(_i)).done) && (_arr.push(_s.value), _arr.length !== i); _n = !0); } catch (err) { _d = !0, _e = err; } finally { try { if (!_n && null != _i.return && (_r = _i.return(), Object(_r) !== _r)) return; } finally { if (_d) throw _e; } } return _arr; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e2) { throw _e2; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e3) { didErr = true; err = _e3; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nvar dontParse = Symbol('dontParse');\nvar expandBind = Symbol('expandBind');\nvar uuid = Symbol('uuid');\nvar moveIndex = 0;\nvar View = /*#__PURE__*/function (_Mixin$with) {\n  _inherits(View, _Mixin$with);\n  var _super = _createSuper(View);\n  function View() {\n    var _this;\n    var args = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var mainView = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    _classCallCheck(this, View);\n    _this = _super.call(this, args, mainView);\n    _this[_EventTargetMixin.EventTargetMixin.Parent] = mainView;\n    Object.defineProperty(_assertThisInitialized(_this), 'args', {\n      value: _Bindable.Bindable.make(args)\n    });\n    Object.defineProperty(_assertThisInitialized(_this), uuid, {\n      value: _this.constructor.uuid()\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'nodesAttached', {\n      value: new _Bag.Bag(function (i, s, a) {})\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'nodesDetached', {\n      value: new _Bag.Bag(function (i, s, a) {})\n    });\n    Object.defineProperty(_assertThisInitialized(_this), '_onRemove', {\n      value: new _Bag.Bag(function (i, s, a) {})\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'cleanup', {\n      value: []\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'parent', {\n      value: mainView,\n      writable: true\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'views', {\n      value: new Map()\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'viewLists', {\n      value: new Map()\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'withViews', {\n      value: new Map()\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'tags', {\n      value: _Bindable.Bindable.make({})\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'nodes', {\n      value: _Bindable.Bindable.make([])\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'timeouts', {\n      value: new Map()\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'intervals', {\n      value: new Map()\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'frames', {\n      value: []\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'ruleSet', {\n      value: new _RuleSet.RuleSet()\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'preRuleSet', {\n      value: new _RuleSet.RuleSet()\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'subBindings', {\n      value: {}\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'templates', {\n      value: {}\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'postMapping', {\n      value: new Set()\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'eventCleanup', {\n      value: []\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'unpauseCallbacks', {\n      value: new Map()\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'interpolateRegex', {\n      value: /(\\[\\[((?:\\$+)?[\\w\\.\\|-]+)\\]\\])/g\n    });\n    Object.defineProperty(_assertThisInitialized(_this), 'rendered', {\n      value: new Promise(function (accept, reject) {\n        return Object.defineProperty(_assertThisInitialized(_this), 'renderComplete', {\n          value: accept\n        });\n      })\n    });\n    _this.onRemove(function () {\n      if (!_this[_EventTargetMixin.EventTargetMixin.Parent]) {\n        return;\n      }\n      _this[_EventTargetMixin.EventTargetMixin.Parent] = null;\n    });\n    _this.controller = _assertThisInitialized(_this);\n    _this.template = \"\";\n    _this.firstNode = null;\n    _this.lastNode = null;\n    _this.viewList = null;\n    _this.mainView = null;\n    _this.preserve = false;\n    _this.removed = false;\n    _this.loaded = Promise.resolve(_assertThisInitialized(_this));\n\n    // return Bindable.make(this);\n    return _this;\n  }\n  _createClass(View, [{\n    key: \"_id\",\n    get: function get() {\n      return this[uuid];\n    }\n  }, {\n    key: \"onFrame\",\n    value: function onFrame(callback) {\n      var _this2 = this;\n      var stopped = false;\n      var cancel = function cancel() {\n        stopped = true;\n      };\n      var c = function c(timestamp) {\n        if (_this2.removed || stopped) {\n          return;\n        }\n        if (!_this2.paused) {\n          callback(Date.now());\n        }\n        requestAnimationFrame(c);\n      };\n      requestAnimationFrame(function () {\n        return c(Date.now());\n      });\n      this.frames.push(cancel);\n      return cancel;\n    }\n  }, {\n    key: \"onNextFrame\",\n    value: function onNextFrame(callback) {\n      return requestAnimationFrame(function () {\n        return callback(Date.now());\n      });\n    }\n  }, {\n    key: \"onIdle\",\n    value: function onIdle(callback) {\n      return requestIdleCallback(function () {\n        return callback(Date.now());\n      });\n    }\n  }, {\n    key: \"onTimeout\",\n    value: function onTimeout(time, callback) {\n      var _this3 = this;\n      var timeoutInfo = {\n        timeout: null,\n        callback: null,\n        time: time,\n        fired: false,\n        created: new Date().getTime(),\n        paused: false\n      };\n      var wrappedCallback = function wrappedCallback() {\n        callback();\n        timeoutInfo.fired = true;\n        _this3.timeouts.delete(timeoutInfo.timeout);\n      };\n      var timeout = setTimeout(wrappedCallback, time);\n      timeoutInfo.callback = wrappedCallback;\n      timeoutInfo.timeout = timeout;\n      this.timeouts.set(timeoutInfo.timeout, timeoutInfo);\n      return timeout;\n    }\n  }, {\n    key: \"clearTimeout\",\n    value: function (_clearTimeout) {\n      function clearTimeout(_x) {\n        return _clearTimeout.apply(this, arguments);\n      }\n      clearTimeout.toString = function () {\n        return _clearTimeout.toString();\n      };\n      return clearTimeout;\n    }(function (timeout) {\n      if (!this.timeouts.has(timeout)) {\n        return;\n      }\n      var timeoutInfo = this.timeouts.get(timeout);\n      clearTimeout(timeoutInfo.timeout);\n      this.timeouts.delete(timeoutInfo.timeout);\n    })\n  }, {\n    key: \"onInterval\",\n    value: function onInterval(time, callback) {\n      var timeout = setInterval(callback, time);\n      this.intervals.set(timeout, {\n        timeout: timeout,\n        callback: callback,\n        time: time,\n        paused: false\n      });\n      return timeout;\n    }\n  }, {\n    key: \"clearInterval\",\n    value: function clearInterval(timeout) {\n      if (!this.intervals.has(timeout)) {\n        return;\n      }\n      var timeoutInfo = this.intervals.get(timeout);\n      clearTimeout(timeoutInfo.timeout);\n      this.intervals.delete(timeoutInfo.timeout);\n    }\n  }, {\n    key: \"pause\",\n    value: function pause() {\n      var paused = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : undefined;\n      if (paused === undefined) {\n        this.paused = !this.paused;\n      }\n      this.paused = paused;\n      if (this.paused) {\n        var _iterator = _createForOfIteratorHelper(this.timeouts),\n          _step;\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var _step$value = _slicedToArray(_step.value, 2),\n              callback = _step$value[0],\n              timeout = _step$value[1];\n            if (timeout.fired) {\n              this.timeouts.delete(timeout.timeout);\n              continue;\n            }\n            clearTimeout(timeout.timeout);\n            timeout.paused = true;\n            timeout.time = Math.max(0, timeout.time - (Date.now() - timeout.created));\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n        var _iterator2 = _createForOfIteratorHelper(this.intervals),\n          _step2;\n        try {\n          for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n            var _step2$value = _slicedToArray(_step2.value, 2),\n              _callback = _step2$value[0],\n              _timeout = _step2$value[1];\n            clearInterval(_timeout.timeout);\n            _timeout.paused = true;\n          }\n        } catch (err) {\n          _iterator2.e(err);\n        } finally {\n          _iterator2.f();\n        }\n      } else {\n        var _iterator3 = _createForOfIteratorHelper(this.timeouts),\n          _step3;\n        try {\n          for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n            var _step3$value = _slicedToArray(_step3.value, 2),\n              _callback2 = _step3$value[0],\n              _timeout2 = _step3$value[1];\n            if (!_timeout2.paused) {\n              continue;\n            }\n            if (_timeout2.fired) {\n              this.timeouts.delete(_timeout2.timeout);\n              continue;\n            }\n            _timeout2.timeout = setTimeout(_timeout2.callback, _timeout2.time);\n            _timeout2.paused = false;\n          }\n        } catch (err) {\n          _iterator3.e(err);\n        } finally {\n          _iterator3.f();\n        }\n        var _iterator4 = _createForOfIteratorHelper(this.intervals),\n          _step4;\n        try {\n          for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n            var _step4$value = _slicedToArray(_step4.value, 2),\n              _callback3 = _step4$value[0],\n              _timeout3 = _step4$value[1];\n            if (!_timeout3.paused) {\n              continue;\n            }\n            _timeout3.timeout = setInterval(_timeout3.callback, _timeout3.time);\n            _timeout3.paused = false;\n          }\n        } catch (err) {\n          _iterator4.e(err);\n        } finally {\n          _iterator4.f();\n        }\n        var _iterator5 = _createForOfIteratorHelper(this.unpauseCallbacks),\n          _step5;\n        try {\n          for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n            var _step5$value = _slicedToArray(_step5.value, 2),\n              _callback4 = _step5$value[1];\n            _callback4();\n          }\n        } catch (err) {\n          _iterator5.e(err);\n        } finally {\n          _iterator5.f();\n        }\n        this.unpauseCallbacks.clear();\n      }\n      var _iterator6 = _createForOfIteratorHelper(this.viewLists),\n        _step6;\n      try {\n        for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {\n          var _step6$value = _slicedToArray(_step6.value, 2),\n            tag = _step6$value[0],\n            viewList = _step6$value[1];\n          viewList.pause(!!paused);\n        }\n      } catch (err) {\n        _iterator6.e(err);\n      } finally {\n        _iterator6.f();\n      }\n      for (var i in this.tags) {\n        if (Array.isArray(this.tags[i])) {\n          for (var j in this.tags[i]) {\n            this.tags[i][j].pause(!!paused);\n          }\n          continue;\n        }\n        this.tags[i].pause(!!paused);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$nodes,\n        _this4 = this;\n      var parentNode = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      var insertPoint = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n      var outerView = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n      if (parentNode instanceof View) {\n        parentNode = parentNode.firstNode.parentNode;\n      }\n      if (insertPoint instanceof View) {\n        insertPoint = insertPoint.firstNode;\n      }\n      if (this.firstNode) {\n        return this.reRender(parentNode, insertPoint, outerView);\n      }\n      this.dispatchEvent(new CustomEvent('render'));\n      var templateIsFragment = _typeof(this.template) === 'object' && typeof this.template.cloneNode === 'function';\n      var templateParsed = templateIsFragment || View.templates.has(this.template);\n      var subDoc;\n      if (templateParsed) {\n        if (templateIsFragment) {\n          subDoc = this.template.cloneNode(true);\n        } else {\n          subDoc = View.templates.get(this.template).cloneNode(true);\n        }\n      } else {\n        subDoc = document.createRange().createContextualFragment(this.template);\n      }\n      if (!templateParsed && !templateIsFragment) {\n        View.templates.set(this.template, subDoc.cloneNode(true));\n      }\n      this.mainView || this.preRuleSet.apply(subDoc, this);\n      this.mapTags(subDoc);\n      this.mainView || this.ruleSet.apply(subDoc, this);\n      if (window.devMode === true) {\n        this.firstNode = document.createComment(\"Template \".concat(this._id, \" Start\"));\n        this.lastNode = document.createComment(\"Template \".concat(this._id, \" End\"));\n      } else {\n        this.firstNode = document.createTextNode('');\n        this.lastNode = document.createTextNode('');\n      }\n      (_this$nodes = this.nodes).push.apply(_this$nodes, [this.firstNode].concat(_toConsumableArray(Array.from(subDoc.childNodes)), [this.lastNode]));\n      this.postRender(parentNode);\n      this.dispatchEvent(new CustomEvent('rendered'));\n      if (!this.dispatchAttach()) {\n        return;\n      }\n      if (parentNode) {\n        if (insertPoint) {\n          parentNode.insertBefore(this.firstNode, insertPoint);\n          parentNode.insertBefore(this.lastNode, insertPoint);\n        } else {\n          parentNode.appendChild(this.firstNode);\n          parentNode.appendChild(this.lastNode);\n        }\n        parentNode.insertBefore(subDoc, this.lastNode);\n        moveIndex++;\n        var rootNode = parentNode.getRootNode();\n        if (rootNode.isConnected) {\n          this.attached(rootNode, parentNode);\n          this.dispatchAttached(rootNode, parentNode, outerView);\n        } else if (outerView) {\n          var firstDomAttach = function firstDomAttach(event) {\n            var rootNode = parentNode.getRootNode();\n            _this4.attached(rootNode, parentNode);\n            _this4.dispatchAttached(rootNode, parentNode, outerView);\n            outerView.removeEventListener('attached', firstDomAttach);\n          };\n          outerView.addEventListener('attached', firstDomAttach);\n        }\n      }\n      this.renderComplete(this.nodes);\n      return this.nodes;\n    }\n  }, {\n    key: \"dispatchAttach\",\n    value: function dispatchAttach() {\n      return this.dispatchEvent(new CustomEvent('attach', {\n        cancelable: true,\n        target: this\n      }));\n    }\n  }, {\n    key: \"dispatchAttached\",\n    value: function dispatchAttached(rootNode, parentNode) {\n      var view = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;\n      this.dispatchEvent(new CustomEvent('attached', {\n        detail: {\n          view: view || this,\n          node: parentNode,\n          root: rootNode,\n          mainView: this\n        }\n      }));\n      this.dispatchDomAttached(view);\n      var _iterator7 = _createForOfIteratorHelper(this.nodesAttached.items()),\n        _step7;\n      try {\n        for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {\n          var callback = _step7.value;\n          callback(rootNode, parentNode);\n        }\n      } catch (err) {\n        _iterator7.e(err);\n      } finally {\n        _iterator7.f();\n      }\n    }\n  }, {\n    key: \"dispatchDomAttached\",\n    value: function dispatchDomAttached(view) {\n      var _this5 = this;\n      this.nodes.filter(function (n) {\n        return n.nodeType !== Node.COMMENT_NODE;\n      }).forEach(function (child) {\n        if (!child.matches) {\n          return;\n        }\n        child.dispatchEvent(new CustomEvent('cvDomAttached', {\n          target: child,\n          detail: {\n            view: view || _this5,\n            mainView: _this5\n          }\n        }));\n        _Dom.Dom.mapTags(child, false, function (tag, walker) {\n          if (!tag.matches) {\n            return;\n          }\n          tag.dispatchEvent(new CustomEvent('cvDomAttached', {\n            target: tag,\n            detail: {\n              view: view || _this5,\n              mainView: _this5\n            }\n          }));\n        });\n      });\n    }\n  }, {\n    key: \"reRender\",\n    value: function reRender(parentNode, insertPoint, outerView) {\n      var willReRender = this.dispatchEvent(new CustomEvent('reRender'), {\n        cancelable: true,\n        target: this,\n        view: outerView\n      });\n      if (!willReRender) {\n        return;\n      }\n      var subDoc = new DocumentFragment();\n      if (this.firstNode.isConnected) {\n        var detach = this.nodesDetached.items();\n        for (var i in detach) {\n          detach[i]();\n        }\n      }\n      subDoc.append.apply(subDoc, _toConsumableArray(this.nodes));\n      if (parentNode) {\n        if (insertPoint) {\n          parentNode.insertBefore(this.firstNode, insertPoint);\n          parentNode.insertBefore(this.lastNode, insertPoint);\n        } else {\n          parentNode.appendChild(this.firstNode);\n          parentNode.appendChild(this.lastNode);\n        }\n        parentNode.insertBefore(subDoc, this.lastNode);\n        this.dispatchEvent(new CustomEvent('reRendered'), {\n          cancelable: true,\n          target: this,\n          view: outerView\n        });\n        var rootNode = parentNode.getRootNode();\n        if (rootNode.isConnected) {\n          this.attached(rootNode, parentNode);\n          this.dispatchAttached(rootNode, parentNode);\n        }\n      }\n      return this.nodes;\n    }\n  }, {\n    key: \"mapTags\",\n    value: function mapTags(subDoc) {\n      var _this6 = this;\n      _Dom.Dom.mapTags(subDoc, false, function (tag, walker) {\n        if (tag[dontParse]) {\n          return;\n        }\n        if (tag.matches) {\n          tag = _this6.mapInterpolatableTag(tag);\n          tag = tag.matches('[cv-template]') && _this6.mapTemplateTag(tag) || tag;\n          tag = tag.matches('[cv-slot]') && _this6.mapSlotTag(tag) || tag;\n          tag = tag.matches('[cv-prerender]') && _this6.mapPrendererTag(tag) || tag;\n          tag = tag.matches('[cv-link]') && _this6.mapLinkTag(tag) || tag;\n          tag = tag.matches('[cv-attr]') && _this6.mapAttrTag(tag) || tag;\n          tag = tag.matches('[cv-expand]') && _this6.mapExpandableTag(tag) || tag;\n          tag = tag.matches('[cv-ref]') && _this6.mapRefTag(tag) || tag;\n          tag = tag.matches('[cv-on]') && _this6.mapOnTag(tag) || tag;\n          tag = tag.matches('[cv-each]') && _this6.mapEachTag(tag) || tag;\n          tag = tag.matches('[cv-bind]') && _this6.mapBindTag(tag) || tag;\n          tag = tag.matches('[cv-with]') && _this6.mapWithTag(tag) || tag;\n          tag = tag.matches('[cv-if]') && _this6.mapIfTag(tag) || tag;\n          tag = tag.matches('[cv-view]') && _this6.mapViewTag(tag) || tag;\n        } else {\n          tag = _this6.mapInterpolatableTag(tag);\n        }\n        if (tag !== walker.currentNode) {\n          walker.currentNode = tag;\n        }\n      });\n      this.postMapping.forEach(function (c) {\n        return c();\n      });\n    }\n  }, {\n    key: \"mapExpandableTag\",\n    value: function mapExpandableTag(tag) {\n      // const tagCompiler = this.compileExpandableTag(tag);\n      // const newTag = tagCompiler(this);\n      // tag.replaceWith(newTag);\n      // return newTag;\n\n      var existing = tag[expandBind];\n      if (existing) {\n        existing();\n        tag[expandBind] = false;\n      }\n      var _Bindable$resolve = _Bindable.Bindable.resolve(this.args, tag.getAttribute('cv-expand'), true),\n        _Bindable$resolve2 = _slicedToArray(_Bindable$resolve, 2),\n        proxy = _Bindable$resolve2[0],\n        expandProperty = _Bindable$resolve2[1];\n      tag.removeAttribute('cv-expand');\n      if (!proxy[expandProperty]) {\n        proxy[expandProperty] = {};\n      }\n      proxy[expandProperty] = _Bindable.Bindable.make(proxy[expandProperty]);\n      this.onRemove(tag[expandBind] = proxy[expandProperty].bindTo(function (v, k, t, d, p) {\n        if (d || v === undefined) {\n          tag.removeAttribute(k, v);\n          return;\n        }\n        if (v === null) {\n          tag.setAttribute(k, '');\n          return;\n        }\n        tag.setAttribute(k, v);\n      }));\n\n      // let expandProperty = tag.getAttribute('cv-expand');\n      // let expandArg = Bindable.makeBindable(\n      // \tthis.args[expandProperty] || {}\n      // );\n\n      // tag.removeAttribute('cv-expand');\n\n      // for(let i in expandArg)\n      // {\n      // \tif(i === 'name' || i === 'type')\n      // \t{\n      // \t\tcontinue;\n      // \t}\n\n      // \tlet debind = expandArg.bindTo(i, ((tag,i)=>(v)=>{\n      // \t\ttag.setAttribute(i, v);\n      // \t})(tag,i));\n\n      // \tthis.onRemove(()=>{\n      // \t\tdebind();\n      // \t\tif(expandArg.isBound())\n      // \t\t{\n      // \t\t\tBindable.clearBindings(expandArg);\n      // \t\t}\n      // \t});\n      // }\n\n      return tag;\n    }\n\n    // compileExpandableTag(sourceTag)\n    // {\n    // \treturn (bindingView) => {\n\n    // \t\tconst tag = sourceTag.cloneNode(true);\n\n    // \t\tlet expandProperty = tag.getAttribute('cv-expand');\n    // \t\tlet expandArg = Bindable.make(\n    // \t\t\tbindingView.args[expandProperty] || {}\n    // \t\t);\n\n    // \t\ttag.removeAttribute('cv-expand');\n\n    // \t\tfor(let i in expandArg)\n    // \t\t{\n    // \t\t\tif(i === 'name' || i === 'type')\n    // \t\t\t{\n    // \t\t\t\tcontinue;\n    // \t\t\t}\n\n    // \t\t\tlet debind = expandArg.bindTo(i, ((tag,i)=>(v)=>{\n    // \t\t\t\ttag.setAttribute(i, v);\n    // \t\t\t})(tag,i));\n\n    // \t\t\tbindingView.onRemove(()=>{\n    // \t\t\t\tdebind();\n    // \t\t\t\tif(expandArg.isBound())\n    // \t\t\t\t{\n    // \t\t\t\t\tBindable.clearBindings(expandArg);\n    // \t\t\t\t}\n    // \t\t\t});\n    // \t\t}\n\n    // \t\treturn tag;\n    // \t};\n    // }\n  }, {\n    key: \"mapAttrTag\",\n    value: function mapAttrTag(tag) {\n      var tagCompiler = this.compileAttrTag(tag);\n      var newTag = tagCompiler(this);\n      tag.replaceWith(newTag);\n      return newTag;\n\n      // let attrProperty = tag.getAttribute('cv-attr');\n\n      // tag.removeAttribute('cv-attr');\n\n      // let pairs = attrProperty.split(',');\n      // let attrs = pairs.map((p) => p.split(':'));\n\n      // for (let i in attrs)\n      // {\n      // \tlet proxy        = this.args;\n      // \tlet bindProperty = attrs[i][1];\n      // \tlet property     = bindProperty;\n\n      // \tif(bindProperty.match(/\\./))\n      // \t{\n      // \t\t[proxy, property] = Bindable.resolve(\n      // \t\t\tthis.args\n      // \t\t\t, bindProperty\n      // \t\t\t, true\n      // \t\t);\n      // \t}\n\n      // \tlet attrib = attrs[i][0];\n\n      // \tthis.onRemove(proxy.bindTo(\n      // \t\tproperty\n      // \t\t, (v)=>{\n      // \t\t\tif(v == null)\n      // \t\t\t{\n      // \t\t\t\ttag.setAttribute(attrib, '');\n      // \t\t\t\treturn;\n      // \t\t\t}\n      // \t\t\ttag.setAttribute(attrib, v);\n      // \t\t}\n      // \t));\n      // }\n\n      // return tag;\n    }\n  }, {\n    key: \"compileAttrTag\",\n    value: function compileAttrTag(sourceTag) {\n      var attrProperty = sourceTag.getAttribute('cv-attr');\n      var pairs = attrProperty.split(/[,;]/);\n      var attrs = pairs.map(function (p) {\n        return p.split(':');\n      });\n      sourceTag.removeAttribute('cv-attr');\n      return function (bindingView) {\n        var tag = sourceTag.cloneNode(true);\n        var _loop = function _loop() {\n          var bindProperty = attrs[i][1] || attrs[i][0];\n          var _Bindable$resolve3 = _Bindable.Bindable.resolve(bindingView.args, bindProperty, true),\n            _Bindable$resolve4 = _slicedToArray(_Bindable$resolve3, 2),\n            proxy = _Bindable$resolve4[0],\n            property = _Bindable$resolve4[1];\n          var attrib = attrs[i][0];\n          bindingView.onRemove(proxy.bindTo(property, function (v, k, t, d) {\n            if (d || v === undefined) {\n              tag.removeAttribute(attrib, v);\n              return;\n            }\n            if (v === null) {\n              tag.setAttribute(attrib, '');\n              return;\n            }\n            tag.setAttribute(attrib, v);\n          }));\n        };\n        for (var i in attrs) {\n          _loop();\n        }\n        return tag;\n      };\n    }\n  }, {\n    key: \"mapInterpolatableTag\",\n    value: function mapInterpolatableTag(tag) {\n      var _this7 = this;\n      var regex = this.interpolateRegex;\n      if (tag.nodeType === Node.TEXT_NODE) {\n        var original = tag.nodeValue;\n        if (!this.interpolatable(original)) {\n          return tag;\n        }\n        var header = 0;\n        var match;\n        var _loop2 = function _loop2() {\n          var bindProperty = match[2];\n          var unsafeHtml = false;\n          var unsafeView = false;\n          var propertySplit = bindProperty.split('|');\n          var transformer = false;\n          if (propertySplit.length > 1) {\n            transformer = _this7.stringTransformer(propertySplit.slice(1));\n            bindProperty = propertySplit[0];\n          }\n          if (bindProperty.substr(0, 2) === '$$') {\n            unsafeHtml = true;\n            unsafeView = true;\n            bindProperty = bindProperty.substr(2);\n          }\n          if (bindProperty.substr(0, 1) === '$') {\n            unsafeHtml = true;\n            bindProperty = bindProperty.substr(1);\n          }\n          if (bindProperty.substr(0, 3) === '000') {\n            expand = true;\n            bindProperty = bindProperty.substr(3);\n            return \"continue\";\n          }\n          var staticPrefix = original.substring(header, match.index);\n          header = match.index + match[1].length;\n          var staticNode = document.createTextNode(staticPrefix);\n          staticNode[dontParse] = true;\n          tag.parentNode.insertBefore(staticNode, tag);\n          var dynamicNode;\n          if (unsafeHtml) {\n            dynamicNode = document.createElement('div');\n          } else {\n            dynamicNode = document.createTextNode('');\n          }\n          dynamicNode[dontParse] = true;\n          var proxy = _this7.args;\n          var property = bindProperty;\n          if (bindProperty.match(/\\./)) {\n            var _Bindable$resolve5 = _Bindable.Bindable.resolve(_this7.args, bindProperty, true);\n            var _Bindable$resolve6 = _slicedToArray(_Bindable$resolve5, 2);\n            proxy = _Bindable$resolve6[0];\n            property = _Bindable$resolve6[1];\n          }\n          tag.parentNode.insertBefore(dynamicNode, tag);\n          if (_typeof(proxy) !== 'object') {\n            return \"break\";\n          }\n          proxy = _Bindable.Bindable.make(proxy);\n          var debind = proxy.bindTo(property, function (v, k, t) {\n            if (t[k] !== v && (t[k] instanceof View || t[k] instanceof Node || t[k] instanceof _Tag.Tag)) {\n              if (!t[k].preserve) {\n                t[k].remove();\n              }\n            }\n            dynamicNode.nodeValue = '';\n            if (unsafeView && !(v instanceof View)) {\n              var _v;\n              var unsafeTemplate = (_v = v) !== null && _v !== void 0 ? _v : '';\n              v = new View(_this7.args, _this7);\n              v.template = unsafeTemplate;\n            }\n            if (transformer) {\n              v = transformer(v);\n            }\n            if (v instanceof View) {\n              v[_EventTargetMixin.EventTargetMixin.Parent] = _this7;\n              v.render(tag.parentNode, dynamicNode, _this7);\n              var cleanup = function cleanup() {\n                if (!v.preserve) {\n                  v.remove();\n                }\n              };\n              _this7.onRemove(cleanup);\n              v.onRemove(function () {\n                return _this7._onRemove.remove(cleanup);\n              });\n            } else if (v instanceof Node) {\n              tag.parentNode.insertBefore(v, dynamicNode);\n              _this7.onRemove(function () {\n                return v.remove();\n              });\n            } else if (v instanceof _Tag.Tag) {\n              if (v.node) {\n                tag.parentNode.insertBefore(v.node, dynamicNode);\n                _this7.onRemove(function () {\n                  return v.remove();\n                });\n              } else {\n                v.remove();\n              }\n            } else {\n              if (v instanceof Object && v.__toString instanceof Function) {\n                v = v.__toString();\n              }\n              if (unsafeHtml) {\n                dynamicNode.innerHTML = v;\n              } else {\n                dynamicNode.nodeValue = v;\n              }\n            }\n            dynamicNode[dontParse] = true;\n          });\n          _this7.onRemove(debind);\n        };\n        while (match = regex.exec(original)) {\n          var _ret = _loop2();\n          if (_ret === \"continue\") continue;\n          if (_ret === \"break\") break;\n        }\n        var staticSuffix = original.substring(header);\n        var staticNode = document.createTextNode(staticSuffix);\n        staticNode[dontParse] = true;\n        tag.parentNode.insertBefore(staticNode, tag);\n        tag.nodeValue = '';\n      } else if (tag.nodeType === Node.ELEMENT_NODE) {\n        var _loop3 = function _loop3() {\n          if (!_this7.interpolatable(tag.attributes[i].value)) {\n            return \"continue\";\n          }\n          var header = 0;\n          var match;\n          var original = tag.attributes[i].value;\n          var attribute = tag.attributes[i];\n          var bindProperties = {};\n          var segments = [];\n          while (match = regex.exec(original)) {\n            segments.push(original.substring(header, match.index));\n            if (!bindProperties[match[2]]) {\n              bindProperties[match[2]] = [];\n            }\n            bindProperties[match[2]].push(segments.length);\n            segments.push(match[1]);\n            header = match.index + match[1].length;\n          }\n          segments.push(original.substring(header));\n          var _loop4 = function _loop4() {\n            var proxy = _this7.args;\n            var property = j;\n            var propertySplit = j.split('|');\n            var transformer = false;\n            var longProperty = j;\n            if (propertySplit.length > 1) {\n              transformer = _this7.stringTransformer(propertySplit.slice(1));\n              property = propertySplit[0];\n            }\n            if (property.match(/\\./)) {\n              var _Bindable$resolve7 = _Bindable.Bindable.resolve(_this7.args, property, true);\n              var _Bindable$resolve8 = _slicedToArray(_Bindable$resolve7, 2);\n              proxy = _Bindable$resolve8[0];\n              property = _Bindable$resolve8[1];\n            }\n            var matching = [];\n            var bindProperty = j;\n            var matchingSegments = bindProperties[longProperty];\n\n            // const changeAttribute = (v, k, t, d) => {\n            // \ttag.setAttribute(attribute.name, segments.join(''));\n            // };\n\n            _this7.onRemove(proxy.bindTo(property, function (v, k, t, d) {\n              if (transformer) {\n                v = transformer(v);\n              }\n              for (var _i2 in bindProperties) {\n                for (var _j in bindProperties[longProperty]) {\n                  segments[bindProperties[longProperty][_j]] = t[_i2];\n                  if (k === property) {\n                    segments[bindProperties[longProperty][_j]] = v;\n                  }\n                }\n              }\n              if (!_this7.paused) {\n                // changeAttribute(v,k,t,d);\n                tag.setAttribute(attribute.name, segments.join(''));\n              } else {\n                // this.unpauseCallbacks.set(attribute, () => changeAttribute(v,k,t,d));\n                _this7.unpauseCallbacks.set(attribute, function () {\n                  return tag.setAttribute(attribute.name, segments.join(''));\n                });\n              }\n            }));\n\n            // this.onRemove(()=>{\n            // \tif(!proxy.isBound())\n            // \t{\n            // \t\tBindable.clearBindings(proxy);\n            // \t}\n            // });\n          };\n          for (var j in bindProperties) {\n            _loop4();\n          }\n        };\n        for (var i = 0; i < tag.attributes.length; i++) {\n          var _ret2 = _loop3();\n          if (_ret2 === \"continue\") continue;\n        }\n      }\n      return tag;\n    }\n  }, {\n    key: \"mapRefTag\",\n    value: function mapRefTag(tag) {\n      var refAttr = tag.getAttribute('cv-ref');\n      var _refAttr$split = refAttr.split(':'),\n        _refAttr$split2 = _slicedToArray(_refAttr$split, 3),\n        refProp = _refAttr$split2[0],\n        _refAttr$split2$ = _refAttr$split2[1],\n        refClassname = _refAttr$split2$ === void 0 ? null : _refAttr$split2$,\n        _refAttr$split2$2 = _refAttr$split2[2],\n        refKey = _refAttr$split2$2 === void 0 ? null : _refAttr$split2$2;\n      var refClass = _Tag.Tag;\n      if (refClassname) {\n        refClass = this.stringToClass(refClassname);\n      }\n      tag.removeAttribute('cv-ref');\n      Object.defineProperty(tag, '___tag___', {\n        enumerable: false,\n        writable: true\n      });\n      this.onRemove(function () {\n        tag.___tag___ = null;\n        tag.remove();\n      });\n      var parent = this;\n      var direct = this;\n      if (this.viewList) {\n        parent = this.viewList.parent;\n        // if(!this.viewList.parent.tags[refProp])\n        // {\n        // \tthis.viewList.parent.tags[refProp] = [];\n        // }\n\n        // let refKeyVal = this.args[refKey];\n\n        // this.viewList.parent.tags[refProp][refKeyVal] = new refClass(\n        // \ttag, this, refProp, refKeyVal\n        // );\n      }\n      // else\n      // {\n      // \tthis.tags[refProp] = new refClass(\n      // \t\ttag, this, refProp\n      // \t);\n      // }\n\n      var tagObject = new refClass(tag, this, refProp, undefined, direct);\n      tag.___tag___ = tagObject;\n      this.tags[refProp] = tagObject;\n      while (parent) {\n        var refKeyVal = this.args[refKey];\n        if (refKeyVal !== undefined) {\n          if (!parent.tags[refProp]) {\n            parent.tags[refProp] = [];\n          }\n          parent.tags[refProp][refKeyVal] = tagObject;\n        } else {\n          parent.tags[refProp] = tagObject;\n        }\n        if (!parent.parent) {\n          break;\n        }\n        parent = parent.parent;\n      }\n      return tag;\n    }\n  }, {\n    key: \"mapBindTag\",\n    value: function mapBindTag(tag) {\n      var _this8 = this;\n      var bindArg = tag.getAttribute('cv-bind');\n      var proxy = this.args;\n      var property = bindArg;\n      var top = null;\n      if (bindArg.match(/\\./)) {\n        var _Bindable$resolve9 = _Bindable.Bindable.resolve(this.args, bindArg, true);\n        var _Bindable$resolve10 = _slicedToArray(_Bindable$resolve9, 3);\n        proxy = _Bindable$resolve10[0];\n        property = _Bindable$resolve10[1];\n        top = _Bindable$resolve10[2];\n      }\n      if (proxy !== this.args) {\n        this.subBindings[bindArg] = this.subBindings[bindArg] || [];\n        this.onRemove(this.args.bindTo(top, function () {\n          while (_this8.subBindings.length) {\n            _this8.subBindings.shift()();\n          }\n        }));\n      }\n      var unsafeHtml = false;\n      if (property.substr(0, 1) === '$') {\n        property = property.substr(1);\n        unsafeHtml = true;\n      }\n      var autoEventStarted = false;\n      var debind = proxy.bindTo(property, function (v, k, t, d, p) {\n        if ((p instanceof View || p instanceof Node || p instanceof _Tag.Tag) && p !== v) {\n          p.remove();\n        }\n        if (['INPUT', 'SELECT', 'TEXTAREA'].includes(tag.tagName)) {\n          var _type = tag.getAttribute('type');\n          if (_type && _type.toLowerCase() === 'checkbox') {\n            tag.checked = !!v;\n          } else if (_type && _type.toLowerCase() === 'radio') {\n            tag.checked = v == tag.value;\n          } else if (_type !== 'file') {\n            if (tag.tagName === 'SELECT') {\n              var selectOption = function selectOption() {\n                for (var i = 0; i < tag.options.length; i++) {\n                  var option = tag.options[i];\n                  if (option.value == v) {\n                    tag.selectedIndex = i;\n                  }\n                }\n              };\n              selectOption();\n              _this8.nodesAttached.add(selectOption);\n            } else {\n              tag.value = v == null ? '' : v;\n            }\n          }\n          if (autoEventStarted) {\n            tag.dispatchEvent(new CustomEvent('cvAutoChanged', {\n              bubbles: true\n            }));\n          }\n          autoEventStarted = true;\n        } else {\n          if (v instanceof View) {\n            var _iterator8 = _createForOfIteratorHelper(tag.childNodes),\n              _step8;\n            try {\n              for (_iterator8.s(); !(_step8 = _iterator8.n()).done;) {\n                var node = _step8.value;\n                node.remove();\n              }\n            } catch (err) {\n              _iterator8.e(err);\n            } finally {\n              _iterator8.f();\n            }\n            v[_EventTargetMixin.EventTargetMixin.Parent] = _this8;\n            v.render(tag, null, _this8);\n          } else if (v instanceof Node) {\n            tag.insert(v);\n          } else if (v instanceof _Tag.Tag) {\n            tag.append(v.node);\n          } else if (unsafeHtml) {\n            if (tag.innerHTML !== v) {\n              v = String(v);\n              if (tag.innerHTML === v.substring(0, tag.innerHTML.length)) {\n                tag.innerHTML += v.substring(tag.innerHTML.length);\n              } else {\n                var _iterator9 = _createForOfIteratorHelper(tag.childNodes),\n                  _step9;\n                try {\n                  for (_iterator9.s(); !(_step9 = _iterator9.n()).done;) {\n                    var _node = _step9.value;\n                    _node.remove();\n                  }\n                } catch (err) {\n                  _iterator9.e(err);\n                } finally {\n                  _iterator9.f();\n                }\n                tag.innerHTML = v;\n              }\n              _Dom.Dom.mapTags(tag, false, function (t) {\n                return t[dontParse] = true;\n              });\n            }\n          } else {\n            if (tag.textContent !== v) {\n              var _iterator10 = _createForOfIteratorHelper(tag.childNodes),\n                _step10;\n              try {\n                for (_iterator10.s(); !(_step10 = _iterator10.n()).done;) {\n                  var _node2 = _step10.value;\n                  _node2.remove();\n                }\n              } catch (err) {\n                _iterator10.e(err);\n              } finally {\n                _iterator10.f();\n              }\n              tag.textContent = v;\n            }\n          }\n        }\n      });\n      if (proxy !== this.args) {\n        this.subBindings[bindArg].push(debind);\n      }\n      this.onRemove(debind);\n      var type = tag.getAttribute('type');\n      var multi = tag.getAttribute('multiple');\n      var inputListener = function inputListener(event) {\n        if (event.target !== tag) {\n          return;\n        }\n        if (type && type.toLowerCase() === 'checkbox') {\n          if (tag.checked) {\n            proxy[property] = event.target.getAttribute('value');\n          } else {\n            proxy[property] = false;\n          }\n        } else if (event.target.matches('[contenteditable=true]')) {\n          proxy[property] = event.target.innerHTML;\n        } else if (type === 'file' && multi) {\n          var files = Array.from(event.target.files);\n          var current = proxy[property] || _Bindable.Bindable.onDeck(proxy, property);\n          if (!current || !files.length) {\n            proxy[property] = files;\n          } else {\n            var _loop5 = function _loop5(i) {\n              if (files[i] !== current[i]) {\n                files[i].toJSON = function () {\n                  return {\n                    name: file[i].name,\n                    size: file[i].size,\n                    type: file[i].type,\n                    date: file[i].lastModified\n                  };\n                };\n                current[i] = files[i];\n                return \"break\";\n              }\n            };\n            for (var i in files) {\n              var _ret3 = _loop5(i);\n              if (_ret3 === \"break\") break;\n            }\n          }\n        } else if (type === 'file' && !multi && event.target.files.length) {\n          var _file = event.target.files.item(0);\n          _file.toJSON = function () {\n            return {\n              name: _file.name,\n              size: _file.size,\n              type: _file.type,\n              date: _file.lastModified\n            };\n          };\n          proxy[property] = _file;\n        } else {\n          proxy[property] = event.target.value;\n        }\n      };\n      if (type === 'file' || type === 'radio') {\n        tag.addEventListener('change', inputListener);\n      } else {\n        tag.addEventListener('input', inputListener);\n        tag.addEventListener('change', inputListener);\n        tag.addEventListener('value-changed', inputListener);\n      }\n      this.onRemove(function () {\n        if (type === 'file' || type === 'radio') {\n          tag.removeEventListener('change', inputListener);\n        } else {\n          tag.removeEventListener('input', inputListener);\n          tag.removeEventListener('change', inputListener);\n          tag.removeEventListener('value-changed', inputListener);\n        }\n      });\n      tag.removeAttribute('cv-bind');\n      return tag;\n    }\n  }, {\n    key: \"mapOnTag\",\n    value: function mapOnTag(tag) {\n      var _this9 = this;\n      var referents = String(tag.getAttribute('cv-on'));\n      referents.split(';').map(function (a) {\n        return a.split(':');\n      }).forEach(function (a) {\n        a = a.map(function (a) {\n          return a.trim();\n        });\n        var argLen = a.length;\n        var eventName = String(a.shift()).trim();\n        var callbackName = String(a.shift() || eventName).trim();\n        var eventFlags = String(a.shift() || '').trim();\n        var argList = [];\n        var groups = /(\\w+)(?:\\(([$\\w\\s-'\",]+)\\))?/.exec(callbackName);\n        if (groups) {\n          callbackName = groups[1].replace(/(^[\\s\\n]+|[\\s\\n]+$)/, '');\n          if (groups[2]) {\n            argList = groups[2].split(',').map(function (s) {\n              return s.trim();\n            });\n          }\n        }\n        if (!argList.length) {\n          argList.push('$event');\n        }\n        if (!eventName || argLen === 1) {\n          eventName = callbackName;\n        }\n        var eventMethod;\n        var parent = _this9;\n        var _loop6 = function _loop6() {\n          var controller = parent.controller;\n          if (typeof controller[callbackName] === 'function') {\n            eventMethod = function eventMethod() {\n              controller[callbackName].apply(controller, arguments);\n            };\n            return \"break\";\n          } else if (typeof parent[callbackName] === 'function') {\n            eventMethod = function eventMethod() {\n              var _parent;\n              (_parent = parent)[callbackName].apply(_parent, arguments);\n            };\n            return \"break\";\n          }\n          if (parent.parent) {\n            parent = parent.parent;\n          } else {\n            return \"break\";\n          }\n        };\n        while (parent) {\n          var _ret4 = _loop6();\n          if (_ret4 === \"break\") break;\n        }\n        var eventListener = function eventListener(event) {\n          var argRefs = argList.map(function (arg) {\n            var match;\n            if (Number(arg) == arg) {\n              return arg;\n            } else if (arg === 'event' || arg === '$event') {\n              return event;\n            } else if (arg === '$view') {\n              return parent;\n            } else if (arg === '$controller') {\n              return controller;\n            } else if (arg === '$tag') {\n              return tag;\n            } else if (arg === '$parent') {\n              return _this9.parent;\n            } else if (arg === '$subview') {\n              return _this9;\n            } else if (arg in _this9.args) {\n              return _this9.args[arg];\n            } else if (match = /^['\"]([\\w-]+?)[\"']$/.exec(arg)) {\n              return match[1];\n            }\n          });\n          if (!(typeof eventMethod === 'function')) {\n            throw new Error(\"\".concat(callbackName, \" is not defined on View object.\") + \"\\n\" + \"Tag:\" + \"\\n\" + \"\".concat(tag.outerHTML));\n          }\n          eventMethod.apply(void 0, _toConsumableArray(argRefs));\n        };\n        var eventOptions = {};\n        if (eventFlags.includes('p')) {\n          eventOptions.passive = true;\n        } else if (eventFlags.includes('P')) {\n          eventOptions.passive = false;\n        }\n        if (eventFlags.includes('c')) {\n          eventOptions.capture = true;\n        } else if (eventFlags.includes('C')) {\n          eventOptions.capture = false;\n        }\n        if (eventFlags.includes('o')) {\n          eventOptions.once = true;\n        } else if (eventFlags.includes('O')) {\n          eventOptions.once = false;\n        }\n        switch (eventName) {\n          case '_init':\n            eventListener();\n            break;\n          case '_attach':\n            _this9.nodesAttached.add(eventListener);\n            break;\n          case '_detach':\n            _this9.nodesDetached.add(eventListener);\n            break;\n          default:\n            tag.addEventListener(eventName, eventListener, eventOptions);\n            _this9.onRemove(function () {\n              tag.removeEventListener(eventName, eventListener, eventOptions);\n            });\n            break;\n        }\n        return [eventName, callbackName, argList];\n      });\n      tag.removeAttribute('cv-on');\n      return tag;\n    }\n  }, {\n    key: \"mapLinkTag\",\n    value: function mapLinkTag(tag) {\n      // const tagCompiler = this.compileLinkTag(tag);\n\n      // const newTag = tagCompiler(this);\n\n      // tag.replaceWith(newTag);\n\n      // return newTag;\n\n      var linkAttr = tag.getAttribute('cv-link');\n      tag.setAttribute('href', linkAttr);\n      var linkClick = function linkClick(event) {\n        event.preventDefault();\n        if (linkAttr.substring(0, 4) === 'http' || linkAttr.substring(0, 2) === '//') {\n          window.open(tag.getAttribute('href', linkAttr));\n          return;\n        }\n        _Router.Router.go(tag.getAttribute('href'));\n      };\n      tag.addEventListener('click', linkClick);\n      this.onRemove(function (tag, eventListener) {\n        return function () {\n          tag.removeEventListener('click', eventListener);\n          tag = undefined;\n          eventListener = undefined;\n        };\n      }(tag, linkClick));\n      tag.removeAttribute('cv-link');\n      return tag;\n    }\n\n    // compileLinkTag(sourceTag)\n    // {\n    // \tconst linkAttr = sourceTag.getAttribute('cv-link');\n    // \tsourceTag.removeAttribute('cv-link');\n    // \treturn (bindingView) => {\n    // \t\tconst tag = sourceTag.cloneNode(true);\n    // \t\ttag.setAttribute('href', linkAttr);\n    // \t\treturn tag;\n    // \t};\n    // }\n  }, {\n    key: \"mapPrendererTag\",\n    value: function mapPrendererTag(tag) {\n      var prerenderAttr = tag.getAttribute('cv-prerender');\n      var prerendering = window.prerenderer || navigator.userAgent.match(/prerender/i);\n      tag.removeAttribute('cv-prerender');\n      if (prerendering) {\n        window.prerenderer = window.prerenderer || true;\n      }\n      if (prerenderAttr === 'never' && prerendering || prerenderAttr === 'only' && !prerendering) {\n        this.postMapping.add(function () {\n          return tag.parentNode.removeChild(tag);\n        });\n      }\n      return tag;\n    }\n  }, {\n    key: \"mapWithTag\",\n    value: function mapWithTag(tag) {\n      var _this10 = this;\n      var withAttr = tag.getAttribute('cv-with');\n      var carryAttr = tag.getAttribute('cv-carry');\n      var viewAttr = tag.getAttribute('cv-view');\n      tag.removeAttribute('cv-with');\n      tag.removeAttribute('cv-carry');\n      tag.removeAttribute('cv-view');\n      var viewClass = viewAttr ? this.stringToClass(viewAttr) : View;\n      var subTemplate = new DocumentFragment();\n      _toConsumableArray(tag.childNodes).forEach(function (n) {\n        return subTemplate.appendChild(n);\n      });\n      var carryProps = [];\n      if (carryAttr) {\n        carryProps = carryAttr.split(',').map(function (s) {\n          return s.trim();\n        });\n      }\n      var debind = this.args.bindTo(withAttr, function (v, k, t, d) {\n        if (_this10.withViews.has(tag)) {\n          _this10.withViews.delete(tag);\n        }\n        while (tag.firstChild) {\n          tag.removeChild(tag.firstChild);\n        }\n        var view = new viewClass({}, _this10);\n        _this10.onRemove(function (view) {\n          return function () {\n            view.remove();\n          };\n        }(view));\n        view.template = subTemplate;\n        var _loop7 = function _loop7() {\n          var debind = _this10.args.bindTo(carryProps[i], function (v, k) {\n            view.args[k] = v;\n          });\n          view.onRemove(debind);\n          _this10.onRemove(function () {\n            debind();\n            view.remove();\n          });\n        };\n        for (var i in carryProps) {\n          _loop7();\n        }\n        var _loop8 = function _loop8() {\n          if (_typeof(v) !== 'object') {\n            return \"continue\";\n          }\n          v = _Bindable.Bindable.make(v);\n          var debind = v.bindTo(_i3, function (vv, kk, tt, dd) {\n            if (!dd) {\n              view.args[kk] = vv;\n            } else if (kk in view.args) {\n              delete view.args[kk];\n            }\n          });\n          var debindUp = view.args.bindTo(_i3, function (vv, kk, tt, dd) {\n            if (!dd) {\n              v[kk] = vv;\n            } else if (kk in v) {\n              delete v[kk];\n            }\n          });\n          _this10.onRemove(function () {\n            debind();\n            if (!v.isBound()) {\n              _Bindable.Bindable.clearBindings(v);\n            }\n            view.remove();\n          });\n          view.onRemove(function () {\n            debind();\n            if (!v.isBound()) {\n              _Bindable.Bindable.clearBindings(v);\n            }\n          });\n        };\n        for (var _i3 in v) {\n          var _ret5 = _loop8();\n          if (_ret5 === \"continue\") continue;\n        }\n        view.render(tag, null, _this10);\n        _this10.withViews.set(tag, view);\n      });\n      this.onRemove(function () {\n        _this10.withViews.delete(tag);\n        debind();\n      });\n      return tag;\n    }\n  }, {\n    key: \"mapViewTag\",\n    value: function mapViewTag(tag) {\n      var _this11 = this;\n      var viewAttr = tag.getAttribute('cv-view');\n      tag.removeAttribute('cv-view');\n      var subTemplate = new DocumentFragment();\n      _toConsumableArray(tag.childNodes).forEach(function (n) {\n        return subTemplate.appendChild(n);\n      });\n      var parts = viewAttr.split(':');\n      var viewName = parts.shift();\n      var viewClass = parts.length ? this.stringToClass(parts[0]) : View;\n      var view = new viewClass(this.args, this);\n      this.views.set(tag, view);\n      this.views.set(viewName, view);\n      this.onRemove(function () {\n        view.remove();\n        _this11.views.delete(tag);\n        _this11.views.delete(viewName);\n      });\n      view.template = subTemplate;\n      view.render(tag, null, this);\n      return tag;\n    }\n  }, {\n    key: \"mapEachTag\",\n    value: function mapEachTag(tag) {\n      var _this12 = this;\n      var eachAttr = tag.getAttribute('cv-each');\n      var viewAttr = tag.getAttribute('cv-view');\n      tag.removeAttribute('cv-each');\n      tag.removeAttribute('cv-view');\n      var viewClass = viewAttr ? this.stringToClass(viewAttr) : View;\n      var subTemplate = new DocumentFragment();\n      _toConsumableArray(tag.childNodes).forEach(function (n) {\n        return subTemplate.appendChild(n);\n      });\n      var _eachAttr$split = eachAttr.split(':'),\n        _eachAttr$split2 = _slicedToArray(_eachAttr$split, 3),\n        eachProp = _eachAttr$split2[0],\n        asProp = _eachAttr$split2[1],\n        keyProp = _eachAttr$split2[2];\n      var proxy = this.args;\n      var property = eachProp;\n      if (eachProp.match(/\\./)) {\n        var _Bindable$resolve11 = _Bindable.Bindable.resolve(this.args, eachProp, true);\n        var _Bindable$resolve12 = _slicedToArray(_Bindable$resolve11, 2);\n        proxy = _Bindable$resolve12[0];\n        property = _Bindable$resolve12[1];\n      }\n      var debind = proxy.bindTo(property, function (v, k, t, d, p) {\n        if (v instanceof _Bag.Bag) {\n          v = v.list;\n        }\n        if (_this12.viewLists.has(tag)) {\n          _this12.viewLists.get(tag).remove();\n        }\n        var viewList = new _ViewList.ViewList(subTemplate, asProp, v, _this12, keyProp, viewClass);\n        var viewListRemover = function viewListRemover() {\n          return viewList.remove();\n        };\n        _this12.onRemove(viewListRemover);\n        viewList.onRemove(function () {\n          return _this12._onRemove.remove(viewListRemover);\n        });\n        var debindA = _this12.args.bindTo(function (v, k, t, d) {\n          if (k === '_id') {\n            return;\n          }\n          if (!d) {\n            viewList.subArgs[k] = v;\n          } else {\n            if (k in viewList.subArgs) {\n              delete viewList.subArgs[k];\n            }\n          }\n        });\n        var debindB = viewList.args.bindTo(function (v, k, t, d, p) {\n          if (k === '_id' || k === 'value' || String(k).substring(0, 3) === '___') {\n            return;\n          }\n          if (!d) {\n            if (k in _this12.args) {\n              _this12.args[k] = v;\n            }\n          } else {\n            delete _this12.args[k];\n          }\n        });\n        viewList.onRemove(debindA);\n        viewList.onRemove(debindB);\n        _this12.onRemove(debindA);\n        _this12.onRemove(debindB);\n        while (tag.firstChild) {\n          tag.removeChild(tag.firstChild);\n        }\n        _this12.viewLists.set(tag, viewList);\n        viewList.render(tag, null, _this12);\n      });\n      this.onRemove(debind);\n      return tag;\n    }\n  }, {\n    key: \"mapIfTag\",\n    value: function mapIfTag(tag) {\n      var _this13 = this;\n      var sourceTag = tag;\n      var viewProperty = sourceTag.getAttribute('cv-view');\n      var ifProperty = sourceTag.getAttribute('cv-if');\n      var isProperty = sourceTag.getAttribute('cv-is');\n      var inverted = false;\n      var defined = false;\n      sourceTag.removeAttribute('cv-view');\n      sourceTag.removeAttribute('cv-if');\n      sourceTag.removeAttribute('cv-is');\n      var viewClass = viewProperty ? this.stringToClass(viewProperty) : View;\n      if (ifProperty.substr(0, 1) === '!') {\n        ifProperty = ifProperty.substr(1);\n        inverted = true;\n      }\n      if (ifProperty.substr(0, 1) === '?') {\n        ifProperty = ifProperty.substr(1);\n        defined = true;\n      }\n      var subTemplate = new DocumentFragment();\n      _toConsumableArray(sourceTag.childNodes).forEach(function (n) {\n        return subTemplate.appendChild(n);\n      });\n      var bindingView = this;\n      var ifDoc = new DocumentFragment();\n\n      // let view = new viewClass(Object.assign({}, this.args), bindingView);\n      var view = new viewClass(this.args, bindingView);\n      view.tags.bindTo(function (v, k) {\n        return _this13.tags[k] = v;\n      }, {\n        removeWith: this\n      });\n      view.template = subTemplate;\n      var proxy = bindingView.args;\n      var property = ifProperty;\n      if (ifProperty.match(/\\./)) {\n        var _Bindable$resolve13 = _Bindable.Bindable.resolve(bindingView.args, ifProperty, true);\n        var _Bindable$resolve14 = _slicedToArray(_Bindable$resolve13, 2);\n        proxy = _Bindable$resolve14[0];\n        property = _Bindable$resolve14[1];\n      }\n      view.render(ifDoc, null, this);\n      var propertyDebind = proxy.bindTo(property, function (v, k) {\n        var o = v;\n        if (defined) {\n          v = v !== null && v !== undefined;\n        }\n        if (v instanceof _Bag.Bag) {\n          v = v.list;\n        }\n        if (Array.isArray(v)) {\n          v = !!v.length;\n        }\n        if (isProperty !== null) {\n          v = o == isProperty;\n        }\n        if (inverted) {\n          v = !v;\n        }\n        if (v) {\n          tag.appendChild(ifDoc);\n          _toConsumableArray(ifDoc.childNodes).forEach(function (node) {\n            return _Dom.Dom.mapTags(node, false, function (tag, walker) {\n              if (!tag.matches) {\n                return;\n              }\n              tag.dispatchEvent(new CustomEvent('cvDomAttached', {\n                target: tag,\n                detail: {\n                  view: view || _this13,\n                  mainView: _this13\n                }\n              }));\n            });\n          });\n        } else {\n          view.nodes.forEach(function (n) {\n            return ifDoc.appendChild(n);\n          });\n          _Dom.Dom.mapTags(ifDoc, false, function (tag, walker) {\n            if (!tag.matches) {\n              return;\n            }\n            new CustomEvent('cvDomDetached', {\n              target: tag,\n              detail: {\n                view: view || _this13,\n                mainView: _this13\n              }\n            });\n          });\n        }\n      }, {\n        children: Array.isArray(proxy[property])\n      });\n\n      // const propertyDebind = this.args.bindChain(property, onUpdate);\n\n      bindingView.onRemove(propertyDebind);\n\n      // const debindA = this.args.bindTo((v,k,t,d) => {\n      // \tif(k === '_id')\n      // \t{\n      // \t\treturn;\n      // \t}\n\n      // \tif(!d)\n      // \t{\n      // \t\tview.args[k] = v;\n      // \t}\n      // \telse if(k in view.args)\n      // \t{\n      // \t\tdelete view.args[k];\n      // \t}\n\n      // });\n\n      // const debindB = view.args.bindTo((v,k,t,d,p) => {\n      // \tif(k === '_id' || String(k).substring(0,3) === '___')\n      // \t{\n      // \t\treturn;\n      // \t}\n\n      // \tif(k in this.args)\n      // \t{\n      // \t\tif(!d)\n      // \t\t{\n      // \t\t\tthis.args[k] = v;\n      // \t\t}\n      // \t\telse\n      // \t\t{\n      // \t\t\tdelete this.args[k];\n      // \t\t}\n      // \t}\n      // });\n\n      var viewDebind = function viewDebind() {\n        propertyDebind();\n        // debindA();\n        // debindB();\n        bindingView._onRemove.remove(propertyDebind);\n        // bindingView._onRemove.remove(bindableDebind);\n      };\n\n      bindingView.onRemove(viewDebind);\n      this.onRemove(function () {\n        // debindA();\n        // debindB();\n        view.remove();\n        if (bindingView !== _this13) {\n          bindingView.remove();\n        }\n      });\n      return tag;\n    }\n\n    // compileIfTag(sourceTag)\n    // {\n    // \tlet ifProperty = sourceTag.getAttribute('cv-if');\n    // \tlet inverted   = false;\n\n    // \tsourceTag.removeAttribute('cv-if');\n\n    // \tif(ifProperty.substr(0, 1) === '!')\n    // \t{\n    // \t\tifProperty = ifProperty.substr(1);\n    // \t\tinverted   = true;\n    // \t}\n\n    // \tconst subTemplate = new DocumentFragment;\n\n    // \t[...sourceTag.childNodes].forEach(\n    // \t\tn => subTemplate.appendChild(n.cloneNode(true))\n    // \t);\n\n    // \treturn (bindingView) => {\n\n    // \t\tconst tag = sourceTag.cloneNode();\n\n    // \t\tconst ifDoc = new DocumentFragment;\n\n    // \t\tlet view = new View({}, bindingView);\n\n    // \t\tview.template = subTemplate;\n    // \t\t// view.parent   = bindingView;\n\n    // \t\tbindingView.syncBind(view);\n\n    // \t\tlet proxy    = bindingView.args;\n    // \t\tlet property = ifProperty;\n\n    // \t\tif(ifProperty.match(/\\./))\n    // \t\t{\n    // \t\t\t[proxy, property] = Bindable.resolve(\n    // \t\t\t\tbindingView.args\n    // \t\t\t\t, ifProperty\n    // \t\t\t\t, true\n    // \t\t\t);\n    // \t\t}\n\n    // \t\tlet hasRendered = false;\n\n    // \t\tconst propertyDebind = proxy.bindTo(property, (v,k) => {\n\n    // \t\t\tif(!hasRendered)\n    // \t\t\t{\n    // \t\t\t\tconst renderDoc = (bindingView.args[property] || inverted)\n    // \t\t\t\t\t? tag : ifDoc;\n\n    // \t\t\t\tview.render(renderDoc);\n\n    // \t\t\t\thasRendered = true;\n\n    // \t\t\t\treturn;\n    // \t\t\t}\n\n    // \t\t\tif(Array.isArray(v))\n    // \t\t\t{\n    // \t\t\t\tv = !!v.length;\n    // \t\t\t}\n\n    // \t\t\tif(inverted)\n    // \t\t\t{\n    // \t\t\t\tv = !v;\n    // \t\t\t}\n\n    // \t\t\tif(v)\n    // \t\t\t{\n    // \t\t\t\ttag.appendChild(ifDoc);\n    // \t\t\t}\n    // \t\t\telse\n    // \t\t\t{\n    // \t\t\t\tview.nodes.forEach(n=>ifDoc.appendChild(n));\n    // \t\t\t}\n\n    // \t\t});\n\n    // \t\t// let cleaner = bindingView;\n\n    // \t\t// while(cleaner.parent)\n    // \t\t// {\n    // \t\t// \tcleaner = cleaner.parent;\n    // \t\t// }\n\n    // \t\tbindingView.onRemove(propertyDebind);\n\n    // \t\tlet bindableDebind = () => {\n\n    // \t\t\tif(!proxy.isBound())\n    // \t\t\t{\n    // \t\t\t\tBindable.clearBindings(proxy);\n    // \t\t\t}\n\n    // \t\t};\n\n    // \t\tlet viewDebind = ()=>{\n    // \t\t\tpropertyDebind();\n    // \t\t\tbindableDebind();\n    // \t\t\tbindingView._onRemove.remove(propertyDebind);\n    // \t\t\tbindingView._onRemove.remove(bindableDebind);\n    // \t\t};\n\n    // \t\tview.onRemove(viewDebind);\n\n    // \t\treturn tag;\n    // \t};\n    // }\n  }, {\n    key: \"mapTemplateTag\",\n    value: function mapTemplateTag(tag) {\n      // const templateName = tag.getAttribute('cv-template');\n\n      // tag.removeAttribute('cv-template');\n\n      // this.templates[ templateName ] = tag.tagName === 'TEMPLATE'\n      // \t? tag.cloneNode(true).content\n      // \t: new DocumentFragment(tag.innerHTML);\n\n      var templateName = tag.getAttribute('cv-template');\n      tag.removeAttribute('cv-template');\n      var source = tag.innerHTML;\n      if (!View.templates.has(source)) {\n        View.templates.set(source, document.createRange().createContextualFragment(tag.innerHTML));\n      }\n      this.templates[templateName] = View.templates.get(source);\n      this.postMapping.add(function () {\n        return tag.remove();\n      });\n      return tag;\n    }\n  }, {\n    key: \"mapSlotTag\",\n    value: function mapSlotTag(tag) {\n      var templateName = tag.getAttribute('cv-slot');\n      var template = this.templates[templateName];\n      if (!template) {\n        var parent = this;\n        while (parent) {\n          template = parent.templates[templateName];\n          if (template) {\n            break;\n          }\n          parent = this.parent;\n        }\n        if (!template) {\n          console.error(\"Template \".concat(templateName, \" not found.\"));\n          return;\n        }\n      }\n      tag.removeAttribute('cv-slot');\n      while (tag.firstChild) {\n        tag.firstChild.remove();\n      }\n      tag.appendChild(template.cloneNode(true));\n      return tag;\n    }\n\n    // syncBind(subView)\n    // {\n    // \tlet debindA = this.args.bindTo((v,k,t,d)=>{\n    // \t\tif(k === '_id')\n    // \t\t{\n    // \t\t\treturn;\n    // \t\t}\n\n    // \t\tif(subView.args[k] !== v)\n    // \t\t{\n    // \t\t\tsubView.args[k] = v;\n    // \t\t}\n    // \t});\n\n    // \tlet debindB = subView.args.bindTo((v,k,t,d,p)=>{\n\n    // \t\tif(k === '_id')\n    // \t\t{\n    // \t\t\treturn;\n    // \t\t}\n\n    // \t\tlet newRef = v;\n    // \t\tlet oldRef = p;\n\n    // \t\tif(newRef instanceof View)\n    // \t\t{\n    // \t\t\tnewRef = newRef.___ref___;\n    // \t\t}\n\n    // \t\tif(oldRef instanceof View)\n    // \t\t{\n    // \t\t\toldRef = oldRef.___ref___;\n    // \t\t}\n\n    // \t\tif(newRef !== oldRef && oldRef instanceof View)\n    // \t\t{\n    // \t\t\tp.remove();\n    // \t\t}\n\n    // \t\tif(k in this.args)\n    // \t\t{\n    // \t\t\tthis.args[k] = v;\n    // \t\t}\n\n    // \t});\n\n    // \tthis.onRemove(debindA);\n    // \tthis.onRemove(debindB);\n\n    // \tsubView.onRemove(()=>{\n    // \t\tthis._onRemove.remove(debindA);\n    // \t\tthis._onRemove.remove(debindB);\n    // \t});\n    // }\n  }, {\n    key: \"postRender\",\n    value: function postRender(parentNode) {}\n  }, {\n    key: \"attached\",\n    value: function attached(parentNode) {}\n  }, {\n    key: \"interpolatable\",\n    value: function interpolatable(str) {\n      return !!String(str).match(this.interpolateRegex);\n    }\n  }, {\n    key: \"remove\",\n    value: function remove() {\n      var _this14 = this;\n      var now = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      if (!this.dispatchEvent(new CustomEvent('remove', {\n        detail: {\n          view: this\n        },\n        cancelable: true\n      }))) {\n        return;\n      }\n      var remover = function remover() {\n        for (var i in _this14.tags) {\n          if (Array.isArray(_this14.tags[i])) {\n            _this14.tags[i] && _this14.tags[i].forEach(function (t) {\n              return t.remove();\n            });\n            _this14.tags[i].splice(0);\n          } else {\n            _this14.tags[i] && _this14.tags[i].remove();\n            _this14.tags[i] = undefined;\n          }\n        }\n        for (var _i4 in _this14.nodes) {\n          _this14.nodes[_i4] && _this14.nodes[_i4].dispatchEvent(new Event('cvDomDetached'));\n          _this14.nodes[_i4] && _this14.nodes[_i4].remove();\n          _this14.nodes[_i4] = undefined;\n        }\n        _this14.nodes.splice(0);\n        _this14.firstNode = _this14.lastNode = undefined;\n      };\n      if (now) {\n        remover();\n      } else {\n        requestAnimationFrame(remover);\n      }\n      var callbacks = this._onRemove.items();\n      var _iterator11 = _createForOfIteratorHelper(callbacks),\n        _step11;\n      try {\n        for (_iterator11.s(); !(_step11 = _iterator11.n()).done;) {\n          var callback = _step11.value;\n          callback();\n          this._onRemove.remove(callback);\n        }\n      } catch (err) {\n        _iterator11.e(err);\n      } finally {\n        _iterator11.f();\n      }\n      var _iterator12 = _createForOfIteratorHelper(this.cleanup),\n        _step12;\n      try {\n        for (_iterator12.s(); !(_step12 = _iterator12.n()).done;) {\n          var cleanup = _step12.value;\n          cleanup && cleanup();\n        }\n      } catch (err) {\n        _iterator12.e(err);\n      } finally {\n        _iterator12.f();\n      }\n      this.cleanup.length = 0;\n      var _iterator13 = _createForOfIteratorHelper(this.viewLists),\n        _step13;\n      try {\n        for (_iterator13.s(); !(_step13 = _iterator13.n()).done;) {\n          var _step13$value = _slicedToArray(_step13.value, 2),\n            tag = _step13$value[0],\n            viewList = _step13$value[1];\n          viewList.remove();\n        }\n      } catch (err) {\n        _iterator13.e(err);\n      } finally {\n        _iterator13.f();\n      }\n      this.viewLists.clear();\n      var _iterator14 = _createForOfIteratorHelper(this.timeouts),\n        _step14;\n      try {\n        for (_iterator14.s(); !(_step14 = _iterator14.n()).done;) {\n          var _step14$value = _slicedToArray(_step14.value, 2),\n            _callback5 = _step14$value[0],\n            timeout = _step14$value[1];\n          clearTimeout(timeout.timeout);\n          this.timeouts.delete(timeout.timeout);\n        }\n      } catch (err) {\n        _iterator14.e(err);\n      } finally {\n        _iterator14.f();\n      }\n      var _iterator15 = _createForOfIteratorHelper(this.intervals),\n        _step15;\n      try {\n        for (_iterator15.s(); !(_step15 = _iterator15.n()).done;) {\n          var interval = _step15.value;\n          clearInterval(interval);\n        }\n      } catch (err) {\n        _iterator15.e(err);\n      } finally {\n        _iterator15.f();\n      }\n      this.intervals.length = 0;\n      var _iterator16 = _createForOfIteratorHelper(this.frames),\n        _step16;\n      try {\n        for (_iterator16.s(); !(_step16 = _iterator16.n()).done;) {\n          var frame = _step16.value;\n          frame();\n        }\n      } catch (err) {\n        _iterator16.e(err);\n      } finally {\n        _iterator16.f();\n      }\n      this.frames.length = 0;\n      this.preRuleSet.purge();\n      this.ruleSet.purge();\n      this.removed = true;\n      this.dispatchEvent(new CustomEvent('removed', {\n        detail: {\n          view: this\n        },\n        cancelable: true\n      }));\n    }\n  }, {\n    key: \"findTag\",\n    value: function findTag(selector) {\n      for (var i in this.nodes) {\n        var result = void 0;\n        if (!this.nodes[i].querySelector) {\n          continue;\n        }\n        if (this.nodes[i].matches(selector)) {\n          return new _Tag.Tag(this.nodes[i], this, undefined, undefined, this);\n        }\n        if (result = this.nodes[i].querySelector(selector)) {\n          return new _Tag.Tag(result, this, undefined, undefined, this);\n        }\n      }\n    }\n  }, {\n    key: \"findTags\",\n    value: function findTags(selector) {\n      var _this15 = this;\n      var topLevel = this.nodes.filter(function (n) {\n        return n.matches && n.matches(selector);\n      });\n      var subLevel = this.nodes.filter(function (n) {\n        return n.querySelectorAll;\n      }).map(function (n) {\n        return _toConsumableArray(n.querySelectorAll(selector));\n      }).flat().map(function (n) {\n        return new _Tag.Tag(n, _this15, undefined, undefined, _this15);\n      }) || [];\n      return topLevel.concat(subLevel);\n    }\n  }, {\n    key: \"onRemove\",\n    value: function onRemove(callback) {\n      if (callback instanceof Event) {\n        return;\n      }\n      this._onRemove.add(callback);\n    }\n  }, {\n    key: \"update\",\n    value: function update() {}\n  }, {\n    key: \"beforeUpdate\",\n    value: function beforeUpdate(args) {}\n  }, {\n    key: \"afterUpdate\",\n    value: function afterUpdate(args) {}\n  }, {\n    key: \"stringTransformer\",\n    value: function stringTransformer(methods) {\n      var _this16 = this;\n      return function (x) {\n        for (var m in methods) {\n          var parent = _this16;\n          var method = methods[m];\n          while (parent && !parent[method]) {\n            parent = parent.parent;\n          }\n          if (!parent) {\n            return;\n          }\n          x = parent[methods[m]](x);\n        }\n        return x;\n      };\n    }\n  }, {\n    key: \"stringToClass\",\n    value: function stringToClass(refClassname) {\n      if (View.refClasses.has(refClassname)) {\n        return View.refClasses.get(refClassname);\n      }\n      var refClassSplit = refClassname.split('/');\n      var refShortClass = refClassSplit[refClassSplit.length - 1];\n      var refClass = require(refClassname);\n      View.refClasses.set(refClassname, refClass[refShortClass]);\n      return refClass[refShortClass];\n    }\n  }, {\n    key: \"preventParsing\",\n    value: function preventParsing(node) {\n      node[dontParse] = true;\n    }\n  }, {\n    key: \"toString\",\n    value: function toString() {\n      return this.nodes.map(function (n) {\n        return n.outerHTML;\n      }).join(' ');\n    }\n  }, {\n    key: \"listen\",\n    value: function listen(node, eventName, callback, options) {\n      var _this17 = this;\n      if (typeof node === 'string') {\n        options = callback;\n        callback = eventName;\n        eventName = node;\n        node = this;\n      }\n      if (node instanceof View) {\n        return this.listen(node.nodes, eventName, callback, options);\n      }\n      if (Array.isArray(node)) {\n        return node.map(function (n) {\n          return _this17.listen(n, eventName, callback, options);\n        });\n        // .forEach(r => r());\n      }\n\n      if (node instanceof _Tag.Tag) {\n        return this.listen(node.element, eventName, callback, options);\n      }\n      node.addEventListener(eventName, callback, options);\n      var remove = function remove() {\n        return node.removeEventListener(eventName, callback, options);\n      };\n      var remover = function remover() {\n        remove();\n        remove = function remove() {};\n      };\n      this.onRemove(function () {\n        return remover();\n      });\n      return remover;\n    }\n  }, {\n    key: \"detach\",\n    value: function detach() {\n      for (var n in this.nodes) {\n        this.nodes[n].remove();\n      }\n      return this.nodes;\n    }\n  }], [{\n    key: \"from\",\n    value: function from(template) {\n      var args = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var mainView = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n      var view = new this(args, mainView);\n      view.template = template;\n      return view;\n    }\n  }, {\n    key: \"isView\",\n    value: function isView() {\n      return View;\n    }\n  }, {\n    key: \"uuid\",\n    value: function uuid() {\n      return new _Uuid.Uuid();\n    }\n  }]);\n  return View;\n}(_Mixin.Mixin.with(_EventTargetMixin.EventTargetMixin));\nexports.View = View;\nObject.defineProperty(View, 'templates', {\n  value: new Map()\n});\nObject.defineProperty(View, 'refClasses', {\n  value: new Map()\n});\n  })();\n});","\nrequire.register(\"curvature/base/ViewList.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ViewList = void 0;\nvar _Bindable = require(\"./Bindable\");\nvar _SetMap = require(\"./SetMap\");\nvar _Bag = require(\"./Bag\");\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar ViewList = /*#__PURE__*/function () {\n  function ViewList(template, subProperty, list, parent) {\n    var _this = this;\n    var keyProperty = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : null;\n    var viewClass = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : null;\n    _classCallCheck(this, ViewList);\n    this.removed = false;\n    this.args = _Bindable.Bindable.makeBindable(Object.create(null));\n    this.args.value = _Bindable.Bindable.makeBindable(list || Object.create(null));\n    this.subArgs = _Bindable.Bindable.makeBindable(Object.create(null));\n    this.views = [];\n    this.cleanup = [];\n    this.viewClass = viewClass;\n    this._onRemove = new _Bag.Bag();\n    this.template = template;\n    this.subProperty = subProperty;\n    this.keyProperty = keyProperty;\n    this.tag = null;\n    this.downDebind = [];\n    this.upDebind = [];\n    this.paused = false;\n    this.parent = parent;\n    this.viewCount = 0;\n    this.rendered = new Promise(function (accept, reject) {\n      Object.defineProperty(_this, 'renderComplete', {\n        configurable: false,\n        writable: true,\n        value: accept\n      });\n    });\n    this.willReRender = false;\n    this.args.___before(function (t, e, s, o, a) {\n      if (e == 'bindTo') {\n        return;\n      }\n      _this.paused = true;\n    });\n    this.args.___after(function (t, e, s, o, a) {\n      if (e == 'bindTo') {\n        return;\n      }\n      _this.paused = s.length > 1;\n      _this.reRender();\n    });\n    var debind = this.args.value.bindTo(function (v, k, t, d) {\n      if (_this.paused) {\n        return;\n      }\n      var kk = k;\n      if (_typeof(k) === 'symbol') {\n        return;\n      }\n      if (isNaN(k)) {\n        kk = '_' + k;\n      }\n      if (d) {\n        if (_this.views[kk]) {\n          _this.views[kk].remove(true);\n        }\n        delete _this.views[kk];\n        for (var i in _this.views) {\n          if (isNaN(i)) {\n            _this.views[i].args[_this.keyProperty] = i.substr(1);\n            continue;\n          }\n          _this.views[i].args[_this.keyProperty] = i;\n        }\n      } else if (!_this.views[kk]) {\n        if (_this.willReRender === false) {\n          _this.willReRender = requestAnimationFrame(function () {\n            _this.willReRender = false;\n            _this.reRender();\n          });\n        }\n      } else if (_this.views[kk] && _this.views[kk].args) {\n        _this.views[kk].args[_this.keyProperty] = k;\n        _this.views[kk].args[_this.subProperty] = v;\n      }\n    });\n    this._onRemove.add(debind);\n    Object.preventExtensions(this);\n  }\n  _createClass(ViewList, [{\n    key: \"render\",\n    value: function render(tag) {\n      var _this2 = this;\n      var renders = [];\n      var _iterator = _createForOfIteratorHelper(this.views),\n        _step;\n      try {\n        var _loop = function _loop() {\n          var view = _step.value;\n          view.viewList = _this2;\n          view.render(tag, null, _this2.parent);\n          renders.push(view.rendered.then(function () {\n            return view;\n          }));\n        };\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          _loop();\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n      this.tag = tag;\n      Promise.all(renders).then(function (views) {\n        return _this2.renderComplete(views);\n      });\n      this.parent.dispatchEvent(new CustomEvent('listRendered', {\n        detail: {\n          detail: {\n            key: this.subProperty,\n            value: this.args.value\n          }\n        }\n      }));\n    }\n  }, {\n    key: \"reRender\",\n    value: function reRender() {\n      var _this3 = this;\n      if (this.paused || !this.tag) {\n        return;\n      }\n      var views = [];\n      var existingViews = new _SetMap.SetMap();\n      for (var i in this.views) {\n        var view = this.views[i];\n        var rawValue = view.args[this.subProperty];\n        existingViews.add(rawValue, view);\n        views[i] = view;\n      }\n      var finalViews = [];\n      var finalViewSet = new Set();\n      this.downDebind.length && this.downDebind.forEach(function (d) {\n        return d && d();\n      });\n      this.upDebind.length && this.upDebind.forEach(function (d) {\n        return d && d();\n      });\n      this.upDebind.length = 0;\n      this.downDebind.length = 0;\n      var minKey = Infinity;\n      var anteMinKey = Infinity;\n      var _loop2 = function _loop2() {\n        var found = false;\n        var k = _i;\n        if (isNaN(k)) {\n          k = '_' + _i;\n        } else if (String(k).length) {\n          k = Number(k);\n        }\n        if (_this3.args.value[_i] !== undefined && existingViews.has(_this3.args.value[_i])) {\n          var existingView = existingViews.getOne(_this3.args.value[_i]);\n          if (existingView) {\n            existingView.args[_this3.keyProperty] = _i;\n            finalViews[k] = existingView;\n            finalViewSet.add(existingView);\n            found = true;\n            if (!isNaN(k)) {\n              minKey = Math.min(minKey, k);\n              k > 0 && (anteMinKey = Math.min(anteMinKey, k));\n            }\n            existingViews.remove(_this3.args.value[_i], existingView);\n          }\n        }\n        if (!found) {\n          var viewArgs = Object.create(null);\n          var _view = finalViews[k] = new _this3.viewClass(viewArgs, _this3.parent);\n          if (!isNaN(k)) {\n            minKey = Math.min(minKey, k);\n            k > 0 && (anteMinKey = Math.min(anteMinKey, k));\n          }\n          finalViews[k].template = _this3.template;\n          finalViews[k].viewList = _this3;\n          finalViews[k].args[_this3.keyProperty] = _i;\n          finalViews[k].args[_this3.subProperty] = _this3.args.value[_i];\n          _this3.upDebind[k] = viewArgs.bindTo(_this3.subProperty, function (v, k, t, d) {\n            var index = viewArgs[_this3.keyProperty];\n            if (d) {\n              delete _this3.args.value[index];\n              return;\n            }\n            _this3.args.value[index] = v;\n          });\n          _this3.downDebind[k] = _this3.subArgs.bindTo(function (v, k, t, d) {\n            if (d) {\n              delete viewArgs[k];\n              return;\n            }\n            viewArgs[k] = v;\n          });\n          var upDebind = function upDebind() {\n            _this3.upDebind.filter(function (x) {\n              return x;\n            }).forEach(function (d) {\n              return d();\n            });\n            _this3.upDebind.length = 0;\n          };\n          var downDebind = function downDebind() {\n            _this3.downDebind.filter(function (x) {\n              return x;\n            }).forEach(function (d) {\n              return d();\n            });\n            _this3.downDebind.length = 0;\n          };\n          _view.onRemove(function () {\n            _this3._onRemove.remove(upDebind);\n            _this3._onRemove.remove(downDebind);\n            _this3.upDebind[k] && _this3.upDebind[k]();\n            _this3.downDebind[k] && _this3.downDebind[k]();\n            delete _this3.upDebind[k];\n            delete _this3.downDebind[k];\n          });\n          _this3._onRemove.add(upDebind);\n          _this3._onRemove.add(downDebind);\n          viewArgs[_this3.subProperty] = _this3.args.value[_i];\n        }\n      };\n      for (var _i in this.args.value) {\n        _loop2();\n      }\n      for (var _i2 in views) {\n        if (!finalViewSet.has(views[_i2])) {\n          views[_i2].remove(true);\n        }\n      }\n      if (Array.isArray(this.args.value)) {\n        var localMin = minKey === 0 && finalViews[1] !== undefined && finalViews.length > 1 || anteMinKey === Infinity ? minKey : anteMinKey;\n        var renderRecurse = function renderRecurse() {\n          var i = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n          var ii = finalViews.length - i - 1;\n          while (ii > localMin && finalViews[ii] === undefined) {\n            ii--;\n          }\n          if (ii < localMin) {\n            return Promise.resolve();\n          }\n          if (finalViews[ii] === _this3.views[ii]) {\n            if (finalViews[ii] && !finalViews[ii].firstNode) {\n              finalViews[ii].render(_this3.tag, finalViews[ii + 1], _this3.parent);\n              return finalViews[ii].rendered.then(function () {\n                return renderRecurse(Number(i) + 1);\n              });\n            } else {\n              var split = 500;\n              if (i === 0 || i % split) {\n                return renderRecurse(Number(i) + 1);\n              } else {\n                return new Promise(function (accept) {\n                  return requestAnimationFrame(function () {\n                    return accept(renderRecurse(Number(i) + 1));\n                  });\n                });\n              }\n            }\n          }\n          finalViews[ii].render(_this3.tag, finalViews[ii + 1], _this3.parent);\n          _this3.views.splice(ii, 0, finalViews[ii]);\n          return finalViews[ii].rendered.then(function () {\n            return renderRecurse(i + 1);\n          });\n        };\n        this.rendered = renderRecurse();\n      } else {\n        var renders = [];\n        var leftovers = Object.assign(Object.create(null), finalViews);\n        var isInt = function isInt(x) {\n          return parseInt(x) === x - 0;\n        };\n        var keys = Object.keys(finalViews).sort(function (a, b) {\n          if (isInt(a) && isInt(b)) {\n            return Math.sign(a - b);\n          }\n          if (!isInt(a) && !isInt(b)) {\n            return 0;\n          }\n          if (!isInt(a) && isInt(b)) {\n            return -1;\n          }\n          if (isInt(a) && !isInt(b)) {\n            return 1;\n          }\n        });\n        var _iterator2 = _createForOfIteratorHelper(keys),\n          _step2;\n        try {\n          var _loop3 = function _loop3() {\n            var i = _step2.value;\n            delete leftovers[i];\n            if (finalViews[i].firstNode && finalViews[i] === _this3.views[i]) {\n              return \"continue\";\n            }\n            finalViews[i].render(_this3.tag, null, _this3.parent);\n            renders.push(finalViews[i].rendered.then(function () {\n              return finalViews[i];\n            }));\n          };\n          for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n            var _ret = _loop3();\n            if (_ret === \"continue\") continue;\n          }\n        } catch (err) {\n          _iterator2.e(err);\n        } finally {\n          _iterator2.f();\n        }\n        for (var _i3 in leftovers) {\n          delete this.args.views[_i3];\n          leftovers.remove(true);\n        }\n        this.rendered = Promise.all(renders);\n      }\n      for (var _i4 in finalViews) {\n        if (isNaN(_i4)) {\n          finalViews[_i4].args[this.keyProperty] = _i4.substr(1);\n          continue;\n        }\n        finalViews[_i4].args[this.keyProperty] = _i4;\n      }\n      this.views = Array.isArray(this.args.value) ? [].concat(finalViews) : finalViews;\n      this.viewCount = finalViewSet.size;\n      finalViewSet.clear();\n      this.willReRender = false;\n      this.rendered.then(function () {\n        _this3.parent.dispatchEvent(new CustomEvent('listRendered', {\n          detail: {\n            detail: {\n              key: _this3.subProperty,\n              value: _this3.args.value,\n              tag: _this3.tag\n            }\n          }\n        }));\n        _this3.tag.dispatchEvent(new CustomEvent('listRendered', {\n          detail: {\n            detail: {\n              key: _this3.subProperty,\n              value: _this3.args.value,\n              tag: _this3.tag\n            }\n          }\n        }));\n      });\n      return this.rendered;\n    }\n  }, {\n    key: \"pause\",\n    value: function pause() {\n      var _pause = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      for (var i in this.views) {\n        this.views[i].pause(_pause);\n      }\n    }\n  }, {\n    key: \"onRemove\",\n    value: function onRemove(callback) {\n      this._onRemove.add(callback);\n    }\n  }, {\n    key: \"remove\",\n    value: function remove() {\n      for (var i in this.views) {\n        this.views[i].remove(true);\n      }\n      var onRemove = this._onRemove.items();\n      for (var _i5 in onRemove) {\n        this._onRemove.remove(onRemove[_i5]);\n        onRemove[_i5]();\n      }\n      var cleanup;\n      while (this.cleanup.length) {\n        cleanup = this.cleanup.pop();\n        cleanup();\n      }\n      this.views = [];\n      while (this.tag && this.tag.firstChild) {\n        this.tag.removeChild(this.tag.firstChild);\n      }\n      if (this.subArgs) {\n        _Bindable.Bindable.clearBindings(this.subArgs);\n      }\n      _Bindable.Bindable.clearBindings(this.args);\n\n      // if(this.args.value && !this.args.value.isBound())\n      // {\n      // \tBindable.clearBindings(this.args.value);\n      // }\n\n      this.removed = true;\n    }\n  }]);\n  return ViewList;\n}();\nexports.ViewList = ViewList;\n  })();\n});","\nrequire.register(\"curvature/mixin/EventTargetMixin.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.EventTargetMixin = void 0;\nvar _Mixin = require(\"../base/Mixin\");\nvar _EventTargetMixin;\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e2) { throw _e2; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e3) { didErr = true; err = _e3; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _iterableToArrayLimit(arr, i) { var _i = null == arr ? null : \"undefined\" != typeof Symbol && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (null != _i) { var _s, _e, _x, _r, _arr = [], _n = !0, _d = !1; try { if (_x = (_i = _i.call(arr)).next, 0 === i) { if (Object(_i) !== _i) return; _n = !1; } else for (; !(_n = (_s = _x.call(_i)).done) && (_arr.push(_s.value), _arr.length !== i); _n = !0); } catch (err) { _d = !0, _e = err; } finally { try { if (!_n && null != _i.return && (_r = _i.return(), Object(_r) !== _r)) return; } finally { if (_d) throw _e; } } return _arr; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nvar EventTargetParent = Symbol('EventTargetParent');\nvar CallHandler = Symbol('CallHandler');\nvar Capture = Symbol('Capture');\nvar Bubble = Symbol('Bubble');\nvar Target = Symbol('Target');\nvar HandlersBubble = Symbol('HandlersBubble');\nvar HandlersCapture = Symbol('HandlersCapture');\nvar EventTargetMixin = (_EventTargetMixin = {}, _defineProperty(_EventTargetMixin, _Mixin.Mixin.Constructor, function () {\n  this[HandlersCapture] = new Map();\n  this[HandlersBubble] = new Map();\n}), _defineProperty(_EventTargetMixin, \"dispatchEvent\", function dispatchEvent() {\n  var _this = this;\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n  var event = args[0];\n  if (typeof event === 'string') {\n    event = new CustomEvent(event);\n    args[0] = event;\n  }\n  event.cvPath = event.cvPath || [];\n  event.cvTarget = event.cvCurrentTarget = this;\n  var result = this[Capture].apply(this, args);\n  if (event.cancelable && (result === false || event.cancelBubble)) {\n    return result;\n  }\n  var handlers = [];\n  if (this[HandlersCapture].has(event.type)) {\n    var handlerMap = this[HandlersCapture].get(event.type);\n    var newHandlers = _toConsumableArray(handlerMap);\n    newHandlers.forEach(function (h) {\n      return h.push(handlerMap);\n    });\n    handlers.push.apply(handlers, _toConsumableArray(newHandlers));\n  }\n  if (this[HandlersBubble].has(event.type)) {\n    var _handlerMap = this[HandlersBubble].get(event.type);\n    var _newHandlers = _toConsumableArray(_handlerMap);\n    _newHandlers.forEach(function (h) {\n      return h.push(_handlerMap);\n    });\n    handlers.push.apply(handlers, _toConsumableArray(_newHandlers));\n  }\n  handlers.push([function () {\n    return _this[CallHandler].apply(_this, args);\n  }, {}, null]);\n  for (var _i = 0, _handlers = handlers; _i < _handlers.length; _i++) {\n    var _handlers$_i = _slicedToArray(_handlers[_i], 3),\n      handler = _handlers$_i[0],\n      options = _handlers$_i[1],\n      map = _handlers$_i[2];\n    if (options.once) {\n      map.delete(handler);\n    }\n    result = handler(event);\n    if (event.cancelable && result === false) {\n      break;\n    }\n  }\n  if (!event.cancelable || !event.cancelBubble && result !== false) {\n    this[Bubble].apply(this, args);\n  }\n  if (!this[EventTargetParent]) {\n    Object.freeze(event.cvPath);\n  }\n  return event.returnValue;\n}), _defineProperty(_EventTargetMixin, \"addEventListener\", function addEventListener(type, callback) {\n  var _this2 = this;\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  if (options === true) {\n    options = {\n      useCapture: true\n    };\n  }\n  var handlers = HandlersBubble;\n  if (options.useCapture) {\n    handlers = HandlersCapture;\n  }\n  if (!this[handlers].has(type)) {\n    this[handlers].set(type, new Map());\n  }\n  this[handlers].get(type).set(callback, options);\n  if (options.signal) {\n    options.signal.addEventListener('abort', function (event) {\n      return _this2.removeEventListener(type, callback, options);\n    }, {\n      once: true\n    });\n  }\n}), _defineProperty(_EventTargetMixin, \"removeEventListener\", function removeEventListener(type, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  if (options === true) {\n    options = {\n      useCapture: true\n    };\n  }\n  var handlers = HandlersBubble;\n  if (options.useCapture) {\n    handlers = HandlersCapture;\n  }\n  if (!this[handlers].has(type)) {\n    return;\n  }\n  this[handlers].get(type).delete(callback);\n}), _defineProperty(_EventTargetMixin, Capture, function () {\n  var _this$EventTargetPare;\n  var event = arguments.length <= 0 ? undefined : arguments[0];\n  event.cvPath.push(this);\n  if (!this[EventTargetParent]) {\n    return;\n  }\n  var result = (_this$EventTargetPare = this[EventTargetParent])[Capture].apply(_this$EventTargetPare, arguments);\n  if (event.cancelable && (result === false || event.cancelBubble)) {\n    return;\n  }\n  if (!this[EventTargetParent][HandlersCapture].has(event.type)) {\n    return;\n  }\n  event.cvCurrentTarget = this[EventTargetParent];\n  var type = event.type;\n  var handlers = this[EventTargetParent][HandlersCapture].get(type);\n  var _iterator = _createForOfIteratorHelper(handlers),\n    _step;\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var _step$value = _slicedToArray(_step.value, 2),\n        handler = _step$value[0],\n        options = _step$value[1];\n      if (options.once) {\n        handlers.delete(handler);\n      }\n      result = handler(event);\n      if (event.cancelable && (result === false || event.cancelBubble)) {\n        break;\n      }\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n  return result;\n}), _defineProperty(_EventTargetMixin, Bubble, function () {\n  var _this$EventTargetPare3, _this$EventTargetPare4;\n  var event = arguments.length <= 0 ? undefined : arguments[0];\n  if (!event.bubbles || !this[EventTargetParent] || event.cancelBubble) {\n    return;\n  }\n  if (!this[EventTargetParent][HandlersBubble].has(event.type)) {\n    var _this$EventTargetPare2;\n    return (_this$EventTargetPare2 = this[EventTargetParent])[Bubble].apply(_this$EventTargetPare2, arguments);\n  }\n  var result;\n  event.cvCurrentTarget = this[EventTargetParent];\n  var type = event.type;\n  var handlers = this[EventTargetParent][HandlersBubble].get(event.type);\n  var _iterator2 = _createForOfIteratorHelper(handlers),\n    _step2;\n  try {\n    for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n      var _step2$value = _slicedToArray(_step2.value, 2),\n        handler = _step2$value[0],\n        options = _step2$value[1];\n      if (options.once) {\n        handlers.delete(handler);\n      }\n      result = handler(event);\n      if (event.cancelable && result === false) {\n        return result;\n      }\n    }\n  } catch (err) {\n    _iterator2.e(err);\n  } finally {\n    _iterator2.f();\n  }\n  result = (_this$EventTargetPare3 = this[EventTargetParent])[CallHandler].apply(_this$EventTargetPare3, arguments);\n  if (event.cancelable && (result === false || event.cancelBubble)) {\n    return result;\n  }\n  return (_this$EventTargetPare4 = this[EventTargetParent])[Bubble].apply(_this$EventTargetPare4, arguments);\n}), _defineProperty(_EventTargetMixin, CallHandler, function () {\n  var event = arguments.length <= 0 ? undefined : arguments[0];\n  if (event.defaultPrevented) {\n    return;\n  }\n  var defaultHandler = \"on\".concat(event.type[0].toUpperCase() + event.type.slice(1));\n  if (typeof this[defaultHandler] === 'function') {\n    return this[defaultHandler](event);\n  }\n}), _EventTargetMixin);\nexports.EventTargetMixin = EventTargetMixin;\nObject.defineProperty(EventTargetMixin, 'Parent', {\n  value: EventTargetParent\n});\n  })();\n});","\nrequire.register(\"curvature/mixin/PromiseMixin.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.PromiseMixin = void 0;\nvar _Mixin = require(\"../base/Mixin\");\nvar _PromiseMixin;\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar _Promise = Symbol('Promise');\nvar Accept = Symbol('Accept');\nvar Reject = Symbol('Reject');\nvar PromiseMixin = (_PromiseMixin = {}, _defineProperty(_PromiseMixin, _Mixin.Mixin.Constructor, function () {\n  var _this = this;\n  this[_Promise] = new Promise(function (accept, reject) {\n    _this[Accept] = accept;\n    _this[Reject] = reject;\n  });\n}), _defineProperty(_PromiseMixin, \"then\", function then() {\n  var _this$_Promise;\n  return (_this$_Promise = this[_Promise]).then.apply(_this$_Promise, arguments);\n}), _defineProperty(_PromiseMixin, \"catch\", function _catch() {\n  var _this$_Promise2;\n  return (_this$_Promise2 = this[_Promise]).catch.apply(_this$_Promise2, arguments);\n}), _defineProperty(_PromiseMixin, \"finally\", function _finally() {\n  var _this$_Promise3;\n  return (_this$_Promise3 = this[_Promise]).finally.apply(_this$_Promise3, arguments);\n}), _PromiseMixin);\nexports.PromiseMixin = PromiseMixin;\nObject.defineProperty(PromiseMixin, 'Reject', {\n  value: Reject\n});\nObject.defineProperty(PromiseMixin, 'Accept', {\n  value: Accept\n});\n  })();\n});","\nrequire.register(\"curvature/model/Database.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Database = void 0;\nvar _Bindable = require(\"../base/Bindable\");\nvar _Mixin = require(\"../base/Mixin\");\nvar _EventTargetMixin = require(\"../mixin/EventTargetMixin\");\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e2) { throw _e2; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e3) { didErr = true; err = _e3; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _iterableToArrayLimit(arr, i) { var _i = null == arr ? null : \"undefined\" != typeof Symbol && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (null != _i) { var _s, _e, _x, _r, _arr = [], _n = !0, _d = !1; try { if (_x = (_i = _i.call(arr)).next, 0 === i) { if (Object(_i) !== _i) return; _n = !1; } else for (; !(_n = (_s = _x.call(_i)).done) && (_arr.push(_s.value), _arr.length !== i); _n = !0); } catch (err) { _d = !0, _e = err; } finally { try { if (!_n && null != _i.return && (_r = _i.return(), Object(_r) !== _r)) return; } finally { if (_d) throw _e; } } return _arr; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nvar BeforeWrite = Symbol('BeforeWrite');\nvar AfterWrite = Symbol('AfterWrite');\nvar BeforeDelete = Symbol('BeforeDelete');\nvar AfterDelete = Symbol('AfterDelete');\nvar BeforeInsert = Symbol('BeforeInsert');\nvar AfterInsert = Symbol('AfterInsert');\nvar BeforeUpdate = Symbol('BeforeUpdate');\nvar AfterUpdate = Symbol('AfterUpdate');\nvar BeforeRead = Symbol('BeforeRead');\nvar AfterRead = Symbol('AfterRead');\nvar PrimaryKey = Symbol('PrimaryKey');\nvar Connection = Symbol('Connection');\nvar Instances = Symbol('Instances');\nvar HighWater = Symbol('HighWater');\nvar Metadata = Symbol('Metadata');\nvar Timers = Symbol('Timers');\nvar Target = Symbol('Target');\nvar Store = Symbol('Store');\nvar Fetch = Symbol('Each');\nvar Name = Symbol('Name');\nvar Bank = Symbol('Bank');\nvar Database = /*#__PURE__*/function (_Mixin$with) {\n  _inherits(Database, _Mixin$with);\n  var _super = _createSuper(Database);\n  function Database(connection) {\n    var _this;\n    _classCallCheck(this, Database);\n    _this = _super.call(this);\n    Object.defineProperty(_assertThisInitialized(_this), Connection, {\n      value: connection\n    });\n    Object.defineProperty(_assertThisInitialized(_this), Name, {\n      value: connection.name\n    });\n    Object.defineProperty(_assertThisInitialized(_this), Timers, {\n      value: {}\n    });\n    Object.defineProperty(_assertThisInitialized(_this), Metadata, {\n      value: {}\n    });\n    Object.defineProperty(_assertThisInitialized(_this), Bank, {\n      value: {}\n    });\n    return _this;\n  }\n  _createClass(Database, [{\n    key: \"select\",\n    value: function select(_ref) {\n      var _this2 = this;\n      var store = _ref.store,\n        index = _ref.index,\n        _ref$range = _ref.range,\n        range = _ref$range === void 0 ? undefined : _ref$range,\n        _ref$ranges = _ref.ranges,\n        ranges = _ref$ranges === void 0 ? [] : _ref$ranges,\n        _ref$direction = _ref.direction,\n        direction = _ref$direction === void 0 ? 'next' : _ref$direction,\n        _ref$limit = _ref.limit,\n        limit = _ref$limit === void 0 ? 0 : _ref$limit,\n        _ref$offset = _ref.offset,\n        offset = _ref$offset === void 0 ? 0 : _ref$offset,\n        _ref$type = _ref.type,\n        type = _ref$type === void 0 ? false : _ref$type,\n        _ref$origin = _ref.origin,\n        origin = _ref$origin === void 0 ? undefined : _ref$origin,\n        _ref$map = _ref.map,\n        map = _ref$map === void 0 ? undefined : _ref$map;\n      var transaction = this[Connection].transaction(store, \"readonly\");\n      var storeObject = transaction.objectStore(store);\n      var indexObject = index ? storeObject.index(index) : storeObject;\n      if (range !== undefined && (!ranges || !ranges.length)) {\n        ranges = [range];\n      }\n      var params = [type, indexObject, direction, ranges, limit, offset, origin, map];\n      var existing = null;\n      return {\n        finally: function _finally(c) {\n          return (existing || (existing = _this2[Fetch].apply(_this2, params)(function (e) {\n            return e;\n          }))).finally(c);\n        },\n        catch: function _catch(c) {\n          return (existing || (existing = _this2[Fetch].apply(_this2, params)(function (e) {\n            return e;\n          }))).catch(c);\n        },\n        then: function then(c) {\n          return (existing || (existing = _this2[Fetch].apply(_this2, params)(function (e) {\n            return e;\n          }))).then(c);\n        },\n        each: function each(c) {\n          return existing || (existing = _this2[Fetch].apply(_this2, params)(c));\n        },\n        one: function one(c) {\n          return existing || (existing = _this2[Fetch].apply(_this2, _toConsumableArray(Object.assign(params, [,,,, 1])))(c));\n        }\n      };\n    }\n  }, {\n    key: \"insert\",\n    value: function insert(storeName, records) {\n      var origin = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var inserts = this.inserts(_defineProperty({}, storeName, records), origin);\n      return inserts[0];\n    }\n  }, {\n    key: \"inserts\",\n    value: function inserts(storesToRecords) {\n      var _this3 = this;\n      var origin = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var storeNames = Object.keys(storesToRecords);\n      var transaction = this[Connection].transaction(storeNames, 'readwrite');\n      var inserts = [];\n      var _loop = function _loop() {\n        var _Object$entries$_i = _slicedToArray(_Object$entries[_i], 2),\n          storeName = _Object$entries$_i[0],\n          records = _Object$entries$_i[1];\n        var store = transaction.objectStore(storeName);\n        var bank = _this3[Bank][storeName] = _this3[Bank][storeName] || {};\n        var list = true;\n        if (!Array.isArray(records)) {\n          records = [records];\n          list = false;\n        }\n        var results = records.map(function (record) {\n          return new Promise(function (accept, reject) {\n            record = _Bindable.Bindable.make(record);\n            var detail = {\n              database: _this3,\n              record: record,\n              store: storeName,\n              type: 'write',\n              subType: 'insert',\n              origin: origin\n            };\n            detail.key = Database.getPrimaryKey(record);\n            var cancelable = true;\n            var writeEvent = new CustomEvent('write', {\n              cancelable: cancelable,\n              detail: detail\n            });\n            var eventResult = _this3.dispatchEvent(writeEvent);\n            if (!eventResult) {\n              transaction.abort && transaction.abort();\n              return;\n            }\n            var beforeWriteResult = record[Database.BeforeWrite] ? record[Database.BeforeWrite](detail) : null;\n            var beforeInsertResult = record[Database.BeforeInsert] ? record[Database.BeforeInsert](detail) : null;\n            var request = store.add(Object.assign({}, _Bindable.Bindable.shuck(record)));\n            if (beforeWriteResult === false || beforeInsertResult === false) {\n              transaction.abort && transaction.abort();\n              return;\n            }\n            request.onerror = function (error) {\n              _this3.dispatchEvent(new CustomEvent('writeError', {\n                detail: detail\n              }));\n              transaction.abort && transaction.abort();\n              reject(error);\n            };\n            request.onsuccess = function (event) {\n              var pk = event.target.result;\n              transaction.addEventListener('complete', function (event) {\n                if (store.autoIncrement) {\n                  record.id = pk;\n                }\n                record[Database.AfterInsert] && record[Database.AfterInsert](detail);\n                record[Database.AfterWrite] && record[Database.AfterWrite](detail);\n                bank[pk] = record;\n                record[PrimaryKey] = Symbol.for(pk);\n                accept(record);\n                if (!_this3[Metadata][storeName]) {\n                  _this3[Metadata][storeName] = _this3.getStoreMeta(storeName, 'store', {});\n                }\n                if (_this3[Metadata][storeName]) {\n                  var currentHighMark = _this3.checkHighWaterMark(storeName, record);\n                  var currentLowMark = _this3.checkLowWaterMark(storeName, record);\n                  var metadata = _this3[Metadata][storeName];\n                  var recordMark = record[metadata.highWater];\n                  if (origin.setHighWater && currentHighMark < recordMark) {\n                    _this3.setHighWaterMark(storeName, record, origin, 'insert');\n                  }\n                  if (origin.setLowWater && currentLowMark > recordMark) {\n                    _this3.setLowWaterMark(storeName, record, origin, 'insert');\n                  }\n                }\n              });\n            };\n          });\n        });\n        var finalResult;\n        if (list) {\n          finalResult = Promise.all(results);\n        } else {\n          finalResult = results[0];\n        }\n        inserts.push(finalResult);\n      };\n      for (var _i = 0, _Object$entries = Object.entries(storesToRecords); _i < _Object$entries.length; _i++) {\n        _loop();\n      }\n\n      // Promise.all(inserts).then(() => transaction.commit && transaction.commit());\n\n      return inserts;\n    }\n  }, {\n    key: \"update\",\n    value: function update(storeName, record) {\n      var origin = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var updates = this.updates(_defineProperty({}, storeName, [record]), origin);\n      return updates[0];\n    }\n  }, {\n    key: \"updates\",\n    value: function updates(storesToRecords) {\n      var _this4 = this;\n      var origin = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var storeNames = Object.keys(storesToRecords);\n      var transaction = this[Connection].transaction(storeNames, 'readwrite');\n      var updates = [];\n      var _loop2 = function _loop2() {\n        var _Object$entries2$_i = _slicedToArray(_Object$entries2[_i2], 2),\n          storeName = _Object$entries2$_i[0],\n          records = _Object$entries2$_i[1];\n        var store = transaction.objectStore(storeName);\n        var _iterator = _createForOfIteratorHelper(records),\n          _step;\n        try {\n          var _loop3 = function _loop3() {\n            var record = _step.value;\n            if (!record[PrimaryKey]) {\n              throw Error('Value provided is not a DB record!');\n            }\n            updates.push(new Promise(function (accept, reject) {\n              var detail = {\n                database: _this4,\n                key: Database.getPrimaryKey(record),\n                record: record,\n                store: storeName,\n                type: 'write',\n                subType: 'update',\n                origin: origin\n              };\n              var cancelable = true;\n              var writeEvent = new CustomEvent('write', {\n                cancelable: cancelable,\n                detail: detail\n              });\n              var eventResult = _this4.dispatchEvent(writeEvent);\n              if (!eventResult) {\n                transaction.abort && transaction.abort();\n                return;\n              }\n              var beforeWriteResult = record[Database.BeforeWrite] ? record[Database.BeforeWrite](detail) : null;\n              var beforeUpdateResult = record[Database.BeforeUpdate] ? record[Database.BeforeUpdate](detail) : null;\n              if (beforeWriteResult === false || beforeUpdateResult === false) {\n                transaction.abort && transaction.abort();\n                return;\n              }\n              var requestA = store.delete(record.id);\n              requestA.onerror = function (error) {\n                _this4.dispatchEvent(new CustomEvent('writeError', {\n                  detail: detail\n                }));\n                reject(error);\n              };\n              requestA.onsuccess = function (event) {\n                var requestB = store.put(Object.assign({}, _Bindable.Bindable.shuck(record)));\n                requestB.onerror = function (error) {\n                  _this4.dispatchEvent(new CustomEvent('writeError', {\n                    detail: detail\n                  }));\n                  reject(error);\n                };\n                requestB.onsuccess = function (event) {\n                  accept(writeEvent);\n                  transaction.oncomplete = function (event) {\n                    record[Database.AfterInsert] && record[Database.AfterInsert](detail);\n                    record[Database.AfterWrite] && record[Database.AfterWrite](detail);\n                    if (!_this4[Metadata][storeName]) {\n                      _this4[Metadata][storeName] = _this4.getStoreMeta(storeName, 'store', {});\n                    }\n                    if (_this4[Metadata][storeName]) {\n                      var currentHighMark = _this4.checkHighWaterMark(storeName, record);\n                      var currentLowMark = _this4.checkLowWaterMark(storeName, record);\n                      var metadata = _this4[Metadata][storeName];\n                      var recordMark = record[metadata.highWater];\n                      if (origin.setHighWater && currentHighMark < recordMark) {\n                        _this4.setHighWaterMark(storeName, record, origin, 'insert');\n                      }\n                      if (origin.setLowWater && currentLowMark > recordMark) {\n                        _this4.setLowWaterMark(storeName, record, origin, 'insert');\n                      }\n                    }\n                  };\n                };\n              };\n            }));\n          };\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            _loop3();\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n      };\n      for (var _i2 = 0, _Object$entries2 = Object.entries(storesToRecords); _i2 < _Object$entries2.length; _i2++) {\n        _loop2();\n      }\n      Promise.all(updates).then(function () {\n        return transaction.commit && transaction.commit();\n      });\n      return updates;\n    }\n  }, {\n    key: \"delete\",\n    value: function _delete(storeName, record) {\n      var origin = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var deletes = this.deletes(_defineProperty({}, storeName, [record]), origin);\n      return deletes[0];\n    }\n  }, {\n    key: \"deletes\",\n    value: function deletes(storesToRecords) {\n      var _this5 = this;\n      var origin = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var storeNames = Object.keys(storesToRecords);\n      var transaction = this[Connection].transaction(storeNames, 'readwrite');\n      var deletes = [];\n      var _loop4 = function _loop4() {\n        var _Object$entries3$_i = _slicedToArray(_Object$entries3[_i3], 2),\n          storeName = _Object$entries3$_i[0],\n          records = _Object$entries3$_i[1];\n        var store = transaction.objectStore(storeName);\n        var _iterator2 = _createForOfIteratorHelper(records),\n          _step2;\n        try {\n          var _loop5 = function _loop5() {\n            var record = _step2.value;\n            if (!record[PrimaryKey]) {\n              throw Error('Value provided is not a DB record!');\n            }\n            deletes.push(new Promise(function (accept, reject) {\n              var detail = {\n                database: _this5,\n                record: record,\n                key: Database.getPrimaryKey(record),\n                store: storeName,\n                type: 'write',\n                subType: 'delete',\n                origin: origin\n              };\n              var cancelable = true;\n              var writeEvent = new CustomEvent('write', {\n                cancelable: cancelable,\n                detail: detail\n              });\n              var eventResult = _this5.dispatchEvent(writeEvent);\n              if (!eventResult) {\n                transaction.abort && transaction.abort();\n                return;\n              }\n              var beforeDeleteResult = record[Database.BeforeDelete] ? record[Database.BeforeDelete](detail) : null;\n              if (beforeDeleteResult === false) {\n                transaction.abort && transaction.abort();\n                return;\n              }\n              var request = store.delete(record.id);\n              request.onerror = function (error) {\n                detail.original = error;\n                var deleteEvent = new CustomEvent('writeError', {\n                  detail: detail\n                });\n                _this5.dispatchEvent(deleteEvent);\n                reject(error);\n              };\n              request.onsuccess = function (event) {\n                accept(writeEvent);\n                transaction.oncomplete = function (event) {\n                  record[PrimaryKey] = undefined;\n                  record[Database.AfterDelete] && record[Database.AfterDelete](detail);\n                  detail.original = event;\n                };\n              };\n            }));\n          };\n          for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n            _loop5();\n          }\n        } catch (err) {\n          _iterator2.e(err);\n        } finally {\n          _iterator2.f();\n        }\n      };\n      for (var _i3 = 0, _Object$entries3 = Object.entries(storesToRecords); _i3 < _Object$entries3.length; _i3++) {\n        _loop4();\n      }\n      Promise.all(deletes).then(function () {\n        return transaction.commit && transaction.commit();\n      });\n      return deletes;\n    }\n  }, {\n    key: \"clear\",\n    value: function clear(storeName) {\n      var _this6 = this;\n      return new Promise(function (accept, reject) {\n        var trans = _this6[Connection].transaction([storeName], 'readwrite');\n        var store = trans.objectStore(storeName);\n        var request = store.clear();\n        var detail = {\n          database: _this6[Name],\n          store: storeName,\n          type: 'write',\n          subType: 'clear',\n          origin: origin\n        };\n        request.onerror = function (error) {\n          detail.original = error;\n          var deleteEvent = new CustomEvent('writeError', {\n            detail: detail\n          });\n          _this6.dispatchEvent(deleteEvent);\n          reject(error);\n        };\n        request.onsuccess = function (event) {\n          detail.original = event;\n          var writeEvent = new CustomEvent('write', {\n            detail: detail\n          });\n          _this6.dispatchEvent(writeEvent);\n          trans.commit && trans.commit();\n          accept(writeEvent);\n        };\n      });\n    }\n  }, {\n    key: \"listStores\",\n    value: function listStores() {\n      return _toConsumableArray(this[Connection].objectStoreNames);\n    }\n  }, {\n    key: \"listIndexes\",\n    value: function listIndexes(storeName) {\n      var trans = this[Connection].transaction([storeName]);\n      var store = trans.objectStore(storeName);\n      return _toConsumableArray(store.indexNames);\n    }\n  }, {\n    key: Fetch,\n    value: function value(type, index, direction, ranges, limit, offset, origin, map) {\n      var _this7 = this;\n      var processRange = function processRange(range, callback) {\n        return new Promise(function (accept, reject) {\n          if (range instanceof IDBKeyRange) {\n            // NOOP\n          } else if (!Array.isArray(range)) {\n            if (typeof range !== 'undefined' && range !== null) {\n              range = IDBKeyRange.only(range);\n            }\n          } else if (range.length === 0) {\n            range = undefined;\n          } else if (range.length === 1) {\n            range = IDBKeyRange.only(range[0]);\n          } else {\n            if (range[0] === undefined && range[1] === undefined) {\n              range = undefined;\n            } else if (range[0] === undefined) {\n              var _range$;\n              range = IDBKeyRange.upperBound(range[1], (_range$ = range[2]) !== null && _range$ !== void 0 ? _range$ : true);\n            } else if (range[1] === undefined) {\n              var _range$2;\n              range = IDBKeyRange.lowerBound(range[0], (_range$2 = range[2]) !== null && _range$2 !== void 0 ? _range$2 : false);\n            } else {\n              var _range$3, _range$4;\n              range = IDBKeyRange.bound(range[0], range[1], (_range$3 = range[2]) !== null && _range$3 !== void 0 ? _range$3 : false, (_range$4 = range[3]) !== null && _range$4 !== void 0 ? _range$4 : true);\n            }\n          }\n          var request = index.openCursor(range, direction);\n          var i = 0;\n          var resultHandler = function resultHandler(event) {\n            var cursor = event.target.result;\n            if (!cursor) {\n              return accept({\n                record: null,\n                result: null,\n                index: i\n              });\n            }\n            var source = cursor.source;\n            var storeName = source.objectStore ? source.objectStore.name : index.name;\n            _this7[Bank][storeName] = _this7[Bank][storeName] || {};\n            var bank = _this7[Bank][storeName];\n            var pk = cursor.primaryKey;\n            var value = type ? type.from(cursor.value) : cursor.value;\n            var bindableValue = _Bindable.Bindable.makeBindable(value);\n            var detail = {\n              database: _this7[Name],\n              key: Database.getPrimaryKey(bindableValue),\n              record: value,\n              store: index.name,\n              type: 'read',\n              subType: 'select',\n              origin: origin\n            };\n            var beforeReadResult = value[Database.BeforeRead] ? value[Database.BeforeRead](detail) : null;\n            if (offset > i++ || beforeReadResult === false) {\n              return cursor.continue();\n            }\n            if (bank[pk]) {\n              Object.assign(bank[pk], value);\n            } else {\n              value[PrimaryKey] = Symbol.for(pk);\n              bank[pk] = value;\n            }\n            detail.record = value;\n            bank[pk][Database.AfterRead] && bank[pk][Database.AfterRead](detail);\n            var cancelable = true;\n            var eventResult = _this7.dispatchEvent(new CustomEvent('read', {\n              detail: detail,\n              cancelable: cancelable\n            }));\n            if (eventResult) {\n              var record = type ? type.from(bank[pk]) : bank[pk];\n              record[PrimaryKey] = Symbol.for(pk);\n              var mapped = map ? map(record) : record;\n              var result = callback ? callback(mapped, i) : mapped;\n              if (limit && i - offset >= limit) {\n                offset += limit;\n                return accept({\n                  mapped: mapped,\n                  result: result,\n                  index: i\n                });\n              }\n            }\n            cursor.continue();\n          };\n          request.addEventListener('success', resultHandler);\n        });\n      };\n      var results = [];\n      ranges = ranges && ranges.length ? ranges.slice() : [[]];\n      var processResult = function processResult(result, callback) {\n        results.push(result);\n        if (ranges.length) {\n          return processRange(ranges.shift(), callback).then(function (result) {\n            return processResult(result, callback);\n          });\n        }\n        if (results.length === 1) {\n          return results[0];\n        }\n        return results;\n      };\n      return function (callback) {\n        return processRange(ranges.shift(), callback).then(function (result) {\n          return processResult(result, callback);\n        });\n      };\n    }\n  }, {\n    key: \"getObjectStores\",\n    value: function getObjectStores(storeName) {\n      return _toConsumableArray(this[Connection].objectStoreNames);\n    }\n  }, {\n    key: \"getStoreIndexes\",\n    value: function getStoreIndexes(storeName) {\n      var transaction = this[Connection].transaction([storeName], 'readonly');\n      var storeObject = transaction.objectStore(storeName);\n      var indexes = _toConsumableArray(storeObject.indexNames);\n      transaction.abort();\n      return indexes;\n    }\n  }, {\n    key: \"setStoreMeta\",\n    value: function setStoreMeta(storeName, key, value) {\n      localStorage.setItem(\"::::cvdb::\".concat(storeName, \"::\").concat(key), JSON.stringify(value));\n    }\n  }, {\n    key: \"getStoreMeta\",\n    value: function getStoreMeta(storeName, key) {\n      var notFound = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n      var source = localStorage.getItem(\"::::cvdb::\".concat(storeName, \"::\").concat(key));\n      var value = source !== null ? JSON.parse(source) : notFound;\n      if (value === null) {\n        return notFound;\n      }\n      return value;\n    }\n  }, {\n    key: \"createObjectStore\",\n    value: function createObjectStore(storeName, options) {\n      var store = this[Connection].createObjectStore(storeName, options);\n      this.setStoreMeta(storeName, 'store', options);\n      return store;\n    }\n  }, {\n    key: \"deleteObjectStore\",\n    value: function deleteObjectStore(storeName) {\n      return this[Connection].deleteObjectStore(storeName);\n    }\n  }, {\n    key: \"checkHighWaterMark\",\n    value: function checkHighWaterMark(storeName, record) {\n      var origin = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;\n      var currentMark = this.getStoreMeta(storeName, 'highWater', 0);\n      return currentMark;\n    }\n  }, {\n    key: \"setHighWaterMark\",\n    value: function setHighWaterMark(storeName, record) {\n      var origin = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;\n      var subType = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : undefined;\n      var metadata = this[Metadata][storeName];\n      var recordMark = record[metadata.highWater];\n      var currentMark = this.getStoreMeta(storeName, 'highWater', 0);\n      this.setStoreMeta(storeName, 'highWater', recordMark);\n      this.dispatchEvent(new CustomEvent('highWaterMoved', {\n        detail: {\n          database: this[Name],\n          record: record,\n          store: storeName,\n          type: 'highWaterMoved',\n          subType: subType,\n          origin: origin,\n          oldValue: currentMark,\n          value: recordMark\n        }\n      }));\n    }\n  }, {\n    key: \"checkLowWaterMark\",\n    value: function checkLowWaterMark(storeName, record) {\n      var origin = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;\n      var currentMark = this.getStoreMeta(storeName, 'lowWater', Infinity);\n      return currentMark;\n    }\n  }, {\n    key: \"setLowWaterMark\",\n    value: function setLowWaterMark(storeName, record) {\n      var origin = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;\n      var subType = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : undefined;\n      var metadata = this[Metadata][storeName];\n      var recordMark = record[metadata.highWater];\n      var currentMark = this.getStoreMeta(storeName, 'lowWater', null);\n      this.setStoreMeta(storeName, 'lowWater', recordMark);\n      this.dispatchEvent(new CustomEvent('lowWaterMoved', {\n        detail: {\n          database: this[Name],\n          record: record,\n          store: storeName,\n          type: 'lowWaterMoved',\n          subType: subType,\n          origin: origin,\n          oldValue: currentMark,\n          value: recordMark\n        }\n      }));\n    }\n  }], [{\n    key: \"open\",\n    value: function open(dbName) {\n      var _this8 = this;\n      var version = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      if (this[Instances][dbName]) {\n        return this[Instances][dbName];\n      }\n      return this[Instances][dbName] = new Promise(function (accept, reject) {\n        var request = indexedDB.open(dbName, version);\n        request.onerror = function (error) {\n          Database.dispatchEvent(new CustomEvent('error', {\n            detail: {\n              database: _this8[Name],\n              error: error,\n              store: undefined,\n              type: 'read',\n              subType: 'select'\n            }\n          }));\n          reject(error);\n        };\n        request.onsuccess = function (event) {\n          var instance = new _this8(event.target.result);\n          accept(instance);\n        };\n        request.onupgradeneeded = function (event) {\n          var connection = event.target.result;\n          connection.addEventListener('error', function (error) {\n            return console.error(error);\n          });\n          var instance = new _this8(connection);\n          for (var v = event.oldVersion + 1; v <= version; v += 1) {\n            instance['_version_' + v](connection, instance, event);\n          }\n        };\n      });\n    }\n  }, {\n    key: \"getPrimaryKey\",\n    value: function getPrimaryKey(record) {\n      return record[PrimaryKey] ? record[PrimaryKey] : null;\n    }\n  }, {\n    key: \"destroyDatabase\",\n    value: function destroyDatabase() {\n      var _this9 = this;\n      return new Promise(function (accept, reject) {\n        var request = indexedDB.delete(dbName);\n        request.onerror = function (error) {\n          Database.dispatchEvent(new CustomEvent('error', {\n            detail: {\n              database: dbName,\n              error: error,\n              type: 'destroy'\n            }\n          }));\n          reject(error);\n        };\n        request.onsuccess = function (event) {\n          delete _this9[Instances][dbName];\n          accept(dbName);\n        };\n      });\n    }\n  }]);\n  return Database;\n}(_Mixin.Mixin.with(_EventTargetMixin.EventTargetMixin));\nexports.Database = Database;\nObject.defineProperty(Database, Instances, {\n  value: []\n});\nObject.defineProperty(Database, 'BeforeDelete', {\n  value: BeforeDelete\n});\nObject.defineProperty(Database, 'AfterDelete', {\n  value: AfterDelete\n});\nObject.defineProperty(Database, 'BeforeWrite', {\n  value: BeforeWrite\n});\nObject.defineProperty(Database, 'AfterWrite', {\n  value: AfterWrite\n});\nObject.defineProperty(Database, 'BeforeInsert', {\n  value: BeforeInsert\n});\nObject.defineProperty(Database, 'AfterInsert', {\n  value: AfterInsert\n});\nObject.defineProperty(Database, 'BeforeUpdate', {\n  value: BeforeUpdate\n});\nObject.defineProperty(Database, 'AfterUpdate', {\n  value: AfterUpdate\n});\nObject.defineProperty(Database, 'BeforeRead', {\n  value: BeforeRead\n});\nObject.defineProperty(Database, 'AfterRead', {\n  value: AfterRead\n});\nObject.defineProperty(Database, 'PKSymbol', {\n  value: PrimaryKey\n});\nObject.defineProperty(Database, 'PrimaryKey', {\n  value: PrimaryKey\n});\ntry {\n  Object.defineProperty(Database, Target, {\n    value: new EventTarget()\n  });\n} catch (error) {\n  Object.defineProperty(Database, Target, {\n    value: document.createDocumentFragment()\n  });\n}\nvar _loop6 = function _loop6() {\n  var method = _arr2[_i4];\n  Object.defineProperty(Database, method, {\n    value: function value() {\n      var _Database$Target;\n      return (_Database$Target = Database[Target])[method].apply(_Database$Target, arguments);\n    }\n  });\n};\nfor (var _i4 = 0, _arr2 = ['addEventListener', 'removeEventListener', 'dispatchEvent']; _i4 < _arr2.length; _i4++) {\n  _loop6();\n}\n  })();\n});","\nrequire.register(\"curvature/model/Model.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Model = void 0;\nvar _Cache = require(\"../base/Cache\");\nvar _Bindable = require(\"../base/Bindable\");\nvar _Database = require(\"./Database\");\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar Changed = Symbol('Changed');\nvar Deleted = Symbol('Deleted');\nvar Saved = Symbol('Saved');\nvar Keys = Symbol('Keys');\nvar Model = /*#__PURE__*/function () {\n  function Model() {\n    _classCallCheck(this, Model);\n    _defineProperty(this, \"id\", void 0);\n    _defineProperty(this, \"class\", void 0);\n    Object.defineProperty(this, Changed, {\n      value: _Bindable.Bindable.make({})\n    });\n    Object.defineProperty(this, Deleted, {\n      writable: true,\n      value: false\n    });\n    Object.defineProperty(this, Saved, {\n      writable: true,\n      value: false\n    });\n    Object.defineProperty(this, Keys, {\n      writable: true,\n      value: new Set()\n    });\n    return _Bindable.Bindable.make(this);\n  }\n  _createClass(Model, [{\n    key: \"consume\",\n    value: function consume(skeleton) {\n      var _this = this;\n      var override = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var keyProps = Model.keyProps;\n      var setProp = function setProp(property, value) {\n        if (value && _typeof(value) === 'object' && value.constructor.keyProps) {\n          var subKeyProps = value.constructor.keyProps;\n          var propCacheKey = subKeyProps.map(function (prop) {\n            return value[prop];\n          }).join('::');\n          var bucket = 'models-by-type-and-publicId';\n          var propCached = _Cache.Cache.load(propCacheKey, false, bucket);\n          if (propCached) {\n            propCached.consume(value);\n            value = propCached;\n          }\n        }\n        if (!override && _this[Changed][property]) {\n          return;\n        }\n        _this[property] = value;\n      };\n      if (_Database.Database.PKSymbol in skeleton) {\n        setProp(_Database.Database.PKSymbol, skeleton[_Database.Database.PKSymbol]);\n      }\n      this[Keys] = new Set([].concat(_toConsumableArray(this[Keys]), _toConsumableArray(Object.keys(this)), _toConsumableArray(Object.keys(skeleton))));\n      var _iterator = _createForOfIteratorHelper(this[Keys]),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var property = _step.value;\n          if (!override && this[Changed][property]) {\n            continue;\n          }\n          if (keyProps.includes(property)) {\n            continue;\n          }\n          if (property in skeleton) {\n            setProp(property, skeleton[property]);\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n    }\n  }, {\n    key: \"changed\",\n    value: function changed() {\n      this[Saved] = false;\n    }\n  }, {\n    key: \"markDeleted\",\n    value: function markDeleted() {\n      for (var property in this[Changed]) {\n        this[Changed][property] = false;\n      }\n      this[Deleted] = true;\n      this[Saved] = false;\n    }\n  }, {\n    key: \"markStored\",\n    value: function markStored() {\n      for (var property in this) {\n        this[Changed][property] = false;\n      }\n      this[Deleted] = false;\n      this[Saved] = true;\n    }\n  }, {\n    key: \"isSaved\",\n    value: function isSaved() {\n      return this[Saved];\n    }\n  }], [{\n    key: \"keyProps\",\n    get: function get() {\n      return ['id', 'class'];\n    }\n  }, {\n    key: \"from\",\n    value: function from(skeleton) {\n      var isSaved = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var keyProps = this.keyProps;\n      var cacheProps = keyProps.map(function (prop) {\n        return skeleton[prop];\n      });\n      cacheProps.unshift(this.name);\n      var cacheKey = cacheProps.join('::');\n      var bucket = 'models-by-type-and-publicId';\n      var cached = _Cache.Cache.load(cacheKey, false, bucket);\n      var instance = cached ? cached : new this();\n      var _iterator2 = _createForOfIteratorHelper(keyProps),\n        _step2;\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var _ref, _instance$keyProp;\n          var keyProp = _step2.value;\n          instance[keyProp] = (_ref = (_instance$keyProp = instance[keyProp]) !== null && _instance$keyProp !== void 0 ? _instance$keyProp : skeleton[keyProp]) !== null && _ref !== void 0 ? _ref : null;\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n      instance.consume(skeleton);\n      if (!cached) {\n        _Cache.Cache.store(cacheKey, instance, 0, bucket);\n        var changed = false;\n        instance.bindTo(function (v, k, t, d) {\n          if (_typeof(k) === 'symbol') {\n            return;\n          }\n          if (v === t[k]) {\n            return;\n          }\n          instance[Changed][k] = changed;\n          instance[Saved] = !!(changed ? false : instance[Saved]);\n        });\n        if (Object.keys(instance[Changed]).length === 0) {\n          instance[Saved] = isSaved;\n        }\n        changed = true;\n      }\n      return instance;\n    }\n  }]);\n  return Model;\n}();\nexports.Model = Model;\nObject.defineProperty(Model, 'Changed', {\n  value: Changed\n});\nObject.defineProperty(Model, 'Deleted', {\n  value: Deleted\n});\nObject.defineProperty(Model, 'Saved', {\n  value: Saved\n});\n  })();\n});","\nrequire.register(\"curvature/net/Elicit.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"curvature\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Elicit = void 0;\nvar _Mixin = require(\"curvature/base/Mixin\");\nvar _EventTargetMixin = require(\"curvature/mixin/EventTargetMixin\");\nvar _PromiseMixin = require(\"curvature/mixin/PromiseMixin\");\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar IterateDownload = Symbol('IterateDownload');\nvar Retry = Symbol('Retry');\nvar HandleFirstByte = Symbol('HandleFirstByte');\nvar HandleProgress = Symbol('HandleProgress');\nvar HandleComplete = Symbol('HandleComplete');\nvar HandleHeaders = Symbol('HandleHeaders');\nvar HandleClose = Symbol('HandleClose');\nvar HandleError = Symbol('HandleError');\nvar HandleOpen = Symbol('HandleOpen');\nvar HandleFail = Symbol('HandleFail');\nvar FetchDeferrer = Symbol('FetchDeferrer');\nvar LastChunkSize = Symbol('LastChunkSize');\nvar LastChunkTime = Symbol('LastChunkTime');\nvar Options = Symbol('Options');\nvar Fetch = Symbol('Fetch');\nvar Type = Symbol('Type');\nvar Url = Symbol('Url');\nvar RetriesLeft = Symbol('RetriesLeft');\nvar TimeoutLeft = Symbol('TimeoutLeft');\nvar Timeout = Symbol('Timeout');\nvar Timer = Symbol('Timer');\nvar Canceller = Symbol('Canecller');\nvar Cancelled = Symbol('Caneclled');\nvar Paused = Symbol('Paused');\nvar Received = Symbol('Received');\nvar Length = Symbol('Length');\nvar Opened = Symbol('Opened');\nvar Closed = Symbol('Closed');\nvar Start = Symbol('Start');\nvar First = Symbol('First');\nvar End = Symbol('End');\nvar Elicit = /*#__PURE__*/function (_Mixin$with) {\n  _inherits(Elicit, _Mixin$with);\n  var _super = _createSuper(Elicit);\n  function Elicit(url) {\n    var _this2;\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    _classCallCheck(this, Elicit);\n    _this2 = _super.call(this);\n    _this2[RetriesLeft] = options.retries || 5;\n    _this2[Timeout] = options.timeout || 4500;\n    _this2[TimeoutLeft] = options.maxTimeout || _this2[Timeout] * _this2[RetriesLeft];\n    _this2[FetchDeferrer] = null;\n    _this2[LastChunkTime] = 0;\n    _this2[LastChunkSize] = 0;\n    _this2[Cancelled] = false;\n    _this2[Received] = 0;\n    _this2[Paused] = false;\n    _this2[Closed] = 0;\n    _this2[Options] = Object.assign({}, options);\n    _this2[Url] = url;\n    if (!options.defer) {\n      _this2.open();\n    } else {\n      _this2[Fetch] = new Promise(function (accept) {\n        return _this2[FetchDeferrer] = accept;\n      });\n    }\n    return _this2;\n  }\n  _createClass(Elicit, [{\n    key: \"open\",\n    value: function open() {\n      var _this3 = this;\n      if (this[Opened] && !this[Closed]) {\n        return;\n      }\n      if (!this[Start]) {\n        this[Start] = Date.now();\n      }\n      this[Canceller] = new AbortController();\n      this[Options].signal = this[Canceller].signal;\n      this[Opened] = Date.now();\n      this[Closed] = 0;\n      this[First] = 0;\n      this[Fetch] = fetch(this[Url], this[Options]).then(function (response) {\n        return _this3[HandleOpen](response);\n      }).catch(function (error) {\n        return _this3[HandleError](error);\n      });\n      var onTimeout = function onTimeout() {\n        if (!_this3[First]) {\n          _this3[Canceller].abort();\n          _this3[HandleClose]();\n          _this3[TimeoutLeft] = Math.max(0, _this3[TimeoutLeft] - _this3[Timeout]);\n          if (_this3[TimeoutLeft]) {\n            return;\n          }\n          _this3[HandleFail](new Error('Timed out.'));\n        }\n      };\n      this[Timer] = setTimeout(onTimeout, this[Timeout]);\n    }\n  }, {\n    key: \"headers\",\n    value: function headers() {\n      return this[Fetch].then(function (_ref) {\n        var response = _ref.response,\n          stream = _ref.stream;\n        return response.headers;\n      });\n    }\n  }, {\n    key: \"json\",\n    value: function json() {\n      return this[Fetch].then(function (_ref2) {\n        var response = _ref2.response,\n          stream = _ref2.stream;\n        var wrapped = new Response(stream, {\n          headers: {\n            'Content-Type': 'application/json'\n          }\n        });\n        return wrapped.json();\n      });\n    }\n  }, {\n    key: \"text\",\n    value: function text() {\n      var _this4 = this;\n      return this[Fetch].then(function (_ref3) {\n        var response = _ref3.response,\n          stream = _ref3.stream;\n        var wrapped = new Response(stream, {\n          headers: {\n            'Content-Type': _this4.type\n          }\n        });\n        return wrapped.text();\n      });\n    }\n  }, {\n    key: \"css\",\n    value: function css() {\n      return this.text().then(function (css) {\n        var sheet = new CSSStyleSheet();\n        sheet.replace(css);\n        return sheet;\n      });\n    }\n  }, {\n    key: \"blob\",\n    value: function blob() {\n      return this[Fetch].then(function (_ref4) {\n        var response = _ref4.response,\n          stream = _ref4.stream;\n        var wrapped = new Response(stream, {\n          headers: {\n            'Content-Type': response.headers.get('Content-Type')\n          }\n        });\n        return wrapped.blob();\n      });\n    }\n  }, {\n    key: \"objectUrl\",\n    value: function objectUrl() {\n      return this.blob().then(function (blob) {\n        return URL.createObjectURL(blob);\n      });\n    }\n  }, {\n    key: \"dataUri\",\n    value: function dataUri() {\n      return this.blob().then(function (blob) {\n        return new Promise(function (accept, reject) {\n          var reader = new FileReader();\n          reader.onload = function (event) {\n            return accept(reader.result);\n          };\n          reader.onerror = function (event) {\n            return reject(reader.error);\n          };\n          reader.onabort = function (event) {\n            return reject(new Error(\"Read aborted\"));\n          };\n          reader.readAsDataURL(blob);\n        });\n      });\n    }\n  }, {\n    key: \"buffer\",\n    value: function buffer() {\n      return this[Fetch].then(function (_ref5) {\n        var response = _ref5.response,\n          stream = _ref5.stream;\n        var wrapped = new Response(stream, {\n          headers: {\n            'Content-Type': response.headers.get('Content-Type')\n          }\n        });\n        return wrapped.arrayBuffer();\n      });\n    }\n  }, {\n    key: \"bytes\",\n    value: function bytes() {\n      return this.buffer().then(function (buffer) {\n        return new Uint8Array(buffer);\n      });\n    }\n  }, {\n    key: \"cancel\",\n    value: function cancel() {\n      if (!this.emitCancelEvent()) {\n        return;\n      }\n      this[Canceller].abort();\n      this[Cancelled] = true;\n      this.emitCancelledEvent();\n    }\n  }, {\n    key: \"pause\",\n    value: function pause() {\n      if (this[End] || this[Paused] || this[Closed]) {\n        return;\n      }\n      if (!this.emitPauseEvent()) {\n        return;\n      }\n      this[Paused] = true;\n      this.emitPausedEvent();\n    }\n  }, {\n    key: \"unpause\",\n    value: function unpause() {\n      if (this[End] || !this[Paused]) {\n        return;\n      }\n      if (!this.emitUnpauseEvent()) {\n        return;\n      }\n      this[Paused] = false;\n      this.emitUnpausedEvent();\n    }\n  }, {\n    key: \"done\",\n    get: function get() {\n      return !!this[End];\n    }\n  }, {\n    key: \"type\",\n    get: function get() {\n      return this[Type];\n    }\n  }, {\n    key: \"totalTime\",\n    get: function get() {\n      if (!this[End]) {\n        return Date.now() - this[Start];\n      }\n      return this[End] - this[Start];\n    }\n  }, {\n    key: \"waitTime\",\n    get: function get() {\n      if (!this[First]) {\n        return Date.now() - this[Opened];\n      }\n      return this[First] - this[Opened];\n    }\n  }, {\n    key: \"loadTime\",\n    get: function get() {\n      if (!this[Opened]) {\n        return 0;\n      }\n      if (!this[Closed]) {\n        return Date.now() - this[First];\n      }\n      return this[Closed] - this[First];\n    }\n  }, {\n    key: \"speed\",\n    get: function get() {\n      if (!this[Opened]) {\n        return 0;\n      }\n      var time;\n      if (this[End]) {\n        time = this[End] - this[LastChunkTime];\n      } else {\n        time = Date.now() - this[LastChunkTime];\n      }\n      if (!time) {\n        time = 0.01;\n      }\n      return this[LastChunkSize] / time;\n    }\n  }, {\n    key: \"received\",\n    get: function get() {\n      return this[Received];\n    }\n  }, {\n    key: \"length\",\n    get: function get() {\n      return this[Length];\n    }\n  }, {\n    key: \"isPaused\",\n    get: function get() {\n      return this[Paused];\n    }\n  }, {\n    key: IterateDownload,\n    value: function value(reader, controller, length) {\n      var _this5 = this;\n      this[HandleProgress](length, 0, null);\n      var lastTime = Date.now();\n      var lastSize = 1;\n      var handleChunk = function handleChunk(_ref6) {\n        var done = _ref6.done,\n          value = _ref6.value;\n        if (done) {\n          controller.close();\n          return _this5[HandleComplete]();\n        }\n        controller.enqueue(value);\n        _this5[Received] += value.length;\n        if (!_this5[First]) {\n          _this5[HandleFirstByte](value);\n        }\n        _this5[HandleProgress](length, _this5[Received], value);\n        _this5[LastChunkTime] = lastTime;\n        _this5[LastChunkSize] = lastSize;\n        lastTime = Date.now();\n        lastSize = value.length;\n        return iterate();\n      };\n      var iterate = function iterate() {\n        if (_this5[Cancelled]) {\n          return reader.cancel();\n        }\n        if (_this5[Paused]) {\n          return new Promise(function (accept) {\n            setTimeout(function () {\n              return accept(iterate());\n            }, 100);\n          });\n        }\n        return reader.read().then(function (chunk) {\n          return handleChunk(chunk);\n        }).catch(function (error) {\n          return _this5[HandleError](error);\n        });\n      };\n      return iterate();\n    }\n  }, {\n    key: Retry,\n    value: function value() {\n      if (!this.emitRetryEvent()) {\n        return;\n      }\n      if (this[RetriesLeft] <= 0) {\n        return;\n      }\n      this[Canceller].abort();\n      this[HandleClose]();\n      this[Received] = 0;\n      this[RetriesLeft]--;\n      return this.open();\n    }\n  }, {\n    key: HandleOpen,\n    value: function value(response) {\n      var reader = response.body.getReader();\n      var length = this[Length] || Number(response.headers.get('Content-Length'));\n      var type = this[type] || response.headers.get('Content-Type');\n      this[Length] = length;\n      this[Type] = type;\n      this[HandleHeaders](response.headers);\n      if (this[FetchDeferrer]) {\n        this[FetchDeferrer](this[Fetch]);\n      }\n      var _this = this;\n      var stream = new ReadableStream({\n        start: function start(controller) {\n          _this[IterateDownload](reader, controller, length);\n        }\n      });\n      return {\n        response: response,\n        stream: stream\n      };\n    }\n  }, {\n    key: HandleClose,\n    value: function value() {\n      this[Closed] = Date.now();\n      this.emitCloseEvent();\n    }\n  }, {\n    key: HandleHeaders,\n    value: function value(headers) {\n      this.emitHeadersEvent(headers);\n    }\n  }, {\n    key: HandleProgress,\n    value: function value(length, received, _value) {\n      this.emitProgressEvent(length, received, _value);\n    }\n  }, {\n    key: HandleComplete,\n    value: function value() {\n      this[End] = Date.now();\n      this[HandleClose]();\n      this.emitCompleteEvent();\n      this[_PromiseMixin.PromiseMixin.Accept]();\n    }\n  }, {\n    key: HandleError,\n    value: function value(error) {\n      console.warn(\"[\".concat(error.constructor.name, \"] \").concat(error.code, \": \").concat(error.message), error);\n      if (!this.emitErrorEvent(error)) {\n        return this[Retry]();\n      }\n      return this[HandleFail](error);\n    }\n  }, {\n    key: HandleFail,\n    value: function value(error) {\n      this[End] = Date.now();\n      this[HandleClose]();\n      this.emitFailEvent(error);\n      return this[_PromiseMixin.PromiseMixin.Reject](error);\n    }\n  }, {\n    key: HandleFirstByte,\n    value: function value(received) {\n      clearInterval(this[Timer]);\n      this[First] = Date.now();\n      this.emitFirstByteEvent(received);\n    }\n  }, {\n    key: \"emitProgressEvent\",\n    value: function emitProgressEvent(length, received, value) {\n      var done = length ? received / length : 0;\n      var totalTime = this.totalTime;\n      var loadTime = this.loadTime;\n      var waitTime = this.waitTime;\n      var speed = this.speed;\n      return this.dispatchEvent(new CustomEvent('progress', {\n        detail: {\n          length: length,\n          received: received,\n          done: done,\n          speed: speed,\n          loadTime: loadTime,\n          waitTime: waitTime,\n          totalTime: totalTime,\n          value: value\n        }\n      }));\n    }\n  }, {\n    key: \"emitOpenEvent\",\n    value: function emitOpenEvent() {\n      return this.dispatchEvent(new CustomEvent('open'));\n    }\n  }, {\n    key: \"emitCloseEvent\",\n    value: function emitCloseEvent() {\n      return this.dispatchEvent(new CustomEvent('close'));\n    }\n  }, {\n    key: \"emitFirstByteEvent\",\n    value: function emitFirstByteEvent(received) {\n      return this.dispatchEvent(new CustomEvent('firstByte', {\n        detail: {\n          received: received\n        }\n      }));\n    }\n  }, {\n    key: \"emitHeadersEvent\",\n    value: function emitHeadersEvent(headers) {\n      return this.dispatchEvent(new CustomEvent('headers', {\n        detail: {\n          headers: headers\n        }\n      }));\n    }\n  }, {\n    key: \"emitCompleteEvent\",\n    value: function emitCompleteEvent() {\n      return this.dispatchEvent(new CustomEvent('complete'));\n    }\n  }, {\n    key: \"emitErrorEvent\",\n    value: function emitErrorEvent() {\n      return this.dispatchEvent(new CustomEvent('error', {\n        cancelable: this[RetriesLeft] > 0\n      }));\n    }\n  }, {\n    key: \"emitRetryEvent\",\n    value: function emitRetryEvent() {\n      return this.dispatchEvent(new CustomEvent('retry', {\n        cancelable: true\n      }));\n    }\n  }, {\n    key: \"emitFailEvent\",\n    value: function emitFailEvent() {\n      return this.dispatchEvent(new CustomEvent('fail'));\n    }\n  }, {\n    key: \"emitPauseEvent\",\n    value: function emitPauseEvent() {\n      return this.dispatchEvent(new CustomEvent('pause', {\n        cancelable: true\n      }));\n    }\n  }, {\n    key: \"emitPausedEvent\",\n    value: function emitPausedEvent() {\n      this.dispatchEvent(new CustomEvent('paused'));\n    }\n  }, {\n    key: \"emitUnpauseEvent\",\n    value: function emitUnpauseEvent() {\n      return this.dispatchEvent(new CustomEvent('unpause', {\n        cancelable: true\n      }));\n    }\n  }, {\n    key: \"emitUnpausedEvent\",\n    value: function emitUnpausedEvent() {\n      this.dispatchEvent(new CustomEvent('unpaused'));\n    }\n  }, {\n    key: \"emitCancelEvent\",\n    value: function emitCancelEvent() {\n      return this.dispatchEvent(new CustomEvent('cancel', {\n        cancelable: true\n      }));\n    }\n  }, {\n    key: \"emitCancelledEvent\",\n    value: function emitCancelledEvent() {\n      return this.dispatchEvent(new CustomEvent('cancelled'));\n    }\n  }], [{\n    key: \"pool\",\n    value: function pool(elicit) {\n      var _this6 = this;\n      var maxPool = 5;\n      elicit.finally(function () {\n        _this6.running.delete(elicit);\n        if (!_this6.backlog.length) {\n          return;\n        }\n        var next = _this6.backlog.shift();\n        _this6.running.add(next);\n        next.open();\n      });\n      if (this.running.size < maxPool) {\n        this.running.add(elicit);\n        elicit.open();\n      } else {\n        this.backlog.push(elicit);\n      }\n    }\n  }]);\n  return Elicit;\n}(_Mixin.Mixin.with(_EventTargetMixin.EventTargetMixin, _PromiseMixin.PromiseMixin)); // elicit.addEventListener('open', event => console.log(event));\n// elicit.addEventListener('close', event => console.log(event));\n// elicit.addEventListener('firstByte', event => console.log(event));\n// elicit.addEventListener('headers', event => console.log(event));\n// elicit.addEventListener('complete', event => console.log(event));\n// elicit.addEventListener('error', event => console.log(event));\n// elicit.addEventListener('fail', event => console.log(event));\n// elicit.addEventListener('pause', event => console.log(event));\n// elicit.addEventListener('paused', event => console.log(event));\n// elicit.addEventListener('unpause', event => console.log(event));\n// elicit.addEventListener('unpaused', event => console.log(event));\n// elicit.addEventListener('cancelled', event => console.log(event));\n// elicit.addEventListener('cancel', event => console.log(event));\nexports.Elicit = Elicit;\n_defineProperty(Elicit, \"backlog\", []);\n_defineProperty(Elicit, \"running\", new Set());\n  })();\n});","\nrequire.register(\"pokemon-parser/BitArray.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"pokemon-parser\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.BitArray = void 0;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar BitArray = /*#__PURE__*/function () {\n  function BitArray() {\n    var buffer = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : undefined;\n\n    _classCallCheck(this, BitArray);\n\n    if (buffer === undefined) {\n      buffer = [];\n    }\n\n    if (typeof buffer === 'number') {\n      buffer = Array.from(Array(buffer));\n    }\n\n    if (Array.isArray(buffer)) {\n      buffer = new Uint8Array(buffer);\n    }\n\n    if (buffer instanceof BitArray) {\n      buffer = buffer.buffer;\n    }\n\n    this.buffer = buffer;\n    this.done = false;\n    this.i = this.j = 0;\n  }\n\n  _createClass(BitArray, [{\n    key: \"clone\",\n    value: function clone() {\n      return new this.constructor(this);\n    }\n  }, {\n    key: \"get\",\n    value: function get(address) {\n      var byteAddress = Math.floor(address / 8);\n      var bitOffset = address % 8;\n      var getMask = 0x1 << bitOffset; // console.log(getMask.toString(2), this.buffer[ byteAddress ].toString(2));\n\n      return (getMask & this.buffer[byteAddress]) >> bitOffset;\n    } // read()\n    // {\n    // \tyield 0;\n    // \tyield 1;\n    // \tyield 2;\n    // \tyield 3;\n    // }\n\n  }, {\n    key: \"set\",\n    value: function set(address, value) {\n      var byteAddress = Math.floor(address / 8);\n      var bitOffset = address % 8;\n      var setMask = value ? 0x1 << bitOffset : ~(0x1 << bitOffset);\n\n      if (value) {\n        this.buffer[byteAddress] |= setMask;\n      } else {\n        this.buffer[byteAddress] &= setMask;\n      }\n    }\n  }, {\n    key: \"next\",\n    value: function next() {\n      var x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n      var result = 0;\n      var count = x;\n      var _byte = this.buffer[this.i];\n\n      while (x-- > 0) {\n        var bit = _byte >> 7 - this.j & 0x1;\n        this.j++;\n\n        if (this.j > 7) {\n          this.j = 0;\n          _byte = this.buffer[++this.i];\n        }\n\n        if (this.i >= this.buffer.length) {\n          this.done = true;\n        }\n\n        result <<= 1;\n        result |= bit;\n      }\n\n      return result;\n    }\n  }, {\n    key: \"length\",\n    get: function get() {\n      return this.buffer.length * 8;\n    }\n  }]);\n\n  return BitArray;\n}();\n\nexports.BitArray = BitArray;\n  })();\n});","\nrequire.register(\"pokemon-parser/PokemonRom.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"pokemon-parser\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.PokemonRom = void 0;\n\nvar _BitArray = require(\"./BitArray\");\n\nvar _Rom2 = require(\"./gameboy/Rom\");\n\nvar _Gameboy2bpp = require(\"./decompress/Gameboy2bpp\");\n\nvar _RleDelta = require(\"./decompress/RleDelta\");\n\nvar _Merge = require(\"./decompress/Merge\");\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e2) { throw _e2; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e3) { didErr = true; err = _e3; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar PokemonRom = /*#__PURE__*/function (_Rom) {\n  _inherits(PokemonRom, _Rom);\n\n  var _super = _createSuper(PokemonRom);\n\n  function PokemonRom(filename) {\n    var _this;\n\n    _classCallCheck(this, PokemonRom);\n\n    _this = _super.call(this, filename);\n    _this.textCodes = {\n      0x4F: '  ',\n      0x57: '#',\n      0x51: '*',\n      0x52: 'A1',\n      0x53: 'A2',\n      0x54: 'POK',\n      0x55: '+',\n      0x58: '$',\n      0x75: '',\n      0x7F: ' ',\n      0x80: 'A',\n      0x81: 'B',\n      0x82: 'C',\n      0x83: 'D',\n      0x84: 'E',\n      0x85: 'F',\n      0x86: 'G',\n      0x87: 'H',\n      0x88: 'I',\n      0x89: 'J',\n      0x8A: 'K',\n      0x8B: 'L',\n      0x8C: 'M',\n      0x8D: 'N',\n      0x8E: 'O',\n      0x8F: 'P',\n      0x90: 'Q',\n      0x91: 'R',\n      0x92: 'S',\n      0x93: 'T',\n      0x94: 'U',\n      0x95: 'V',\n      0x96: 'W',\n      0x97: 'X',\n      0x98: 'Y',\n      0x99: 'Z',\n      0x9A: '(',\n      0x9B: ')',\n      0x9C: ':',\n      0x9D: ';',\n      0x9E: '[',\n      0x9F: ']',\n      0xA0: 'a',\n      0xA1: 'b',\n      0xA2: 'c',\n      0xA3: 'd',\n      0xA4: 'e',\n      0xA5: 'f',\n      0xA6: 'g',\n      0xA7: 'h',\n      0xA8: 'i',\n      0xA9: 'j',\n      0xAA: 'k',\n      0xAB: 'l',\n      0xAC: 'm',\n      0xAD: 'n',\n      0xAE: 'o',\n      0xAF: 'p',\n      0xB0: 'q',\n      0xB1: 'r',\n      0xB2: 's',\n      0xB3: 't',\n      0xB4: 'u',\n      0xB5: 'v',\n      0xB6: 'w',\n      0xB7: 'x',\n      0xB8: 'y',\n      0xB9: 'z',\n      0xBA: '',\n      0xBB: '\\'d',\n      0xBC: '\\'l',\n      0xBD: '\\'s',\n      0xBE: '\\'t',\n      0xBF: '\\'v',\n      0xE0: '\\'',\n      0xE1: 'PK',\n      0xE2: 'MN',\n      0xE3: '-',\n      0xE4: '\\'r',\n      0xE5: '\\'m',\n      0xE6: '?',\n      0xE7: '!',\n      0xE8: '.',\n      0xED: '',\n      0xEE: '',\n      0xEF: '',\n      0xF0: '',\n      0xF1: '',\n      0xF3: '/',\n      0xF4: ',',\n      0xF5: '',\n      0xF6: '0',\n      0xF7: '1',\n      0xF8: '2',\n      0xF9: '3',\n      0xFA: '4',\n      0xFB: '5',\n      0xFC: '6',\n      0xFD: '7',\n      0xFE: '8',\n      0xFF: '9'\n    };\n    return _this;\n  }\n\n  _createClass(PokemonRom, [{\n    key: \"decodeText\",\n    value: function decodeText(buffer) {\n      var text = '';\n\n      for (var i = 0; i < buffer.length; i++) {\n        if (buffer[i] in this.textCodes) {\n          text += this.textCodes[buffer[i]];\n        } else {\n          text += ' ';\n        }\n      }\n\n      return text.trim();\n    }\n  }, {\n    key: \"getAllTypes\",\n    value: function getAllTypes() {\n      var _this2 = this;\n\n      return this.types = this.types || this.piece(0x27DE4, 0x27E49).then(function (buffer) {\n        return _this2.decodeText(buffer).split(' ');\n      });\n    }\n  }, {\n    key: \"getAllMoves\",\n    value: function getAllMoves() {\n      var _this3 = this;\n\n      return this.moves = this.moves || this.piece(0xB0000, 0xB060E).then(function (buffer) {\n        var nameBytes = [];\n        var nameList = [];\n\n        for (var i in buffer) {\n          var _byte = buffer[i];\n\n          if (_byte === 80) {\n            var _name = _this3.decodeText(nameBytes.splice(0));\n\n            nameList.push(_name);\n            continue;\n          }\n\n          nameBytes.push(buffer[i]);\n        }\n\n        var name = _this3.decodeText(nameBytes.splice(0));\n\n        nameList.push(name);\n        return nameList;\n      });\n    }\n  }, {\n    key: \"getAllNumbers\",\n    value: function getAllNumbers() {\n      return this.numbers = this.numbers = this.slice(0x41024, 190);\n    }\n  }, {\n    key: \"getAllIndexNumbers\",\n    value: function getAllIndexNumbers() {\n      var _this4 = this;\n\n      if (!this.indexNumbers) {\n        this.indexNumbers = [];\n      } else {\n        return this.indexNumbers;\n      }\n\n      return this.getAllNumbers().then(function (numbers) {\n        for (var i in numbers) {\n          _this4.indexNumbers[numbers[i]] = i;\n        }\n\n        return _this4.indexNumbers;\n      });\n    }\n  }, {\n    key: \"getSprites\",\n    value: function getSprites() {\n      var getChunks = [this.piece(0x10000, 0x11380), this.piece(0x14000, 0x17840), this.piece(0x17CBD, 0x17D7D), this.piece(0xEA9E, 0xEE9E), this.piece(0x781FE, 0x78D3E)];\n      return Promise.all(getChunks).then(function (chunks) {\n        return chunks.map(function (chunk) {\n          var sprites = new Uint8Array(chunk.length * 32);\n          var decoder = new _Gameboy2bpp.Gameboy2bpp(chunk, sprites, 16);\n\n          while (decoder.next()) {}\n\n          return sprites;\n        });\n      });\n    }\n  }, {\n    key: \"getBlockFromSet\",\n    value: function getBlockFromSet(address, blockId) {\n      return this.buffer.slice(address + (0 + blockId) * 16, address + (1 + blockId) * 16);\n    }\n  }, {\n    key: \"getAllTilesets\",\n    value: function getAllTilesets() {\n      var _this5 = this;\n\n      return this.piece(0xC7BE, 0xC8DE).then(function (headers) {\n        var tilesets = [];\n\n        for (var c = 0; c < 24; c++) {\n          var header = headers.slice((0 + c) * 12, (1 + c) * 12);\n          var bank = header[0];\n\n          var blockPointer = _this5.makeRef(bank, header.slice(1, 3));\n\n          var tilePointer = _this5.makeRef(bank, header.slice(3, 5));\n\n          var collisionPointer = _this5.makeRef(0, header.slice(5, 7));\n\n          var talkTiles = header.slice(7, 10);\n          var grass = header[10];\n          var animation = header[11];\n          tilesets.push({\n            tilePointer: tilePointer,\n            blockPointer: blockPointer,\n            collisionPointer: collisionPointer,\n            grass: grass,\n            animation: animation\n          });\n        }\n\n        return tilesets;\n      }); // 0x64000 - 0x67FFF\n      // 0x68000 - 0x6AFF8\n      // 0x6B5E8 - 0x6BFFF\n      // 0x6C000 - 0x6EB0B\n    }\n  }, {\n    key: \"getAllMaps\",\n    value: function getAllMaps() {\n      var _this6 = this;\n\n      var pieces = [this.piece(0x01AE, 0x039E), this.piece(0xC23D, 0xC335)];\n      return Promise.all(pieces).then(function (_ref) {\n        var _ref2 = _slicedToArray(_ref, 2),\n            offsets = _ref2[0],\n            banks = _ref2[1];\n\n        var mapPointers = [];\n\n        for (var i in banks) {\n          var bank = banks[i];\n          var offset = offsets.slice(i * 2, i * 2 + 2);\n\n          var pointer = _this6.makeRef(bank, offset);\n\n          mapPointers.push([bank, pointer, i]);\n        }\n\n        var maps = [];\n\n        for (var _i2 = 0, _mapPointers = mapPointers; _i2 < _mapPointers.length; _i2++) {\n          var _mapPointers$_i = _slicedToArray(_mapPointers[_i2], 3),\n              _bank = _mapPointers$_i[0],\n              mapPointer = _mapPointers$_i[1],\n              mapId = _mapPointers$_i[2];\n\n          var tilesetId = _this6.buffer[0 + mapPointer];\n          var height = _this6.buffer[1 + mapPointer];\n          var width = _this6.buffer[2 + mapPointer];\n\n          var tilePointer = _this6.makeRef(_bank, _this6.buffer.slice(3 + mapPointer, 5 + mapPointer));\n\n          var textPointers = _this6.buffer.slice(5 + mapPointer, 7 + mapPointer);\n\n          var scriptPointer = _this6.buffer.slice(7 + mapPointer, 9 + mapPointer);\n\n          var connectionByte = _this6.buffer[9 + mapPointer];\n          var east = connectionByte & 1 << 0;\n          var west = connectionByte & 1 << 1;\n          var south = connectionByte & 1 << 2;\n          var north = connectionByte & 1 << 3;\n          var activeConnections = [north, south, west, east].filter(function (x) {\n            return x;\n          }).length;\n          var objectPointer = _this6.buffer[10 + 11 * activeConnections + mapPointer];\n          var connections = [];\n\n          for (var c = 0; c < activeConnections; c++) {\n            var connection = _this6.buffer.slice((0 + c) * 11 + mapPointer, (1 + c) * 11 + mapPointer);\n\n            connections.push(connection);\n          }\n\n          var blockIds = _this6.deref(tilePointer, null, width * height);\n\n          maps.push({\n            id: Number(mapId),\n            tilesetId: tilesetId,\n            tileset: null,\n            height: height,\n            width: width,\n            bank: _bank,\n            tilePointer: tilePointer // , collision\n            ,\n            textPointers: textPointers,\n            scriptPointer: scriptPointer,\n            connectionByte: connectionByte,\n            north: north,\n            south: south,\n            west: west,\n            east: east,\n            objectPointer: objectPointer,\n            blockIds: blockIds\n          });\n        }\n\n        return Promise.all([maps, _this6.getAllTilesets()]);\n      }).then(function (_ref3) {\n        var _ref4 = _slicedToArray(_ref3, 2),\n            maps = _ref4[0],\n            tilesets = _ref4[1];\n\n        var _iterator = _createForOfIteratorHelper(maps),\n            _step;\n\n        try {\n          var _loop = function _loop() {\n            var map = _step.value;\n            var tileset = map.tileset = tilesets[map.tilesetId];\n\n            if (!tileset) {\n              return \"continue\";\n            }\n\n            console.log(tileset.collisionPointer);\n\n            var collision = _this6.deref(tileset.collisionPointer, 0xFF);\n\n            map.collision = Object.values(collision);\n            var blocks = {};\n            var tiles = {};\n\n            if (!map.tileset) {\n              return \"continue\";\n            }\n\n            var tilePlane = new Uint8Array(map.width * map.height * 4 * 4);\n            var solidPlane = new Uint8Array(map.width * map.height * 4 * 4);\n\n            for (var blockIndex in map.blockIds) {\n              var blockId = map.blockIds[blockIndex];\n              var blockOffset = map.tileset.blockPointer + blockId * 16; // if(blocks[blockId])\n              // {\n              // \tcontinue;\n              // }\n\n              var block = _this6.buffer.slice(0 + blockOffset, 16 + blockOffset);\n\n              blocks[blockId] = block;\n\n              for (var tileIndex in block) {\n                var tileId = block[tileIndex];\n                var tileOffset = map.tileset.tilePointer + tileId * 16;\n\n                var tile = _this6.buffer.slice(0 + tileOffset, 16 + tileOffset);\n\n                tiles[tileId] = tile;\n                var xBlockOffset = blockIndex % map.width;\n                var yBlockOffset = Math.floor(blockIndex / map.width);\n                var xTileOffset = tileIndex % 4;\n                var yTileOffset = Math.floor(tileIndex / 4); // const tilePlaneIndex = (xBlockOffset * 4 + xTileOffset)\n                // + (yBlockOffset * 4 + yTileOffset * map.width * 4);\n\n                var xPlaneOffset = xTileOffset + xBlockOffset * 4;\n                var yPlaneOffset = yTileOffset + yBlockOffset * 4;\n                var tilePlaneIndex = xPlaneOffset + yPlaneOffset * map.width * 4;\n                tilePlane[tilePlaneIndex] = 1 + tileId;\n                solidPlane[tilePlaneIndex] = !map.collision.includes(tileId);\n              }\n            }\n\n            map.tilePlane = tilePlane;\n            map.solidPlane = solidPlane; // map.collision = collision;\n\n            console.log(map);\n\n            if (!tiles) {\n              return {\n                v: void 0\n              };\n            }\n\n            var pallet = [255, 128, 196, 64];\n            var ansi = [function (x) {\n              return \"\\x1B[48;2;255;255;255m\\x1B[38;2;192;192;192m\".concat(x, \"\\x1B[0m\");\n            }, function (x) {\n              return \"\\x1B[48;2;128;128;128m\\x1B[38;2;64;64;64m\".concat(x, \"\\x1B[0m\");\n            }, function (x) {\n              return \"\\x1B[48;2;196;196;196m\\x1B[38;2;128;128;128m\".concat(x, \"\\x1B[0m\");\n            }, function (x) {\n              return \"\\x1B[48;2;64;64;64m\\x1B[38;2;32;32;32m\".concat(x, \"\\x1B[0m\");\n            }]; // console.log(map);\n\n            var renderedTiles = {};\n            Object.keys(tiles).forEach(function (tileIndex) {\n              var tile = tiles[tileIndex]; // console.log(tile, tileIndex);\n\n              var bitPairs = [];\n              var i = 0;\n\n              while (i < 16) {\n                var byteA = tile[i++];\n                var byteB = tile[i++];\n                var colors = [((byteA & 128) << 1 | byteB & 128) >> 7, ((byteA & 64) << 1 | byteB & 64) >> 6, ((byteA & 32) << 1 | byteB & 32) >> 5, ((byteA & 16) << 1 | byteB & 16) >> 4, ((byteA & 8) << 1 | byteB & 8) >> 3, ((byteA & 4) << 1 | byteB & 4) >> 2, ((byteA & 2) << 1 | byteB & 2) >> 1, ((byteA & 1) << 1 | byteB & 1) >> 0];\n                bitPairs.push.apply(bitPairs, colors);\n              } // console.log([...tile].map(b => b.toString(16).padStart(2,'0')).join(' '));\n              // console.log(`Map id: ${map.id}, Tile Index ${tileIndex}:`);\n              // for(const i in bitPairs)\n              // {\n              // \tconst bp = bitPairs[i];\n              // \tprocess.stdout.write( ansi[bp]('  ') )\n              // \tif(i % 8 === 7)\n              // \t{\n              // \t\tprocess.stdout.write( `\\n` );\n              // \t}\n              // }\n              // process.stdout.write( `\\n` );\n\n\n              renderedTiles[tileIndex] = bitPairs;\n            });\n            map.renderedTiles = renderedTiles;\n            var renderedBlocks = {};\n\n            for (var _blockId in blocks) {\n              var _ref5;\n\n              if (renderedBlocks[_blockId]) {\n                continue;\n              }\n\n              var _block = blocks[_blockId]; // const lines = Array(32).fill().map(l => Array(32).fill(0));\n\n              var bytes = Array(32).fill().map(function (l) {\n                return Array(32).fill(0);\n              });\n\n              for (var _tileIndex in _block) {\n                var _tileId = _block[_tileIndex];\n                var _tile = renderedTiles[_tileId];\n\n                if (!_tile) {\n                  // console.log({tileIndex, tileId});\n                  continue;\n                }\n\n                var tileX = 8 * (_tileIndex % 4);\n                var tileY = 8 * Math.floor(_tileIndex / 4);\n\n                for (var i = 0; i < 8; i++) {\n                  var x = i + tileX;\n\n                  for (var j = 0; j < 8; j++) {\n                    var y = j + tileY; // lines[y][x] = tile[i + j * 8];\n\n                    bytes[y][x] = _tile[i + j * 8];\n                  }\n                }\n              } // for(const line of lines)\n              // {\n              // \tline.map(b => process.stdout.write( ansi[b]('  ') ) )\n              // \tconsole.log(' ');\n              // }\n              // console.log(' ');\n\n\n              renderedBlocks[_blockId] = (_ref5 = []).concat.apply(_ref5, _toConsumableArray(bytes));\n            }\n\n            map.renderedBlocks = renderedBlocks;\n            map.blocks = blocks;\n          };\n\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var _ret = _loop();\n\n            if (_ret === \"continue\") continue;\n            if (_typeof(_ret) === \"object\") return _ret.v;\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n\n        return [maps, tilesets];\n      });\n    }\n  }, {\n    key: \"getPokemonName\",\n    value: function getPokemonName(indexNumber) {\n      var _this7 = this;\n\n      return this.slice(0x2FA3, 1).then(function (buffer) {\n        var bankByte = buffer[0];\n        return _this7.slice(0x2FAE, 2).then(function (buffer) {\n          var pointer = _this7.makeRef(bankByte, buffer);\n\n          var bytes = _this7.deref(pointer + 0xA * indexNumber, 0x50, 0xA);\n\n          return _this7.decodeText(bytes);\n        });\n      });\n    }\n  }, {\n    key: \"getPokemonNumber\",\n    value: function getPokemonNumber(indexNumber) {\n      return this.slice(0x41024, 190).then(function (buffer) {\n        return buffer[indexNumber];\n      });\n    }\n  }, {\n    key: \"getPokemonStats\",\n    value: function getPokemonStats(indexNumber) {\n      var _this8 = this;\n\n      var spriteBank;\n\n      if (indexNumber === 0x14) {\n        spriteBank = 0x1;\n      } else if (indexNumber === 0xB5) {\n        spriteBank = 0xB;\n      } else if (indexNumber < 0x1F) {\n        spriteBank = 0x9;\n      } else if (indexNumber < 0x49) {\n        spriteBank = 0xA;\n      } else if (indexNumber < 0x73) {\n        spriteBank = 0xB;\n      } else if (indexNumber < 0x98) {\n        spriteBank = 0xC;\n      } else {\n        spriteBank = 0xD;\n      }\n\n      return this.getPokemonNumber(indexNumber).then(function (number) {\n        var offset = 0x383DE + 28 * (number - 1);\n\n        if (indexNumber === 0x14) {\n          offset = 0x425B;\n        }\n\n        return _this8.slice(offset, 28).then(function (buffer) {\n          return {\n            index: Number(indexNumber) || indexNumber,\n            number: buffer[0],\n            hp: buffer[1],\n            attack: buffer[2],\n            defense: buffer[3],\n            speed: buffer[4],\n            special: buffer[5],\n            type1: buffer[6],\n            type2: buffer[7],\n            catchRate: buffer[8],\n            expYield: buffer[9],\n            frontSpriteSize: buffer[10],\n            frontSprite: _this8.formatRef(spriteBank, buffer.slice(11, 13)),\n            backSprite: _this8.formatRef(spriteBank, buffer.slice(13, 15)),\n            basicMoves: [buffer[15], buffer[16], buffer[17], buffer[18]]\n          };\n        });\n      });\n    }\n  }, {\n    key: \"getAllPokemon\",\n    value: function getAllPokemon() {\n      var _this9 = this;\n\n      return this.slice(0x41024, 190).then(function (buffer) {\n        var promises = [];\n\n        for (var i = 0; i < buffer.length; i++) {\n          promises.push(_this9.getPokemon(i));\n        }\n\n        return Promise.all(promises);\n      });\n    }\n  }, {\n    key: \"getAllPokemonPalettes\",\n    value: function getAllPokemonPalettes() {\n      return this.slice(0x725C9, 150).then(function (buffer) {\n        var used = [];\n\n        var _iterator2 = _createForOfIteratorHelper(buffer),\n            _step2;\n\n        try {\n          for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n            var _byte2 = _step2.value;\n            used.push(_byte2);\n          }\n        } catch (err) {\n          _iterator2.e(err);\n        } finally {\n          _iterator2.f();\n        }\n\n        return used;\n      });\n    }\n  }, {\n    key: \"getAllPalettes\",\n    value: function getAllPalettes() {\n      var _this10 = this;\n\n      return this.piece(0x72660, 0x7278F).then(function (buffer) {\n        var index = 0;\n        var bytes = [];\n        _this10.palettes = [];\n\n        var _iterator3 = _createForOfIteratorHelper(buffer),\n            _step3;\n\n        try {\n          for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n            var _byte3 = _step3.value;\n\n            if (!_this10.palettes[index]) {\n              _this10.palettes[index] = [];\n            }\n\n            bytes.push(_byte3);\n\n            if (bytes.length >= 8) {\n              var palette = _this10.palettes[index];\n\n              for (var i = 0; i < bytes.length; i += 2) {\n                var binColor = bytes[i] + (bytes[i + 1] << 8);\n                palette.push({\n                  r: (binColor & 31) >> 0,\n                  g: (binColor & 992) >> 5,\n                  b: (binColor & 31744) >> 10\n                });\n              }\n\n              bytes.splice(0);\n              index++;\n            }\n          }\n        } catch (err) {\n          _iterator3.e(err);\n        } finally {\n          _iterator3.f();\n        }\n\n        return _this10.palettes;\n      });\n    }\n  }, {\n    key: \"getPokemon\",\n    value: function getPokemon(index) {\n      var _this11 = this;\n\n      var getAllTypes = this.getAllTypes();\n      var getAllMoves = this.getAllMoves();\n      var getPokedex = this.getPokedexEntry(index);\n      var getNumber = this.getPokemonNumber(index);\n      var getName = this.getPokemonName(index);\n      var getStats = this.getPokemonStats(index);\n      var getLevelUp = this.getLevelUpActions(index);\n      var getBackSize = this.getBackSpriteLength(index);\n      var getPokemon = Promise.all([getAllTypes, getAllMoves, getNumber, getPokedex, getName, getStats, getLevelUp, getBackSize]);\n      return getPokemon.then(function (_ref6) {\n        var _ref7 = _slicedToArray(_ref6, 8),\n            allTypes = _ref7[0],\n            allMoves = _ref7[1],\n            number = _ref7[2],\n            dex = _ref7[3],\n            name = _ref7[4],\n            stats = _ref7[5],\n            levelUp = _ref7[6],\n            backSize = _ref7[7];\n\n        var s = [0x0, 0x1, 0x2, 0x3, 0xA, 0xB, 0xC, 0xD, null, null, null, null, null, null, null, null, null, null, null, 0xE, 0x4, 0x5, 0x6, 0x7, 0x8, 0x9, 0xF];\n\n        var type = function type(t) {\n          var tt = s[t];\n          return allTypes[tt];\n        };\n\n        var types = [type(stats.type1)];\n\n        if (stats.type1 !== stats.type2) {\n          types[1] = type(stats.type2);\n        }\n\n        for (var i in stats.basicMoves) {\n          var moveId = -1 + stats.basicMoves[i];\n\n          if (moveId === -1) {\n            continue;\n          }\n\n          if (allMoves[moveId]) {\n            var move = allMoves[moveId];\n            stats.basicMoves[i] = {\n              moveId: moveId,\n              move: move\n            };\n          }\n        }\n\n        stats.basicMoves = stats.basicMoves.filter(function (x) {\n          return x;\n        });\n        var basicMoves = stats.basicMoves;\n        var sprites = {\n          front: stats.frontSprite,\n          back: stats.backSprite\n        };\n        sprites.front.length = stats.frontSpriteSize * 8;\n        sprites.back.length = backSize;\n        delete stats.type1;\n        delete stats.type2;\n        delete stats.basicMoves;\n        delete stats.frontSprite;\n        delete stats.frontSpriteSize;\n        delete stats.backSprite; // delete stats.backSpriteSize;\n\n        var levelUpMoves = [];\n\n        for (var _i3 in levelUp.learnset) {\n          var _moveId = levelUp.learnset[_i3].move - 1;\n\n          var level = levelUp.learnset[_i3].level;\n\n          if (allMoves[_moveId] === -1) {\n            continue;\n          }\n\n          var _move = allMoves[_moveId];\n          levelUpMoves[_i3] = {\n            moveId: _moveId,\n            move: _move,\n            level: level\n          };\n        }\n\n        var evoPromise = [];\n        var evolutions = [];\n\n        var _loop2 = function _loop2(_i4) {\n          var evoIndex = levelUp.evolutions[_i4].index;\n          var evoType = levelUp.evolutions[_i4].type;\n          var level = levelUp.evolutions[_i4].level;\n\n          var evo = _this11.getPokemonNumber(evoIndex - 1).then(function (evoNumber) {\n            return _this11.getPokemonName(evoIndex - 1).then(function (evoName) {\n              var type;\n\n              switch (evoType) {\n                case 1:\n                  type = 'Level';\n                  break;\n\n                case 2:\n                  type = 'Stone';\n                  break;\n\n                case 3:\n                  type = 'Trade';\n                  break;\n              }\n\n              return {\n                name: evoName,\n                type: type,\n                level: level,\n                index: evoIndex,\n                number: evoNumber,\n                item: levelUp.evolutions[_i4].item || undefined\n              };\n            });\n          });\n\n          evoPromise.push(evo);\n        };\n\n        for (var _i4 in levelUp.evolutions) {\n          _loop2(_i4);\n        }\n\n        return Promise.all(evoPromise).then(function (evolutions) {\n          return {\n            name: name,\n            number: number,\n            index: index,\n            types: types,\n            dex: dex,\n            evolutions: evolutions,\n            stats: stats,\n            sprites: sprites,\n            basicMoves: basicMoves,\n            levelUpMoves: levelUpMoves\n          };\n        });\n      });\n    }\n  }, {\n    key: \"getPokedexEntry\",\n    value: function getPokedexEntry(indexNumber) {\n      var _this12 = this;\n\n      return this.piece(0x4047E, 0x405FA).then(function (buffer) {\n        var pointer = 0 + (buffer[indexNumber * 2 + 1] << 8) + (buffer[indexNumber * 2 + 0] << 0);\n        pointer -= 0x4000;\n        pointer += 0x40000;\n\n        var bytes = _this12.deref(pointer, 0x50);\n\n        var type = _this12.decodeText(bytes);\n\n        var nextPointer = pointer + bytes.length + 1;\n\n        if (nextPointer == 0x40fe9) {\n          return;\n        }\n\n        return _this12.slice(nextPointer, 9).then(function (bytes) {\n          var feet = bytes[0];\n          var inches = bytes[1];\n          var pounds = _this12.byteVal(bytes.slice(2, 4)) / 10;\n\n          var dexPointer = bytes[7] * 0x4000 + _this12.byteVal(bytes.slice(5, 7));\n\n          dexPointer -= 0x4000;\n\n          var entryBytes = _this12.deref(dexPointer, 0x50, 512);\n\n          var entry = _this12.decodeText(entryBytes);\n\n          return {\n            type: type,\n            feet: feet,\n            inches: inches,\n            pounds: pounds,\n            entry: entry\n          };\n        });\n      });\n    }\n  }, {\n    key: \"getLevelUpActions\",\n    value: function getLevelUpActions(indexNumber) {\n      var _this13 = this;\n\n      return this.slice(indexNumber * 2 + 0x3B05C, 2).then(function (pointerBytes) {\n        var evoPointer = _this13.makeRef(0x0E, pointerBytes);\n\n        var evoBytes = _this13.deref(evoPointer, 0x0);\n\n        var learnPointer = evoPointer + evoBytes.length + 1;\n\n        var learnBytes = _this13.deref(learnPointer, 0x0);\n\n        var evolutions = _this13.parseEvolutions(evoBytes);\n\n        var learnset = _this13.parseLearnset(learnBytes);\n\n        return {\n          evolutions: evolutions,\n          learnset: learnset\n        };\n      });\n    }\n  }, {\n    key: \"parseEvolutions\",\n    value: function parseEvolutions(bytes) {\n      var evolutions = [];\n\n      for (var i = 0; i < bytes.length;) {\n        var type = bytes[i++];\n        var level = void 0,\n            index = void 0,\n            item = void 0;\n\n        switch (type) {\n          case 1:\n            level = bytes[i++];\n            index = bytes[i++];\n            evolutions.push({\n              type: type,\n              level: level,\n              index: index\n            });\n            break;\n\n          case 2:\n            item = bytes[i++];\n            level = bytes[i++];\n            index = bytes[i++];\n            evolutions.push({\n              type: type,\n              item: item,\n              level: level,\n              index: index\n            });\n            break;\n\n          case 3:\n            level = bytes[i++];\n            index = bytes[i++];\n            evolutions.push({\n              type: type,\n              level: level,\n              index: index\n            });\n            break;\n        }\n      }\n\n      return evolutions;\n    }\n  }, {\n    key: \"parseLearnset\",\n    value: function parseLearnset(bytes) {\n      var learnset = [];\n\n      for (var i = 0; i < bytes.length; i += 2) {\n        var level = bytes[i + 0];\n        var move = bytes[i + 1];\n        learnset.push({\n          level: level,\n          move: move\n        });\n      }\n\n      return learnset;\n    }\n  }, {\n    key: \"getFrontSprite\",\n    value: function getFrontSprite(index) {\n      var _this14 = this;\n\n      return this.getPokemonStats(index).then(function (stats) {\n        return _this14.slice(stats.frontSprite.offset);\n      }).then(function (input) {\n        var rleDelta = new _RleDelta.RleDelta(input);\n        rleDelta.decompress();\n        var merge = new _Merge.Merge(rleDelta.buffer, rleDelta.xSize);\n        merge.decompress();\n        return merge.buffer;\n      });\n    }\n  }, {\n    key: \"getBackSpriteLength\",\n    value: function getBackSpriteLength(index) {\n      return this.getBackSpriteMeta(index).then(function (m) {\n        return m[0];\n      });\n    }\n  }, {\n    key: \"getBackSprite\",\n    value: function getBackSprite(index) {\n      return this.getBackSpriteMeta(index).then(function (m) {\n        return m[1];\n      });\n    }\n  }, {\n    key: \"getBackSpriteMeta\",\n    value: function getBackSpriteMeta(index) {\n      var _this15 = this;\n\n      return this.getPokemonStats(index).then(function (stats) {\n        return _this15.slice(stats.backSprite.offset);\n      }).then(function (input) {\n        var rleDelta = new _RleDelta.RleDelta(input);\n        rleDelta.decompress();\n        var merge = new _Merge.Merge(rleDelta.buffer, rleDelta.xSize);\n        merge.decompress();\n        var sourceLength = rleDelta.bits.i;\n        return [sourceLength, merge.buffer];\n      });\n    } // lzDecompress(start)\n    // {\n    // \treturn this.slice(start).then((buffer) => {\n    // \t\tconst eof = 0xFF;\n    // \t\tlet o = 0;\n    // \t\tlet width  = buffer[0] & 0xF;\n    // \t\tlet height = (buffer[0] & 0xF0) >> 4;\n    // \t\tconst out = new Uint8Array(width * height * 8 * 8);\n    // \t\tfor (let i = 1; i < buffer.length;)\n    // \t\t{\n    // \t\t\tconst n = buffer[i++];\n    // \t\t\tif(n === eof)\n    // \t\t\t{\n    // \t\t\t\tconsole.error(`EOF after ${i++} bytes read, ${o} bytes written.`);\n    // \t\t\t\tbreak;\n    // \t\t\t}\n    // \t\t\tlet code = n >> 5;\n    // \t\t\tlet c    = n & 0x1F;\n    // \t\t\tlet decoded;\n    // \t\t\tif(code === 0x7)\n    // \t\t\t{\n    // \t\t\t\tcode = c >> 2;\n    // \t\t\t\tc = (buffer[i++] & 3) * 256;\n    // \t\t\t\tc += buffer[i++] + 1;\n    // \t\t\t}\n    // \t\t\tcode > 0 && console.error('code:', code, 'c', c);\n    // \t\t\tdecoded = [];\n    // \t\t\tlet offset, direction, b, b1, b2;\n    // \t\t\tswitch(code)\n    // \t\t\t{\n    // \t\t\t\tcase 0x0:\n    // \t\t\t\t\tfor(let ii = 0; ii <= c; ii++)\n    // \t\t\t\t\t{\n    // \t\t\t\t\t\tout[o++] = buffer[i++];\n    // \t\t\t\t\t}\n    // \t\t\t\t\tbreak;\n    // \t\t\t\tcase 0x1:\n    // \t\t\t\t\tb  = buffer[i++];\n    // \t\t\t\t\tfor(let ii = 0; ii <= c; ii++)\n    // \t\t\t\t\t{\n    // \t\t\t\t\t\tout[o++] = b;\n    // \t\t\t\t\t}\n    // \t\t\t\t\tbreak;\n    // \t\t\t\tcase 0x2:\n    // \t\t\t\t\tb1 = buffer[i++];\n    // \t\t\t\t\tb2 = buffer[i++];\n    // \t\t\t\t\tfor(let ii = 0; ii <= c; ii++)\n    // \t\t\t\t\t{\n    // \t\t\t\t\t\tout[o++] = (ii %2 ? b2 : b1);\n    // \t\t\t\t\t}\n    // \t\t\t\t\tbreak;\n    // \t\t\t\tcase 0x3:\n    // \t\t\t\t\tfor(let ii = 0; ii <= c; ii++)\n    // \t\t\t\t\t{\n    // \t\t\t\t\t\tout[o++] = 0x0;\n    // \t\t\t\t\t}\n    // \t\t\t\t\tbreak;\n    // \t\t\t\tcase 0x4:\n    // \t\t\t\t\tb = buffer[i++];\n    // \t\t\t\t\tif(b < 0x80)\n    // \t\t\t\t\t{\n    // \t\t\t\t\t\tb2 = buffer[i++];\n    // \t\t\t\t\t\toffset = out.length % (b * 256 + b2);\n    // \t\t\t\t\t\tconsole.error('4', {length: out.length, offset,c,b, b2});\n    // \t\t\t\t\t}\n    // \t\t\t\t\telse\n    // \t\t\t\t\t{\n    // \t\t\t\t\t\tb = b & 0x7f;\n    // \t\t\t\t\t\toffset = o - b;\n    // \t\t\t\t\t\tconsole.error('4', {length: out.length, offset,c, b});\n    // \t\t\t\t\t}\n    // \t\t\t\t\tfor(let ii = 0; ii <= c; ii++)\n    // \t\t\t\t\t{\n    // \t\t\t\t\t\tout[o++] = out[offset + ii];\n    // \t\t\t\t\t}\n    // \t\t\t\t\tbreak;\n    // \t\t\t\tcase 0x5:\n    // \t\t\t\t\tb = buffer[i++];\n    // \t\t\t\t\tif(b >= 0x80)\n    // \t\t\t\t\t{\n    // \t\t\t\t\t\tb = b & 0x7f;\n    // \t\t\t\t\t\toffset = o - b;\n    // \t\t\t\t\t\tconsole.error('5', {length: out.length, offset,c,b});\n    // \t\t\t\t\t}\n    // \t\t\t\t\telse\n    // \t\t\t\t\t{\n    // \t\t\t\t\t\tb2 = buffer[i++];\n    // \t\t\t\t\t\toffset = out.length % (b * 256 + b2);\n    // \t\t\t\t\t\tconsole.error('5', {length: out.length, offset,c,b,b2});\n    // \t\t\t\t\t}\n    // \t\t\t\t\tfor(let ii = 0; ii <= c; ii++)\n    // \t\t\t\t\t{\n    // \t\t\t\t\t\tout[o++] = out[offset + ii];\n    // \t\t\t\t\t}\n    // \t\t\t\t\tbreak;\n    // \t\t\t\tcase 0x6:\n    // \t\t\t\t\tb = buffer[i++];\n    // \t\t\t\t\tif(b >= 0x80)\n    // \t\t\t\t\t{\n    // \t\t\t\t\t\tb = b & 0x7f;\n    // \t\t\t\t\t\toffset = o - b;\n    // \t\t\t\t\t\tconsole.error('6', {length: out.length, offset,b});\n    // \t\t\t\t\t}\n    // \t\t\t\t\telse\n    // \t\t\t\t\t{\n    // \t\t\t\t\t\tb2 = buffer[i++];\n    // \t\t\t\t\t\toffset = out.length % (b * 256 + b2);\n    // \t\t\t\t\t\tconsole.error('6', {length: out.length, offset,b,b2});\n    // \t\t\t\t\t}\n    // \t\t\t\t\tfor(let ii = 0; ii <= c; ii++)\n    // \t\t\t\t\t{\n    // \t\t\t\t\t\tout[o++] = out[offset - ii];\n    // \t\t\t\t\t}\n    // \t\t\t\t\tbreak;\n    // \t\t\t}\n    // \t\t\tif(o > out.length)\n    // \t\t\t{\n    // \t\t\t\tbreak;\n    // \t\t\t}\n    // \t\t}\n    // \t\tprocess.stdout.write(out);\n    // \t\t// out.forEach(b => {\n    // \t\t// })\n    // \t});\n    // }\n\n  }]);\n\n  return PokemonRom;\n}(_Rom2.Rom);\n\nexports.PokemonRom = PokemonRom;\n  })();\n});","\nrequire.register(\"pokemon-parser/base/Rom.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"pokemon-parser\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Rom = void 0;\n\nvar _fsRom = _interopRequireDefault(require(\"../factory/fsRom\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar Rom = /*#__PURE__*/function () {\n  function Rom(filename) {\n    _classCallCheck(this, Rom);\n\n    this.filename = filename;\n    this.buffer = null;\n    this.index = {};\n    this.segments = {};\n    this.ordered = false;\n  }\n\n  _createClass(Rom, [{\n    key: \"preload\",\n    value: function preload(buffer) {\n      var _this = this;\n\n      if (buffer) {\n        this.buffer = buffer;\n        return Promise.resolve(buffer);\n      }\n\n      if (this.buffer) {\n        return Promise.resolve(this.buffer);\n      }\n\n      return (0, _fsRom[\"default\"])(this.filename).then(function (buffer) {\n        _this.buffer = buffer;\n        return buffer;\n      });\n    }\n  }, {\n    key: \"slice\",\n    value: function slice(start) {\n      var _this2 = this;\n\n      var length = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : undefined;\n      return new Promise(function (accept, reject) {\n        if (!_this2.buffer) {\n          _this2.preload();\n        }\n\n        accept(length ? _this2.buffer.slice(start, start + length) : _this2.buffer.slice(start)); // fs.exists(this.filename, (exists) => {\n        // \tif(!exists)\n        // \t{\n        // \t\treturn reject('Rom file does not exist.');\n        // \t}\n        // \tfs.open(this.filename, 'r', (error, handle) => {\n        // \t\tif(error)\n        // \t\t{\n        // \t\t\treturn reject(error);\n        // \t\t}\n        // \t\tfs.read(\n        // \t\t\thandle\n        // \t\t\t, ArrayBuffer.alloc(length)\n        // \t\t\t, null\n        // \t\t\t, length\n        // \t\t\t, start\n        // \t\t\t, (error, bytesRead, buffer) => {\n        // \t\t\t\tif(error)\n        // \t\t\t\t{\n        // \t\t\t\t\treturn reject(error);\n        // \t\t\t\t}\n        // \t\t\t\taccept(buffer);\n        // \t\t\t}\n        // \t\t);\n        // \t});\n        // });\n      });\n    }\n  }, {\n    key: \"piece\",\n    value: function piece(start, end) {\n      return this.slice(start, end - start);\n    }\n  }, {\n    key: \"byteVal\",\n    value: function byteVal(buffer) {\n      var val = 0;\n\n      for (var i = 0; i < buffer.length; i += 1) {\n        val += buffer[i] << 8 * i;\n      }\n\n      return val;\n    }\n  }, {\n    key: \"indexSegments\",\n    value: function indexSegments() {\n      var segments = [];\n\n      for (var i in this.index) {\n        segments.push({\n          position: this.index[i],\n          title: i\n        });\n      }\n\n      segments.sort(function (a, b) {\n        return b.position - a.position;\n      });\n      var lastSegment = null;\n\n      for (var _i in segments) {\n        if (!lastSegment) {\n          segments[_i].length = 0;\n        } else {\n          segments[_i].length = lastSegment.position - segments[_i].position;\n        }\n\n        lastSegment = segments[_i];\n      }\n\n      for (var _i2 in segments) {\n        this.segments[segments[_i2].title] = segments[_i2];\n      }\n    }\n  }, {\n    key: \"segment\",\n    value: function segment(name) {\n      var _this3 = this;\n\n      this.indexSegments();\n\n      if (name in this.segments) {\n        if (!this.segments[name].length) {\n          return new Promise(function (accept, reject) {\n            _this3.preload().then(function (buffer) {\n              _this3.segments[name].length = buffer.length - _this3.segments[name].position;\n              accept(_this3.slice(_this3.segments[name].position, _this3.segments[name].length));\n            });\n          });\n        }\n\n        return this.slice(this.segments[name].position, this.segments[name].length);\n      }\n    }\n  }]);\n\n  return Rom;\n}();\n\nexports.Rom = Rom;\n  })();\n});","\nrequire.register(\"pokemon-parser/decompress/Gameboy2bpp.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"pokemon-parser\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Gameboy2bpp = void 0;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar Gameboy2bpp = /*#__PURE__*/function () {\n  function Gameboy2bpp(inputBuffer, outputBuffer, width) {\n    _classCallCheck(this, Gameboy2bpp);\n\n    _defineProperty(this, \"outputPos\", 0);\n\n    _defineProperty(this, \"inputPos\", 0);\n\n    _defineProperty(this, \"tileWidth\", 8);\n\n    _defineProperty(this, \"tileHeight\", 8);\n\n    _defineProperty(this, \"depth\", 2);\n\n    this.inputBuffer = inputBuffer;\n    this.outputBuffer = outputBuffer;\n    this.width = width;\n  }\n\n  _createClass(Gameboy2bpp, [{\n    key: \"next\",\n    value: function next() {\n      if (this.inputPos >= this.inputBuffer.length) {\n        return;\n      }\n\n      var palette = [[0xFF, 0xFF, 0xFF], [0x33, 0x33, 0x33], [0x66, 0x66, 0x66], [0x00, 0x00, 0x00]];\n      var byteA = this.inputBuffer[this.inputPos++];\n      var byteB = this.inputBuffer[this.inputPos++];\n      var maxTilesX = Math.floor(this.width / this.tileWidth);\n      var bitPairs = [((byteA & 128) << 1 | byteB & 128) >> 7, ((byteA & 64) << 1 | byteB & 64) >> 6, ((byteA & 32) << 1 | byteB & 32) >> 5, ((byteA & 16) << 1 | byteB & 16) >> 4, ((byteA & 8) << 1 | byteB & 8) >> 3, ((byteA & 4) << 1 | byteB & 4) >> 2, ((byteA & 2) << 1 | byteB & 2) >> 1, ((byteA & 1) << 1 | byteB & 1) >> 0];\n      var tileArea = this.tileWidth * this.tileHeight;\n\n      for (var j in bitPairs) {\n        var currentTile = Math.floor(this.outputPos / tileArea);\n        var currentTileX = currentTile % maxTilesX;\n        var currentTileY = Math.floor(currentTile / maxTilesX);\n        var fromTile = this.outputPos % tileArea;\n        var fromTileY = Math.floor(fromTile / this.tileWidth);\n        var fromTileX = fromTile % this.tileWidth;\n        var fromOriginX = currentTileX * this.tileWidth + fromTileX;\n        var fromOriginY = currentTileY * this.tileHeight + fromTileY;\n        var address = maxTilesX * this.tileWidth * fromOriginY + fromOriginX;\n        this.outputBuffer[address * 4 + 0] = palette[bitPairs[j]][0];\n        this.outputBuffer[address * 4 + 1] = palette[bitPairs[j]][1];\n        this.outputBuffer[address * 4 + 2] = palette[bitPairs[j]][2];\n        this.outputBuffer[address * 4 + 3] = 255;\n        this.outputPos++;\n      }\n\n      return this.outputPos * 4 < this.outputBuffer.length;\n    }\n  }]);\n\n  return Gameboy2bpp;\n}();\n\nexports.Gameboy2bpp = Gameboy2bpp;\n  })();\n});","\nrequire.register(\"pokemon-parser/decompress/Merge.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"pokemon-parser\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Merge = void 0;\n\nvar _BitArray = require(\"../BitArray\");\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar Merge = /*#__PURE__*/function () {\n  function Merge(input, width) {\n    _classCallCheck(this, Merge);\n\n    this.width = width;\n    this.size = input.length;\n    this.input = new _BitArray.BitArray(input);\n    this.buffer = new Uint8Array(Math.pow(width, 2));\n    this.i = 0;\n  }\n\n  _createClass(Merge, [{\n    key: \"decompress\",\n    value: function decompress() {\n      while (this.iterate()) {\n        ;\n      }\n    }\n  }, {\n    key: \"iterate\",\n    value: function iterate() {\n      var pallet = [255, 128, 196, 64];\n      var halfLength = this.input.length / 2;\n\n      if (this.i < halfLength) {\n        var b1 = this.input.get(this.pixelToRowPixel(this.i));\n        var b2 = this.input.get(this.pixelToRowPixel(this.i) + Math.pow(this.width, 2));\n        var b = b1 << 1 | b2;\n        this.buffer[this.i] = pallet[b];\n        this.i++;\n        return true;\n      }\n\n      return false;\n    }\n  }, {\n    key: \"pixelToRowPixel\",\n    value: function pixelToRowPixel(pixel) {\n      var width = this.width;\n      var pEven = pixel % 2 === 0;\n      var xOff = Math.floor(pixel / width);\n      var xEven = xOff % 2 == 0;\n      var yOff = pixel % width;\n      var result = xOff * 2 + yOff * width + (pEven ? 0 : -(width - 1));\n      return result;\n    }\n  }]);\n\n  return Merge;\n}();\n\nexports.Merge = Merge;\n  })();\n});","\nrequire.register(\"pokemon-parser/decompress/RleDelta.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"pokemon-parser\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.RleDelta = void 0;\n\nvar _BitArray = require(\"../BitArray\");\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar RleDelta = /*#__PURE__*/function () {\n  function RleDelta(input) {\n    _classCallCheck(this, RleDelta);\n\n    _defineProperty(this, \"tileSize\", 8);\n\n    _defineProperty(this, \"lastBit\", 0);\n\n    _defineProperty(this, \"fillMode\", null);\n\n    _defineProperty(this, \"fillCount\", 0);\n\n    _defineProperty(this, \"deltaCount\", 0);\n\n    _defineProperty(this, \"xorCount\", 0);\n\n    this.mode = null;\n    this.bits = new _BitArray.BitArray(input);\n    this.input = input;\n    this.xSize = this.bits.next(4) || 7;\n    this.ySize = this.bits.next(4) || 7;\n    this.sideSize = this.xSize;\n    this.xSize *= this.tileSize;\n    this.size = this.xSize * this.ySize;\n    this.xSize = this.xSize <= 56 ? this.xSize : 56;\n    this.ySize = this.ySize <= 7 ? this.ySize : 7;\n    this.buffSize = Math.pow(this.sideSize, 2) * this.tileSize;\n    this.buffer = new Uint8Array(this.buffSize * 2);\n    this.bufferA = new Uint8Array(this.buffer.buffer, this.buffSize * 0, this.buffSize * 1);\n    this.bufferB = new Uint8Array(this.buffer.buffer, this.buffSize * 1, this.buffSize * 1);\n    this.step1 = -1;\n    this.step2 = -1;\n    this.step3 = -1;\n    this.step3b = -1;\n  }\n\n  _createClass(RleDelta, [{\n    key: \"decompress\",\n    value: function decompress() {\n      while (this.decompressBufferFirst()) {\n        ;\n      }\n\n      while (this.decompressBufferSecond()) {\n        ;\n      }\n\n      while (this.decompressDelta()) {\n        ;\n      }\n    }\n  }, {\n    key: \"iterate\",\n    value: function iterate() {\n      if (this.step1 <= 0) {\n        this.decompressBufferFirst();\n      } else if (this.step2 <= 0) {\n        this.decompressBufferSecond();\n      } else if (this.step3 <= 0) {\n        this.decompressDelta();\n      } else if (this.step3 === 1) {\n        return false;\n      }\n\n      return true;\n    }\n  }, {\n    key: \"decompressBufferFirst\",\n    value: function decompressBufferFirst() {\n      if (this.step1 >= 1) {\n        return false;\n      }\n\n      var buffers = [new _BitArray.BitArray(this.bufferA), new _BitArray.BitArray(this.bufferB)];\n\n      if (this.step1 === -1) {\n        var order = this.bits.next();\n        this.bufA = buffers[order];\n        this.bufB = buffers[order ^ 1];\n        this.fillMode = this.bits.next();\n        this.fillCount = 0;\n        this.step1 = 0;\n      }\n\n      var more = this.fillBuffer(this.bufA, this.bits, this.xSize, this.size);\n\n      if (more) {\n        return true;\n      } else {\n        this.step1 = 1;\n        return false;\n      }\n    }\n  }, {\n    key: \"decompressBufferSecond\",\n    value: function decompressBufferSecond() {\n      if (this.step2 >= 1) {\n        return false;\n      }\n\n      if (this.step2 === -1) {\n        this.mode = this.bits.next();\n\n        if (this.mode === 1) {\n          this.mode = 1 + this.bits.next();\n        }\n\n        this.fillMode = this.bits.next();\n        this.fillCount = 0;\n        this.step2 = 0;\n      }\n\n      var more = this.fillBuffer(this.bufB, this.bits, this.xSize, this.size);\n\n      if (more) {\n        return true;\n      } else {\n        this.step2 = 1;\n        return false;\n      }\n    }\n  }, {\n    key: \"decompressDelta\",\n    value: function decompressDelta() {\n      switch (this.mode) {\n        case 0:\n          if (this.step3b === -1) {\n            this.deltaCount = 0;\n            this.step3b = 0;\n          } else if (this.step3b === 0) {\n            if (!this.deltaFill(this.bufA, this.xSize)) {\n              this.step3b = 1;\n            }\n          } else if (this.step3b === 1) {\n            this.deltaCount = 0;\n            this.step3b = 2;\n          } else if (this.step3b === 2) {\n            if (!this.deltaFill(this.bufB, this.xSize)) {\n              this.step3b = 3;\n            }\n          } else {\n            this.step3 = 1;\n            return false;\n          }\n\n          return true;\n          break;\n\n        case 1:\n          if (this.step3b === -1) {\n            this.deltaCount = 0;\n            this.step3b = 0;\n          } else if (this.step3b === 0) {\n            if (!this.deltaFill(this.bufA, this.xSize)) {\n              this.step3b = 1;\n            }\n          } else if (this.step3b === 1) {\n            this.xorCount = 0;\n            this.step3b = 2;\n          } else if (this.step3b === 2) {\n            if (!this.xorFill(this.bufA, this.bufB)) {\n              this.step3b = 3;\n            }\n          } else {\n            this.step3 = 1;\n            return false;\n          }\n\n          return true;\n          break;\n\n        case 2:\n          if (this.step3b === -1) {\n            this.deltaCount = 0;\n            this.step3b = 0;\n          } else if (this.step3b === 0) {\n            if (!this.deltaFill(this.bufA, this.xSize)) {\n              this.step3b = 1;\n            }\n          } else if (this.step3b === 1) {\n            this.deltaCount = 0;\n            this.step3b = 2;\n          } else if (this.step3b === 2) {\n            if (!this.deltaFill(this.bufB, this.xSize)) {\n              this.step3b = 3;\n            }\n          } else if (this.step3b === 3) {\n            this.xorCount = 0;\n            this.step3b = 4;\n          } else if (this.step3b === 4) {\n            if (!this.xorFill(this.bufA, this.bufB)) {\n              this.step3b = 5;\n            }\n          } else {\n            this.step3 = 1;\n            return false;\n          }\n\n          return true;\n          break;\n      }\n    }\n  }, {\n    key: \"pixelToRowPixel\",\n    value: function pixelToRowPixel(pixel) {\n      var width = this.sideSize * this.tileSize;\n      var pEven = pixel % 2 === 0;\n      var xOff = Math.floor(pixel / width);\n      var xEven = xOff % 2 == 0;\n      var yOff = pixel % width;\n      var result = xOff * 2 + yOff * width + (pEven ? 0 : -(width - 1));\n      return result;\n    }\n  }, {\n    key: \"xorFill\",\n    value: function xorFill(bitsA, bitsB) {\n      if (this.xorCount >= this.buffSize * 8) {\n        return false;\n      }\n\n      var bitA = bitsA.get(this.xorCount);\n      var bitB = bitsB.get(this.xorCount);\n      bitsB.set(this.xorCount, bitA ^ bitB);\n      this.xorCount++;\n      return true;\n    }\n  }, {\n    key: \"deltaFill\",\n    value: function deltaFill(bits, xSize) {\n      if (this.deltaCount % (this.sideSize * this.tileSize) === 0) {\n        this.lastBit = 0;\n      }\n\n      var pixel = this.pixelToRowPixel(this.deltaCount);\n      var bit = bits.get(pixel);\n\n      if (bit) {\n        this.lastBit = 1 ^ this.lastBit;\n      }\n\n      bits.set(pixel, this.lastBit);\n      this.deltaCount++;\n\n      if (this.deltaCount < this.buffSize * 8) {\n        return true;\n      } else {\n        return false;\n      }\n    }\n  }, {\n    key: \"fillBuffer\",\n    value: function fillBuffer(buffer, bits, xSize, size) {\n      var bitSize = size * 8;\n\n      if (this.fillMode === 0) {\n        this.rleFill(buffer, bits);\n        this.fillMode = 1;\n      } else if (this.fillMode === 1) {\n        this.dataFill(buffer, bits, bitSize);\n        this.fillMode = 0;\n      }\n\n      if (this.fillCount < bitSize) {\n        return true;\n      } else {\n        return false;\n      }\n    }\n  }, {\n    key: \"rleFill\",\n    value: function rleFill(buffer, bits) {\n      var i = 0;\n      var bit = '';\n      var read = '';\n\n      while (bit = bits.next()) {\n        read += bit;\n        i++;\n      }\n\n      read += bit;\n      var n = bits.next(i + 1);\n      var x = (2 << i) + -1 + n;\n\n      for (var j = 0; j < x; j++) {\n        this.fillCount++;\n        this.fillCount++;\n      }\n    }\n  }, {\n    key: \"dataFill\",\n    value: function dataFill(buffer, bits, bitSize) {\n      var fill = [];\n\n      while (this.fillCount < bitSize) {\n        var b1 = bits.next();\n        var b2 = bits.next();\n\n        if (b1 === 0 && b2 === 0) {\n          break;\n        }\n\n        fill.push(b1, b2);\n        b1 && buffer.set(this.fillCount, b1);\n        this.fillCount++;\n        b2 && buffer.set(this.fillCount, b2);\n        this.fillCount++;\n      }\n    }\n  }]);\n\n  return RleDelta;\n}();\n\nexports.RleDelta = RleDelta;\n  })();\n});","\nrequire.register(\"pokemon-parser/factory/fsRom.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"pokemon-parser\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = _default;\n\nvar _fs = _interopRequireDefault(require(\"fs\"));\n\nvar _Rom = require(\"../base/Rom\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _default(filename) {\n  return new Promise(function (accept, reject) {\n    _fs[\"default\"].exists(filename, function (exists) {\n      if (!exists) {\n        return reject('Rom file does not exist.');\n      }\n\n      _fs[\"default\"].stat(filename, function (error, stats) {\n        if (error) {\n          return reject(error);\n        }\n\n        _fs[\"default\"].open(filename, 'r', function (error, handle) {\n          if (error) {\n            return reject(error);\n          }\n\n          _fs[\"default\"].read(handle, new Uint8Array(stats.size), null, stats.size, 0, function (error, bytesRead, buffer) {\n            if (error) {\n              return reject(error);\n            }\n\n            accept(buffer);\n          });\n        });\n      });\n    });\n  });\n}\n  })();\n});","\nrequire.register(\"pokemon-parser/gameboy/GbcLicensees.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"pokemon-parser\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.GbcLicensees = void 0;\nvar GbcLicensees = {\n  '00': 'none',\n  '01': 'nintendo',\n  '08': 'capcom',\n  '13': 'electronic arts',\n  '18': 'hudsonsoft',\n  '19': 'b-ai',\n  '20': 'kss',\n  '22': 'pow',\n  '24': 'pcm complete',\n  '25': 'san-x',\n  '28': 'kemco japan',\n  '29': 'seta',\n  '30': 'viacom',\n  '31': 'nintendo',\n  '32': 'bandia',\n  '33': 'ocean/acclaim',\n  '34': 'konami',\n  '35': 'hector',\n  '37': 'taito',\n  '38': 'hudson',\n  '39': 'banpresto',\n  '41': 'ubi soft',\n  '42': 'atlus',\n  '44': 'malibu',\n  '46': 'angel',\n  '47': 'pullet-proof',\n  '49': 'irem',\n  '50': 'absolute',\n  '51': 'acclaim',\n  '52': 'activision',\n  '53': 'american sammy',\n  '54': 'konami',\n  '55': 'hi tech entertainment',\n  '56': 'ljn',\n  '57': 'matchbox',\n  '58': 'mattel',\n  '59': 'milton bradley',\n  '60': 'titus',\n  '61': 'virgin',\n  '64': 'lucasarts',\n  '67': 'ocean',\n  '69': 'electronic arts',\n  '70': 'infogrames',\n  '71': 'interplay',\n  '72': 'broderbund',\n  '73': 'sculptured',\n  '75': 'sci',\n  '78': 't*hq',\n  '79': 'accolade',\n  '80': 'misawa',\n  '83': 'lozc',\n  '86': 'tokuma shoten i*',\n  '87': 'tsukuda ori*',\n  '91': 'chun soft',\n  '92': 'video system',\n  '93': 'ocean/acclaim',\n  '95': 'varie',\n  '96': 'yonezawa/s\\'pal',\n  '97': 'kaneko',\n  '99': 'pack in soft'\n};\nexports.GbcLicensees = GbcLicensees;\n  })();\n});","\nrequire.register(\"pokemon-parser/gameboy/Licensees.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"pokemon-parser\");\n  (function() {\n    \"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Licensees = void 0;\nvar Licensees = {\n  '00': 'none',\n  '01': 'nintendo',\n  '08': 'capcom',\n  '09': 'hot-b',\n  '0A': 'jaleco',\n  '0B': 'coconuts',\n  '0C': 'elite systems',\n  '13': 'electronic arts',\n  '18': 'hudsonsoft',\n  '19': 'itc entertainment',\n  '1A': 'yanoman',\n  '1D': 'clary',\n  '1F': 'virgin',\n  '20': 'KSS',\n  '24': 'pcm complete',\n  '25': 'san-x',\n  '28': 'kotobuki systems',\n  '29': 'seta',\n  '30': 'infogrames',\n  '31': 'nintendo',\n  '32': 'bandai',\n  '33': 'GBC - see above',\n  '34': 'konami',\n  '35': 'hector',\n  '38': 'Capcom',\n  '39': 'Banpresto',\n  '3C': '*entertainment i',\n  '3E': 'gremlin',\n  '41': 'Ubisoft',\n  '42': 'Atlus',\n  '44': 'Malibu',\n  '46': 'angel',\n  '47': 'spectrum holoby',\n  '49': 'irem',\n  '4A': 'virgin',\n  '4D': 'malibu',\n  '4F': 'u.s. gold',\n  '50': 'absolute',\n  '51': 'acclaim',\n  '52': 'activision',\n  '53': 'american sammy',\n  '54': 'gametek',\n  '55': 'park place',\n  '56': 'ljn',\n  '57': 'matchbox',\n  '59': 'milton bradley',\n  '5A': 'mindscape',\n  '5B': 'romstar',\n  '5C': 'naxat soft',\n  '5D': 'tradewest',\n  '60': 'titus',\n  '61': 'virgin',\n  '67': 'ocean',\n  '69': 'electronic arts',\n  '6E': 'elite systems',\n  '6F': 'electro brain',\n  '70': 'Infogrammes',\n  '71': 'Interplay',\n  '72': 'broderbund',\n  '73': 'sculptered soft',\n  '75': 'the sales curve',\n  '78': 't*hq',\n  '79': 'accolade',\n  '7A': 'triffix entertainment',\n  '7C': 'microprose',\n  '7F': 'kemco',\n  '80': 'misawa entertainment',\n  '83': 'lozc',\n  '86': 'tokuma shoten intermedia',\n  '8B': 'bullet-proof software',\n  '8C': 'vic tokai',\n  '8E': 'ape',\n  '8F': 'i\\'max',\n  '91': 'chun soft',\n  '92': 'video system',\n  '93': 'tsuburava',\n  '95': 'varie',\n  '96': 'yonezawa/s\\'pal',\n  '97': 'kaneko',\n  '99': 'arc',\n  '9A': 'nihon bussan',\n  '9B': 'Tecmo',\n  '9C': 'imagineer',\n  '9D': 'Banpresto',\n  '9F': 'nova',\n  'A1': 'Hori electric',\n  'A2': 'Bandai',\n  'A4': 'Konami',\n  'A6': 'kawada',\n  'A7': 'takara',\n  'A9': 'technos japan',\n  'AA': 'broderbund',\n  'AC': 'Toei animation',\n  'AD': 'toho',\n  'AF': 'Namco',\n  'B0': 'Acclaim',\n  'B1': 'ascii or nexoft',\n  'B2': 'Bandai',\n  'B4': 'Enix',\n  'B6': 'HAL',\n  'B7': 'SNK',\n  'B9': 'pony canyon',\n  'BA': '*culture brain o',\n  'BB': 'Sunsoft',\n  'BD': 'Sony imagesoft',\n  'BF': 'sammy',\n  'C0': 'Taito',\n  'C2': 'Kemco',\n  'C3': 'Squaresoft',\n  'C4': 'tokuma shoten intermedia',\n  'C5': 'data east',\n  'C6': 'tonkin house',\n  'C8': 'koei',\n  'C9': 'ufl',\n  'CA': 'ultra',\n  'CB': 'vap',\n  'CC': 'use',\n  'CD': 'meldac',\n  'CE': '*pony canyon or',\n  'CF': 'angel',\n  'D0': 'Taito',\n  'D1': 'sofel',\n  'D2': 'quest',\n  'D3': 'sigma enterprises',\n  'D4': 'ask kodansha',\n  'D6': 'naxat soft',\n  'D7': 'copya systems',\n  'D9': 'Banpresto',\n  'DA': 'tomy',\n  'DB': 'ljn',\n  'DD': 'ncs',\n  'DE': 'human',\n  'DF': 'altron',\n  'E0': 'jaleco',\n  'E1': 'towachiki',\n  'E2': 'uutaka',\n  'E3': 'varie',\n  'E5': 'epoch',\n  'E7': 'athena',\n  'E8': 'asmik',\n  'E9': 'natsume',\n  'EA': 'king records',\n  'EB': 'atlus',\n  'EC': 'Epic/Sony records',\n  'EE': 'igs',\n  'F0': 'a wave',\n  'F3': 'extreme entertainment',\n  'FF': 'ljn'\n};\nexports.Licensees = Licensees;\n  })();\n});","\nrequire.register(\"pokemon-parser/gameboy/Rom.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"pokemon-parser\");\n  (function() {\n    \"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Rom = void 0;\n\nvar _Rom = require(\"../base/Rom\");\n\nvar _Licensees = require(\"./Licensees\");\n\nvar _GbcLicensees = require(\"./GbcLicensees\");\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar Rom = /*#__PURE__*/function (_BaseRom) {\n  _inherits(Rom, _BaseRom);\n\n  var _super = _createSuper(Rom);\n\n  function Rom(filename) {\n    var _this;\n\n    _classCallCheck(this, Rom);\n\n    _this = _super.call(this, filename);\n    _this.index = {\n      blank: 0x0,\n      entryPoint: 0x100,\n      nintendoLogo: 0x104,\n      title: 0x134,\n      manufacturer: 0x13F,\n      colorGameboy: 0x143,\n      licensee: 0x144,\n      superGameboy: 0x146,\n      cartrigeType: 0x147,\n      romSize: 0x148,\n      ramSize: 0x149,\n      destination: 0x14A,\n      gbcLicensee: 0x14B,\n      romVersion: 0x14C,\n      headerCheck: 0x14D,\n      globalCheck: 0x14E,\n      _: 0x150\n    };\n    return _this;\n  }\n\n  _createClass(Rom, [{\n    key: \"title\",\n    get: function get() {\n      var bytes = _toConsumableArray(this.buffer.slice(this.index.title, this.index.title + 15));\n\n      return bytes.map(function (b) {\n        return b > 0 ? String.fromCharCode(b) : '';\n      }).join('');\n    }\n  }, {\n    key: \"manufacturer\",\n    get: function get() {\n      var bytes = _toConsumableArray(this.buffer.slice(this.index.manufacturer, this.index.manufacturer + 4));\n\n      return bytes.map(function (b) {\n        return b > 0 ? String.fromCharCode(b) : '';\n      }).join('');\n    }\n  }, {\n    key: \"licensee\",\n    get: function get() {\n      var _Licensees$code;\n\n      var bytes = _toConsumableArray(this.buffer.slice(this.index.manufacturer, this.index.manufacturer + 2));\n\n      var code = bytes.map(function (b) {\n        return b.toString(16);\n      }).join('');\n      return (_Licensees$code = _Licensees.Licensees[code]) !== null && _Licensees$code !== void 0 ? _Licensees$code : undefined;\n    } // get gbcLicensee()\n    // {\n    // \tconst bytes = [...this.buffer.slice(this.index.gbcLicensee, this.index.gbcLicensee + 2)];\n    // \tconst code  = bytes.map(b => b.toString(16)).join('');\n    // \tconsole.log(bytes,code);\n    // \treturn GbcLicensees[code] ?? undefined;\n    // }\n\n  }, {\n    key: \"deref\",\n    value: function deref(start, terminator, max) {\n      var bytes = [];\n\n      for (var i = start; i < this.buffer.length; i += 1) {\n        if (this.buffer[i] === terminator || bytes.length >= max) {\n          return new Uint8Array(bytes);\n        } else {\n          bytes.push(this.buffer[i]);\n        }\n      }\n\n      return bytes;\n    }\n  }, {\n    key: \"makeRef\",\n    value: function makeRef(bankByte, buffer) {\n      return (bankByte << 14) + (this.byteVal(buffer) & 0x3fff);\n    }\n  }, {\n    key: \"formatRef\",\n    value: function formatRef(bank, buffer) {\n      var offset = this.makeRef(bank, buffer);\n      var pointer = this.byteVal(buffer);\n      return {\n        bank: bank,\n        pointer: pointer,\n        offset: offset\n      };\n    }\n  }]);\n\n  return Rom;\n}(_Rom.Rom);\n\nexports.Rom = Rom;\n  })();\n});","\nrequire.register(\"process/browser.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"process\");\n  (function() {\n    // shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n  })();\n});","export class Format\n{\n\ttileWidth  = 1;\n\ttileHeight = 1;\n\toutputPos  = 0;\n\tinputPos   = 0;\n\tdepth      = 1;\n\n\tconstructor(inputBuffer, outputBuffer, width)\n\t{\n\t\tthis.inputBuffer  = inputBuffer;\n\t\tthis.outputBuffer = outputBuffer;\n\n\t\tthis.width = width;\n\t}\n\n\tnext()\n\t{\n\t\tconsole.warn(\n\t\t\t`Error: ${this.constructor.name}::next() has not been implemented.`\n\t\t);\n\t}\n}\n","import { Mixin }  from 'curvature/base/Mixin';\nimport { View }   from 'curvature/base/View';\n\nimport { Panelable } from './panel/Panelable';\n\nexport class Processor extends View\n{\n\tconstructor(args,parent)\n\t{\n\t\tsuper(args, parent);\n\n\t\tObject.assign(this.panel.args, {widgets: [this]});\n\n\t\tthis.args.bindTo('input', v => {\n\t\t\tif(!v)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.args.inputName = v.args.input ? v.args.input.name : v.args.title;\n\t\t\tthis.args.offset    = Number(v.args.firstByte);\n\t\t\tthis.args.length    = Number(v.args.buffer.length) - this.args.offset;\n\t\t});\n\t}\n}\n\nMixin.to(Processor, Panelable);\n","import { Mixin }  from 'curvature/base/Mixin';\nimport { View }   from 'curvature/base/View';\n\nimport { Menu }   from '../menu/Menu';\n\nimport { Panelable } from '../panel/Panelable';\nimport { Panel }     from '../panel/Panel';\n\nimport { BytePerPixel } from '../format/BytePerPixel';\nimport { BitPerPixel  } from '../format/BitPerPixel';\n\nimport { Gameboy1bpp } from '../format/Gameboy1bpp';\nimport { Gameboy2bpp } from '../format/Gameboy2bpp';\n\nimport { Gameboy1bppCol } from '../format/Gameboy1bppCol';\n\nimport { PokemonRom } from 'pokemon-parser/PokemonRom';\n\nimport { Invert } from '../processor/Invert';\nimport { Slice }  from '../processor/Slice';\nimport { RLE }    from '../processor/RLE';\n\nexport class Canvas extends View\n{\n\ttemplate = require('./canvas.html');\n\n\tconstructor(args, parent)\n\t{\n\t\tsuper(args, parent);\n\n\t\tthis.args.height = args.height || 64;\n\t\tthis.args.width  = args.width  || 128;\n\t\tthis.args.scale  = args.scale  || 2;\n\n\t\tthis.args.tileArea = 1;\n\t\tthis.args.offset   = 0;\n\n\t\tthis.scrollDelta = 1;\n\n\t\tthis.args.decoder = args.decoder || 'gameboy';\n\n\t\tthis.args.showSettings = false;\n\n\t\tthis.args.input = args.input || false;\n\n\t\tthis.args.firstByte = '0000';\n\n\t\tthis.panel.args.widgets = [this];\n\n\t\tthis.args.name = (args.input && args.input.name) || args.title || 'Canvas';\n\n\t\tthis.args.bindTo('name', v => {\n\t\t\tthis.panel.args.title = v;\n\n\t\t\tif(this.args.input)\n\t\t\t{\n\t\t\t\tthis.args.input.name = v;\n\t\t\t}\n\t\t});\n\n\t\tconst rootPanel = this.args.panel;\n\t\tconst input = this;\n\n\t\tthis.args.toolBar = [\n\t\t\t  { icon: 'gear',  action: event => this.toggleSettings(event) }\n\t\t\t, { icon: 'run',   action: event => rootPanel.panels.add(new RLE({input, panel: rootPanel}, this).panel) }\n\t\t\t, { icon: 'slice', action: event => rootPanel.panels.add(new Slice({input, panel: rootPanel}, this).panel) }\n\t\t\t, { icon: 'save',  action: event => this.save(event) }\n\t\t\t// , { icon: 'invert', action: event => rootPanel.panels.add(new Invert({input, panel: rootPanel}, this).panel) }\n\t\t];\n\t}\n\n\tonRendered()\n\t{\n\t\tconst canvasStyle = {\n\t\t\t'--scale':    this.args.scale\n\t\t\t, '--width':  this.args.width\n\t\t\t, '--height': this.args.height\n\t\t};\n\n\t\tthis.args.bindTo('offset', (v,k) => {\n\t\t\tif(!this.args.buffer || !this.tags.canvas)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.drawDots(this.args.buffer);\n\t\t}, {wait: 0});\n\n\t\tthis.args.bindTo('scale', (v,k) => {\n\t\t\tif(this.tags.canvas)\n\t\t\t{\n\t\t\t\tcanvasStyle['--scale'] = v;\n\t\t\t\tthis.tags.canvas.style(canvasStyle);\n\t\t\t}\n\n\t\t\tif(this.args.buffer)\n\t\t\t{\n\t\t\t\tthis.drawDots(this.args.buffer);\n\t\t\t}\n\t\t}, {wait: 0});\n\n\t\tthis.args.bindTo('width', (v,k) => {\n\n\t\t\tv = Number(v);\n\n\t\t\tif(this.tags.canvas)\n\t\t\t{\n\t\t\t\tcanvasStyle['--width'] = v;\n\t\t\t\tthis.tags.canvas.width = v;\n\t\t\t\tthis.tags.canvas.style(canvasStyle);\n\t\t\t}\n\n\t\t\tif(this.args.buffer)\n\t\t\t{\n\t\t\t\tthis.drawDots(this.args.buffer);\n\t\t\t}\n\t\t}, {wait: 0});\n\n\t\tthis.args.bindTo('height', (v,k) => {\n\n\t\t\tv = Number(v);\n\n\t\t\tif(this.tags.canvas)\n\t\t\t{\n\t\t\t\tcanvasStyle['--height'] = v;\n\t\t\t\tthis.tags.canvas.height = v;\n\t\t\t\tthis.tags.canvas.style(canvasStyle);\n\t\t\t}\n\n\t\t\tif(this.args.buffer)\n\t\t\t{\n\t\t\t\tthis.drawDots(this.args.buffer);\n\t\t\t}\n\n\t\t}, {wait: 0});\n\n\t\tthis.args.bindTo('input', v => {\n\t\t\tif(!v)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.args.height = Math.ceil(new Uint8Array(v.buffer).length / 16) || this.args.height;\n\n\t\t\tthis.args.height = Math.min(160, this.args.height);\n\n\t\t\tconsole.log(v.buffer);\n\n\t\t\tthis.args.filename = v.name;\n\n\t\t\tthis.args.buffer = new Uint8Array(v.buffer);\n\n\t\t\tthis.onTimeout(0, () => {\n\t\t\t\tthis.drawDots(this.args.buffer);\n\t\t\t});\n\n\t\t\tcrypto.subtle.digest(\"SHA-256\", this.args.input.buffer).then(digestBytes => {\n\t\t\t\tconst digest = Array.from(new Uint8Array(digestBytes))\n\t\t\t\t.map((b) => b.toString(16).padStart(2, \"0\"))\n\t\t\t\t.join(\"\");\n\n\t\t\t\tconst pokemonHashes = [\n\t\t\t\t\t'5ca7ba01642a3b27b0cc0b5349b52792795b62d3ed977e98a09390659af96b7b',\n\t\t\t\t\t'2a951313c2640e8c2cb21f25d1db019ae6245d9c7121f754fa61afd7bee6452d',\n\t\t\t\t];\n\n\t\t\t\tif(!pokemonHashes.includes(digest))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst rom = new PokemonRom();\n\n\t\t\t\tthis.args.spriteOffsets = {};\n\n\t\t\t\trom.preload(this.args.buffer).then(() => {\n\n\t\t\t\t\trom.getAllPokemon().then(allPokemon => {\n\n\t\t\t\t\t\tallPokemon = allPokemon.filter(a => a.number).sort((a,b)=>{\n\t\t\t\t\t\t\treturn a.number - b.number;\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tfor(const pokemon of allPokemon)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst frontOffset = pokemon.sprites.front.offset + ':' + pokemon.sprites.front.length;\n\t\t\t\t\t\t\tconst backOffset  = pokemon.sprites.back.offset + ':' + pokemon.sprites.back.length;\n\t\t\t\t\t\t\tconst number      = pokemon.number.toString().padStart('0', 3);\n\t\t\t\t\t\t\tconst name        = pokemon.name;\n\n\t\t\t\t\t\t\tthis.args.spriteOffsets[frontOffset] = `# ${number} ${name} FRONT`;\n\t\t\t\t\t\t\tthis.args.spriteOffsets[backOffset]  = `# ${number} ${name} BACK`;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t});\n\n\t\t\t\t});\n\n\t\t\t});\n\t\t});\n\n\t\tthis.args.bindTo('decoder', v => {\n\n\t\t\tif(!this.args.buffer)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.drawDots(this.args.buffer);\n\n\t\t}, {frame: true});\n\t}\n\n\twheel(event)\n\t{\n\t\tevent.preventDefault();\n\n\t\tif(event.deltaY < 1 && this.args.offset > 0)\n\t\t{\n\t\t\tthis.args.offset -= this.args.width * this.depth;\n\t\t}\n\t\telse if(event.deltaY > 1)\n\t\t{\n\t\t\tthis.args.offset += this.args.width * this.depth;\n\t\t}\n\n\t\tif(0 > this.args.offset)\n\t\t{\n\t\t\tthis.args.offset = 0;\n\t\t}\n\t}\n\n\tkeydown(event)\n\t{\n\t\tif(event.key === 'PageDown')\n\t\t{\n\t\t\tthis.args.offset += this.args.width * this.args.height * (this.depth / 8);\n\t\t\tthis.drawDots();\n\t\t}\n\t\telse if(event.key === 'PageUp')\n\t\t{\n\t\t\tthis.args.offset -= this.args.width * this.args.height * (this.depth / 8);\n\n\t\t\tif(this.args.offset < 0)\n\t\t\t{\n\t\t\t\tthis.args.offset = 0;\n\t\t\t}\n\n\t\t\tthis.drawDots();\n\t\t}\n\t\telse if(event.key === 'ArrowDown')\n\t\t{\n\t\t\tif(event.ctrlKey)\n\t\t\t{\n\t\t\t\tthis.args.offset += this.depth;\n\t\t\t}\n\t\t\telse if(event.shiftKey)\n\t\t\t{\n\t\t\t\tthis.args.offset += this.args.width  * this.depth * 2;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.args.offset += this.args.width * this.depth;\n\t\t\t}\n\n\t\t\tthis.drawDots();\n\t\t}\n\t\telse if(event.key === 'ArrowUp')\n\t\t{\n\t\t\tif(event.ctrlKey)\n\t\t\t{\n\t\t\t\tthis.args.offset -= this.depth;\n\t\t\t}\n\t\t\telse if(event.shiftKey)\n\t\t\t{\n\t\t\t\tthis.args.offset -= this.args.width  * this.depth * 2;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.args.offset -= this.args.width * this.depth;\n\t\t\t}\n\n\t\t\tif(this.args.offset < 0)\n\t\t\t{\n\t\t\t\tthis.args.offset = 0;\n\t\t\t}\n\t\t\tthis.drawDots();\n\t\t}\n\t\telse if(event.key === 'ArrowRight')\n\t\t{\n\t\t\tif(event.ctrlKey)\n\t\t\t{\n\t\t\t\tthis.args.offset++;\n\t\t\t}\n\t\t\telse if(event.shiftKey)\n\t\t\t{\n\t\t\t\tthis.args.offset += this.tileArea * (this.depth / 8) * 2;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.args.offset += this.tileArea * (this.depth / 8);\n\t\t\t}\n\n\t\t\tthis.drawDots();\n\t\t}\n\t\telse if(event.key === 'ArrowLeft')\n\t\t{\n\t\t\tif(event.ctrlKey)\n\t\t\t{\n\t\t\t\tthis.args.offset--;\n\t\t\t}\n\t\t\telse if(event.shiftKey)\n\t\t\t{\n\t\t\t\tthis.args.offset -= this.tileArea * (this.depth / 8) * 2;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.args.offset -= this.tileArea * (this.depth / 8);\n\t\t\t}\n\n\t\t\tif(this.args.offset < 0)\n\t\t\t{\n\t\t\t\tthis.args.offset = 0;\n\t\t\t}\n\t\t\tthis.drawDots();\n\t\t}\n\t\telse if(event.key === 'Home')\n\t\t{\n\t\t\tthis.args.offset = 0;\n\t\t\tthis.drawDots();\n\t\t}\n\t\telse if(event.key === 'End')\n\t\t{\n\t\t\tthis.args.offset = this.args.buffer.length;\n\t\t\tthis.drawDots();\n\t\t}\n\t}\n\n\tdrawDots(bytes = undefined)\n\t{\n\t\tif(this.willDraw)\n\t\t{\n\t\t\tcancelAnimationFrame(this.willDraw);\n\t\t}\n\n\t\tthis.willDraw = requestAnimationFrame(()=>{\n\t\t\tif(bytes === undefined)\n\t\t\t{\n\t\t\t\tbytes = this.args.buffer;\n\t\t\t}\n\n\t\t\tconst canvas  = this.tags.canvas;\n\t\t\tconst context = canvas.getContext('2d');\n\n\t\t\trequestAnimationFrame(()=>context.clearRect(0, 0, canvas.width, canvas.height));\n\n\t\t\tlet formatter = null;\n\n\t\t\tswitch(this.args.decoder)\n\t\t\t{\n\t\t\t\tcase 'bytes':\n\t\t\t\t\tformatter = BytePerPixel;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'bits':\n\t\t\t\t\tformatter = BitPerPixel;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'gameboy':\n\t\t\t\t\tformatter = Gameboy2bpp;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'gameboy-1bit':\n\t\t\t\t\tformatter = Gameboy1bpp;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'gameboy-1bit-cols':\n\t\t\t\t\tformatter = Gameboy1bppCol;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tthis.format(formatter, bytes)\n\t\t});\n\t};\n\n\tformat(formatter, bytes)\n\t{\n\t\tconst canvas  = this.tags.canvas;\n\t\tconst context = canvas.getContext('2d');\n\n\t\tconst inputBuffer  = bytes.slice(this.args.offset);\n\t\tconst output       = context.createImageData(this.args.width, this.args.height);\n\t\tconst outputBuffer = output.data;\n\n\t\tconst pixels = new formatter(\n\t\t\tinputBuffer\n\t\t\t, outputBuffer\n\t\t\t, this.args.width\n\t\t);\n\n\t\tthis.tileArea = pixels.tileWidth * pixels.tileHeight;\n\t\tthis.depth    = pixels.depth;\n\n\t\twhile( pixels.next() );\n\n\t\trequestAnimationFrame(\n\t\t\t()=>context.putImageData(output, 0, 0)\n\t\t);\n\t}\n\n\ttoggleSettings()\n\t{\n\t\tthis.args.showSettings = !this.args.showSettings;\n\t}\n\n\tzoomIn()\n\t{\n\t\tthis.args.scale++;\n\t}\n\n\tzoomOut()\n\t{\n\t\tthis.args.scale--;\n\t}\n\n\tjump(event)\n\t{\n\t\tconst [offset, length] = event.target.value.split(':');\n\n\t\tthis.args.offset = Number(offset);\n\t\tthis.args.length = Number(length);\n\t}\n\n\tsave(event)\n\t{\n\t\tconst link = document.createElement('a');\n\t\tconst blob = new Blob([this.args.buffer]);\n\t\tconst oURL = URL.createObjectURL(blob);\n\n\t\tlink.setAttribute('download', this.args.name);\n\t\tlink.setAttribute('href', oURL);\n\n\t\tconsole.log(this.args.buffer);\n\n\t\tlink.click();\n\t}\n\n\t// run(event)\n\t// {\n\t// \tconst rootPanel = this.args.panel;\n\n\t// \tconst input = this;\n\t// \tconst menu  = new Menu({input, panel: rootPanel}, this);\n\n\t// \trootPanel.panels.add(menu.panel);\n\t// }\n\n\trunAction(event, button)\n\t{\n\t\tbutton.action(event);\n\t}\n\n\thex(x)\n\t{\n\t\treturn Number(x).toString(16).padStart(4, '0');\n\t}\n}\n\nMixin.to(Canvas, Panelable);\n","module.exports = \"<div data-module = \\\"canvas [[module]]\\\">\\n\\n\\t<p>[[name]]</p>\\n\\n\\t<label cv-if = \\\"buffer\\\">\\n\\t\\t<div>\\n\\t\\t\\t<div class = \\\"tool-bar\\\" cv-each = \\\"toolBar:button\\\">\\n\\t\\t\\t\\t<div class = \\\"icon inline-icon [[button.icon]]-icon\\\" cv-on = \\\"click:runAction(event, button)\\\"></div>\\n\\t\\t\\t</div>\\n\\n\\t\\t\\t<!--\\n\\t\\t\\t<div>\\n\\t\\t\\t\\t<div class = \\\"icon inline-icon goto-address-icon\\\" cv-on = \\\"click:goto(event)\\\"></div>\\n\\t\\t\\t</div>\\n\\t\\t\\t-->\\n\\t\\t\\t<!--\\n\\t\\t\\t<div>\\n\\t\\t\\t\\t<div class = \\\"icon inline-icon gear-icon\\\" cv-on = \\\"click:toggleSettings(event)\\\"></div>\\n\\t\\t\\t\\t<div class = \\\"icon inline-icon run-icon\\\" cv-on = \\\"click:run(event)\\\"></div>\\n\\t\\t\\t\\t<div class = \\\"icon inline-icon save-icon\\\"cv-on = \\\"click:save(event)\\\"></div>\\n\\t\\t\\t</div>\\n \\t\\t\\t-->\\n \\t\\t\\t<div cv-if = \\\"loading\\\" class = \\\"right\\\">\\n\\t\\t\\t\\t<div class = \\\"icon inline-icon loading-icon right\\\"></div>\\n\\t\\t\\t</div>\\n\\t\\t\\t<!-- <div class = \\\"icon inline-icon folder-icon\\\"></div> -->\\n\\t\\t</div>\\n\\t</label>\\n\\n\\t<span cv-if = \\\"showSettings\\\">\\n\\n\\t\\t<label cv-if = \\\"buffer\\\">\\n\\t\\t\\t<p>name</p>\\n\\t\\t\\t<input cv-bind = \\\"name\\\" type = \\\"text\\\">\\n\\t\\t</label>\\n\\n\\t\\t<label cv-if = \\\"buffer\\\">\\n\\t\\t\\t<p>width</p>\\n\\t\\t\\t<input cv-bind = \\\"width\\\" type = \\\"number\\\" min = \\\"0\\\">\\n\\t\\t</label>\\n\\n\\t\\t<label cv-if = \\\"buffer\\\">\\n\\t\\t\\t<p>height</p>\\n\\t\\t\\t<input cv-bind = \\\"height\\\" type = \\\"number\\\" min = \\\"0\\\">\\n\\t\\t</label>\\n\\n\\t\\t<label cv-if = \\\"buffer\\\">\\n\\t\\t\\t<p>scale</p>\\n\\t\\t\\t<input cv-bind = \\\"scale\\\" type = \\\"number\\\" min = \\\"1\\\">\\n\\t\\t</label>\\n\\n\\t\\t<label cv-if = \\\"buffer\\\">\\n\\t\\t\\t<p>row</p>\\n\\t\\t\\t<input cv-bind = \\\"offset\\\" type = \\\"number\\\" min = \\\"0\\\">\\n\\t\\t</label>\\n\\t</span>\\n\\n\\t<label cv-if = \\\"!buffer\\\">\\n\\t\\t<input type = \\\"file\\\" cv-bind = \\\"input\\\">\\n\\t</label>\\n\\n\\t<div class = \\\"row\\\">\\n\\n\\t\\t<label cv-if = \\\"spriteOffsets\\\">\\n\\t\\t\\t<p>offsets</p>\\n\\t\\t\\t<div class = \\\"canvas-window\\\">\\n\\t\\t\\t\\t<select multiple=\\\"multiple\\\"  cv-on = \\\"change:jump(event)\\\">\\n\\t\\t\\t\\t\\t<optgroup label = \\\"tiles\\\">\\n\\t\\t\\t\\t\\t\\t<option value = \\\"65536\\\">OVERWORLD CHARACTERS 1</option>\\n\\t\\t\\t\\t\\t\\t<option value = \\\"81920\\\">OVERWORLD CHARACTERS 2</option>\\n\\t\\t\\t\\t\\t\\t<option value = \\\"70784\\\">TITLESCREEN GRAPHICS</option>\\n\\t\\t\\t\\t\\t\\t<option value = \\\"0x11a80\\\">FONTS (1BPP)</option>\\n\\t\\t\\t\\t\\t\\t<option value = \\\"0x64000\\\">MAP TILES</option>\\n\\t\\t\\t\\t\\t</optgroup>\\n\\t\\t\\t\\t\\t<optgroup label = \\\"sprites\\\" cv-each = \\\"spriteOffsets:name:offset\\\">\\n\\t\\t\\t\\t\\t\\t<option value = \\\"[[offset]]\\\">[[name]]</option>\\n\\t\\t\\t\\t\\t</optgroup>\\n\\t\\t\\t\\t</select>\\n\\t\\t\\t</div>\\n\\t\\t</label>\\n\\n\\t\\t<label cv-if = \\\"buffer\\\" for=\\\"\\\">\\n\\t\\t\\t<p>buffer</p>\\n\\t\\t\\t<div class = \\\"canvas-window\\\">\\n\\t\\t\\t\\t<label cv-if = \\\"buffer\\\">\\n\\t\\t\\t\\t\\t<p>encoding</p>\\n\\t\\t\\t\\t\\t<select cv-bind = \\\"decoder\\\">\\n\\t\\t\\t\\t\\t\\t<optgroup label = \\\"raw\\\">\\n\\t\\t\\t\\t\\t\\t\\t<option value = \\\"bytes\\\">8 bit greyscale</option>\\n\\t\\t\\t\\t\\t\\t\\t<option value = \\\"bits\\\">1 bit black & white</option>\\n\\t\\t\\t\\t\\t\\t</optgroup>\\n\\t\\t\\t\\t\\t\\t<optgroup label = \\\"gameboy data\\\">\\n\\t\\t\\t\\t\\t\\t\\t<option value = \\\"gameboy\\\">2bpp - 2 bit 8x8 tiles</option>\\n\\t\\t\\t\\t\\t\\t\\t<option value = \\\"gameboy-1bit\\\">1bpp - 1 bit 8x8 tiles</option>\\n\\t\\t\\t\\t\\t\\t\\t<option value = \\\"gameboy-1bit-cols\\\">1bpp - 1 bit columns</option>\\n\\t\\t\\t\\t\\t\\t</optgroup>\\n\\t\\t\\t\\t\\t</select>\\n\\t\\t\\t\\t</label>\\n\\t\\t\\t\\t<canvas tabindex = \\\"0\\\" cv-ref = \\\"canvas\\\" cv-on = \\\"wheel(event);keydown(event)\\\"></canvas>\\n\\t\\t\\t\\t<div class = \\\"row\\\">\\n\\t\\t\\t\\t\\t<div><code>0x[[offset|hex]]</code></div>\\n\\t\\t\\t\\t\\t<div class = \\\"right\\\">\\n\\t\\t\\t\\t\\t\\t<div class = \\\"icon inline-icon zoom-out-icon\\\" cv-on = \\\"click:zoomOut(event)\\\"></div>\\n\\t\\t\\t\\t\\t\\t<div class = \\\"icon inline-icon zoom-in-icon\\\" cv-on = \\\"click:zoomIn(event)\\\"></div>\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t</div>\\n\\t\\t</label>\\n\\n\\t\\t[[mergeWidget]]\\n\\n\\t</div>\\n</div>\\n\"","import { Bindable } from 'curvature/base/Bindable';\n\nimport { View } from 'curvature/base/View';\nimport { Panel } from '../panel/Panel';\nimport { Canvas } from '../canvas/Canvas';\n\nimport { Icon } from './Icon';\n\nimport { FileDatabase } from './FileDatabase';\nimport { FileModel } from './FileModel';\n\nimport { PokemonRom } from 'pokemon-parser/PokemonRom';\n\nexport class Drop extends View\n{\n\ttemplate = require('./drop.html');\n\n\tconstructor(args, parent)\n\t{\n\t\tsuper(args, parent);\n\n\t\tthis.args.files = [];\n\n\t\tthis.fileDb = FileDatabase.open('files', 1);\n\n\t\tthis.refresh();\n\t}\n\n\trefresh()\n\t{\n\t\tconst query = {store: 'files', index: 'name', type:  FileModel};\n\n\t\tthis.args.files = [];\n\n\t\tthis.fileDb.then((db)=> db.select(query).each(file => {\n\t\t\tfile && this.args.files.push(file);\n\t\t}));\n\t}\n\n\tdrop(event)\n\t{\n\t\tevent.preventDefault();\n\n\t\tthis.importFiles(event.dataTransfer.files);\n\n\t}\n\n\tdragover(event)\n\t{\n\t\tevent.preventDefault();\n\t}\n\n\ticonClicked(event, file)\n\t{\n\t\tthis.openCanvasPanel(file);\n\t}\n\n\timportFile()\n\t{\n\t\tconst input = document.createElement('input');\n\n\t\tinput.setAttribute('type', 'file');\n\t\tinput.addEventListener('change', event => {\n\n\t\t\tconsole.log(event);\n\t\t\tthis.importFiles(input.files);\n\n\t\t}, {once:true});\n\n\t\tinput.click();\n\t}\n\n\timportFiles(files)\n\t{\n\t\tfor(const file of files)\n\t\t{\n\t\t\tconst buffer = file.arrayBuffer();\n\t\t\tconst fileDb = this.fileDb;\n\n\t\t\tPromise.all([buffer, fileDb]).then(([buffer, fileDb])=>{\n\n\t\t\t\tconst query = {\n\t\t\t\t\tstore: 'files'\n\t\t\t\t\t, index: 'name'\n\t\t\t\t\t, range: file.name\n\t\t\t\t\t, type:  FileModel\n\t\t\t\t};\n\n\t\t\t\tconst values = {\n\t\t\t\t\tname: file.name\n\t\t\t\t\t, lastModified: file.lastModified\n\t\t\t\t\t, size: file.size\n\t\t\t\t\t, type: file.type\n\t\t\t\t\t, buffer: buffer\n\t\t\t\t};\n\n\t\t\t\tfileDb.select(query).one().then(result => {\n\n\t\t\t\t\tlet record = result.record;\n\n\t\t\t\t\tif(!record)\n\t\t\t\t\t{\n\t\t\t\t\t\trecord = FileModel.from(values);\n\t\t\t\t\t\tfileDb.insert('files', record);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\trecord.consume(values);\n\t\t\t\t\t\tfileDb.update('files', record);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.args.files.push(record);\n\n\t\t\t\t\tthis.openCanvasPanel(record);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\topenCanvasPanel(file)\n\t{\n\t\tconst rootPanel = this.args.panel;\n\n\t\tconst canvas = new Canvas({input: file, panel: rootPanel});\n\n\t\tconst rom = new PokemonRom;\n\n\t\trom.preload(new Uint8Array(file.buffer));\n\n\t\tconsole.log(rom.title);\n\n\t\trootPanel.panels.add(canvas.panel);\n\t}\n}\n","import { Database } from 'curvature/model/Database';\n\nexport class FileDatabase extends Database\n{\n\t_version_1(database)\n\t{\n\t\tconst fileStore = this.createObjectStore('files', {keyPath: 'name'});\n\n\t\tfileStore.createIndex('name', 'name', {unique: true});\n\t}\n}\n","import { Model } from 'curvature/model/Model';\n\nexport class FileModel extends Model\n{\n\tstatic keyProps = ['name']\n\n\tlastModified;\n\tbuffer;\n\tname;\n\tsize;\n\ttype;\n}\n","import { View } from 'curvature/base/View';\n\nexport class Icon extends View\n{\n\ttemplate = require('./icon.html');\n\n\tconstructor(args, parent)\n\t{\n\t\tsuper(args, parent);\n\t}\n}\n","module.exports = \"<div data-module = \\\"file-drop\\\" cv-on = \\\"drop(event);dragover(event);contextmenu(event, file, $parent);\\\">\\n\\tdrop files here.\\n</div>\\n\\n<div data-module = \\\"file-list\\\" cv-each = \\\"files:file\\\" cv-view = \\\"/file/Icon\\\">\\n\\t<div tabindex = \\\"0\\\" class = \\\"file\\\" cv-on = \\\"dblclick:iconClicked(event, file); contextmenu(event, file, $parent);\\\">\\n\\t\\t<img src = \\\"/gameboy.ico\\\">\\n\\t\\t<span>[[file.name]]</span>\\n\\t</div>\\n</div>\\n\"","module.exports = \"<div class = \\\"file\\\" tabindex = \\\"0\\\">\\n\\t<img src = \\\"/gameboy.ico\\\">\\n\\t<span>[[file.name]]</span>\\n</div>\\n\"","import { Format } from '../Format';\n\nexport class BitPerPixel extends Format\n{\n\tdepth = 1;\n\n\tnext()\n\t{\n\t\tif(this.inputPos >= this.inputBuffer.length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst byte = this.inputBuffer[this.inputPos++];\n\n\t\tconst bits = [\n\t\t\t(byte & 0b10000000) >> 7\n\t\t\t, (byte & 0b01000000) >> 6\n\t\t\t, (byte & 0b00100000) >> 5\n\t\t\t, (byte & 0b00010000) >> 4\n\t\t\t, (byte & 0b00001000) >> 3\n\t\t\t, (byte & 0b00000100) >> 2\n\t\t\t, (byte & 0b00000010) >> 1\n\t\t\t, (byte & 0b00000001) >> 0\n\t\t];\n\n\t\tfor(const bit of bits)\n\t\t{\n\t\t\tconst address = this.outputPos * 4;\n\n\t\t\tthis.outputBuffer[ address + 0 ] = bit * 255;\n\t\t\tthis.outputBuffer[ address + 1 ] = bit * 255;\n\t\t\tthis.outputBuffer[ address + 2 ] = bit * 255;\n\t\t\tthis.outputBuffer[ address + 3 ] = 255;\n\n\t\t\tthis.outputPos++;\n\t\t}\n\n\t\treturn this.outputPos * 4 < this.outputBuffer.length;\n\t}\n}\n","import { Format } from '../Format';\n\nexport class BytePerPixel extends Format\n{\n\tdepth = 8;\n\n\tnext()\n\t{\n\t\tif(this.inputPos >= this.inputBuffer.length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst byte = this.inputBuffer[this.inputPos++];\n\n\t\tconst address = this.outputPos * 4;\n\n\t\tthis.outputBuffer[ address + 0 ] = byte;\n\t\tthis.outputBuffer[ address + 1 ] = byte;\n\t\tthis.outputBuffer[ address + 2 ] = byte;\n\t\tthis.outputBuffer[ address + 3 ] = 255;\n\n\t\tthis.outputPos++;\n\n\t\treturn address < this.outputBuffer.length;\n\t}\n}\n","import { Format } from '../Format';\n\nexport class Gameboy1bpp extends Format\n{\n\ttileWidth  = 8;\n\ttileHeight = 8;\n\tdepth      = 1;\n\n\tnext()\n\t{\n\t\tif(this.inputPos >= this.inputBuffer.length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst palette  = [\n\t\t\t[0xFF, 0xFF, 0xFF]\n\t\t\t, [0x44, 0x44, 0x44]\n\t\t\t, [0xCC, 0xCC, 0xCC]\n\t\t\t, [0x00, 0x00, 0x00]\n\t\t];\n\n\t\tconst byte = this.inputBuffer[this.inputPos++];\n\n\t\tconst maxTilesX = Math.floor(this.width / this.tileWidth);\n\n\t\tconst bits = [\n\t\t\t(byte & 0b00000001) >> 0\n\t\t\t, (byte & 0b00000010) >> 1\n\t\t\t, (byte & 0b00000100) >> 2\n\t\t\t, (byte & 0b00001000) >> 3\n\t\t\t, (byte & 0b00010000) >> 4\n\t\t\t, (byte & 0b00100000) >> 5\n\t\t\t, (byte & 0b01000000) >> 6\n\t\t\t, (byte & 0b10000000) >> 7\n\t\t];\n\n\t\tconst tileArea = this.tileWidth * this.tileHeight;\n\n\t\tfor(const j in bits)\n\t\t{\n\t\t\tconst currentTile  = Math.floor(this.outputPos / tileArea);\n\n\t\t\tconst currentTileX = currentTile % maxTilesX;\n\t\t\tconst currentTileY = Math.floor(currentTile / maxTilesX);\n\n\t\t\tconst tileOffset   = this.outputPos % tileArea;\n\n\t\t\tconst fromTileY    = Math.floor(tileOffset / this.tileWidth);\n\t\t\tconst fromTileX    = this.tileWidth - (tileOffset % this.tileWidth);\n\n\t\t\tconst fromOriginX = (currentTileX * this.tileWidth) + fromTileX;\n\t\t\tconst fromOriginY = (currentTileY * this.tileHeight) + fromTileY;\n\n\t\t\tconst address = maxTilesX * this.tileWidth * fromOriginY + fromOriginX;\n\n\t\t\tthis.outputBuffer[address * 4 + 0] = palette[ bits[j] ][0];\n\t\t\tthis.outputBuffer[address * 4 + 1] = palette[ bits[j] ][1];\n\t\t\tthis.outputBuffer[address * 4 + 2] = palette[ bits[j] ][2];\n\t\t\tthis.outputBuffer[address * 4 + 3] = 255;\n\n\t\t\tthis.outputPos++;\n\t\t}\n\n\t\treturn this.outputPos * 4 < this.outputBuffer.length;\n\t}\n}\n","import { Gameboy1bpp } from './Gameboy1bpp';\n\nexport class Gameboy1bppCol extends Gameboy1bpp\n{\n\ttileWidth  = 2;\n\ttileHeight = 2;\n\tdepth      = 1;\n\n\tnext()\n\t{\n\t\tif(this.inputPos >= this.inputBuffer.length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst byte = this.inputBuffer[this.inputPos++];\n\n\t\tconst maxTilesX = Math.floor(this.width / this.tileWidth);\n\n\t\tconst bits = [\n\t\t\t(byte & 0b00000001) >> 0\n\t\t\t, (byte & 0b00000010) >> 1\n\t\t\t, (byte & 0b00000100) >> 2\n\t\t\t, (byte & 0b00001000) >> 3\n\t\t\t, (byte & 0b00010000) >> 4\n\t\t\t, (byte & 0b00100000) >> 5\n\t\t\t, (byte & 0b01000000) >> 6\n\t\t\t, (byte & 0b10000000) >> 7\n\t\t];\n\n\t\tconst tileArea = this.tileWidth * this.tileHeight;\n\n\t\tfor(const j in bits)\n\t\t{\n\t\t\tconst currentTile  = Math.floor(this.outputPos / tileArea);\n\n\t\t\tconst currentTileX = currentTile % maxTilesX;\n\t\t\tconst currentTileY = Math.floor(currentTile / maxTilesX);\n\n\t\t\tconst tileOffset   = this.outputPos % this.tileWidth**2;\n\n\t\t\tconst tileOffsetX  = Math.floor(tileOffset / this.tileWidth);\n\t\t\tconst tileOffsetY  = tileOffset % this.tileHeight;\n\n\t\t\tconst fromOriginX = (currentTileX * this.tileWidth)  + tileOffsetX;\n\t\t\tconst fromOriginY = (currentTileY * this.tileHeight) + tileOffsetY;\n\n\t\t\tconst address = 4 * (this.width * fromOriginY + fromOriginX);\n\n\t\t\tthis.outputBuffer[address+0] = bits[j] ? 255 : 0;\n\t\t\tthis.outputBuffer[address+1] = bits[j] ? 255 : 0;\n\t\t\tthis.outputBuffer[address+2] = bits[j] ? 255 : 0;\n\t\t\tthis.outputBuffer[address+3] = bits[j] ? 255 : 255;\n\n\t\t\tthis.outputPos++;\n\t\t}\n\n\t\treturn this.outputPos * 4 < this.outputBuffer.length;\n\t}\n}\n","import { Format } from '../Format';\n\nexport class Gameboy2bpp extends Format\n{\n\ttileWidth  = 8;\n\ttileHeight = 8;\n\tdepth      = 2;\n\n\tconstructor(inputBuffer, outputBuffer, width)\n\t{\n\t\tsuper();\n\n\t\tthis.inputBuffer  = inputBuffer;\n\t\tthis.outputBuffer = outputBuffer;\n\n\t\tthis.width = width;\n\t}\n\n\tnext()\n\t{\n\t\tif(this.inputPos >= this.inputBuffer.length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst palette  = [\n\t\t\t[0xFF, 0xFF, 0xFF]\n\t\t\t, [0x33, 0x33, 0x33]\n\t\t\t, [0x99, 0x99, 0x99]\n\t\t\t, [0x00, 0x00, 0x00]\n\t\t];\n\n\t\tconst byteA = this.inputBuffer[this.inputPos++];\n\t\tconst byteB = this.inputBuffer[this.inputPos++];\n\n\t\tconst maxTilesX = Math.floor(this.width / this.tileWidth);\n\n\t\tconst bitPairs = [\n\t\t\t(((byteA & 0b10000000) << 1) | (byteB & 0b10000000)) >> 7\n\t\t\t, (((byteA & 0b01000000) << 1) | (byteB & 0b01000000)) >> 6\n\t\t\t, (((byteA & 0b00100000) << 1) | (byteB & 0b00100000)) >> 5\n\t\t\t, (((byteA & 0b00010000) << 1) | (byteB & 0b00010000)) >> 4\n\t\t\t, (((byteA & 0b00001000) << 1) | (byteB & 0b00001000)) >> 3\n\t\t\t, (((byteA & 0b00000100) << 1) | (byteB & 0b00000100)) >> 2\n\t\t\t, (((byteA & 0b00000010) << 1) | (byteB & 0b00000010)) >> 1\n\t\t\t, (((byteA & 0b00000001) << 1) | (byteB & 0b00000001)) >> 0\n\t\t];\n\n\t\tconst tileArea = this.tileWidth * this.tileHeight;\n\n\t\tfor(const j in bitPairs)\n\t\t{\n\t\t\tconst currentTile  = Math.floor(this.outputPos / tileArea);\n\t\t\tconst currentTileX = currentTile % maxTilesX;\n\t\t\tconst currentTileY = Math.floor(currentTile / maxTilesX);\n\n\t\t\tconst fromTile     = this.outputPos % tileArea;\n\t\t\tconst fromTileY    = Math.floor(fromTile / this.tileWidth);\n\t\t\tconst fromTileX    = fromTile % this.tileWidth;\n\n\t\t\tconst fromOriginX = (currentTileX * this.tileWidth) + fromTileX;\n\t\t\tconst fromOriginY = (currentTileY * this.tileHeight) + fromTileY;\n\n\t\t\tconst address = maxTilesX * this.tileWidth * fromOriginY + fromOriginX;\n\n\t\t\tthis.outputBuffer[address * 4 + 0] = palette[ bitPairs[j] ][0];\n\t\t\tthis.outputBuffer[address * 4 + 1] = palette[ bitPairs[j] ][1];\n\t\t\tthis.outputBuffer[address * 4 + 2] = palette[ bitPairs[j] ][2];\n\t\t\tthis.outputBuffer[address * 4 + 3] = 255;\n\n\t\t\tthis.outputPos++;\n\t\t}\n\n\t\treturn this.outputPos * 4 < this.outputBuffer.length;\n\t}\n}\n","import { View } from 'curvature/base/View';\nimport { Tag  } from 'curvature/base/Tag';\n\nimport { Panel } from './panel/Panel';\nimport { Drop } from './file/Drop';\n\nimport { FileDatabase } from './file/FileDatabase';\nimport { FileModel } from './file/FileModel';\n\nimport { Elicit } from 'curvature/net/Elicit';\n\n// const drawDots = (file, context) => {\n\n// \tconst reader = new FileReader();\n\n// \treader.readAsArrayBuffer(file);\n\n// \treader.onload = () => {\n// \t\tconst bytes = new Uint8Array(reader.result);\n\n// \t\tconst height = Math.ceil(bytes.length / context.canvas.width);\n\n// \t\tcontext.canvas.height = height;\n\n// \t\tconst pixels = context.createImageData(context.canvas.width, context.canvas.height);\n\n// \t\tlet i = 0;\n\n// \t\tfor(const byte of bytes)\n// \t\t{\n// \t\t\tpixels.data[i++] = byte;\n// \t\t\tpixels.data[i++] = byte;\n// \t\t\tpixels.data[i++] = byte;\n// \t\t\tpixels.data[i++] = 255;\n// \t\t}\n\n// \t\tcontext.putImageData(pixels, 0, 0);\n// \t};\n// };\n\ndocument.addEventListener('DOMContentLoaded', function() {\n\n\tconst drop  = new Drop();\n\tconst panel = new Panel({\n\t\tcontextMenu: [],\n\t\twidgets: [drop],\n\t\ttype: 'root',\n\t});\n\n\tdrop.args.panel = panel;\n\n\tpanel.render(document.body);\n\n\tconst query = {store: 'files', index: 'name', type:  FileModel};\n\n\tFileDatabase.open('files', 1)\n\t.then(database => {\n\n\t\tdatabase.select(query).then(results => {\n\t\t\tif(results.index)\n\t\t\t{\n\t\t\t\t// return;\n\t\t\t}\n\n\t\t\tconst sampleUrls = [\n\t\t\t\t'squirtle_front.bin'\n\t\t\t\t, 'wartortle_front.bin'\n\t\t\t\t, 'blastoise_front.bin'\n\t\t\t\t, 'charmander_front.bin'\n\t\t\t\t, 'charmeleon_front.bin'\n\t\t\t\t, 'charizard_front.bin'\n\t\t\t\t, 'bulbasaur_front.bin'\n\t\t\t\t, 'ivysaur_front.bin'\n\t\t\t\t, 'venusaur_front.bin'\n\t\t\t];\n\n\t\t\tconst getSamples = Promise.all(sampleUrls.map(u => {\n\n\t\t\t\tconst e = new Elicit('/samples/' + u, {defer:true});\n\n\t\t\t\tElicit.pool(e);\n\n\t\t\t\treturn e\n\t\t\t\t.then(() => e.blob())\n\t\t\t\t.then(b => b.arrayBuffer())\n\t\t\t\t.then(b => [u,new Uint8Array(b).buffer]);\n\n\t\t\t}));\n\n\t\t\tgetSamples.then(s => {\n\t\t\t\tconst inserts = s.map(([u,b]) => {\n\t\t\t\t\tconsole.log(u,b);\n\t\t\t\t\tconst query = {\n\t\t\t\t\t\tstore: 'files'\n\t\t\t\t\t\t, index: 'name'\n\t\t\t\t\t\t, range: [u]\n\t\t\t\t\t\t, type:  FileModel\n\t\t\t\t\t};\n\n\t\t\t\t\tconst values = {\n\t\t\t\t\t\tname: u\n\t\t\t\t\t\t, id: u\n\t\t\t\t\t\t, lastModified: Date.now()\n\t\t\t\t\t\t, size: b.length\n\t\t\t\t\t\t, type: 'bin'\n\t\t\t\t\t\t, buffer: b\n\t\t\t\t\t};\n\n\t\t\t\t\treturn database.select(query).one().then(result => {\n\n\t\t\t\t\t\tlet record = result.mapped;\n\n\t\t\t\t\t\tif(!record)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trecord = FileModel.from(values);\n\t\t\t\t\t\t\trecord.id = record.name;\n\t\t\t\t\t\t\treturn database.insert('files', record);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trecord.consume(values);\n\t\t\t\t\t\t\trecord.id = record.name;\n\t\t\t\t\t\t\treturn database.update('files', record);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\tPromise.all(inserts).then(() => drop.refresh());\n\t\t\t});\n\t\t});\n\t})\n\n});\n","import { Mixin }  from 'curvature/base/Mixin';\nimport { View }   from 'curvature/base/View';\n\nimport { Invert } from '../processor/Invert';\nimport { Slice }  from '../processor/Slice';\nimport { RLE }    from '../processor/RLE';\n\nimport { Panelable } from '../panel/Panelable';\nimport { Panel }     from '../panel/Panel';\n\n// export class Menu extends View\nexport class Menu extends View\n{\n\ttemplate = require('./menu.html');\n\n\tconstructor(args,parent)\n\t{\n\t\tsuper(args,parent);\n\n\t\tthis.args.links = {Invert, Slice, RLE};\n\n\t\tObject.assign(this.panel.args, {\n\t\t\ttitle: 'Select a Processor'\n\t\t\t, widgets: [this]\n\t\t});\n\t}\n\n\tclick(event, processor, title)\n\t{\n\t\tconst rootPanel = this.args.panel;\n\n\t\tconst input  = this.args.input;\n\t\tconst widget = new processor({input, panel: rootPanel});\n\n\t\trootPanel.panels.add(widget.panel);\n\n\t\tthis.remove();\n\t}\n}\n\nMixin.to(Menu, Panelable);\n","module.exports = \"<div data-module = \\\"menu\\\">\\n\\t<ul cv-each = \\\"links:processor:title\\\">\\n\\t\\t<li>\\n\\t\\t\\t<a cv-link = \\\"/process/[[title]]\\\" cv-on = \\\"click(event, processor, title)\\\">\\n\\t\\t\\t\\t[[title]]\\n\\t\\t\\t</a>\\n\\t\\t</lu>\\n\\t</ul>\\n</div>\\n\"","import { Bindable } from 'curvature/base/Bindable';\nimport { View } from 'curvature/base/View';\nimport { Bag  } from 'curvature/base/Bag';\n\nimport { DeleteConfirm } from '../processor/DeleteConfirm';\n\nexport class Panel extends View\n{\n\ttemplate = require('./panel.html');\n\n\tconstructor(args, panel)\n\t{\n\t\tsuper(args, panel);\n\n\t\tthis.host = null;\n\n\t\tthis.openLeft = 0;\n\t\tthis.openTop  = 0;\n\n\t\tthis.args.widgets = Bindable.make(this.args.widgets || []);\n\t\tthis.args.title   = this.args.title  || null;\n\t\tthis.args.widget  = this.args.widget || null;\n\t\tthis.args.left    = 0;\n\t\tthis.args.top     = 0;\n\t\tthis.args.z       = 0;\n\n\t\tthis.panels = new Bag((i,s,a) => {\n\n\t\t\tif(a !== Bag.ITEM_ADDED)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ti.host = this;\n\n\t\t\tthis.openLeft += 57;\n\t\t\tthis.openTop  += 93;\n\n\t\t\ti.args.left = this.openLeft;\n\t\t\ti.args.top  = this.openTop;\n\t\t\ti.args.z    = Object.values(this.panels.list).length;\n\n\t\t\tthis.openLeft %= Math.floor(window.innerWidth / 2);\n\t\t\tthis.openTop  %= Math.floor(window.innerHeight / 2);\n\n\t\t\ti.onRemove(()=>this.panels.remove(i));\n\t\t});\n\n\t\tthis.args.widgets.bindTo((v,k) => {v.parent = this});\n\n\t\tthis.args.panels = this.panels.list;\n\t}\n\n\tonAttached(event)\n\t{\n\t\tthis.args.bindTo(['left', 'top', 'contextMenuXL', 'contextMenuXR', 'contextMenuYT', 'contextMenuYB'], (v,k)=>{\n\t\t\tconst panel = this.tags.panel;\n\n\t\t\tif(!panel)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst body  = document.body;\n\n\t\t\tconst maxX  = body.clientWidth  - panel.clientWidth;\n\t\t\tconst maxY  = body.clientHeight - panel.clientHeight;\n\n\t\t\tif(k === 'left' && v > maxX)\n\t\t\t{\n\t\t\t\tv = maxX;\n\t\t\t}\n\n\t\t\tif(k === 'top' && v > maxY)\n\t\t\t{\n\t\t\t\tv = maxY;\n\t\t\t}\n\n\t\t\tif(v < 0)\n\t\t\t{\n\t\t\t\tv = 0;\n\t\t\t}\n\n\t\t\tthis.args[k] = v;\n\n\t\t\tif(v == Number(v))\n\t\t\t{\n\t\t\t\tv = v + 'px';\n\t\t\t}\n\n\t\t\tthis.tags.panel.style({ [`--${k}`] : `${v}` });\n\t\t});\n\n\t\tthis.args.bindTo('z', (v,k)=>{\n\t\t\tthis.tags.panel.style({ [`--${k}`] : `${v}` });\n\t\t});\n\t}\n\n\tmousedown(event)\n\t{\n\t\tif(!this.host)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst panels = Object.values(this.host.panels.list).sort((a,b)=>{\n\t\t\treturn b.z > a.z;\n\t\t});\n\n\n\t\tfor(const i in panels)\n\t\t{\n\t\t\tif(panels[i] === this)\n\t\t\t{\n\t\t\t\tif(i === 0)\n\t\t\t\t{\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(panels[i].args.z > this.args.z)\n\t\t\t{\n\t\t\t\tpanels[i].args.z--;\n\t\t\t}\n\t\t}\n\n\t\tthis.args.z = panels.length;\n\t}\n\n\tcontextmenu(event, file, icon)\n\t{\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\n\t\tif(this.args.type !== 'root')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(!file)\n\t\t{\n\t\t\tthis.args.contextMenu = [\n\t\t\t\t{title: 'import', callback: () => {\n\t\t\t\t\ticon.args.widgets[0].importFile()\n\t\t\t\t\tthis.args.contextMenu = [];\n\t\t\t\t}},\n\t\t\t];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.args.contextMenu = [\n\t\t\t\t{title: 'open',   callback: () => icon.openCanvasPanel(file)},\n\t\t\t\t{title: 'delete', callback: () => this.openDeleteDialog(file, icon)},\n\t\t\t];\n\t\t}\n\n\t\tthis.args.contextMenuX = event.pageX;\n\t\tconst docWidth  = document.body.offsetWidth;\n\t\tconst docHeight = document.body.offsetHeight;\n\n\t\tif(event.pageX > 0.5 * docWidth)\n\t\t{\n\t\t\tthis.args.contextMenuXR = (docWidth - event.pageX) + 'px';\n\t\t\tthis.args.contextMenuXL = 'initial';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.args.contextMenuXR = 'initial';\n\t\t\tthis.args.contextMenuXL = event.pageX + 'px';\n\t\t}\n\n\t\tif(event.pageY > 0.5 * docHeight)\n\t\t{\n\t\t\tthis.args.contextMenuYB = (docHeight - event.pageY) + 'px';\n\t\t\tthis.args.contextMenuYT = 'initial';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.args.contextMenuYT = event.pageY + 'px';\n\t\t\tthis.args.contextMenuYB = 'initial';\n\t\t}\n\t}\n\n\tcontextmenuClicked(event, item, key)\n\t{\n\t\titem.callback(event, key);\n\n\t\tconsole.log(event, item, key);\n\t\tthis.args.contextMenu = [];\n\t}\n\n\topenDeleteDialog(file, icon)\n\t{\n\t\tconst deleteConfirm = new DeleteConfirm({panel:this, file, icon});\n\n\t\tthis.panels.add(deleteConfirm.panel);\n\t}\n\n\tstartFollow()\n\t{\n\t\tconst stopMoving = this.listen(window, 'mousemove', event => {\n\t\t\tthis.args.left = event.pageX - 10;\n\t\t\tthis.args.top  = event.pageY - 10;\n\t\t\tthis.args.moving = 'moving';\n\t\t});\n\n\t\tthis.listen(window, 'mouseup', event => {\n\t\t\tthis.args.moving = '';\n\n\t\t\tstopMoving();\n\t\t});\n\t}\n\n\tclose()\n\t{\n\t\tif(this.args.widgets)\n\t\t{\n\t\t\tfor(const widget of this.args.widgets)\n\t\t\t{\n\t\t\t\tif(typeof widget == 'object' && typeof widget.remove == 'function')\n\t\t\t\t{\n\t\t\t\t\twidget.remove();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.remove();\n\t}\n}\n","import { Panel } from './Panel';\n\nconst MyPanel   = Symbol('MyPanel');\n\nexport class Panelable\n{\n\tget panel() {\n\t\treturn this[MyPanel] || (this[MyPanel] = new Panel({}, this));\n\t}\n};\n","module.exports = \"<div\\n\\tdata-module = \\\"panel\\\"\\n\\tclass = \\\"[[moving]]\\\"\\n\\tdata-panel-type = \\\"[[type]]\\\"\\n\\tcv-ref = \\\"panel\\\"\\n\\tcv-on = \\\"mousedown(event):c;contextmenu(event)\\\"\\n>\\n\\t<div class = \\\"titlebar\\\" cv-on = \\\"mousedown:startFollow(event)\\\" cv-if = \\\"title\\\">\\n\\t\\t<span class = \\\"icon inline-icon\\\"></span>\\n\\t\\t<span>[[title]]</span>\\n\\t\\t<div class = \\\"right\\\">\\n\\t\\t\\t<div class = \\\"icon inline-icon x-icon\\\" cv-on = \\\"click:close(event)\\\"></div>\\n\\t\\t</div>\\n\\t</div>\\n\\t<div class = \\\"widget\\\" cv-each = \\\"widgets:widget\\\">[[widget]]</div>\\n\\t<div class = \\\"panels\\\" cv-each = \\\"panels:panel\\\">[[panel]]</div>\\n\\n\\t<div class = \\\"context-menu\\\">\\n\\t\\t<div class = \\\"v-container\\\" cv-each = \\\"contextMenu:item:key\\\">\\n\\t\\t\\t<div cv-on = \\\"click:contextmenuClicked(event,item,key)\\\">[[item.title]]</div>\\n\\t\\t</div>\\n\\t</div>\\n</div>\\n\"","import { View } from 'curvature/base/View';\nimport { Panel } from '../panel/Panel';\nimport { Canvas } from '../canvas/Canvas';\n\nimport { FileModel } from '../file/FileModel';\nimport { FileDatabase } from '../file/FileDatabase';\n\nimport { Processor } from '../Processor';\n\nexport class DeleteConfirm extends Processor\n{\n\ttemplate = require('./delete-confirm.html');\n\ttable1 = [...Array(16)].map((_,i)=> (2 << i) - 1);\n\n\tconstructor(args,parent)\n\t{\n\t\tsuper(args, parent);\n\n\t\tObject.assign(this.panel.args, {title: 'Delete?'});\n\t}\n\n\trun()\n\t{\n\t\tconst fileDb = FileDatabase.open('files', 1);\n\n\t\tthis.args.file.id = this.args.file.name;\n\n\t\tconsole.log( this.args.file );\n\n\t\tfileDb\n\t\t.then(database => database.delete('files', this.args.file))\n\t\t.then(() => {\n\t\t\tthis.args.icon.refresh();\n\t\t\tthis.panel.close();\n\t\t});\n\t}\n\n\tclose()\n\t{\n\t\tthis.panel.close();\n\t}\n}\n","import { View } from 'curvature/base/View';\nimport { Panel } from '../panel/Panel';\nimport { Canvas } from '../canvas/Canvas';\n\nimport { Processor } from '../Processor';\n\nexport class Invert extends Processor\n{\n\ttemplate = require('./invert.html');\n\n\tconstructor(args,parent)\n\t{\n\t\tsuper(args, parent);\n\n\t\tObject.assign(this.panel.args, {title: 'Invert'});\n\t}\n\n\trun()\n\t{\n\t\tconst rootPanel = this.args.panel;\n\n\t\tconst offset = Number(this.args.offset);\n\t\tconst length = Number(this.args.length);\n\t\tconst input  = this.args.input.args.buffer;\n\n\t\tconst output = new Uint8Array(length);\n\n\t\tfor(let i = 0; i < length; i++)\n\t\t{\n\t\t\toutput[i] = input[i + offset] ^ 0b11111111;\n\t\t}\n\n\t\tconst title  = 'Inverted ' + this.args.inputName;\n\t\tconst widget = new Canvas({\n\t\t\tbuffer: output, panel: rootPanel, title\n\t\t\t, decoder: this.args.input.args.decoder\n\t\t\t, height: this.args.input.args.height\n\t\t\t, width: this.args.input.args.width\n\t\t\t, scale: this.args.input.args.scale\n\t\t});\n\n\t\trootPanel.panels.add(widget.panel);\n\n\t\tthis.remove();\n\t}\n}\n","import { View } from 'curvature/base/View';\nimport { Panel } from '../panel/Panel';\nimport { Canvas } from '../canvas/Canvas';\n\nimport { Processor } from '../Processor';\n\nimport { RleDelta } from 'pokemon-parser/decompress/RleDelta';\nimport { Merge }    from 'pokemon-parser/decompress/Merge';\n\nexport class RLE extends Processor\n{\n\ttemplate = require('./rle.html');\n\ttable1 = [...Array(16)].map((_,i)=> (2 << i) - 1);\n\n\tconstructor(args,parent)\n\t{\n\t\tsuper(args, parent);\n\n\t\tthis.sideSize = 7;\n\t\tthis.tileSize = 8;\n\n\t\tthis.args.offset = this.args.input.args.offset;\n\t\tthis.args.slow = false;\n\n\t\tObject.assign(this.panel.args, {title: 'RLE + Delta'});\n\t}\n\n\trun()\n\t{\n\t\tconst {rleDelta, rleWidget} = this.openRleWidget();\n\n\t\trleWidget.args.loading = true;\n\n\t\tconst {merge, mergeWidget} = this.openMergeWidget(rleDelta, rleWidget);\n\n\t\trleWidget.panel.args.widgets.push(mergeWidget);\n\n\t\tmergeWidget.rendered.then(() => {\n\t\t\treturn this.runRle(rleDelta, rleWidget)\n\t\t})\n\t\t.then(() => {\n\n\t\t\tmergeWidget.args.loading = true;\n\n\t\t\trleWidget.args.loading = false;\n\n\t\t\treturn this.runMerge(merge, mergeWidget);\n\n\t\t}).then(() => {\n\n\t\t\tmergeWidget.args.loading = false;\n\n\t\t});\n\n\t\tthis.remove();\n\t}\n\n\topenRleWidget()\n\t{\n\t\tconst inputBuffer = this.args.input.args.buffer;\n\t\tconst rootPanel   = this.args.panel;\n\t\tconst input       = inputBuffer.slice(this.args.offset)\n\t\tconst rleDelta    = new RleDelta(input);\n\t\tconst offset      = this.args.offset;\n\t\tconst name        = this.args.inputName;\n\n\n\t\tconst rleWidget = new Canvas({\n\t\t\tbuffer:    rleDelta.buffer\n\t\t\t, scale:   3\n\t\t\t, panel:   rootPanel\n\t\t\t, title:   `${name}@0x${offset.toString(16).toUpperCase()}_rle_delta.bin`\n\t\t\t, decoder: 'gameboy-1bit-cols'\n\t\t\t, width:   rleDelta.xSize\n\t\t\t, height:  rleDelta.xSize * 2\n\t\t});\n\n\t\trootPanel.panels.add(rleWidget.panel);\n\n\t\treturn {rleDelta, rleWidget};\n\t}\n\n\trunRle(rleDelta, rleWidget)\n\t{\n\t\tif(this.args.slow)\n\t\t{\n\t\t\tconst iterate = accept => {\n\t\t\t\tif(rleDelta.iterate())\n\t\t\t\t{\n\t\t\t\t\tsetTimeout(() => iterate(accept), 0);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\taccept();\n\t\t\t\t}\n\n\t\t\t\trleWidget.drawDots();\n\t\t\t};\n\n\t\t\treturn new Promise(iterate);\n\t\t}\n\n\t\trleDelta.decompress();\n\t\trleWidget.drawDots();\n\n\t\treturn Promise.resolve();\n\t}\n\n\topenMergeWidget(rleDelta, rleWidget)\n\t{\n\t\tconst rootPanel = this.args.panel;\n\n\t\tconst merge  = new Merge(rleDelta.buffer, rleDelta.xSize);\n\t\tconst name   = this.args.inputName;\n\t\tconst offset = this.args.offset;\n\n\t\tconst title  = `${name}@0x${offset.toString(16).toUpperCase()}_rle_delta_merged.bin`\n\n\t\tconst mergeWidget = new Canvas({\n\t\t\tbuffer: merge.buffer\n\t\t\t, panel: rootPanel\n\t\t\t, title\n\t\t\t, width: rleDelta.xSize\n\t\t\t, height: rleDelta.xSize\n\t\t\t, scale: 6\n\t\t\t, decoder: 'bytes'\n\t\t});\n\n\t\t// rootPanel.panels.add(mergeWidget.panel);\n\n\t\treturn {merge, mergeWidget};\n\t}\n\n\trunMerge(merge, mergeWidget)\n\t{\n\t\tif(this.args.slow)\n\t\t{\n\t\t\tconst iterate = accept => {\n\t\t\t\tif(merge.iterate())\n\t\t\t\t{\n\t\t\t\t\tsetTimeout(() => iterate(accept), 0);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\taccept();\n\t\t\t\t}\n\n\t\t\t\tmergeWidget.drawDots();\n\t\t\t};\n\n\t\t\treturn new Promise(iterate);\n\t\t}\n\n\t\tmerge.decompress();\n\t\tmergeWidget.drawDots();\n\n\t\treturn Promise.resolve();\n\t}\n}\n","import { View } from 'curvature/base/View';\nimport { Panel } from '../panel/Panel';\nimport { Canvas } from '../canvas/Canvas';\n\nimport { Processor } from '../Processor';\n\nexport class Slice extends Processor\n{\n\ttemplate = require('./slice.html');\n\n\tconstructor(args,parent)\n\t{\n\t\tsuper(args, parent);\n\n\t\tObject.assign(this.panel.args, {title: 'Slice'});\n\n\t\tconst start  = this.args.input.args.offset;\n\t\tconst length = this.args.input.args.length;\n\n\t\tthis.args.start = start;\n\t\tthis.args.end   = start + length;\n\t}\n\n\trun()\n\t{\n\t\tconst rootPanel = this.args.panel;\n\n\t\tconst start  = Number(this.args.start);\n\t\tconst end    = Number(this.args.end);\n\t\tconst input  = this.args.input.args.buffer;\n\t\tconst length = end - start;\n\n\t\tconst output = new Uint8Array(length);\n\n\t\tfor(let i = 0; i < length; i++)\n\t\t{\n\t\t\toutput[i] = input[i + start];\n\t\t}\n\n\t\tconst name     = this.args.inputName;\n\t\tconst startHex = start.toString(16).toUpperCase();\n\t\tconst endHex   = end.toString(16).toUpperCase();\n\n\t\tconst title    = `${name}@0x${startHex}.bin`\n\n\t\tconst widget   = new Canvas({\n\t\t\tbuffer: output, panel: rootPanel, title\n\t\t\t, decoder: this.args.input.args.decoder\n\t\t\t, height: 32\n\t\t\t, width: 128\n\t\t\t, scale: 2\n\t\t});\n\n\t\trootPanel.panels.add(widget.panel);\n\n\t\tthis.remove();\n\t}\n}\n","module.exports = \"<div data-module = \\\"canvas invert\\\">\\n\\t<div class = \\\"column\\\">\\n\\n\\t\\t<label><p>Are you sure?</p></label>\\n\\n\\t\\t<div class = \\\"row right\\\">\\n\\t\\t\\t<button cv-on = \\\"click:run()\\\">yes</button>\\n\\t\\t\\t<button cv-on = \\\"click:close()\\\">no</button>\\n\\t\\t</div>\\n\\n\\t</div>\\n</div>\\n\"","module.exports = \"<div data-module = \\\"canvas invert\\\">\\n\\t<div class = \\\"column\\\">\\n\\t\\t<label><p>input buffer: [[inputName]]</p></label>\\n\\t\\t<label class = \\\"column\\\">\\n\\t\\t\\t<p>offset</p>\\n\\t\\t\\t<input type = \\\"number\\\" cv-bind = \\\"offset\\\">\\n\\t\\t</label>\\n\\t\\t<label class = \\\"column\\\">\\n\\t\\t\\t<p>length</p>\\n\\t\\t\\t<input type = \\\"number\\\" cv-bind = \\\"length\\\">\\n\\t\\t</label>\\n\\t\\t<div class = \\\"row right\\\">\\n\\t\\t\\t<button cv-on = \\\"click:run(event)\\\">invert</button>\\n\\t\\t</div>\\n\\t</div>\\n</div>\\n\"","module.exports = \"<div data-module = \\\"canvas invert\\\">\\n\\t<div class = \\\"column\\\">\\n\\n\\t\\t<label><p>input buffer: [[inputName]]</p></label>\\n\\n\\t\\t<label class = \\\"column\\\">\\n\\t\\t\\t<p>offset</p>\\n\\t\\t\\t<input cv-bind = \\\"offset\\\">\\n\\t\\t</label>\\n\\n\\t\\t<label class = \\\"column\\\">\\n\\t\\t\\t<p>slow</p>\\n\\t\\t\\t<input cv-bind = \\\"slow\\\" type = \\\"checkbox\\\"  value = \\\"1\\\">\\n\\n\\t\\t</label>\\n\\n\\t\\t<div class = \\\"row right\\\">\\n\\t\\t\\t<button cv-on = \\\"click:run(event)\\\">decompress</button>\\n\\t\\t</div>\\n\\n\\t</div>\\n</div>\\n\"","module.exports = \"<div data-module = \\\"canvas invert\\\">\\n\\t<div class = \\\"column\\\">\\n\\t\\t<label><p>input buffer: [[inputName]]</p></label>\\n\\t\\t<label class = \\\"column\\\">\\n\\t\\t\\t<p>start</p>\\n\\t\\t\\t<input cv-bind = \\\"start\\\">\\n\\t\\t</label>\\n\\t\\t<label class = \\\"column\\\">\\n\\t\\t\\t<p>end</p>\\n\\t\\t\\t<input cv-bind = \\\"end\\\">\\n\\t\\t</label>\\n\\t\\t<div class = \\\"row right\\\">\\n\\t\\t\\t<button cv-on = \\\"click:run(event)\\\">slice</button>\\n\\t\\t</div>\\n\\t</div>\\n</div>\\n\"","/* jshint ignore:start */\n(function() {\n  var WebSocket = window.WebSocket || window.MozWebSocket;\n  var br = window.brunch = (window.brunch || {});\n  var ar = br['auto-reload'] = (br['auto-reload'] || {});\n  if (!WebSocket || ar.disabled) return;\n  if (window._ar) return;\n  window._ar = true;\n\n  var cacheBuster = function(url){\n    var date = Math.round(Date.now() / 1000).toString();\n    url = url.replace(/(\\&|\\\\?)cacheBuster=\\d*/, '');\n    return url + (url.indexOf('?') >= 0 ? '&' : '?') +'cacheBuster=' + date;\n  };\n\n  var browser = navigator.userAgent.toLowerCase();\n  var forceRepaint = ar.forceRepaint || browser.indexOf('chrome') > -1;\n\n  var reloaders = {\n    page: function(){\n      window.location.reload(true);\n    },\n\n    stylesheet: function(){\n      [].slice\n        .call(document.querySelectorAll('link[rel=stylesheet]'))\n        .filter(function(link) {\n          var val = link.getAttribute('data-autoreload');\n          return link.href && val != 'false';\n        })\n        .forEach(function(link) {\n          link.href = cacheBuster(link.href);\n        });\n\n      // Hack to force page repaint after 25ms.\n      if (forceRepaint) setTimeout(function() { document.body.offsetHeight; }, 25);\n    },\n\n    javascript: function(){\n      var scripts = [].slice.call(document.querySelectorAll('script'));\n      var textScripts = scripts.map(function(script) { return script.text }).filter(function(text) { return text.length > 0 });\n      var srcScripts = scripts.filter(function(script) { return script.src });\n\n      var loaded = 0;\n      var all = srcScripts.length;\n      var onLoad = function() {\n        loaded = loaded + 1;\n        if (loaded === all) {\n          textScripts.forEach(function(script) { eval(script); });\n        }\n      }\n\n      srcScripts\n        .forEach(function(script) {\n          var src = script.src;\n          script.remove();\n          var newScript = document.createElement('script');\n          newScript.src = cacheBuster(src);\n          newScript.async = true;\n          newScript.onload = onLoad;\n          document.head.appendChild(newScript);\n        });\n    }\n  };\n  var port = ar.port || 9485;\n  var host = br.server || window.location.hostname || 'localhost';\n\n  var connect = function(){\n    var connection = new WebSocket('ws://' + host + ':' + port);\n    connection.onmessage = function(event){\n      if (ar.disabled) return;\n      var message = event.data;\n      var reloader = reloaders[message] || reloaders.page;\n      reloader();\n    };\n    connection.onerror = function(){\n      if (connection.readyState) connection.close();\n    };\n    connection.onclose = function(){\n      window.setTimeout(connect, 1000);\n    };\n  };\n  connect();\n})();\n/* jshint ignore:end */\n"]}